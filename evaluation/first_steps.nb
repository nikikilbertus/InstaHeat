(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    437533,      12386]
NotebookOptionsPosition[    411540,      11587]
NotebookOutlinePosition[    411917,      11604]
CellTagsIndexPosition[    411874,      11601]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
mk_fourier_spectral_operators revisited\
\>", "Section",
 CellChangeTimes->{{3.655590744365844*^9, 3.655590772491901*^9}}],

Cell[BoxData[
 RowBox[{"Quit", "[", "]"}]], "Input",
 CellChangeTimes->{{3.655153761350109*^9, 3.65515376261451*^9}}],

Cell[BoxData[
 RowBox[{"origPoints", " ", "=", " ", 
  RowBox[{
   RowBox[{"-", "\[Pi]"}], "+", 
   FractionBox[
    RowBox[{"2", " ", "\[Pi]", " ", "i"}], "Np"]}]}]], "Input",
 CellChangeTimes->{{3.655150793279812*^9, 3.655150831239789*^9}, {
  3.655151342142723*^9, 3.655151343158386*^9}, {3.6551513859324837`*^9, 
  3.655151386100369*^9}, {3.655153718216855*^9, 3.655153720832675*^9}}],

Cell[BoxData[
 RowBox[{"scaledPoints", " ", "=", " ", 
  RowBox[{
   RowBox[{"origPoints", " ", "*", " ", 
    FractionBox[
     RowBox[{"(", 
      RowBox[{"b", "-", "a"}], ")"}], 
     RowBox[{"2", " ", "\[Pi]"}]]}], " ", "//", " ", "Simplify"}]}]], "Input",\

 CellChangeTimes->{{3.655150834467767*^9, 3.655150877661848*^9}}],

Cell[BoxData[
 RowBox[{"shiftandscaledPoints", " ", "=", " ", 
  RowBox[{
   RowBox[{"scaledPoints", " ", "+", " ", 
    FractionBox[
     RowBox[{"(", 
      RowBox[{"b", "-", "a"}], ")"}], "2"], "+", " ", "a"}], " ", "//", " ", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.655150906522875*^9, 3.655150929202509*^9}, {
  3.655151199181274*^9, 3.655151247611217*^9}, {3.655151513774433*^9, 
  3.655151514374119*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Simplify", "@", "origPoints"}], " ", "==", " ", 
  RowBox[{"Simplify", "@", 
   RowBox[{"(", 
    RowBox[{"shiftandscaledPoints", " ", "/.", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", "\[Rule]", " ", 
        RowBox[{"-", "\[Pi]"}]}], ",", " ", 
       RowBox[{"b", "\[Rule]", " ", "\[Pi]"}]}], "}"}]}], ")"}]}]}]], "Input",\

 CellChangeTimes->{{3.655150973200231*^9, 3.655151065676188*^9}}],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"shiftandscaledPoints", " ", "/.", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", "\[Rule]", " ", 
        RowBox[{"-", "\[Pi]"}]}], ",", " ", 
       RowBox[{"b", "\[Rule]", " ", "\[Pi]"}], ",", " ", 
       RowBox[{"Np", "\[Rule]", " ", "51"}]}], "}"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "0", ",", "50"}], "}"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6551509378460503`*^9, 3.655150967377304*^9}, {
  3.655151089707018*^9, 3.6551511004832*^9}, {3.655151310888871*^9, 
  3.655151321111948*^9}, {3.655153730007979*^9, 3.655153731584453*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"x", "[", 
    RowBox[{"asub_", ",", "bsub_", ",", "Nsub_"}], "]"}], " ", ":=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"N", "@", "shiftandscaledPoints"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", 
         RowBox[{"Nsub", "-", "1"}]}], "}"}]}], "]"}], " ", "//.", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", "\[Rule]", " ", "asub"}], ",", " ", 
       RowBox[{"b", "\[Rule]", " ", "bsub"}], ",", " ", 
       RowBox[{"Np", "\[Rule]", " ", "Nsub"}]}], "}"}]}], ")"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.655153852104765*^9, 3.6551538865208282`*^9}, {
  3.6551545981978273`*^9, 3.655154646506571*^9}, {3.655156822438856*^9, 
  3.655156830774581*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"asub", "=", 
   RowBox[{"-", "\[Pi]"}]}], ";", " ", 
  RowBox[{"bsub", "=", "\[Pi]"}], ";", " ", 
  RowBox[{"Nsub", " ", "=", " ", "51"}], ";"}]], "Input",
 CellChangeTimes->{{3.655154667869948*^9, 3.6551546834085712`*^9}, {
  3.655156788272337*^9, 3.6551567903920517`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"N", "@", 
      RowBox[{"Min", "@", "#"}]}], ",", 
     RowBox[{"N", "@", 
      RowBox[{"Max", "@", "#"}]}], ",", 
     RowBox[{"Length", "@", "#"}]}], "}"}], "&"}], "@", " ", 
  RowBox[{"x", "[", 
   RowBox[{"asub", ",", "bsub", ",", "Nsub"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.655151143711863*^9, 3.6551511681763487`*^9}, {
   3.655151268571808*^9, 3.655151276394033*^9}, 3.65515373432936*^9, {
   3.655153780535063*^9, 3.6551537830226927`*^9}, 3.655153850572686*^9, {
   3.655153890808606*^9, 3.65515389167177*^9}, {3.655154664625476*^9, 
   3.655154688921275*^9}, {3.6551568371267223`*^9, 3.655156838518098*^9}}],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"shiftandscaledPoints", " ", "/.", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", "\[Rule]", " ", "2"}], ",", " ", 
       RowBox[{"b", "\[Rule]", " ", "10"}], ",", " ", 
       RowBox[{"Np", "\[Rule]", " ", "Nsub"}]}], "}"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "0", ",", 
      RowBox[{"Nsub", "-", "1"}]}], "}"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.655151123857177*^9, 3.6551511288893023`*^9}, 
   3.655153736496399*^9, {3.655153841650893*^9, 3.65515384524258*^9}, {
   3.65515390507996*^9, 3.65515390953561*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"d1", " ", "=", " ", 
   FractionBox[
    RowBox[{"\[Pi]", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"-", "1"}], ")"}], 
      RowBox[{"i", "+", "j"}]]}], 
    RowBox[{
     RowBox[{"Sin", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"i", "-", "j"}], ")"}], " ", 
       FractionBox["\[Pi]", "Np"]}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{"b", "-", "a"}], ")"}]}]]}], ";"}]], "Input",
 CellChangeTimes->{{3.6551532693442097`*^9, 3.6551533235169764`*^9}, 
   3.6551537394969482`*^9, {3.655154411022931*^9, 3.655154416862465*^9}, {
   3.655154486475398*^9, 3.655154486811421*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"d1mat", "[", 
    RowBox[{"asub_", ",", "bsub_", ",", "Nsub_"}], "]"}], ":=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"i", "\[Equal]", "j"}], ",", "0.0", ",", 
         RowBox[{"N", "@", "d1"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", 
         RowBox[{"Np", "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "0", ",", 
         RowBox[{"Np", "-", "1"}]}], "}"}]}], "]"}], " ", "//.", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Np", "\[Rule]", " ", "Nsub"}], ",", " ", 
       RowBox[{"a", "\[Rule]", " ", "asub"}], ",", " ", 
       RowBox[{"b", "\[Rule]", " ", "bsub"}]}], "}"}]}], ")"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6551541974309607`*^9, 3.655154254327396*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"d1orig", " ", "=", " ", 
   FractionBox[
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"-", "1"}], ")"}], 
     RowBox[{"i", "+", "j"}]], 
    RowBox[{"2", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"i", "-", "j"}], ")"}], " ", 
       FractionBox["\[Pi]", "Np"]}], "]"}]}]]}], ";"}]], "Input",
 CellChangeTimes->{{3.6551534945160437`*^9, 3.655153568440838*^9}, 
   3.6551537515517817`*^9, {3.655154421278438*^9, 3.655154422206341*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Simplify", "[", 
   RowBox[{"d1orig", " ", 
    FractionBox[
     RowBox[{"2", " ", "\[Pi]"}], 
     RowBox[{"b", "-", "a"}]]}], "]"}], " ", "\[Equal]", " ", 
  RowBox[{"Simplify", "[", "d1", "]"}]}]], "Input",
 CellChangeTimes->{{3.6551554034666*^9, 3.655155432691915*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"d1matorig", "[", "Nsub_", "]"}], " ", ":=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"i", "\[Equal]", "j"}], ",", "0.0", ",", 
         RowBox[{"N", "@", "d1orig"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", 
         RowBox[{"Np", "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "0", ",", 
         RowBox[{"Np", "-", "1"}]}], "}"}]}], "]"}], " ", "//.", " ", 
     RowBox[{"{", 
      RowBox[{"Np", "\[Rule]", " ", "Nsub"}], "}"}]}], ")"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.655153579785368*^9, 3.6551535870392323`*^9}, {
  3.655153752999508*^9, 3.6551537560949783`*^9}, {3.6551538035489264`*^9, 
  3.655153827883072*^9}, {3.655153975308917*^9, 3.655153975588518*^9}, {
  3.655154264870474*^9, 3.655154280813568*^9}, {3.65515434047404*^9, 
  3.655154346482342*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"d1matorig", "[", "Nsub", "]"}], " ", "\[Equal]", " ", 
  RowBox[{"d1mat", "[", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], ",", "\[Pi]", ",", "Nsub"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6551542878096447`*^9, 3.655154315258739*^9}, {
  3.655154355521289*^9, 3.6551543572807713`*^9}, {3.6551547179512157`*^9, 
  3.655154721518672*^9}}],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"#", ",", 
      RowBox[{"Sin", "[", "#", "]"}]}], "}"}], "&"}], "/@", 
   RowBox[{"x", "[", 
    RowBox[{"asub", ",", "bsub", ",", "Nsub"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.655153829770914*^9, 3.655153831066245*^9}, {
  3.655153992922329*^9, 3.6551540280495033`*^9}, {3.655154732646964*^9, 
  3.655154734830585*^9}, {3.65515507990329*^9, 3.6551550862371187`*^9}, {
  3.655156884596385*^9, 3.655156885947163*^9}}],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"ListPlot", "[", 
    RowBox[{"Thread", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"asub", ",", "bsub", ",", "Nsub"}], "]"}], ",", 
       RowBox[{
        RowBox[{"d1mat", "[", 
         RowBox[{"asub", ",", "bsub", ",", "Nsub"}], "]"}], ".", 
        RowBox[{"Sin", "[", 
         RowBox[{"x", "[", 
          RowBox[{"asub", ",", "bsub", ",", "Nsub"}], "]"}], "]"}]}]}], "}"}],
      "]"}], "]"}], ",", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"Cos", "[", "x", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}]}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.655154104305175*^9, 3.655154116724783*^9}, {
  3.65515455175161*^9, 3.655154557390983*^9}, {3.655154748456993*^9, 
  3.655154760501253*^9}, {3.655155094237002*^9, 3.655155233334446*^9}, {
  3.655156892395446*^9, 3.6551569000036707`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"d1mat", "[", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], ",", "\[Pi]", ",", "5"}], "]"}], " ", "//", " ", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.6551545416875143`*^9, 3.655154546687203*^9}, {
  3.6551548964275627`*^9, 3.655154908333261*^9}, {3.6551549478434153`*^9, 
  3.655154949915141*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"d1mat", "[", 
    RowBox[{
     RowBox[{"-", "\[Pi]"}], ",", "\[Pi]", ",", "5"}], "]"}], ".", 
   RowBox[{"d1mat", "[", 
    RowBox[{
     RowBox[{"-", "\[Pi]"}], ",", "\[Pi]", ",", "5"}], "]"}]}], " ", "//", 
  " ", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.655231010707868*^9, 3.6552310108999567`*^9}}],

Cell[BoxData[
 RowBox[{"x", "[", 
  RowBox[{
   RowBox[{"-", "\[Pi]"}], ",", "\[Pi]", ",", "5"}], "]"}]], "Input",
 CellChangeTimes->{{3.6551549233143587`*^9, 3.6551549265323467`*^9}, {
  3.655156907745607*^9, 3.6551569168651867`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"d2orig", " ", "=", " ", 
   FractionBox[
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", "Mp"}], ")"}], "2"], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"j", "-", "i"}], ")"}], " ", "\[Pi]", " ", 
          FractionBox[
           RowBox[{"(", 
            RowBox[{"Np", "-", "2"}], ")"}], "Np"]}], "]"}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"j", "-", "i"}], ")"}], " ", 
           FractionBox["\[Pi]", "Np"]}], "]"}], "3"], " "}]], "+", 
      RowBox[{
       SuperscriptBox["Mp", "2"], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"j", "-", "i"}], ")"}], " ", "\[Pi]", " ", 
         FractionBox[
          RowBox[{"(", 
           RowBox[{"Np", "+", "2"}], ")"}], "Np"]}], "]"}]}]}], ")"}], 
    RowBox[{"4", " ", "Np"}]]}], ";"}]], "Input",
 CellChangeTimes->{{3.6551553748492317`*^9, 3.6551553824615307`*^9}, {
  3.655155467825651*^9, 3.655155544982834*^9}, {3.655155711888338*^9, 
  3.655155720877603*^9}, {3.655155765045697*^9, 3.655155784600442*^9}, {
  3.6551558322746277`*^9, 3.655155867183258*^9}, {3.655155929723876*^9, 
  3.6551560338077803`*^9}, {3.655156407596376*^9, 3.655156432541626*^9}, {
  3.65515653459939*^9, 3.655156546605783*^9}, {3.655156635569347*^9, 
  3.655156636625766*^9}, {3.6551576018498783`*^9, 3.6551576357204037`*^9}}],

Cell[BoxData[
 RowBox[{"d2", " ", "=", " ", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{"-", "1"}], 
     SuperscriptBox["Np", "2"]], 
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox[
       RowBox[{"2", " ", "\[Pi]"}], 
       RowBox[{"b", "-", "a"}]], ")"}], "2"], " ", "*", " ", "d2orig"}], " ", 
   "//", " ", "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.6551560509924*^9, 3.655156089403677*^9}, {
  3.6551567610738*^9, 3.6551567688257017`*^9}, {3.655157644670623*^9, 
  3.6551576521900787`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "Mp"}], " ", 
     FractionBox[
      RowBox[{"(", 
       RowBox[{"1", "+", "Mp"}], ")"}], "3"]}], " ", "/.", " ", 
    RowBox[{"{", 
     RowBox[{"Mp", "\[Rule]", 
      FractionBox[
       RowBox[{"(", 
        RowBox[{"Np", "-", "1"}], ")"}], "2"]}], "}"}]}], ")"}], " ", "//", 
  " ", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.655156214344034*^9, 3.655156283249818*^9}, {
  3.65515650788913*^9, 3.6551565279730988`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"d2mat", "[", 
    RowBox[{"asub_", ",", "bsub_", ",", "Nsub_"}], "]"}], ":=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"i", "\[Equal]", "j"}], ",", " ", 
         RowBox[{
          FractionBox[
           RowBox[{"-", "1"}], 
           SuperscriptBox["Np", "2"]], 
          FractionBox[
           RowBox[{"(", 
            RowBox[{"1", "-", 
             SuperscriptBox["Np", "2"]}], ")"}], "12"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"2", " ", 
             FractionBox["\[Pi]", 
              RowBox[{"b", "-", "a"}]]}], ")"}], "2"]}], ",", 
         RowBox[{"N", "@", "d2"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", 
         RowBox[{"Np", "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "0", ",", 
         RowBox[{"Np", "-", "1"}]}], "}"}]}], "]"}], " ", "//.", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Mp", "\[Rule]", " ", 
        FractionBox[
         RowBox[{"(", 
          RowBox[{"Nsub", "-", "1"}], ")"}], "2"]}], ",", 
       RowBox[{"Np", "\[Rule]", " ", "Nsub"}], ",", " ", 
       RowBox[{"a", "\[Rule]", " ", "asub"}], ",", " ", 
       RowBox[{"b", "\[Rule]", " ", "bsub"}]}], "}"}]}], ")"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.655156103139421*^9, 3.655156109531315*^9}, {
  3.6551563151372833`*^9, 3.655156343919249*^9}, {3.655156467826412*^9, 
  3.655156487759646*^9}, {3.6551566472093267`*^9, 3.655156690647347*^9}, {
  3.6551576679672194`*^9, 3.655157685837167*^9}}],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"ListPlot", "[", 
    RowBox[{"Thread", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"asub", ",", "bsub", ",", "Nsub"}], "]"}], ",", 
       RowBox[{
        RowBox[{"d2mat", "[", 
         RowBox[{"asub", ",", "bsub", ",", "Nsub"}], "]"}], ".", 
        RowBox[{"Sin", "[", 
         RowBox[{"x", "[", 
          RowBox[{"asub", ",", "bsub", ",", "Nsub"}], "]"}], "]"}]}]}], "}"}],
      "]"}], "]"}], ",", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Sin", "[", "x", "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}]}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.655156128129233*^9, 3.655156132528862*^9}, {
  3.6551569565042048`*^9, 3.65515696523018*^9}, {3.655157113481565*^9, 
  3.655157128327496*^9}, {3.6551574939589653`*^9, 3.6551575765301533`*^9}, {
  3.655157749490309*^9, 3.655157770400722*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"d2mat", "[", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], ",", "\[Pi]", ",", "5"}], "]"}], " ", "//", " ", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.655230984539833*^9, 3.65523098476413*^9}}],

Cell[BoxData[
 RowBox[{"Nsub", " ", "=", " ", "11"}]], "Input",
 CellChangeTimes->{{3.655157827989543*^9, 3.655157834155653*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}]}], "}"}], "\[ConjugateTranspose]"}], 
  "  ", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.6551580006965437`*^9, 3.6551580732324467`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"d1mat", "[", 
    RowBox[{"asub", ",", "bsub", ",", "Nsub"}], "]"}], " ", "+", " ", 
   RowBox[{
    RowBox[{"d1mat", "[", 
     RowBox[{"asub", ",", "bsub", ",", "Nsub"}], "]"}], 
    "\[ConjugateTranspose]"}]}], " ", "//", " ", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.6551569749764423`*^9, 3.655156981382307*^9}, {
  3.655157133118905*^9, 3.655157156749825*^9}, {3.655157734113798*^9, 
  3.655157735265071*^9}, {3.655157794135144*^9, 3.6551578192451363`*^9}, {
  3.6551578543639383`*^9, 3.655157862674376*^9}, {3.6551579606404133`*^9, 
  3.655157995261882*^9}, {3.655158078624186*^9, 3.6551580957593317`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "solving wave equation with ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[Phi]", "2"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " and ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[Phi]", "4"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " potential"
}], "Section",
 CellChangeTimes->{{3.655575111199752*^9, 3.655575114645688*^9}, {
  3.655590787668131*^9, 3.655590842472245*^9}}],

Cell[BoxData[
 RowBox[{"Quit", "[", "]"}]], "Input",
 CellChangeTimes->{{3.655576157110862*^9, 3.6555761597959414`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"m", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", " ", "=", " ", "100"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Vprime", " ", "=", " ", 
   RowBox[{
    RowBox[{
     SuperscriptBox["m", "2"], " ", 
     RowBox[{"\[Phi]", "[", 
      RowBox[{"x", ",", "t"}], "]"}]}], " ", "+", " ", 
    RowBox[{
     FractionBox["g", "6"], " ", 
     SuperscriptBox[
      RowBox[{"\[Phi]", "[", 
       RowBox[{"x", ",", "t"}], "]"}], "3"]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Phi]init", " ", "=", " ", 
   RowBox[{"Sin", "[", "x", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d\[Phi]init", " ", "=", " ", 
   RowBox[{"-", 
    RowBox[{"Cos", "[", "x", "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.655576703488723*^9, 3.655576710833851*^9}, {
  3.655576883083097*^9, 3.655576883227063*^9}, {3.655577149159746*^9, 
  3.655577149423852*^9}, {3.655577373533228*^9, 3.655577373684922*^9}, {
  3.6555774374752417`*^9, 3.655577437585413*^9}, {3.65558085456282*^9, 
  3.655580949179134*^9}, {3.655580979913741*^9, 3.6555810061439466`*^9}, {
  3.655581201594098*^9, 3.655581207863261*^9}, {3.6555828020702553`*^9, 
  3.655582804732607*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"eqn", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"x", ",", "t"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "2"}], "}"}]}], "]"}], " ", "-", " ", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"x", ",", "t"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "2"}], "}"}]}], "]"}], " ", "+", " ", "Vprime"}], 
    " ", "\[Equal]", " ", "0"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.655575846843227*^9, 3.655575849034733*^9}, {
  3.65557656569197*^9, 3.6555766002163067`*^9}, {3.655576716442801*^9, 
  3.65557671814624*^9}, {3.6555768804782457`*^9, 3.655576891243807*^9}, {
  3.655576991349042*^9, 3.655577007378632*^9}, {3.6555809102516336`*^9, 
  3.655580912971179*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ic", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Phi]", "[", 
       RowBox[{
        RowBox[{"-", "\[Pi]"}], ",", "t"}], "]"}], "\[Equal]", " ", 
      RowBox[{"\[Phi]", "[", 
       RowBox[{"\[Pi]", ",", "t"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"\[Phi]", "[", 
       RowBox[{"x", ",", "0"}], "]"}], "\[Equal]", "\[Phi]init"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Derivative", "[", 
         RowBox[{"0", ",", "1"}], "]"}], "[", "\[Phi]", "]"}], "[", 
       RowBox[{"x", ",", "0"}], "]"}], "\[Equal]", "d\[Phi]init"}]}], "}"}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.655575850673994*^9, 3.655575866747387*^9}, {
  3.655575907913494*^9, 3.655575930672083*^9}, {3.6555763295763893`*^9, 
  3.655576331503717*^9}, {3.6555763759376717`*^9, 3.655576378037133*^9}, {
  3.6555764327087717`*^9, 3.655576452656415*^9}, {3.655576667597452*^9, 
  3.655576686588431*^9}, {3.655576737201189*^9, 3.65557673926538*^9}, {
  3.6555809301655283`*^9, 3.65558094624299*^9}}],

Cell[BoxData[
 RowBox[{"sol", " ", "=", " ", 
  RowBox[{
   RowBox[{"NDSolve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"eqn", ",", "ic"}], "}"}], ",", "\[Phi]", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"MaxStepFraction", "\[Rule]", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "2"}]]}], ",", " ", 
     RowBox[{"MaxStepSize", "\[Rule]", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "2"}]]}], ",", " ", 
     RowBox[{"Method", "\[Rule]", " ", 
      RowBox[{"{", "\"\<ExplicitRungeKutta\>\"", "}"}]}]}], "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "1"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.655575452228568*^9, 3.655575611224907*^9}, {
  3.655575801889556*^9, 3.655575864577633*^9}, {3.655575934047493*^9, 
  3.6555759355597153`*^9}, {3.655575985577696*^9, 3.655575986263809*^9}, {
  3.655576386647546*^9, 3.6555764196074877`*^9}, {3.6555764893278027`*^9, 
  3.655576504902896*^9}, {3.655576624111209*^9, 3.6555766245750227`*^9}, {
  3.655576690843895*^9, 3.655576691395462*^9}, {3.655577352246397*^9, 
  3.65557737107928*^9}, {3.6555834248502398`*^9, 3.655583462613618*^9}, {
  3.655583499436181*^9, 3.655583500467737*^9}, {3.655583563924025*^9, 
  3.655583611264083*^9}, {3.6555836953002853`*^9, 3.655583707702157*^9}, {
  3.6555837469900723`*^9, 3.6555837934372387`*^9}, {3.6555838323532143`*^9, 
  3.655583893835231*^9}, {3.65558392615555*^9, 3.655583927987*^9}}],

Cell[BoxData[
 RowBox[{"Plot3D", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"\[Phi]", "/.", "sol"}], ")"}], "[", 
    RowBox[{"x", ",", "t"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "\[Pi]"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.655576462212126*^9, 3.6555765338030863`*^9}, {
  3.655576628414688*^9, 3.6555766285027733`*^9}, {3.655576694515492*^9, 
  3.655576694819356*^9}}],

Cell["not working", "Text",
 CellChangeTimes->{{3.655590858439865*^9, 3.655590859471366*^9}}],

Cell[BoxData[
 RowBox[{"exact", " ", "=", " ", 
  RowBox[{"DSolve", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"FullSimplify", "[", "eqn", "]"}], ",", 
      RowBox[{"FullSimplify", "[", "ic", "]"}]}], "}"}], ",", "\[Phi]", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "t"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.655577384661108*^9, 3.655577413217811*^9}}],

Cell["generally working:", "Text",
 CellChangeTimes->{{3.655590861551161*^9, 3.655590863646982*^9}}],

Cell[BoxData[
 RowBox[{"DSolve", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"y", "[", "x", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "2"}], "}"}]}], "]"}], " ", "-", " ", "5"}], " ", 
     "\[Equal]", " ", "0"}], "}"}], ",", "y", ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.655576199099813*^9, 3.655576289688387*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
further nonlinear potentials...\
\>", "Section",
 CellChangeTimes->{{3.6555882075010843`*^9, 3.6555882174267807`*^9}, {
  3.655590900862691*^9, 3.655590901149006*^9}}],

Cell[BoxData[
 RowBox[{"Quit", "[", "]"}]], "Input",
 CellChangeTimes->{{3.655589819877903*^9, 3.6555898210950613`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"func", " ", "=", " ", 
   RowBox[{"Tanh", "[", 
    SuperscriptBox["x", "4"], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.655588377883973*^9, 3.6555883840535994`*^9}}],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{"func", ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6555882186333027`*^9, 3.655588277024762*^9}, {
  3.6555883671593227`*^9, 3.655588389045083*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Vprime", " ", "=", " ", 
   RowBox[{"Tanh", "[", 
    SuperscriptBox[
     RowBox[{"\[Phi]", "[", 
      RowBox[{"x", ",", "t"}], "]"}], "4"], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Phi]init", " ", "=", " ", 
   RowBox[{"Sin", "[", "x", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d\[Phi]init", " ", "=", " ", "0"}], ";"}]}], "Input",
 CellChangeTimes->{{3.655576703488723*^9, 3.655576710833851*^9}, {
  3.655576883083097*^9, 3.655576883227063*^9}, {3.655577149159746*^9, 
  3.655577149423852*^9}, {3.655577373533228*^9, 3.655577373684922*^9}, {
  3.6555774374752417`*^9, 3.655577437585413*^9}, {3.65558085456282*^9, 
  3.655580949179134*^9}, {3.655580979913741*^9, 3.6555810061439466`*^9}, {
  3.655581201594098*^9, 3.655581207863261*^9}, {3.6555828020702553`*^9, 
  3.655582804732607*^9}, {3.6555885789334497`*^9, 3.6555885939883204`*^9}, {
  3.65558863691512*^9, 3.655588644545599*^9}, {3.655589868473386*^9, 
  3.6555898709124928`*^9}, {3.655590315738106*^9, 3.655590324440093*^9}, {
  3.6555903847396297`*^9, 3.655590385490342*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"eqn", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"x", ",", "t"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "2"}], "}"}]}], "]"}], " ", "-", " ", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"x", ",", "t"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "2"}], "}"}]}], "]"}], " ", "+", " ", "Vprime"}], 
    " ", "\[Equal]", " ", "0"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.655575846843227*^9, 3.655575849034733*^9}, {
  3.65557656569197*^9, 3.6555766002163067`*^9}, {3.655576716442801*^9, 
  3.65557671814624*^9}, {3.6555768804782457`*^9, 3.655576891243807*^9}, {
  3.655576991349042*^9, 3.655577007378632*^9}, {3.6555809102516336`*^9, 
  3.655580912971179*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ic", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Phi]", "[", 
       RowBox[{
        RowBox[{"-", "\[Pi]"}], ",", "t"}], "]"}], "\[Equal]", " ", 
      RowBox[{"\[Phi]", "[", 
       RowBox[{"\[Pi]", ",", "t"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"\[Phi]", "[", 
       RowBox[{"x", ",", "0"}], "]"}], "\[Equal]", "\[Phi]init"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Derivative", "[", 
         RowBox[{"0", ",", "1"}], "]"}], "[", "\[Phi]", "]"}], "[", 
       RowBox[{"x", ",", "0"}], "]"}], "\[Equal]", "d\[Phi]init"}]}], "}"}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.655575850673994*^9, 3.655575866747387*^9}, {
  3.655575907913494*^9, 3.655575930672083*^9}, {3.6555763295763893`*^9, 
  3.655576331503717*^9}, {3.6555763759376717`*^9, 3.655576378037133*^9}, {
  3.6555764327087717`*^9, 3.655576452656415*^9}, {3.655576667597452*^9, 
  3.655576686588431*^9}, {3.655576737201189*^9, 3.65557673926538*^9}, {
  3.6555809301655283`*^9, 3.65558094624299*^9}}],

Cell[BoxData[
 RowBox[{"sol", " ", "=", " ", 
  RowBox[{
   RowBox[{"NDSolve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"eqn", ",", "ic"}], "}"}], ",", "\[Phi]", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"MaxStepFraction", "\[Rule]", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "3"}]]}], ",", " ", 
     RowBox[{"MaxStepSize", "\[Rule]", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "3"}]]}], ",", " ", 
     RowBox[{"Method", "\[Rule]", " ", "Automatic"}]}], "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "1"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQnRfQ/rnE5rVjgVE6eymQtiu3kQfRP6qF1EG0QOtB
fRBt8PIjmK6pMTID0QqFHmB6046QDBDdVVCcA6JjarVKQXTbE5lyEM3Wz9wG
oqelCYFpA8boPhC9YHkOmK55xP4QRJd1Jj0G0Vqm0jcqgPShRZfvgGijr7kP
QfSW731geu7E2pcgOq444z2I/jD75U8QLVRR9htEr1kXz1AJpO/81WUD0R2+
3Nwg2mzXLiEQ7fLriBiIbpz6H0zHvzmeUw2kwxSegWnOv52WNUDa/O8qMF2X
1GsPoiUW3QDTALGnkYs=
  "]],

Cell[BoxData[
 RowBox[{"Plot3D", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"\[Phi]", "/.", "sol"}], ")"}], "[", 
    RowBox[{"x", ",", "t"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "\[Pi]"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.655576462212126*^9, 3.6555765338030863`*^9}, {
  3.655576628414688*^9, 3.6555766285027733`*^9}, {3.655576694515492*^9, 
  3.655576694819356*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "evaluate C vs ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " results"
}], "Section",
 CellChangeTimes->{{3.6555894195941668`*^9, 3.655589425905847*^9}, {
  3.6555909075661507`*^9, 3.655590908156703*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"compareCtoMath", "[", 
    RowBox[{"filenum_", ",", " ", "Nxloc_", ",", " ", "mathres_"}], "]"}], 
   " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SetDirectory", "[", 
       RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dt", " ", "=", 
       RowBox[{"0.1", " ", "*", " ", 
        SuperscriptBox["2", 
         RowBox[{"-", "filenum"}]]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"xvec", " ", "=", " ", 
       RowBox[{"N", "@", 
        RowBox[{"Most", "@", 
         RowBox[{"Range", "[", 
          RowBox[{
           RowBox[{"-", "\[Pi]"}], ",", "\[Pi]", ",", 
           RowBox[{"2", " ", 
            RowBox[{"\[Pi]", " ", "/", " ", 
             RowBox[{"(", "Nxloc", ")"}]}]}]}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vec", " ", "=", " ", 
       RowBox[{"Flatten", "@", 
        RowBox[{"Import", "[", 
         RowBox[{
          RowBox[{"\"\<vector_00\>\"", "<>", 
           RowBox[{"ToString", "[", "filenum", "]"}], "<>", "\"\<.txt\>\""}], 
          ",", "\"\<csv\>\""}], "]"}]}]}], ";", 
      RowBox[{"Nt", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "@", "vec"}], " ", "/", " ", "Nxloc"}], " ", "/", 
        " ", "2"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tvec", " ", "=", " ", 
       RowBox[{"Range", "[", 
        RowBox[{"0", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Nt", "-", "1"}], ")"}], " ", "dt"}], ",", " ", "dt"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"A", " ", "=", " ", 
       RowBox[{"Partition", "[", 
        RowBox[{"vec", ",", 
         RowBox[{"2", " ", "Nxloc"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"phi", "[", "filenum", "]"}], " ", "=", " ", 
       RowBox[{"A", "[", 
        RowBox[{"[", 
         RowBox[{";;", ",", 
          RowBox[{"1", ";;", "Nxloc"}]}], "]"}], "]"}]}], ";", 
      RowBox[{
       RowBox[{"phimath", "[", "filenum", "]"}], " ", "=", " ", 
       RowBox[{
        RowBox[{"Partition", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"\[Phi]", "/.", "sol"}], ")"}], "[", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}], " ", "&"}], "/@", " ", 
           RowBox[{"Tuples", "[", 
            RowBox[{"{", 
             RowBox[{"xvec", ",", "tvec"}], "}"}], "]"}]}], ",", "Nt"}], 
         "]"}], "\[ConjugateTranspose]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"diff", "[", "filenum", "]"}], "=", 
       RowBox[{"ListPlot3D", "[", 
        RowBox[{
         RowBox[{"phi", "[", "filenum", "]"}], " ", "-", " ", 
         RowBox[{"phimath", "[", "filenum", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"errors", "[", "filenum", "]"}], " ", "=", " ", 
       RowBox[{"Norm", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"phi", "[", "filenum", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}], "-", 
          RowBox[{
           RowBox[{"phimath", "[", "filenum", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}]}], ",", "2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{
        RowBox[{"errors", "[", "filenum", "]"}], ",", "Module"}], "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.655588919527837*^9, 3.655589210733796*^9}, 
   3.655589243557563*^9, {3.6555893295961514`*^9, 3.655589340273295*^9}, {
   3.655589464611271*^9, 3.655589479578299*^9}, {3.6555896263721657`*^9, 
   3.6555896829858093`*^9}, {3.655589794866194*^9, 3.655589795586275*^9}, {
   3.655589904244278*^9, 3.655589904587906*^9}, {3.655589938129221*^9, 
   3.655589950095606*^9}, 3.65558998267797*^9, {3.655590054031611*^9, 
   3.655590094514122*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Nx", " ", "=", " ", "51"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"files", " ", "=", " ", "7"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"errs", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"compareCtoMath", "[", 
      RowBox[{"#", ",", " ", "Nx", ",", " ", 
       RowBox[{"(", 
        RowBox[{"\[Phi]", " ", "/.", " ", "sol"}], ")"}]}], "]"}], " ", "&"}],
     " ", "/@", " ", 
    RowBox[{"Range", "[", 
     RowBox[{"0", ",", 
      RowBox[{"files", "-", "1"}]}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.655589345975498*^9, 3.655589530917797*^9}, {
  3.655589589898863*^9, 3.655589593482731*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dts", " ", "=", " ", 
   RowBox[{"0.1", "*", 
    SuperscriptBox["2", 
     RowBox[{"-", 
      RowBox[{"Range", "[", 
       RowBox[{"0", ",", 
        RowBox[{"files", "-", "1"}]}], "]"}]}]]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plotvalues", "=", 
   RowBox[{"Thread", "[", 
    RowBox[{"{", 
     RowBox[{"dts", ",", "errs"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListLogLogPlot", "[", 
  RowBox[{"plotvalues", ",", 
   RowBox[{"PlotRange", "\[Rule]", " ", "All"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6555906149413633`*^9, 3.655590618221045*^9}, {
  3.655590656067631*^9, 3.655590663308737*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"gooduntil", " ", "=", " ", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fitvals", " ", "=", 
   RowBox[{"Reverse", "@", 
    RowBox[{"plotvalues", "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", "gooduntil"}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fit", " ", "=", " ", 
   RowBox[{"FindFit", "[", 
    RowBox[{"fitvals", ",", " ", 
     RowBox[{"a", " ", 
      SuperscriptBox["x", "4"]}], ",", "a", ",", "x"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.6555906772904453`*^9, 3.655590706690441*^9}}],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"a", " ", 
        SuperscriptBox["x", "4"]}], " ", "/.", " ", "fit"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "0", ",", "0.1"}], "}"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", " ", "All"}]}], "]"}], ",", 
    RowBox[{"ListPlot", "[", "fitvals", "]"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.655584122123846*^9, 3.655584144964012*^9}, {
  3.6555841942080717`*^9, 3.655584262702096*^9}, {3.655584306355706*^9, 
  3.655584324139279*^9}, {3.655584433655712*^9, 3.6555844468062487`*^9}, {
  3.655584501405294*^9, 3.6555846179746027`*^9}, {3.655584695058155*^9, 
  3.6555847087125063`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
read data for comparison (development, now packaged)\
\>", "Section",
 CellChangeTimes->{{3.655581600107958*^9, 3.655581602026174*^9}, {
  3.655582772821844*^9, 3.655582774300695*^9}, {3.655590873398472*^9, 
  3.655590879686368*^9}}],

Cell[TextData[{
 "that was for:\n",
 Cell[BoxData[{
  RowBox[{
   RowBox[{"m", "=", "5"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"g", " ", "=", " ", "100"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Vprime", " ", "=", " ", 
    RowBox[{
     RowBox[{
      SuperscriptBox["m", "2"], " ", 
      RowBox[{"\[Phi]", "[", 
       RowBox[{"x", ",", "t"}], "]"}]}], " ", "+", " ", 
     RowBox[{
      FractionBox["g", "6"], " ", 
      SuperscriptBox[
       RowBox[{"\[Phi]", "[", 
        RowBox[{"x", ",", "t"}], "]"}], "3"]}]}]}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"\[Phi]init", " ", "=", " ", 
    RowBox[{"Sin", "[", "x", "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"d\[Phi]init", " ", "=", " ", 
    RowBox[{"-", 
     RowBox[{"Cos", "[", "x", "]"}]}]}], ";"}]}],
  CellChangeTimes->{{3.655576703488723*^9, 3.655576710833851*^9}, {
   3.655576883083097*^9, 3.655576883227063*^9}, {3.655577149159746*^9, 
   3.655577149423852*^9}, {3.655577373533228*^9, 3.655577373684922*^9}, {
   3.6555774374752417`*^9, 3.655577437585413*^9}, {3.65558085456282*^9, 
   3.655580949179134*^9}, {3.655580979913741*^9, 3.6555810061439466`*^9}, {
   3.655581201594098*^9, 3.655581207863261*^9}, {3.6555828020702553`*^9, 
   3.655582804732607*^9}}]
}], "Text",
 CellChangeTimes->{{3.655588501731317*^9, 3.655588536310463*^9}}],

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.655581552788537*^9, 3.6555815596944027`*^9}}],

Cell[CellGroupData[{

Cell["compute", "Subsection",
 CellChangeTimes->{{3.6555839522959223`*^9, 3.65558395284798*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"filenum", " ", "=", " ", "6"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Nx", " ", "=", " ", "51"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"dt", " ", "=", 
  RowBox[{"0.1", " ", "*", " ", 
   SuperscriptBox["2", 
    RowBox[{"-", "filenum"}]]}]}]}], "Input",
 CellChangeTimes->{{3.65558164928697*^9, 3.655581651185041*^9}, {
  3.6555818667305403`*^9, 3.65558187196279*^9}, {3.6555825586946898`*^9, 
  3.6555825806713343`*^9}, {3.655582952194742*^9, 3.655583009334552*^9}, {
  3.655583058468197*^9, 3.655583113345252*^9}, {3.655583935778722*^9, 
  3.6555839871755466`*^9}}],

Cell[BoxData[{
 RowBox[{"xvec", " ", "=", " ", 
  RowBox[{"N", "@", 
   RowBox[{"Most", "@", 
    RowBox[{"Range", "[", 
     RowBox[{
      RowBox[{"-", "\[Pi]"}], ",", "\[Pi]", ",", 
      RowBox[{"2", " ", 
       RowBox[{"\[Pi]", " ", "/", " ", 
        RowBox[{"(", "Nx", ")"}]}]}]}], "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"Length", "@", "xvec"}]}], "Input",
 CellChangeTimes->{{3.65558163511928*^9, 3.6555816803425694`*^9}, {
  3.65558175899343*^9, 3.655581857464614*^9}, {3.655582598271306*^9, 
  3.65558259849452*^9}, {3.6555828383316708`*^9, 3.6555828406431217`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"vec", " ", "=", " ", 
   RowBox[{"Flatten", "@", 
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{"\"\<vector_00\>\"", "<>", 
       RowBox[{"ToString", "[", "filenum", "]"}], "<>", "\"\<.txt\>\""}], 
      ",", "\"\<csv\>\""}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.655581524207985*^9, 3.655581539925984*^9}, {
  3.6555815718760366`*^9, 3.6555815794042387`*^9}, {3.655582604653244*^9, 
  3.655582615613431*^9}}],

Cell[BoxData[
 RowBox[{"Nt", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "@", "vec"}], " ", "/", " ", "Nx"}], " ", "/", " ", 
   "2"}]}]], "Input",
 CellChangeTimes->{{3.655581613866681*^9, 3.6555816148407707`*^9}, {
   3.655581903139007*^9, 3.6555819180239983`*^9}, 3.655582623619564*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tvec", " ", "=", " ", 
   RowBox[{"Range", "[", 
    RowBox[{"0", ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Nt", "-", "1"}], ")"}], " ", "dt"}], ",", " ", "dt"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "@", "tvec"}]}], "Input",
 CellChangeTimes->{{3.655581929712533*^9, 3.655581981795143*^9}, {
  3.655582627811273*^9, 3.6555826309228563`*^9}, {3.6555828450511627`*^9, 
  3.655582853578472*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"A", " ", "=", " ", 
   RowBox[{"Partition", "[", 
    RowBox[{"vec", ",", 
     RowBox[{"2", " ", "Nx"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", "A", "]"}]}], "Input",
 CellChangeTimes->{{3.655582121574016*^9, 3.655582213998741*^9}, {
  3.655582639540071*^9, 3.65558263982006*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"phi", " ", "=", " ", 
   RowBox[{"A", "[", 
    RowBox[{"[", 
     RowBox[{";;", ",", 
      RowBox[{"1", ";;", "Nx"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", "phi", "]"}]}], "Input",
 CellChangeTimes->{{3.655582227767475*^9, 3.655582253222035*^9}, {
  3.655582310748623*^9, 3.655582332939929*^9}, {3.6555826452103*^9, 
  3.655582647793869*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"phimath", " ", "=", " ", 
   RowBox[{
    RowBox[{"Partition", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Phi]", "/.", "sol"}], ")"}], "[", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "]"}], " ", "&"}], "/@", " ", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"xvec", ",", "tvec"}], "}"}], "]"}]}], ",", "Nt"}], "]"}], 
    "\[ConjugateTranspose]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", "phimath", "]"}]}], "Input",
 CellChangeTimes->{{3.6555823923207703`*^9, 3.655582451612816*^9}, {
  3.6555824845952597`*^9, 3.655582530905471*^9}, {3.655582654138753*^9, 
  3.655582665657631*^9}, {3.655582861483913*^9, 3.655582862714487*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"ListPlot3D", "[", 
   RowBox[{"phi", " ", "-", " ", "phimath"}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.6555824534276047`*^9, 3.6555824643290854`*^9}, {
   3.655582525120594*^9, 3.655582542479354*^9}, 3.655582669057219*^9, {
   3.655583069643276*^9, 3.655583075370717*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"errors", "[", "filenum", "]"}], " ", "=", " ", 
  RowBox[{"Norm", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"phi", "[", 
      RowBox[{"[", 
       RowBox[{"-", "1"}], "]"}], "]"}], "-", 
     RowBox[{"phimath", "[", 
      RowBox[{"[", 
       RowBox[{"-", "1"}], "]"}], "]"}]}], ",", "2"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.655582890575121*^9, 3.655582944826137*^9}, {
  3.655583018381768*^9, 3.6555830376128397`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["compare", "Subsection",
 CellChangeTimes->{{3.655583946864855*^9, 3.655583947384153*^9}}],

Cell[BoxData[{
 RowBox[{"dts", " ", "=", " ", 
  RowBox[{"0.1", "*", 
   SuperscriptBox["2", 
    RowBox[{"-", 
     RowBox[{"Range", "[", 
      RowBox[{"0", ",", "6"}], "]"}]}]]}]}], "\[IndentingNewLine]", 
 RowBox[{"Length", "@", "dts"}]}], "Input",
 CellChangeTimes->{{3.6555831708401403`*^9, 3.6555832169393463`*^9}}],

Cell[BoxData[
 RowBox[{"errs", " ", "=", " ", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"errors", "[", "i", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "0", ",", "6"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6555832402143087`*^9, 3.6555832511612864`*^9}}],

Cell[BoxData[
 RowBox[{"Thread", "[", 
  RowBox[{"{", 
   RowBox[{"dts", ",", "errs"}], "}"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"plotvalues", "=", 
   RowBox[{"Thread", "[", 
    RowBox[{"{", 
     RowBox[{"dts", ",", "errs"}], "}"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.655584078658087*^9, 3.65558408334231*^9}}],

Cell[BoxData[
 RowBox[{"ListLogLogPlot", "[", 
  RowBox[{"plotvalues", ",", 
   RowBox[{"PlotRange", "\[Rule]", " ", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.655583123735519*^9, 3.655583151022378*^9}, {
  3.655583221819365*^9, 3.655583254497882*^9}, {3.6555832904406853`*^9, 
  3.655583394256915*^9}, {3.655584003395084*^9, 3.6555840067938623`*^9}, {
  3.6555840775993547`*^9, 3.655584086740675*^9}}],

Cell[BoxData[
 RowBox[{"fitvals", " ", "=", 
  RowBox[{"Reverse", "@", 
   RowBox[{"plotvalues", "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "3"}], "]"}], "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{"fit", " ", "=", " ", 
  RowBox[{"FindFit", "[", 
   RowBox[{"fitvals", ",", " ", 
    RowBox[{"a", " ", 
     SuperscriptBox["x", "4"]}], ",", "a", ",", "x"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.655584390237035*^9, 3.655584490748826*^9}, {
  3.655584688881825*^9, 3.655584689688484*^9}}],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"a", " ", 
        SuperscriptBox["x", "4"]}], " ", "/.", " ", "fit"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "0", ",", "0.1"}], "}"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", " ", "All"}]}], "]"}], ",", 
    RowBox[{"ListPlot", "[", "fitvals", "]"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.655584122123846*^9, 3.655584144964012*^9}, {
  3.6555841942080717`*^9, 3.655584262702096*^9}, {3.655584306355706*^9, 
  3.655584324139279*^9}, {3.655584433655712*^9, 3.6555844468062487`*^9}, {
  3.655584501405294*^9, 3.6555846179746027`*^9}, {3.655584695058155*^9, 
  3.6555847087125063`*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.655583412983626*^9, 3.6555834135935087`*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["misc", "Section",
 CellChangeTimes->{{3.655592328674733*^9, 3.655592328857212*^9}}],

Cell[BoxData[
 RowBox[{"Quit", "[", "]"}]], "Input",
 CellChangeTimes->{{3.655669687359812*^9, 3.655669688178329*^9}}],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"Tanh", "[", 
    SuperscriptBox["x", "50"], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.65559233085631*^9, 3.655592349509688*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["filter windows..?", "Section",
 CellChangeTimes->{{3.65567217515525*^9, 3.655672177532392*^9}}],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"1", "-", 
    RowBox[{"Tanh", "[", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"1", "-", 
        SuperscriptBox["x", "6"]}]], "-", "1"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", " ", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6557479648176613`*^9, 3.6557481167385883`*^9}, {
  3.655748181960585*^9, 3.655748233534898*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Tanh", "[", 
       RowBox[{"1", "-", 
        SuperscriptBox[
         RowBox[{"(", 
          FractionBox["1", "x"], ")"}], "#"]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", 
       RowBox[{"3", "\[Pi]"}]}], "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", " ", "All"}]}], "]"}], " ", "&"}], "/@", 
  " ", 
  RowBox[{"Range", "[", 
   RowBox[{"2", ",", "10", ",", "2"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.65566877600126*^9, 3.655668813008852*^9}, {
  3.6556720327432632`*^9, 3.655672085613254*^9}, {3.655672183396626*^9, 
  3.65567221019565*^9}, {3.6557478456393213`*^9, 3.655747847928521*^9}, {
  3.65574788791123*^9, 3.655747950350522*^9}}],

Cell[BoxData[
 RowBox[{"N", "@", 
  RowBox[{"Tanh", "[", 
   RowBox[{"2", " ", "\[Pi]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.655747856919943*^9, 3.6557478847023478`*^9}}],

Cell[BoxData[{
 RowBox[{"Nx", " ", "=", " ", "501"}], "\[IndentingNewLine]", 
 RowBox[{"nc", " ", "=", " ", 
  RowBox[{
   RowBox[{"Floor", "[", 
    FractionBox["Nx", "2"], "]"}], "+", "1"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lowbnd", "=", " ", 
   RowBox[{"-", "\[Pi]"}]}], ";", " ", 
  RowBox[{"upbnd", " ", "=", " ", "\[Pi]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"coFraction", " ", "=", " ", "0.1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"nmax", " ", "=", " ", 
  RowBox[{"Ceiling", "[", 
   RowBox[{"nc", " ", "*", " ", 
    RowBox[{"(", 
     RowBox[{"1", " ", "-", " ", "coFraction"}], ")"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"coIndices", " ", "=", " ", 
  RowBox[{"Range", "[", 
   RowBox[{"0", ",", " ", 
    RowBox[{"nmax", "-", "1"}], ",", " ", "1"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Length", "@", "coIndices"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"w", " ", "=", " ", 
   RowBox[{"1", "-", 
    RowBox[{"Tanh", "[", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"1", "-", 
        SuperscriptBox["x", "8"]}]], "-", "1"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"coPoints", " ", "=", " ", 
   RowBox[{
    RowBox[{
     FractionBox["#", "nmax"], " ", "&"}], "/@", " ", "coIndices"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"wpart", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"N", "@", 
      RowBox[{"(", 
       RowBox[{"w", " ", "/.", " ", 
        RowBox[{"{", 
         RowBox[{"x", "\[Rule]", " ", "#"}], "}"}]}], ")"}]}], " ", "&"}], "/@",
     "coPoints"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"wtot", " ", "=", " ", 
   RowBox[{"wpart", "~", "Join", "~", 
    RowBox[{"Table", "[", 
     RowBox[{"0", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"nc", "-", "nmax"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "@", "wtot"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", "wtot", "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.655747440661509*^9, 3.655747539627924*^9}, {
  3.655747605857692*^9, 3.6557477499023457`*^9}, {3.655747783599494*^9, 
  3.6557477913677*^9}, {3.6557478227543488`*^9, 3.655747823306357*^9}, {
  3.655748150666367*^9, 3.655748172281501*^9}, {3.6557482558790817`*^9, 
  3.655748608436201*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6557475124878674`*^9, 3.655747513135872*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{
         FractionBox["1", 
          RowBox[{
           SuperscriptBox["x", "#"], "-", "1"}]], "+", "1"}], "]"}], ",", 
       RowBox[{"1", "-", 
        RowBox[{"Tanh", "[", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"1", "-", 
            SuperscriptBox["x", "#"]}]], "-", "1"}], "]"}]}], ",", " ", 
       FractionBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{
            SuperscriptBox["x", "#"], " ", "\[Pi]"}], "]"}], "+", "1"}], 
         ")"}], "2"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", " ", "All"}]}], "]"}], "&"}], "/@", " ", 
  
  RowBox[{"Range", "[", 
   RowBox[{"2", ",", "8", ",", "2"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.655672095707308*^9, 3.655672159228774*^9}, {
  3.6556722159723673`*^9, 3.655672253602542*^9}, {3.655758714337641*^9, 
  3.655758807892972*^9}, {3.6557588427619333`*^9, 3.655758890388562*^9}, {
  3.655759035280382*^9, 3.6557590858626003`*^9}}],

Cell[CellGroupData[{

Cell["planck taper window", "Subsection",
 CellChangeTimes->{{3.6556723362643414`*^9, 3.6556723387275887`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"windowl", "[", 
    RowBox[{"n_", ",", "a_", ",", "Nx_"}], "]"}], ":=", " ", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"Exp", "[", 
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{"Nx", "-", "1"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", "n"], "+", 
         FractionBox["1", 
          RowBox[{"n", " ", "-", " ", 
           RowBox[{"a", 
            RowBox[{"(", 
             RowBox[{"Nx", "-", "1"}], ")"}]}]}]]}], ")"}]}], "]"}], "+", 
     "1"}]]}], ";"}]], "Input",
 CellChangeTimes->{{3.655670339928615*^9, 3.655670394963986*^9}, {
   3.655670443501973*^9, 3.655670448396937*^9}, {3.6556704882681227`*^9, 
   3.655670491931326*^9}, 3.65567063008241*^9, {3.6556707075544977`*^9, 
   3.655670707986185*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"windowr", "[", 
    RowBox[{"n_", ",", "a_", ",", "Nx_"}], "]"}], ":=", " ", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"Exp", "[", 
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{"Nx", "-", "1"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", 
          RowBox[{"Nx", "-", "1", "-", "n"}]], "+", 
         FractionBox["1", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", " ", "-", " ", "a"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"Nx", "-", "1"}], ")"}]}], " ", "-", " ", "n"}]]}], 
        ")"}]}], "]"}], "+", "1"}]]}], ";"}]], "Input",
 CellChangeTimes->{{3.655670632315949*^9, 3.6556707106182537`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"window", "[", 
    RowBox[{"n_", ",", "a_", ",", "Nx_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Piecewise", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"windowl", "[", 
          RowBox[{"n", ",", " ", "a", ",", " ", "Nx"}], "]"}], ",", " ", 
         RowBox[{"0", " ", "<", " ", "n", " ", "<", " ", 
          RowBox[{"a", " ", 
           RowBox[{"(", 
            RowBox[{"Nx", "-", "1"}], ")"}]}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"windowr", "[", 
          RowBox[{"n", ",", "a", ",", "Nx"}], "]"}], ",", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", " ", "-", " ", "a"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"Nx", "-", "1"}], ")"}]}], " ", "<", " ", "n", " ", "<", 
          " ", 
          RowBox[{"(", 
           RowBox[{"Nx", "-", "1"}], ")"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"0", ",", " ", 
         RowBox[{
          RowBox[{"n", "==", "0"}], " ", "||", "  ", 
          RowBox[{"n", " ", "==", " ", 
           RowBox[{"Nx", "-", "1"}]}]}]}], "}"}]}], "\[IndentingNewLine]", 
      "}"}], ",", "1"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.65567070042552*^9, 3.6556709437761917`*^9}, {
   3.655671076541554*^9, 3.655671123692505*^9}, {3.6556711661016083`*^9, 
   3.6556711950312243`*^9}, {3.6556712315755053`*^9, 3.655671239111113*^9}, {
   3.655671292919773*^9, 3.6556714168959846`*^9}, {3.6556714806914997`*^9, 
   3.6556715167226763`*^9}, 3.655671609833127*^9, {3.6557472073517942`*^9, 
   3.655747209927526*^9}, {3.655747284038015*^9, 3.655747291229854*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Nxval", "=", "101"}], ";", " ", 
  RowBox[{"aval", "=", "0.6"}], ";"}]], "Input",
 CellChangeTimes->{{3.6556695076727867`*^9, 3.65566971874549*^9}, {
  3.6556697526843643`*^9, 3.655669783321762*^9}, {3.655669823121037*^9, 
  3.655669823665029*^9}, {3.655669887759918*^9, 3.6556699386303*^9}, {
  3.6556699860466833`*^9, 3.655670051181448*^9}, {3.65567008364431*^9, 
  3.6556701244016323`*^9}, {3.6556703220652227`*^9, 3.655670332720265*^9}, {
  3.655670401827641*^9, 3.655670402107211*^9}, {3.6556704584847937`*^9, 
  3.655670474907835*^9}, {3.655671012359703*^9, 3.655671048259953*^9}, {
  3.655747213046093*^9, 3.655747273500115*^9}, {3.6557473077796087`*^9, 
  3.6557473304027977`*^9}}],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"window", "[", 
     RowBox[{"#", ",", "aval", ",", "Nxval"}], "]"}], "&"}], "/@", " ", 
   RowBox[{"Range", "[", 
    RowBox[{"0", ",", 
     RowBox[{"Nxval", "-", "1"}], ",", "1"}], "]"}]}], "]"}]], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Nxval", "=", "101"}], ";", " ", 
  RowBox[{"aval", "=", " ", "0.9"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cutoffpoints", " ", "=", " ", 
   RowBox[{"Range", "[", 
    RowBox[{
     RowBox[{"Floor", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "aval"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"Nxval", "-", "1"}], ")"}]}], "+", "1"}], "]"}], ",", " ", 
     RowBox[{"Nxval", "-", "1"}], ",", " ", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "@", "cutoffpoints"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"windowr", "[", 
     RowBox[{"#", ",", "aval", ",", "Nxval"}], "]"}], " ", "&"}], "/@", " ", 
   "cutoffpoints"}], "]"}]}], "Input",
 CellChangeTimes->{{3.655746964811496*^9, 3.6557471855339413`*^9}, {
  3.6557473577011023`*^9, 3.655747358267585*^9}, {3.655747391259076*^9, 
  3.655747391634488*^9}}],

Cell[BoxData[
 RowBox[{"Nmax", " ", "=", " ", 
  RowBox[{"Floor", "[", 
   RowBox[{"aval", " ", 
    RowBox[{"(", 
     RowBox[{"Nxval", "-", "1"}], ")"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.655671026100792*^9, 3.655671026414804*^9}, {
  3.655672291933659*^9, 3.655672296633713*^9}}],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{
    FractionBox["1", 
     RowBox[{
      RowBox[{"Exp", "[", 
       RowBox[{"a", " ", "L", " ", 
        RowBox[{"(", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"L", "-", "x"}]], "+", 
          FractionBox["1", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "a"}], ")"}], " ", "L"}], " ", "-", "x"}]]}], 
         ")"}]}], "]"}], "+", "1"}]], "/.", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"a", "\[Rule]", " ", "0.5"}], ",", " ", 
      RowBox[{"L", "\[Rule]", " ", "\[Pi]"}]}], "}"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", " ", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.655669343012413*^9, 3.655669411801002*^9}, {
  3.655670564367304*^9, 3.65567057974466*^9}, {3.655671651837233*^9, 
  3.655671656884831*^9}, {3.655671703930113*^9, 3.655671994000031*^9}}],

Cell["\<\
TODO: how to do this with the fftw3 fourier coefficients\
\>", "Text",
 CellChangeTimes->{{3.6556725512556353`*^9, 3.655672565885275*^9}, {
  3.6556904832163467`*^9, 3.655690501383005*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["energy considerations", "Section",
 CellChangeTimes->{{3.655764464502252*^9, 3.65576446694173*^9}}],

Cell[BoxData[
 RowBox[{"Quit", "[", "]"}]], "Input",
 CellChangeTimes->{{3.655764631276184*^9, 3.6557646321490793`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"potential", "[", "f_", "]"}], ":=", "0"}], ";", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     FractionBox["1", "2"], " ", 
     SuperscriptBox["mass", "2"], " ", 
     SuperscriptBox["f", "2"]}], ";"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"energy", "[", 
    RowBox[{"f_", ",", " ", "V_"}], "]"}], ":=", " ", 
   RowBox[{
    RowBox[{
     FractionBox["1", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Derivative", "[", 
          RowBox[{"1", ",", "0"}], "]"}], "[", "f", "]"}], "[", 
        RowBox[{"t", ",", "x"}], "]"}], ")"}], "2"]}], " ", "+", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Derivative", "[", 
          RowBox[{"0", ",", "1"}], "]"}], "[", "f", "]"}], "[", 
        RowBox[{"t", ",", "x"}], "]"}], ")"}], "2"]}], "+", " ", 
    RowBox[{"V", "[", 
     RowBox[{"f", "[", 
      RowBox[{"t", ",", "x"}], "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"phi", "[", 
    RowBox[{"t_", ",", "x_"}], "]"}], ":=", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"x", "-", "t"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Plot3D", "[", 
  RowBox[{
   RowBox[{"phi", "[", 
    RowBox[{"t", ",", "x"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "\[Pi]"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6557646059231377`*^9, 3.655764621455084*^9}, {
  3.6557646546456127`*^9, 3.6557646823246098`*^9}, {3.655764808699465*^9, 
  3.655764883913089*^9}, {3.655765032878912*^9, 3.6557650602949553`*^9}, {
  3.655766096280905*^9, 3.655766117589837*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"energy", "[", 
   RowBox[{"phi", ",", "potential"}], "]"}], " ", "//", " ", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{"etot", " ", "=", " ", 
  RowBox[{"Integrate", "[", 
   RowBox[{"%", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"etot", " ", "/.", " ", 
    RowBox[{"{", 
     RowBox[{"mass", " ", "\[Rule]", " ", "1"}], "}"}]}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "\[Pi]"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.655764639226564*^9, 3.6557646530038633`*^9}, {
  3.65576478264515*^9, 3.655764787437419*^9}, {3.655764860382167*^9, 
  3.655764862125753*^9}, {3.65576489375073*^9, 3.6557648954786673`*^9}, {
  3.655764962067686*^9, 3.6557650003150177`*^9}, {3.6557651161081343`*^9, 
  3.655765150044228*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["tests for differentiation", "Section",
 CellChangeTimes->{{3.65636054188503*^9, 3.656360547171227*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"Sin", "[", "x", "]"}], " ", 
    RowBox[{"Sin", "[", "y", "]"}], " ", 
    RowBox[{"Sin", "[", "z", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], 
       SuperscriptBox["x", "2"]}], " ", "-", " ", 
      RowBox[{"4", " ", 
       SuperscriptBox["y", "2"]}], " ", "-", " ", 
      RowBox[{"1.5", " ", 
       SuperscriptBox["z", "2"]}]}], "]"}], " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"2", " ", "x"}], "]"}], " ", 
    RowBox[{"Cos", "[", "y", "]"}], " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"4", " ", "z"}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.656360590952383*^9, 3.656360621509795*^9}, {
  3.656364809803401*^9, 3.656364811050968*^9}, {3.658686850981612*^9, 
  3.6586868939819317`*^9}, {3.658687181155744*^9, 3.658687197961093*^9}, {
  3.658689615397028*^9, 3.658689627741432*^9}, {3.6586897273028803`*^9, 
  3.658689734117703*^9}, {3.6586898310590363`*^9, 3.6586898311147346`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"x", ",", "y", ",", "z"}], "]"}], " ", "//", " ", 
   "FullSimplify"}], " ", "//", " ", "CForm"}]], "Input",
 CellChangeTimes->{{3.6586880217192574`*^9, 3.658688029035473*^9}, {
  3.6586882952219048`*^9, 3.658688295781736*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", "x"}], "]"}], " ", "//", 
   " ", "FullSimplify"}], " ", "//", " ", "CForm"}]], "Input",
 CellChangeTimes->{{3.658686932066678*^9, 3.6586870041048613`*^9}, {
  3.6586882807122517`*^9, 3.658688281886812*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", "y"}], "]"}], " ", "//", 
   " ", "FullSimplify"}], " ", "//", " ", "CForm"}]], "Input",
 CellChangeTimes->{{3.658686980604033*^9, 3.658686980916299*^9}, {
  3.6586881865643044`*^9, 3.658688190035398*^9}, {3.6586882866780043`*^9, 
  3.658688287430367*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", "z"}], "]"}], " ", "//", 
   " ", "FullSimplify"}], " ", "//", " ", "CForm"}]], "Input",
 CellChangeTimes->{{3.658688192955077*^9, 3.6586881935708323`*^9}, {
  3.658688290726048*^9, 3.658688291461948*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "2"}], "}"}]}], "]"}], " ", "//", " ", 
   "FullSimplify"}], " ", "//", " ", "CForm"}]], "Input",
 CellChangeTimes->{{3.658686932066678*^9, 3.6586870041048613`*^9}, {
  3.6586882807122517`*^9, 3.658688281886812*^9}, {3.65868839030774*^9, 
  3.658688399483282*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", "2"}], "}"}]}], "]"}], " ", "//", " ", 
   "FullSimplify"}], " ", "//", " ", "CForm"}]], "Input",
 CellChangeTimes->{{3.658686980604033*^9, 3.658686980916299*^9}, {
  3.6586881865643044`*^9, 3.658688190035398*^9}, {3.6586882866780043`*^9, 
  3.658688287430367*^9}, {3.658688404747316*^9, 3.6586884066600857`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"z", ",", "2"}], "}"}]}], "]"}], " ", "//", " ", 
   "FullSimplify"}], " ", "//", " ", "CForm"}]], "Input",
 CellChangeTimes->{{3.658688192955077*^9, 3.6586881935708323`*^9}, {
  3.658688290726048*^9, 3.658688291461948*^9}, {3.6586884098833437`*^9, 
  3.658688410907889*^9}}],

Cell[BoxData[
 RowBox[{"grad", " ", "=", " ", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", "x"}], "]"}], ",", " ", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", "y"}], "]"}], ",", " ", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", "z"}], "]"}]}], "}"}], 
   " ", "//", " ", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.656366347869278*^9, 3.656366448550291*^9}, {
  3.658686925560841*^9, 3.658686928177321*^9}}],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "4"}], " ", 
        SuperscriptBox["x", "2"]}], "]"}], " ", 
      RowBox[{"Cos", "[", "x", "]"}]}], ",", " ", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "4"}], " ", 
           SuperscriptBox["y", "2"]}], "]"}], " ", 
         RowBox[{"Cos", "[", "y", "]"}]}], ",", "y"}], "]"}], " ", "/.", " ", 
      
      RowBox[{"y", "\[Rule]", " ", "x"}]}], ",", " ", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "4"}], " ", 
           SuperscriptBox["y", "2"]}], "]"}], " ", 
         RowBox[{"Cos", "[", "y", "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"y", ",", "2"}], "}"}]}], "]"}], " ", "/.", " ", 
      RowBox[{"y", "\[Rule]", " ", "x"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.658689363141218*^9, 3.658689405600234*^9}, {
  3.658689449745226*^9, 3.658689602798375*^9}, {3.658689656469162*^9, 
  3.6586896609728003`*^9}, {3.658689865744318*^9, 3.658689888359207*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6586897750565367`*^9, 3.658689777555394*^9}}],

Cell[BoxData[
 RowBox[{"gradsq", " ", "=", " ", 
  RowBox[{
   RowBox[{"grad", ".", "grad"}], " ", "//", " ", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.656366450300317*^9, 3.656366456893032*^9}}],

Cell[BoxData[
 RowBox[{"lap", " ", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "2"}], "}"}]}], "]"}], " ", "+", " ", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", "2"}], "}"}]}], "]"}], " ", "+", " ", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"z", ",", "2"}], "}"}]}], "]"}]}], " ", "//", " ", 
    "Simplify"}], " ", "//", " ", "CForm"}]}]], "Input",
 CellChangeTimes->{{3.656364624240137*^9, 3.6563647227350893`*^9}, {
  3.656364789069483*^9, 3.656364792453143*^9}, {3.656366388391911*^9, 
  3.6563664204961023`*^9}, {3.6586872068166943`*^9, 3.658687208681076*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["higgs metastability potential", "Section",
 CellChangeTimes->{{3.658678708474242*^9, 3.658678713120556*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Quit", "[", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.6586787304590178`*^9, 3.658678732529181*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"l", "=", 
   SuperscriptBox["10", 
    RowBox[{"-", "7"}]]}], ";"}]], "Input",
 CellChangeTimes->{{3.6586978746780777`*^9, 3.658697886201949*^9}, {
  3.6587019813170843`*^9, 3.658701981398814*^9}}],

Cell[BoxData[
 RowBox[{"repl", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"a", " ", "\[Rule]", "  ", 
     RowBox[{
      SuperscriptBox["10", 
       RowBox[{"-", "2"}]], "/", "l"}]}], ",", " ", 
    RowBox[{"b", " ", "\[Rule]", "  ", 
     RowBox[{"1", "/", "l"}]}], ",", " ", 
    RowBox[{"\[CapitalLambda]", " ", "\[Rule]", " ", 
     RowBox[{
      SuperscriptBox["10", 
       RowBox[{"-", "10"}]], "/", "l"}]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.658676150906073*^9, 3.6586761577835283`*^9}, {
  3.658676366714904*^9, 3.658676378370571*^9}, {3.658676424609541*^9, 
  3.6586764576242228`*^9}, {3.658677130514017*^9, 3.658677135450574*^9}, {
  3.65869786452682*^9, 3.65869787131874*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"pot", "[", "h_", "]"}], " ", ":=", " ", 
   RowBox[{"\[CapitalLambda]", " ", "+", " ", 
    RowBox[{"a", " ", 
     RowBox[{"(", 
      RowBox[{"1", " ", "-", " ", 
       RowBox[{
        SuperscriptBox["10", 
         RowBox[{"-", "1"}]], " ", 
        RowBox[{"Log10", "[", 
         RowBox[{
          SuperscriptBox["10", "19"], " ", 
          RowBox[{"Abs", "[", "h", "]"}]}], "]"}]}]}], ")"}], " ", 
     SuperscriptBox["h", "4"]}], " ", "+", " ", 
    RowBox[{"b", " ", 
     SuperscriptBox["h", "6"]}]}]}], " ", ";"}]], "Input",
 CellChangeTimes->{{3.658676159938664*^9, 3.658676283842246*^9}, 
   3.658676343114794*^9, {3.658676385051181*^9, 3.658676387021325*^9}, {
   3.658677073603652*^9, 3.6586770806510763`*^9}, {3.658677147394457*^9, 
   3.658677150234144*^9}, {3.658677419996299*^9, 3.6586774209566927`*^9}}],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"pot", "[", "h", "]"}], " ", "/.", " ", "repl"}], ",", 
   RowBox[{"{", 
    RowBox[{"h", ",", 
     RowBox[{"-", "0.085"}], ",", "0.085"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.658676555638276*^9, 3.658676625953596*^9}, {
  3.658676660981907*^9, 3.6586767284201727`*^9}, {3.658677291217704*^9, 
  3.658677355026973*^9}, {3.65867742453238*^9, 3.6586774255302763`*^9}, {
  3.658682007118511*^9, 3.6586820540027103`*^9}}],

Cell[BoxData[
 RowBox[{"NMinimize", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"pot", "[", "h", "]"}], " ", "/.", " ", "repl"}], ",", "h"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.658676844376781*^9, 3.6586768520351067`*^9}, {
  3.65867736894036*^9, 3.6586773757144327`*^9}, {3.65867743489174*^9, 
  3.658677435448063*^9}}],

Cell[BoxData[
 RowBox[{"Limit", "[", 
  RowBox[{
   RowBox[{"pot", "[", "h", "]"}], ",", " ", 
   RowBox[{"h", "\[Rule]", " ", "0"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6586823422558327`*^9, 3.658682349704027*^9}}],

Cell[BoxData[{
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"pot", "[", "h", "]"}], ",", "h"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Limit", "[", 
  RowBox[{"%", ",", " ", 
   RowBox[{"h", "\[Rule]", " ", "0"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.658677393958007*^9, 3.65867740799751*^9}, {
  3.658677456436062*^9, 3.658677457019738*^9}, {3.6586774873263903`*^9, 
  3.65867752591813*^9}, {3.658677637035894*^9, 3.658677638763074*^9}, {
  3.6586822326697683`*^9, 3.6586822661331053`*^9}}],

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"Log10", "[", 
    RowBox[{
     RowBox[{"Abs", "[", "h", "]"}], " ", 
     SuperscriptBox["10", "19"]}], "]"}], ",", "h"}], "]"}]], "Input",
 CellChangeTimes->{{3.658677815699524*^9, 3.658677837827643*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Log10", "[", "x", "]"}], " ", "\[Equal]", " ", 
   FractionBox[
    RowBox[{"Log", "[", "x", "]"}], 
    RowBox[{"Log", "[", "10", "]"}]]}], " ", "//", " ", "Simplify"}]], "Input",\

 CellChangeTimes->{{3.658677962931679*^9, 3.658678024546041*^9}}],

Cell[BoxData[
 RowBox[{"replphi", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"phi0", " ", "\[Rule]", " ", "0.04"}], ",", " ", 
    RowBox[{"\[Lambda]", " ", "\[Rule]", " ", "20"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.6586956422035*^9, 3.658695674744548*^9}, {
  3.658695875899352*^9, 3.658695878595769*^9}, {3.658696366281871*^9, 
  3.658696393623845*^9}, {3.658702073616803*^9, 3.658702073767063*^9}}],

Cell[BoxData[
 RowBox[{"phi", " ", "=", " ", 
  RowBox[{"phi0", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Cos", "[", "x", "]"}], " ", "+", " ", "1"}], ")"}], 
   RowBox[{
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", "\[Lambda]"}], " ", 
      SuperscriptBox["x", "2"]}], "]"}], " ", "/", " ", "2"}], 
   "k"}]}]], "Input",
 CellChangeTimes->{{3.658695622542513*^9, 3.6586956401457148`*^9}, {
   3.658695679432623*^9, 3.6586956900960712`*^9}, {3.658695854636318*^9, 
   3.658695871916758*^9}, {3.658702099623028*^9, 3.658702100510827*^9}, 
   3.6587030657376757`*^9}],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"phi", "  ", "/.", " ", "replphi"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", " ", 
   RowBox[{"PlotRange", " ", "\[Rule]", " ", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.658695692571021*^9, 3.6586957884530067`*^9}, 
   3.658695865267981*^9}],

Cell[BoxData[
 RowBox[{"phitrunc", " ", "=", " ", 
  RowBox[{"FourierSeries", "[", 
   RowBox[{
    RowBox[{"phi", " ", "/.", " ", "replphi"}], ",", " ", "x", ",", " ", 
    "30"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6586958280751*^9, 3.658695845899353*^9}, {
  3.658695885114416*^9, 3.658695893183707*^9}, {3.658695937651341*^9, 
  3.658695940411051*^9}, {3.658696051720496*^9, 3.6586960534242887`*^9}}],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Re", "[", "phitrunc", "]"}], ",", " ", 
     RowBox[{"phi", " ", "/.", " ", "replphi"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", " ", 
   RowBox[{"PlotRange", " ", "\[Rule]", " ", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.658695907069496*^9, 3.6586959628498507`*^9}, {
  3.658696000673581*^9, 3.658696014273355*^9}}],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"Abs", "[", 
    RowBox[{
     RowBox[{"Re", "[", "phitrunc", "]"}], " ", "-", " ", 
     RowBox[{"(", " ", 
      RowBox[{"phi", " ", "/.", " ", "replphi"}], ")"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", " ", 
   RowBox[{"PlotRange", " ", "\[Rule]", " ", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.658696035521145*^9, 3.658696043816153*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["solve poisson equation tests", "Section",
 CellChangeTimes->{{3.6591988773222933`*^9, 3.6591988844403687`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Quit", "[", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.661118598921228*^9, 3.661118600193193*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"lap", "[", "f_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"f", ",", " ", 
      RowBox[{"{", 
       RowBox[{"x", ",", "2"}], "}"}]}], "]"}], " ", "+", " ", 
    RowBox[{"D", "[", 
     RowBox[{"f", ",", " ", 
      RowBox[{"{", 
       RowBox[{"y", ",", "2"}], "}"}]}], "]"}], " ", "+", " ", 
    RowBox[{"D", "[", 
     RowBox[{"f", ",", " ", 
      RowBox[{"{", 
       RowBox[{"z", ",", "2"}], "}"}]}], "]"}]}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"gradsq", "[", "f_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"f", ",", " ", 
        RowBox[{"{", 
         RowBox[{"x", ",", "1"}], "}"}]}], "]"}], ",", " ", 
      RowBox[{"D", "[", 
       RowBox[{"f", ",", " ", 
        RowBox[{"{", 
         RowBox[{"y", ",", "1"}], "}"}]}], "]"}], ",", " ", 
      RowBox[{"D", "[", 
       RowBox[{"f", ",", " ", 
        RowBox[{"{", 
         RowBox[{"z", ",", "1"}], "}"}]}], "]"}]}], "}"}], ".", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"f", ",", " ", 
        RowBox[{"{", 
         RowBox[{"x", ",", "1"}], "}"}]}], "]"}], ",", " ", 
      RowBox[{"D", "[", 
       RowBox[{"f", ",", " ", 
        RowBox[{"{", 
         RowBox[{"y", ",", "1"}], "}"}]}], "]"}], ",", " ", 
      RowBox[{"D", "[", 
       RowBox[{"f", ",", " ", 
        RowBox[{"{", 
         RowBox[{"z", ",", "1"}], "}"}]}], "]"}]}], "}"}]}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.6611184039272833`*^9, 3.6611184180425797`*^9}, {
  3.661118453517564*^9, 3.66111847313911*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"getmean", "[", "f_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"NIntegrate", "[", 
     RowBox[{"f", ",", " ", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"y", ",", 
        RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"z", ",", 
        RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}]}], "]"}], " ", "/", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"2", " ", "\[Pi]"}], ")"}], "3"]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.661118353426215*^9, 3.661118353634137*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"solvepoisson", "[", "f_", "]"}], " ", ":=", " ", 
   RowBox[{"InverseFourierTransform", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"FourierTransform", "[", 
        RowBox[{"f", ",", " ", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"kx", ",", "ky", ",", "kz"}], "}"}]}], "]"}]}], " ", "/", 
      " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["kx", "2"], " ", "+", " ", 
        SuperscriptBox["ky", "2"], " ", "+", " ", 
        SuperscriptBox["kz", "2"]}], ")"}]}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"kx", ",", "ky", ",", "kz"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.661118179881118*^9, 3.6611182714674892`*^9}, {
  3.6611192870125523`*^9, 3.661119287164083*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"potential", "[", "f_", "]"}], " ", ":=", " ", "lambdaval"}], ";", 
  " ", 
  RowBox[{
   RowBox[{"potentialprime", "[", "f_", "]"}], " ", ":=", " ", "0"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6611185247416687`*^9, 3.661118535407083*^9}, {
  3.661121807229641*^9, 3.661121815029346*^9}}],

Cell[CellGroupData[{

Cell["first attempt (WARNING: wrong equation)", "Subsection",
 CellChangeTimes->{{3.661117429782316*^9, 3.661117442354233*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rho", " ", ":=", " ", 
   RowBox[{
    RowBox[{"Sin", "[", "x", "]"}], " ", 
    RowBox[{"Sin", "[", "y", "]"}], "  ", 
    RowBox[{"Sin", "[", "z", "]"}], " ", 
    SuperscriptBox["x", "2"]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.659199491812096*^9, 3.659199525643435*^9}, {
  3.659201128659953*^9, 3.659201129691625*^9}, {3.659201757092486*^9, 
  3.659201764516315*^9}, {3.659201803899922*^9, 3.659201806040609*^9}}],

Cell[BoxData[
 RowBox[{"ft", " ", "=", " ", 
  RowBox[{"FourierTransform", "[", 
   RowBox[{"rho", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"kx", ",", "ky", ",", "kz"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6592009493121634`*^9, 3.659200977996911*^9}, {
   3.6592010514943113`*^9, 3.659201052614066*^9}, 3.65920115577127*^9}],

Cell[BoxData[
 RowBox[{"sol", " ", "=", " ", 
  RowBox[{"InverseFourierTransform", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"-", "ft"}], " ", "/", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["kx", "2"], " ", "+", " ", 
        SuperscriptBox["ky", "2"], " ", "+", " ", 
        SuperscriptBox["kz", "2"]}], ")"}]}], " ", "/", " ", "2"}], ",", " ", 
    
    RowBox[{"{", 
     RowBox[{"kx", ",", "ky", ",", "kz"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.659200991417697*^9, 3.6592010559740973`*^9}, {
  3.659201111388873*^9, 3.659201112404662*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"lap", "[", "sol", "]"}], " ", "\[Equal]", " ", 
   FractionBox["rho", "2"]}], " ", "//", " ", "Simplify"}]], "Input",
 CellChangeTimes->{{3.659201078509356*^9, 3.6592010860251627`*^9}, {
  3.659201161938549*^9, 3.659201169681944*^9}}],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Sin", "[", "x", "]"}], " ", 
    RowBox[{"x", "^", "2"}]}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.659205745669917*^9, 3.659205765551742*^9}}],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", "10"}], " ", 
      SuperscriptBox["x", "2"]}], "]"}], " ", 
    RowBox[{"Cos", "[", "x", "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6592059048941917`*^9, 3.659205918092626*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"N", "@", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "10"}], " ", 
           SuperscriptBox["y", "2"]}], "]"}], " ", 
         RowBox[{"Cos", "[", "y", "]"}]}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"y", ",", "#"}], "}"}]}], "]"}], "&"}], "/@", 
     RowBox[{"Range", "[", 
      RowBox[{"0", ",", "15"}], "]"}]}], ")"}]}], " ", "/.", " ", 
  RowBox[{"y", "\[Rule]", " ", 
   RowBox[{"-", "\[Pi]"}]}]}]], "Input",
 CellChangeTimes->{{3.659205958436131*^9, 3.6592060222148237`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "10"}], " ", 
           SuperscriptBox["y", "2"]}], "]"}], " ", 
         RowBox[{"Cos", "[", "y", "]"}]}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"y", ",", "#"}], "}"}]}], "]"}], " ", "/.", " ", 
      RowBox[{"y", "\[Rule]", " ", "x"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}]}], "]"}], "&"}], "/@", 
  RowBox[{"{", 
   RowBox[{"0", ",", "1", ",", "2", ",", "3", ",", "4"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.659205779775818*^9, 3.6592058271310873`*^9}, {
  3.659205857752942*^9, 3.659205877768262*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["new (hopefully) correct poisson equation", "Subsection",
 CellChangeTimes->{{3.661117447281817*^9, 3.661117456841508*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"meanval", " ", "=", " ", "0.5"}], ";", " ", 
  RowBox[{"amplitude", "=", "0.1"}], ";", " ", 
  RowBox[{"lambdaval", " ", "=", " ", "0.2"}], ";", " ", 
  RowBox[{"a", " ", "=", " ", "1"}], ";"}]], "Input",
 CellChangeTimes->{{3.66111786060599*^9, 3.661117890131344*^9}, {
  3.6611183618173637`*^9, 3.661118361985569*^9}, {3.661118540182921*^9, 
  3.66111854620674*^9}, {3.661118663647174*^9, 3.661118666052952*^9}, {
  3.661120578952927*^9, 3.6611205791124697`*^9}, {3.661187527136989*^9, 
  3.66118752740724*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"phi", " ", "=", " ", 
   RowBox[{"meanval", " ", "+", " ", 
    RowBox[{"amplitude", " ", 
     RowBox[{"Cos", "[", "x", "]"}], " ", 
     RowBox[{"Cos", "[", "y", "]"}], " ", 
     RowBox[{"Cos", "[", "z", "]"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.661117854542988*^9, 3.661117855758225*^9}, {
  3.661117896314724*^9, 3.66111792955473*^9}, {3.6611183662894697`*^9, 
  3.66111836648941*^9}, {3.661120773765421*^9, 3.661120780204867*^9}}],

Cell[BoxData[
 RowBox[{"phiavg", " ", "=", " ", 
  RowBox[{"getmean", "[", "phi", "]"}]}]], "Input",
 CellChangeTimes->{{3.6611179484809837`*^9, 3.661118007765349*^9}, {
  3.66111810958882*^9, 3.6611181133638153`*^9}, {3.661118371152939*^9, 
  3.661118371376709*^9}}],

Cell[BoxData[
 RowBox[{"dphiinit", " ", "=", " ", 
  RowBox[{"D", "[", 
   RowBox[{"phi", ",", "t"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.66111863629392*^9, 3.661118647156226*^9}, {
  3.661121577331017*^9, 3.661121634366547*^9}, {3.661121896594157*^9, 
  3.661121900666191*^9}}],

Cell[BoxData[
 RowBox[{"rho", " ", "=", " ", 
  RowBox[{
   RowBox[{
    FractionBox[
     SuperscriptBox["dphiinit", "2"], "2"], " ", "+", " ", 
    FractionBox[
     RowBox[{"gradsq", "[", "phi", "]"}], "2"], "+", " ", 
    RowBox[{"potential", "[", "phi", "]"}]}], " ", "//", " ", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.6611180244221287`*^9, 3.6611180276408577`*^9}, {
  3.661118122805884*^9, 3.661118143270019*^9}, {3.661118383784891*^9, 
  3.661118389632369*^9}, {3.661118504968216*^9, 3.66111852148015*^9}, {
  3.661118563014887*^9, 3.661118568998028*^9}, {3.661118644895751*^9, 
  3.661118645198226*^9}, {3.661121903443006*^9, 3.661121904282711*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"valnum", " ", "=", " ", "32"}], ";", " ", 
  RowBox[{"vals", " ", "=", " ", 
   RowBox[{"N", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "\[Pi]"}], " ", "+", " ", 
       FractionBox[
        RowBox[{"2", "\[Pi]", " ", "i", " "}], "valnum"]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "0", ",", 
        RowBox[{"valnum", "-", "1"}]}], "}"}]}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.661119849304035*^9, 3.661119979553144*^9}, {
  3.661120036134975*^9, 3.661120039398033*^9}, {3.661120085973114*^9, 
  3.6611201250429487`*^9}, {3.661120533940102*^9, 3.661120534780281*^9}, {
  3.6611227168936987`*^9, 3.661122717173088*^9}, {3.66112312267507*^9, 
  3.661123123081437*^9}}],

Cell[BoxData[
 RowBox[{"Length", "@", 
  RowBox[{"Flatten", "@", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"N", "@", 
      RowBox[{"(", 
       RowBox[{"rho", " ", "/.", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "\[Rule]", " ", "xv"}], ",", " ", 
          RowBox[{"y", "\[Rule]", " ", "yv"}], ",", " ", 
          RowBox[{"z", "\[Rule]", " ", "zv"}]}], "}"}]}], ")"}]}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"xv", ",", "vals"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"yv", ",", "vals"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"zv", ",", "vals"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6611228191368093`*^9, 3.661122827088469*^9}, {
  3.6611228941872*^9, 3.661122896201623*^9}}],

Cell[BoxData[
 RowBox[{"rhoavg", " ", "=", " ", 
  RowBox[{"getmean", "[", "rho", "]"}]}]], "Input",
 CellChangeTimes->{{3.661118582736814*^9, 3.6611185962290297`*^9}}],

Cell[BoxData[
 RowBox[{"hub", " ", "=", " ", 
  SqrtBox[
   FractionBox["rhoavg", "3"]]}]], "Input",
 CellChangeTimes->{{3.66111866942756*^9, 3.6611186956615763`*^9}}],

Cell[BoxData[{
 RowBox[{"dphi", " ", "=", " ", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{"lap", "[", "phi", "]"}], 
     SuperscriptBox["a", "2"]], " ", "-", " ", 
    RowBox[{"3", " ", "hub", " ", "dphiinit"}], " ", "-", " ", 
    RowBox[{"potentialprime", "[", "phi", "]"}]}], " ", "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"dphi", " ", "=", " ", "dphiinit"}]}], "Input",
 CellChangeTimes->{
  3.6611216442706537`*^9, {3.6611217373703413`*^9, 3.661121740176528*^9}, {
   3.661121789463975*^9, 3.661121798630067*^9}, {3.661121833253372*^9, 
   3.661121851108987*^9}, {3.661121910202621*^9, 3.661121911027185*^9}, {
   3.661122659326313*^9, 3.661122664213954*^9}}],

Cell[BoxData[
 RowBox[{"rhs", " ", "=", " ", 
  RowBox[{
   RowBox[{"0.5", " ", "*", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"3", " ", "hub", " ", 
       SuperscriptBox["a", "2"], " ", "dphi", " ", 
       RowBox[{"(", 
        RowBox[{"phi", " ", "-", " ", "phiavg"}], ")"}]}], " ", "-", " ", 
      "rho", " ", "+", " ", "rhoavg"}], ")"}]}], " ", "//", " ", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.661117535963876*^9, 3.6611175873022947`*^9}, {
  3.661118707240749*^9, 3.661118710144456*^9}, {3.6611229494809523`*^9, 
  3.661122949999699*^9}}],

Cell[BoxData[
 RowBox[{"sol", " ", "=", " ", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"Re", "[", 
     RowBox[{"solvepoisson", "[", "rhs", "]"}], "]"}], ",", 
    RowBox[{"Assumptions", "\[Rule]", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x", "\[Element]", "Reals"}], ",", " ", 
       RowBox[{"y", "\[Element]", "Reals"}], ",", " ", 
       RowBox[{"z", "\[Element]", "Reals"}]}], "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.661118718204278*^9, 3.661118759120831*^9}, {
  3.661118814002905*^9, 3.661118817818591*^9}, {3.661118866112235*^9, 
  3.661118909196939*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"solcomp", " ", "=", " ", 
   RowBox[{"Flatten", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"N", "@", 
       RowBox[{"(", 
        RowBox[{"sol", " ", "/.", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x", "\[Rule]", " ", "xv"}], ",", " ", 
           RowBox[{"y", "\[Rule]", " ", "yv"}], ",", " ", 
           RowBox[{"z", "\[Rule]", " ", "zv"}]}], "}"}]}], ")"}]}], ",", " ", 
      
      RowBox[{"{", 
       RowBox[{"xv", ",", "vals"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"yv", ",", "vals"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"zv", ",", "vals"}], "}"}]}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.661119982594017*^9, 3.661120070455111*^9}, {
  3.6611201166205072`*^9, 3.6611201493596973`*^9}, {3.661120673991028*^9, 
  3.661120677438554*^9}}],

Cell[BoxData[
 RowBox[{"filename", " ", "=", " ", 
  RowBox[{"SystemDialogInput", "[", 
   RowBox[{"\"\<FileOpen\>\"", ",", 
    RowBox[{"NotebookDirectory", "[", "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.661120244221681*^9, 3.661120281621773*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Import", "[", 
    RowBox[{"filename", ",", " ", 
     RowBox[{"{", 
      RowBox[{"\"\<Datasets\>\"", ",", "\"\</a\>\""}], "}"}]}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}], " ", "\[Equal]", " ", "a"}]], "Input",
 CellChangeTimes->{{3.661120812952992*^9, 3.661120813504758*^9}, {
  3.661121078051072*^9, 3.6611211029461184`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Import", "[", 
    RowBox[{"filename", ",", " ", 
     RowBox[{"{", 
      RowBox[{"\"\<Datasets\>\"", ",", "\"\</rho\>\""}], "}"}]}], "]"}], "[", 
   
   RowBox[{"[", "1", "]"}], "]"}], " ", "\[Equal]", " ", "rhoavg"}]], "Input",\

 CellChangeTimes->{{3.6611210515052547`*^9, 3.661121075259079*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"solnumraw", " ", "=", " ", 
   RowBox[{"Import", "[", 
    RowBox[{"filename", ",", " ", 
     RowBox[{"{", 
      RowBox[{"\"\<Datasets\>\"", ",", "\"\</psi\>\""}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6611202928610287`*^9, 3.661120305221711*^9}, {
  3.661120345109941*^9, 3.661120410638591*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"solnum", " ", "=", " ", 
   RowBox[{"solnumraw", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.661120412648725*^9, 3.661120423686034*^9}, {
  3.6611207048782053`*^9, 3.66112070497305*^9}, {3.661120825184596*^9, 
  3.661120825288353*^9}}],

Cell[BoxData[
 RowBox[{"Max", "[", 
  RowBox[{"Abs", "[", 
   RowBox[{"solnum", "  ", "-", " ", "solcomp"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.661120430379613*^9, 3.6611204579093943`*^9}, {
  3.6611206354998426`*^9, 3.661120641267309*^9}}],

Cell[BoxData[{
 RowBox[{"err", " ", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"Re", "[", 
     RowBox[{
      RowBox[{"lap", "[", "sol", "]"}], " ", "-", " ", "rhs"}], "]"}], ",", 
    RowBox[{"Assumptions", "\[Rule]", "  ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x", "\[Element]", "Reals"}], ",", " ", 
       RowBox[{"y", "\[Element]", "Reals"}], ",", " ", 
       RowBox[{"z", "\[Element]", "Reals"}]}], "}"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Maximize", "[", 
  RowBox[{
   RowBox[{"Re", "[", "err", "]"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Minimize", "[", 
  RowBox[{
   RowBox[{"Re", "[", "err", "]"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.661118754267967*^9, 3.6611187958197308`*^9}, {
  3.661119332613393*^9, 3.66111944664178*^9}, {3.661119569372998*^9, 
  3.661119569885344*^9}, {3.661121963623767*^9, 3.661121974934758*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
equations of motion without scalar perturbation\
\>", "Section",
 CellChangeTimes->{{3.6618080468608637`*^9, 3.661808052612301*^9}}],

Cell[CellGroupData[{

Cell["initialize RGTC", "Subsection",
 CellChangeTimes->{{3.661807404617031*^9, 3.6618074097363577`*^9}, {
  3.662756215001363*^9, 3.662756220273423*^9}}],

Cell[BoxData[
 RowBox[{"<<", " ", "EDCRGTCcode.m"}]], "Input",
 CellChangeTimes->{{3.659213467062601*^9, 3.659213488856326*^9}, 
   3.6618080982767773`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
some helpful functions, mostly for readability\
\>", "Subsection",
 CellChangeTimes->{{3.6627562238969173`*^9, 3.662756235976243*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"nice", "[", "f_", "]"}], " ", ":=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{"tolin", "@", 
     RowBox[{"(", 
      RowBox[{"f", " ", "/.", " ", "printrepl"}], ")"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.66163014438806*^9, 3.6616301457240133`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"printrepl", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      SuperscriptBox["phi", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", " ",
      "dphi"}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox["phi", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", " ",
      "xphi"}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox["phi", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", " ",
      "yphi"}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox["phi", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", " ",
      "zphi"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      SuperscriptBox["phi", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"2", ",", "0", ",", "0", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", " ",
      "ddphi"}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox["phi", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "2", ",", "0", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", " ",
      "xxphi"}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox["phi", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "0", ",", "2", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", " ",
      "yyphi"}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox["phi", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "0", ",", "0", ",", "2"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", " ",
      "zzphi"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"a", "[", "t", "]"}], " ", "\[Rule]", " ", "a"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "'"}], "[", "t", "]"}], " ", "\[Rule]", " ", "da"}]}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.659213914364317*^9, 3.65921392209678*^9}, {
  3.659214396071636*^9, 3.659214400462729*^9}, {3.6592144383026733`*^9, 
  3.659214534062351*^9}, {3.659214571991007*^9, 3.6592146891433773`*^9}, {
  3.659214787192404*^9, 3.65921479109603*^9}, {3.661808089942553*^9, 
  3.661808090855414*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     SuperscriptBox["phi", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"1", ",", "0", ",", "0", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "dphi"}], 
   ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["phi", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "xphi"}], 
   ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["phi", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "0", ",", "1", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "yphi"}], 
   ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["phi", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "0", ",", "0", ",", "1"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "zphi"}], 
   ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["phi", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"2", ",", "0", ",", "0", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "ddphi"}],
    ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["phi", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "2", ",", "0", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "xxphi"}],
    ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["phi", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "0", ",", "2", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "yyphi"}],
    ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["phi", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "0", ",", "0", ",", "2"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "zzphi"}],
    ",", 
   RowBox[{
    RowBox[{"a", "[", "t", "]"}], "\[Rule]", "a"}], ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["a", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], "\[Rule]", "da"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.6617937803784018`*^9, 3.661793897174025*^9, 
  3.6617997211608543`*^9, 3.66180038988172*^9, 3.661800448605348*^9, 
  3.661805261725155*^9, 3.661805603278453*^9, 3.661806050541671*^9, 
  3.661806867244535*^9, 3.6618073557955227`*^9, 3.661807417169598*^9, 
  3.6618083368754587`*^9, 3.6627398959270887`*^9, 3.662752452237453*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"oprepl", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"xxphi", " ", "\[Rule]", "  ", 
     RowBox[{"lphi", " ", "-", " ", "yyphi", " ", "-", " ", "zzphi"}]}], ",", 
    " ", 
    RowBox[{"da", " ", "\[Rule]", " ", 
     RowBox[{"H", " ", "a"}]}], ",", " ", 
    RowBox[{
     SuperscriptBox["xphi", "2"], " ", "\[Rule]", " ", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["yphi", "2"]}], " ", "-", " ", 
      SuperscriptBox["zphi", "2"], " ", "+", " ", 
      SuperscriptBox["gphi", "2"]}]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.659214793541716*^9, 3.659214931155787*^9}, {
   3.659215044272204*^9, 3.659215066023184*^9}, {3.659215187363412*^9, 
   3.659215204714739*^9}, {3.6592156626027393`*^9, 3.659215663906513*^9}, {
   3.6592157005773363`*^9, 3.6592157422419577`*^9}, {3.659215957680072*^9, 
   3.6592159577599077`*^9}, {3.6592164270709352`*^9, 
   3.6592164534208717`*^9}, {3.6592881588968487`*^9, 3.659288181195691*^9}, 
   3.659288894571817*^9, {3.660940168303521*^9, 3.660940175150783*^9}, {
   3.6616292678887367`*^9, 3.661629314263686*^9}, 3.661808130474688*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"xxphi", "\[Rule]", 
    RowBox[{"lphi", "-", "yyphi", "-", "zzphi"}]}], ",", 
   RowBox[{"da", "\[Rule]", 
    RowBox[{"a", " ", "H"}]}], ",", 
   RowBox[{
    SuperscriptBox["xphi", "2"], "\[Rule]", 
    RowBox[{
     SuperscriptBox["gphi", "2"], "-", 
     SuperscriptBox["yphi", "2"], "-", 
     SuperscriptBox["zphi", "2"]}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.661793781493691*^9, 3.6617938981885843`*^9, 
  3.661799721841885*^9, 3.661800390662197*^9, 3.6618004496194773`*^9, 
  3.661805262772709*^9, 3.661805604991458*^9, 3.661806051173753*^9, 
  3.661806867826391*^9, 3.6618073564787893`*^9, 3.6618074172231293`*^9, 
  3.6618083378598747`*^9, 3.662739896535675*^9, 3.662752455837872*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"grepl", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{"Gnew", " ", "\[Rule]", " ", 
    FractionBox["1", 
     RowBox[{"8", " ", "\[Pi]"}]]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.661631228336399*^9, 3.661631249894232*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"Gnew", "\[Rule]", 
   FractionBox["1", 
    RowBox[{"8", " ", "\[Pi]"}]]}], "}"}]], "Output",
 CellChangeTimes->{3.6617937827598257`*^9, 3.6617938991228647`*^9, 
  3.661799723373872*^9, 3.661800393913047*^9, 3.66180045135166*^9, 
  3.6618052647380667`*^9, 3.661805607843219*^9, 3.661806057690358*^9, 
  3.661806870859661*^9, 3.6618073603123913`*^9, 3.661807417323839*^9, 
  3.661808338980921*^9, 3.662739897636835*^9, 3.662752456736308*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"coords", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.659213500185669*^9, 3.659213510640218*^9}, {
  3.661805265682004*^9, 3.661805267194525*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "}"}]], "Output",
 CellChangeTimes->{3.66179377156465*^9, 3.6617938938052807`*^9, 
  3.661799724457036*^9, 3.661800395296323*^9, 3.661800452151763*^9, 
  3.6618052677215977`*^9, 3.661805610958269*^9, 3.661806058289629*^9, 
  3.6618068716942673`*^9, 3.661807360862235*^9, 3.661807417374522*^9, 
  3.661808339846445*^9, 3.662739898511252*^9, 3.66275245770842*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"g", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      SuperscriptBox[
       RowBox[{"a", "[", "t", "]"}], "2"], ",", "0", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", 
      SuperscriptBox[
       RowBox[{"a", "[", "t", "]"}], "2"], ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0", ",", 
      SuperscriptBox[
       RowBox[{"a", "[", "t", "]"}], "2"]}], "}"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"g", " ", "//", " ", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.6592132263670177`*^9, 3.659213327349605*^9}, {
   3.659213515554082*^9, 3.6592135156902237`*^9}, {3.659213549427917*^9, 
   3.659213562219933*^9}, 3.659214205885046*^9, {3.659287997316237*^9, 
   3.659288011285386*^9}, {3.659288783616477*^9, 3.65928879398288*^9}, {
   3.659288859455915*^9, 3.659288860144106*^9}, {3.660939909094689*^9, 
   3.660939913567176*^9}, {3.661189582767799*^9, 3.6611895896059523`*^9}, {
   3.661190896548168*^9, 3.661190912622839*^9}, {3.661808147436657*^9, 
   3.661808156098823*^9}, {3.6618082752755337`*^9, 3.661808275562008*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     SuperscriptBox[
      RowBox[{"a", "[", "t", "]"}], "2"], ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     SuperscriptBox[
      RowBox[{"a", "[", "t", "]"}], "2"], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", 
     SuperscriptBox[
      RowBox[{"a", "[", "t", "]"}], "2"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.661793772634087*^9, 3.6617938945224543`*^9, 
  3.661799725358715*^9, 3.66180039626402*^9, 3.661800453003325*^9, 
  3.6618052689891977`*^9, 3.6618056132435017`*^9, 3.66180605964098*^9, 
  3.66180687269571*^9, 3.661807361829916*^9, 3.6618074174463997`*^9, 
  3.661808340780862*^9, 3.662739899743884*^9, 3.662752460026765*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "1"}], "0", "0", "0"},
     {"0", 
      SuperscriptBox[
       RowBox[{"a", "[", "t", "]"}], "2"], "0", "0"},
     {"0", "0", 
      SuperscriptBox[
       RowBox[{"a", "[", "t", "]"}], "2"], "0"},
     {"0", "0", "0", 
      SuperscriptBox[
       RowBox[{"a", "[", "t", "]"}], "2"]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.661793772634087*^9, 3.6617938945224543`*^9, 
  3.661799725358715*^9, 3.66180039626402*^9, 3.661800453003325*^9, 
  3.6618052689891977`*^9, 3.6618056132435017`*^9, 3.66180605964098*^9, 
  3.66180687269571*^9, 3.661807361829916*^9, 3.6618074174463997`*^9, 
  3.661808340780862*^9, 3.662739899743884*^9, 3.662752460029763*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RGtensors", "[", 
  RowBox[{"g", ",", "coords"}], "]"}]], "Input",
 CellChangeTimes->{{3.6592135276621113`*^9, 3.6592135335942593`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"gdd = \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"-", "1"}], "0", "0", "0"},
       {"0", 
        SuperscriptBox[
         RowBox[{"a", "[", "t", "]"}], "2"], "0", "0"},
       {"0", "0", 
        SuperscriptBox[
         RowBox[{"a", "[", "t", "]"}], "2"], "0"},
       {"0", "0", "0", 
        SuperscriptBox[
         RowBox[{"a", "[", "t", "]"}], "2"]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm["gdd = ", 
   MatrixForm[{{-1, 0, 0, 0}, {0, $CellContext`a[$CellContext`t]^2, 0, 0}, {
     0, 0, $CellContext`a[$CellContext`t]^2, 0}, {
     0, 0, 0, $CellContext`a[$CellContext`t]^2}}]],
  Editable->False]], "Print",
 CellChangeTimes->{3.66179377772738*^9, 3.661793895771625*^9, 
  3.661799726941099*^9, 3.661800398764287*^9, 3.661800454068523*^9, 
  3.6618052790584393`*^9, 3.6618056147933064`*^9, 3.661806061022974*^9, 
  3.66180687381091*^9, 3.661807363995236*^9, 3.661807417503338*^9, 
  3.6618083424161997`*^9, 3.662739911979648*^9, 3.6627524616934967`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"LineElement = \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox[
       RowBox[{"d", "[", "t", "]"}], "2"]}], "+", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"a", "[", "t", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"d", "[", "x", "]"}], "2"]}], "+", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"a", "[", "t", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"d", "[", "y", "]"}], "2"]}], "+", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"a", "[", "t", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"d", "[", "z", "]"}], "2"]}]}],
    Short[#, 32]& ]}],
  SequenceForm["LineElement = ", 
   Short[-$CellContext`d[$CellContext`t]^2 + $CellContext`a[$CellContext`t]^2 \
$CellContext`d[$CellContext`x]^2 + $CellContext`a[$CellContext`t]^2 \
$CellContext`d[$CellContext`y]^2 + $CellContext`a[$CellContext`t]^2 \
$CellContext`d[$CellContext`z]^2, 32]],
  Editable->False]], "Print",
 CellChangeTimes->{3.66179377772738*^9, 3.661793895771625*^9, 
  3.661799726941099*^9, 3.661800398764287*^9, 3.661800454068523*^9, 
  3.6618052790584393`*^9, 3.6618056147933064`*^9, 3.661806061022974*^9, 
  3.66180687381091*^9, 3.661807363995236*^9, 3.661807417503338*^9, 
  3.6618083424161997`*^9, 3.662739911979648*^9, 3.662752461695909*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"gUU = \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"-", "1"}], "0", "0", "0"},
       {"0", 
        FractionBox["1", 
         SuperscriptBox[
          RowBox[{"a", "[", "t", "]"}], "2"]], "0", "0"},
       {"0", "0", 
        FractionBox["1", 
         SuperscriptBox[
          RowBox[{"a", "[", "t", "]"}], "2"]], "0"},
       {"0", "0", "0", 
        FractionBox["1", 
         SuperscriptBox[
          RowBox[{"a", "[", "t", "]"}], "2"]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm["gUU = ", 
   MatrixForm[{{-1, 0, 0, 0}, {
     0, $CellContext`a[$CellContext`t]^(-2), 0, 0}, {
     0, 0, $CellContext`a[$CellContext`t]^(-2), 0}, {
     0, 0, 0, $CellContext`a[$CellContext`t]^(-2)}}]],
  Editable->False]], "Print",
 CellChangeTimes->{3.66179377772738*^9, 3.661793895771625*^9, 
  3.661799726941099*^9, 3.661800398764287*^9, 3.661800454068523*^9, 
  3.6618052790584393`*^9, 3.6618056147933064`*^9, 3.661806061022974*^9, 
  3.66180687381091*^9, 3.661807363995236*^9, 3.661807417503338*^9, 
  3.6618083424161997`*^9, 3.662739911979648*^9, 3.662752461698668*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"gUU computed in \"\>", "\[InvisibleSpace]", 
   "0.0008860000000001644`", "\[InvisibleSpace]", "\<\" sec\"\>"}],
  SequenceForm["gUU computed in ", 0.0008860000000001644, " sec"],
  Editable->False]], "Print",
 CellChangeTimes->{3.66179377772738*^9, 3.661793895771625*^9, 
  3.661799726941099*^9, 3.661800398764287*^9, 3.661800454068523*^9, 
  3.6618052790584393`*^9, 3.6618056147933064`*^9, 3.661806061022974*^9, 
  3.66180687381091*^9, 3.661807363995236*^9, 3.661807417503338*^9, 
  3.6618083424161997`*^9, 3.662739911979648*^9, 3.6627524617008543`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Gamma computed in \"\>", "\[InvisibleSpace]", 
   "0.00166299999999997`", "\[InvisibleSpace]", "\<\" sec\"\>"}],
  SequenceForm["Gamma computed in ", 0.00166299999999997, " sec"],
  Editable->False]], "Print",
 CellChangeTimes->{3.66179377772738*^9, 3.661793895771625*^9, 
  3.661799726941099*^9, 3.661800398764287*^9, 3.661800454068523*^9, 
  3.6618052790584393`*^9, 3.6618056147933064`*^9, 3.661806061022974*^9, 
  3.66180687381091*^9, 3.661807363995236*^9, 3.661807417503338*^9, 
  3.6618083424161997`*^9, 3.662739911979648*^9, 3.662752461702898*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Riemann(dddd) computed in \"\>", "\[InvisibleSpace]", 
   "0.0031769999999999854`", "\[InvisibleSpace]", "\<\" sec\"\>"}],
  SequenceForm["Riemann(dddd) computed in ", 0.0031769999999999854`, " sec"],
  Editable->False]], "Print",
 CellChangeTimes->{3.66179377772738*^9, 3.661793895771625*^9, 
  3.661799726941099*^9, 3.661800398764287*^9, 3.661800454068523*^9, 
  3.6618052790584393`*^9, 3.6618056147933064`*^9, 3.661806061022974*^9, 
  3.66180687381091*^9, 3.661807363995236*^9, 3.661807417503338*^9, 
  3.6618083424161997`*^9, 3.662739911979648*^9, 3.662752461705186*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Riemann(Uddd) computed in \"\>", "\[InvisibleSpace]", 
   "0.0018599999999999728`", "\[InvisibleSpace]", "\<\" sec\"\>"}],
  SequenceForm["Riemann(Uddd) computed in ", 0.0018599999999999728`, " sec"],
  Editable->False]], "Print",
 CellChangeTimes->{3.66179377772738*^9, 3.661793895771625*^9, 
  3.661799726941099*^9, 3.661800398764287*^9, 3.661800454068523*^9, 
  3.6618052790584393`*^9, 3.6618056147933064`*^9, 3.661806061022974*^9, 
  3.66180687381091*^9, 3.661807363995236*^9, 3.661807417503338*^9, 
  3.6618083424161997`*^9, 3.662739911979648*^9, 3.662752461708407*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Ricci computed in \"\>", "\[InvisibleSpace]", 
   "0.0007009999999998406`", "\[InvisibleSpace]", "\<\" sec\"\>"}],
  SequenceForm["Ricci computed in ", 0.0007009999999998406, " sec"],
  Editable->False]], "Print",
 CellChangeTimes->{3.66179377772738*^9, 3.661793895771625*^9, 
  3.661799726941099*^9, 3.661800398764287*^9, 3.661800454068523*^9, 
  3.6618052790584393`*^9, 3.6618056147933064`*^9, 3.661806061022974*^9, 
  3.66180687381091*^9, 3.661807363995236*^9, 3.661807417503338*^9, 
  3.6618083424161997`*^9, 3.662739911979648*^9, 3.662752461710537*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Weyl computed in \"\>", "\[InvisibleSpace]", 
   "0.0034009999999999874`", "\[InvisibleSpace]", "\<\" sec\"\>"}],
  SequenceForm["Weyl computed in ", 0.0034009999999999874`, " sec"],
  Editable->False]], "Print",
 CellChangeTimes->{3.66179377772738*^9, 3.661793895771625*^9, 
  3.661799726941099*^9, 3.661800398764287*^9, 3.661800454068523*^9, 
  3.6618052790584393`*^9, 3.6618056147933064`*^9, 3.661806061022974*^9, 
  3.66180687381091*^9, 3.661807363995236*^9, 3.661807417503338*^9, 
  3.6618083424161997`*^9, 3.662739911979648*^9, 3.6627524617126293`*^9}],

Cell[BoxData[
 StyleBox["\<\"Conformally Flat\"\>",
  StripOnInput->False,
  FontSize->20,
  FontWeight->"Bold",
  FontColor->RGBColor[1, 0, 1]]], "Print",
 CellChangeTimes->{3.66179377772738*^9, 3.661793895771625*^9, 
  3.661799726941099*^9, 3.661800398764287*^9, 3.661800454068523*^9, 
  3.6618052790584393`*^9, 3.6618056147933064`*^9, 3.661806061022974*^9, 
  3.66180687381091*^9, 3.661807363995236*^9, 3.661807417503338*^9, 
  3.6618083424161997`*^9, 3.662739911979648*^9, 3.662752461714665*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Einstein computed in \"\>", "\[InvisibleSpace]", 
   "0.0008369999999999767`", "\[InvisibleSpace]", "\<\" sec\"\>"}],
  SequenceForm["Einstein computed in ", 0.0008369999999999767, " sec"],
  Editable->False]], "Print",
 CellChangeTimes->{3.66179377772738*^9, 3.661793895771625*^9, 
  3.661799726941099*^9, 3.661800398764287*^9, 3.661800454068523*^9, 
  3.6618052790584393`*^9, 3.6618056147933064`*^9, 3.661806061022974*^9, 
  3.66180687381091*^9, 3.661807363995236*^9, 3.661807417503338*^9, 
  3.6618083424161997`*^9, 3.662739911979648*^9, 3.662752461716617*^9}],

Cell[BoxData["\<\"All tasks completed in 0.018561 seconds\"\>"], "Print",
 CellChangeTimes->{3.66179377772738*^9, 3.661793895771625*^9, 
  3.661799726941099*^9, 3.661800398764287*^9, 3.661800454068523*^9, 
  3.6618052790584393`*^9, 3.6618056147933064`*^9, 3.661806061022974*^9, 
  3.66180687381091*^9, 3.661807363995236*^9, 3.661807417503338*^9, 
  3.6618083424161997`*^9, 3.662739911979648*^9, 3.662752461718528*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["compute eom", "Subsection",
 CellChangeTimes->{{3.661800417974061*^9, 3.661800419924685*^9}, {
  3.6618062412926826`*^9, 3.661806242819202*^9}, {3.661808306621282*^9, 
  3.6618083067490187`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Laplacian", "[", 
   RowBox[{"phi", "[", 
    RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "]"}], " ", "//", " ",
   "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{"eomtmp", " ", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"%", " ", "/.", " ", "printrepl"}], ")"}], ",", " ", 
    RowBox[{"Assumptions", " ", "\[Rule]", "  ", "oprepl"}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.659213984446457*^9, 3.6592140165301533`*^9}, {
  3.659214079454344*^9, 3.6592141197235193`*^9}, {3.6592143219106903`*^9, 
  3.659214381024578*^9}, {3.659214540282854*^9, 3.659214549824751*^9}, {
  3.659214698842856*^9, 3.6592147557365828`*^9}, {3.6592148287619553`*^9, 
  3.659214833049459*^9}, {3.659214941697033*^9, 3.659214950600512*^9}, {
  3.659215026730626*^9, 3.659215087767284*^9}, {3.659215333484338*^9, 
  3.6592153424571247`*^9}, {3.659215839196046*^9, 3.659215839323812*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    SuperscriptBox["phi", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "0", ",", "0", ",", "2"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "+", 
   RowBox[{
    SuperscriptBox["phi", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "0", ",", "2", ",", "0"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "+", 
   RowBox[{
    SuperscriptBox["phi", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "2", ",", "0", ",", "0"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "-", 
   RowBox[{
    RowBox[{"a", "[", "t", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"3", " ", 
       RowBox[{
        SuperscriptBox["a", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], " ", 
       RowBox[{
        SuperscriptBox["phi", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0", ",", "0", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"a", "[", "t", "]"}], " ", 
       RowBox[{
        SuperscriptBox["phi", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"2", ",", "0", ",", "0", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], ")"}]}]}], 
  SuperscriptBox[
   RowBox[{"a", "[", "t", "]"}], "2"]]], "Output",
 CellChangeTimes->{3.661793792937232*^9, 3.661793903273398*^9, 
  3.661799733253769*^9, 3.6618003576485367`*^9, 3.6618004269543877`*^9, 
  3.6618004607887907`*^9, 3.661805294135742*^9, 3.661805621080722*^9, 
  3.661806065716523*^9, 3.661806877948206*^9, 3.661808345219232*^9, 
  3.6627399366027393`*^9, 3.6627524646230392`*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    RowBox[{"-", "a"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"a", " ", "ddphi"}], "+", 
      RowBox[{"3", " ", "da", " ", "dphi"}]}], ")"}]}], "+", "xxphi", "+", 
   "yyphi", "+", "zzphi"}], 
  SuperscriptBox["a", "2"]]], "Output",
 CellChangeTimes->{3.661793792937232*^9, 3.661793903273398*^9, 
  3.661799733253769*^9, 3.6618003576485367`*^9, 3.6618004269543877`*^9, 
  3.6618004607887907`*^9, 3.661805294135742*^9, 3.661805621080722*^9, 
  3.661806065716523*^9, 3.661806877948206*^9, 3.661808345219232*^9, 
  3.6627399366027393`*^9, 3.6627524647017183`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"eomtmp", " ", "\[Equal]", " ", 
    RowBox[{"covDiv", "[", 
     RowBox[{
      RowBox[{"gUU", ".", 
       RowBox[{"covD", "[", 
        RowBox[{"phi", "[", 
         RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "]"}]}], ",", 
      "1"}], "]"}]}], " ", "/.", " ", "printrepl"}], " ", "//", " ", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.662752471482067*^9, 3.662752545887148*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.6627525071174917`*^9, 3.662752546231092*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"eomtmp", " ", "/.", " ", "oprepl"}], ")"}], " ", "//", " ", 
   "FullSimplify"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"eomrepl", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"%", " ", "\[Equal]", " ", "Vprime"}], ",", " ", "ddphi"}], 
     "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], " ", "//", " ", 
   "FullSimplify"}]}]}], "Input",
 CellChangeTimes->{{3.661799750264654*^9, 3.661799842294924*^9}, {
  3.6618054872423964`*^9, 3.6618054894012136`*^9}, {3.661805921255815*^9, 
  3.661805921607616*^9}, {3.6618059582450657`*^9, 3.661805963295781*^9}, {
  3.66180831710308*^9, 3.661808320670527*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"ddphi", "\[Rule]", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "3"}], " ", "dphi", " ", "H"}], "+", 
    FractionBox["lphi", 
     SuperscriptBox["a", "2"]], "-", "Vprime"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.661799774780377*^9, 3.661799842620865*^9}, 
   3.661800364191799*^9, 3.661800467757988*^9, 3.661806076394123*^9, 
   3.661806190388741*^9, 3.661806887918294*^9, 3.661808232093062*^9, 
   3.661808346654131*^9, 3.662739937896989*^9, 3.66275255012014*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rhs", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{"ddphi", " ", "/.", " ", "eomrepl"}], ",", 
      RowBox[{"{", 
       RowBox[{"Psi", ",", "0", ",", "1"}], "}"}]}], "]"}], " ", "//", " ", 
    "FullSimplify"}], " ", "//", " ", "Normal"}]}]], "Input",
 CellChangeTimes->{{3.661799814588168*^9, 3.661799870749342*^9}, {
   3.661799938425756*^9, 3.6617999504171133`*^9}, {3.6618000456916313`*^9, 
   3.661800061786771*^9}, {3.6618002911838837`*^9, 3.6618002920055523`*^9}, 
   3.6618059324785013`*^9, {3.661805967340741*^9, 3.661805993707757*^9}, 
   3.661806039136339*^9, {3.661808323838702*^9, 3.6618083278781147`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "3"}], " ", "dphi", " ", "H"}], "+", 
  FractionBox["lphi", 
   SuperscriptBox["a", "2"]], "-", "Vprime"}]], "Output",
 CellChangeTimes->{3.661799871925385*^9, 3.661799951433176*^9, 
  3.661800062594718*^9, 3.661800292919671*^9, 3.661800365944322*^9, 
  3.661800469181068*^9, 3.661806078143025*^9, 3.661806192054335*^9, 
  3.6618068892603693`*^9, 3.661808233194413*^9, 3.661808350029607*^9, 
  3.662739939072495*^9, 3.662752550902584*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["equations of motion with scalar perturbation", "Section",
 CellChangeTimes->{{3.659213014104723*^9, 3.659213021975371*^9}, {
  3.659213222484356*^9, 3.6592132237242527`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Quit", "[", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.659214211589732*^9, 3.6592142130562477`*^9}}],

Cell[CellGroupData[{

Cell["initialization RGTC", "Subsection",
 CellChangeTimes->{{3.661807404617031*^9, 3.6618074097363577`*^9}, {
  3.662842661503759*^9, 3.662842663238081*^9}}],

Cell[BoxData[
 RowBox[{"<<", " ", "EDCRGTCcode.m"}]], "Input",
 CellChangeTimes->{{3.659213467062601*^9, 3.659213488856326*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["compute background values first", "Subsection",
 CellChangeTimes->{{3.6628424457636223`*^9, 3.6628424496979513`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"bgcoords", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.662842451879236*^9, 3.6628424620990047`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "}"}]], "Output",
 CellChangeTimes->{3.6628424632919273`*^9, 3.662842673198505*^9, 
  3.6628510156778593`*^9, 3.662906861236095*^9, 3.66291639397092*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"bgg", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      SuperscriptBox[
       RowBox[{"a", "[", "t", "]"}], "2"], ",", "0", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", 
      SuperscriptBox[
       RowBox[{"a", "[", "t", "]"}], "2"], ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0", ",", 
      SuperscriptBox[
       RowBox[{"a", "[", "t", "]"}], "2"]}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.662842464462376*^9, 3.662842489362385*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     SuperscriptBox[
      RowBox[{"a", "[", "t", "]"}], "2"], ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     SuperscriptBox[
      RowBox[{"a", "[", "t", "]"}], "2"], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", 
     SuperscriptBox[
      RowBox[{"a", "[", "t", "]"}], "2"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.662842490178022*^9, 3.662842674300383*^9, 
  3.662851016408424*^9, 3.662906861801813*^9, 3.662916394974675*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RGtensors", "[", 
  RowBox[{"bgg", ",", "bgcoords"}], "]"}]], "Input",
 CellChangeTimes->{{3.662842491866322*^9, 3.66284249960067*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"gdd = \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"-", "1"}], "0", "0", "0"},
       {"0", 
        SuperscriptBox[
         RowBox[{"a", "[", "t", "]"}], "2"], "0", "0"},
       {"0", "0", 
        SuperscriptBox[
         RowBox[{"a", "[", "t", "]"}], "2"], "0"},
       {"0", "0", "0", 
        SuperscriptBox[
         RowBox[{"a", "[", "t", "]"}], "2"]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm["gdd = ", 
   MatrixForm[{{-1, 0, 0, 0}, {0, $CellContext`a[$CellContext`t]^2, 0, 0}, {
     0, 0, $CellContext`a[$CellContext`t]^2, 0}, {
     0, 0, 0, $CellContext`a[$CellContext`t]^2}}]],
  Editable->False]], "Print",
 CellChangeTimes->{3.662842500296536*^9, 3.6628426762895613`*^9, 
  3.6628510174207067`*^9, 3.662906862375979*^9, 3.6629163953814373`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"LineElement = \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox[
       RowBox[{"d", "[", "t", "]"}], "2"]}], "+", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"a", "[", "t", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"d", "[", "x", "]"}], "2"]}], "+", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"a", "[", "t", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"d", "[", "y", "]"}], "2"]}], "+", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"a", "[", "t", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"d", "[", "z", "]"}], "2"]}]}],
    Short[#, 32]& ]}],
  SequenceForm["LineElement = ", 
   Short[-$CellContext`d[$CellContext`t]^2 + $CellContext`a[$CellContext`t]^2 \
$CellContext`d[$CellContext`x]^2 + $CellContext`a[$CellContext`t]^2 \
$CellContext`d[$CellContext`y]^2 + $CellContext`a[$CellContext`t]^2 \
$CellContext`d[$CellContext`z]^2, 32]],
  Editable->False]], "Print",
 CellChangeTimes->{3.662842500296536*^9, 3.6628426762895613`*^9, 
  3.6628510174207067`*^9, 3.662906862375979*^9, 3.662916395383923*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"gUU = \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"-", "1"}], "0", "0", "0"},
       {"0", 
        FractionBox["1", 
         SuperscriptBox[
          RowBox[{"a", "[", "t", "]"}], "2"]], "0", "0"},
       {"0", "0", 
        FractionBox["1", 
         SuperscriptBox[
          RowBox[{"a", "[", "t", "]"}], "2"]], "0"},
       {"0", "0", "0", 
        FractionBox["1", 
         SuperscriptBox[
          RowBox[{"a", "[", "t", "]"}], "2"]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm["gUU = ", 
   MatrixForm[{{-1, 0, 0, 0}, {
     0, $CellContext`a[$CellContext`t]^(-2), 0, 0}, {
     0, 0, $CellContext`a[$CellContext`t]^(-2), 0}, {
     0, 0, 0, $CellContext`a[$CellContext`t]^(-2)}}]],
  Editable->False]], "Print",
 CellChangeTimes->{3.662842500296536*^9, 3.6628426762895613`*^9, 
  3.6628510174207067`*^9, 3.662906862375979*^9, 3.662916395386965*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"gUU computed in \"\>", "\[InvisibleSpace]", 
   "0.0007379999999999609`", "\[InvisibleSpace]", "\<\" sec\"\>"}],
  SequenceForm["gUU computed in ", 0.0007379999999999609, " sec"],
  Editable->False]], "Print",
 CellChangeTimes->{3.662842500296536*^9, 3.6628426762895613`*^9, 
  3.6628510174207067`*^9, 3.662906862375979*^9, 3.662916395389036*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Gamma computed in \"\>", "\[InvisibleSpace]", 
   "0.0015149999999999886`", "\[InvisibleSpace]", "\<\" sec\"\>"}],
  SequenceForm["Gamma computed in ", 0.0015149999999999886`, " sec"],
  Editable->False]], "Print",
 CellChangeTimes->{3.662842500296536*^9, 3.6628426762895613`*^9, 
  3.6628510174207067`*^9, 3.662906862375979*^9, 3.662916395391016*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Riemann(dddd) computed in \"\>", "\[InvisibleSpace]", 
   "0.0029569999999999874`", "\[InvisibleSpace]", "\<\" sec\"\>"}],
  SequenceForm["Riemann(dddd) computed in ", 0.0029569999999999874`, " sec"],
  Editable->False]], "Print",
 CellChangeTimes->{3.662842500296536*^9, 3.6628426762895613`*^9, 
  3.6628510174207067`*^9, 3.662906862375979*^9, 3.6629163953930397`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Riemann(Uddd) computed in \"\>", "\[InvisibleSpace]", 
   "0.001678999999999986`", "\[InvisibleSpace]", "\<\" sec\"\>"}],
  SequenceForm["Riemann(Uddd) computed in ", 0.001678999999999986, " sec"],
  Editable->False]], "Print",
 CellChangeTimes->{3.662842500296536*^9, 3.6628426762895613`*^9, 
  3.6628510174207067`*^9, 3.662906862375979*^9, 3.662916395395076*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Ricci computed in \"\>", "\[InvisibleSpace]", 
   "0.0006619999999999959`", "\[InvisibleSpace]", "\<\" sec\"\>"}],
  SequenceForm["Ricci computed in ", 0.0006619999999999959, " sec"],
  Editable->False]], "Print",
 CellChangeTimes->{3.662842500296536*^9, 3.6628426762895613`*^9, 
  3.6628510174207067`*^9, 3.662906862375979*^9, 3.662916395397119*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Weyl computed in \"\>", "\[InvisibleSpace]", 
   "0.0028699999999999837`", "\[InvisibleSpace]", "\<\" sec\"\>"}],
  SequenceForm["Weyl computed in ", 0.0028699999999999837`, " sec"],
  Editable->False]], "Print",
 CellChangeTimes->{3.662842500296536*^9, 3.6628426762895613`*^9, 
  3.6628510174207067`*^9, 3.662906862375979*^9, 3.662916395399173*^9}],

Cell[BoxData[
 StyleBox["\<\"Conformally Flat\"\>",
  StripOnInput->False,
  FontSize->20,
  FontWeight->"Bold",
  FontColor->RGBColor[1, 0, 1]]], "Print",
 CellChangeTimes->{3.662842500296536*^9, 3.6628426762895613`*^9, 
  3.6628510174207067`*^9, 3.662906862375979*^9, 3.662916395401452*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Einstein computed in \"\>", "\[InvisibleSpace]", 
   "0.0008069999999999466`", "\[InvisibleSpace]", "\<\" sec\"\>"}],
  SequenceForm["Einstein computed in ", 0.0008069999999999466, " sec"],
  Editable->False]], "Print",
 CellChangeTimes->{3.662842500296536*^9, 3.6628426762895613`*^9, 
  3.6628510174207067`*^9, 3.662906862375979*^9, 3.6629163954034843`*^9}],

Cell[BoxData["\<\"All tasks completed in 0.020917 seconds\"\>"], "Print",
 CellChangeTimes->{3.662842500296536*^9, 3.6628426762895613`*^9, 
  3.6628510174207067`*^9, 3.662906862375979*^9, 3.662916395405479*^9}]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"bgRdd", " ", "=", " ", "Rdd"}], ";", " ", 
  RowBox[{"bgEUd", " ", "=", " ", "EUd"}], ";", " ", 
  RowBox[{"bgR", " ", "=", " ", "R"}], ";"}]], "Input",
 CellChangeTimes->{{3.662842504250105*^9, 3.662842526303337*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Clear", "@@", 
    RowBox[{"DeleteCases", "[", 
     RowBox[{
      RowBox[{"Names", "@", "\"\<`*\>\""}], ",", 
      RowBox[{
      "\"\<bgRdd\>\"", " ", "|", " ", "\"\<bgEUd\>\"", " ", "|", " ", 
       "\"\<bgR\>\""}]}], "]"}]}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.6628425324205847`*^9, 3.662842533782303*^9}, {
  3.662842611843705*^9, 3.6628426335299597`*^9}, {3.6628510213230467`*^9, 
  3.6628510232345448`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["some useful functions, mostly for readability", "Subsection",
 CellChangeTimes->{{3.662756289879479*^9, 3.662756295756824*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"expansionOrder", " ", "=", " ", "1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tolin", "[", "f_", "]"}], " ", ":=", " ", 
   RowBox[{"Simplify", "@", 
    RowBox[{"Normal", "@", 
     RowBox[{"Series", "[", 
      RowBox[{"f", ",", " ", 
       RowBox[{"{", 
        RowBox[{"Psi", ",", "0", ",", "expansionOrder"}], "}"}]}], 
      "]"}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.66162916071454*^9, 3.6616291837383413`*^9}, {
  3.66162936215162*^9, 3.661629364199099*^9}, {3.662851102293614*^9, 
  3.662851114045546*^9}, {3.662851155506918*^9, 3.662851155682184*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"fullnice", "[", "f_", "]"}], " ", ":=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"tolin", "@", 
      RowBox[{"(", 
       RowBox[{"f", " ", "/.", " ", "printrepl"}], ")"}]}], " ", "/.", " ", 
     "oprepl"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.661629964073977*^9, 3.661630013875849*^9}, {
  3.6616301386362743`*^9, 3.661630138964213*^9}, {3.6628510924941177`*^9, 
  3.662851099510166*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"myLaplacian", "[", "f_", "]"}], " ", ":=", " ", 
  RowBox[{"covDiv", "[", 
   RowBox[{
    RowBox[{"gUU", ".", 
     RowBox[{"covD", "[", "f", "]"}]}], ",", "1"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6627467455883303`*^9, 3.6627467570703917`*^9}, {
   3.662746805605633*^9, 3.662746864739229*^9}, {3.662746964393807*^9, 
   3.662746989965805*^9}, {3.662747246028304*^9, 3.662747300769566*^9}, {
   3.66274733324783*^9, 3.662747333335977*^9}, {3.662747421925318*^9, 
   3.662747422716901*^9}, {3.66274757457069*^9, 3.6627475793928328`*^9}, {
   3.662747710770337*^9, 3.662747749623884*^9}, {3.662747791122501*^9, 
   3.662747831490425*^9}, 3.6627483239106293`*^9, {3.662752419339052*^9, 
   3.662752439224073*^9}, {3.662752563798275*^9, 3.662752564430092*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"getCoefficients", "[", "f_", "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{"\"\<full expression: \>\"", ",", " ", 
        RowBox[{"Collect", "[", 
         RowBox[{"f", ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"dphi", ",", " ", 
             SuperscriptBox["dphi", "2"], ",", " ", "lphi", ",", " ", 
             RowBox[{"gphi", " ", "gPsi"}], ",", " ", "Vprime"}], "}"}], " ", 
           "/.", " ", "mathrepl"}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "\"\<coefficients of\>\"", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<\!\(\*OverscriptBox[\(\[Phi]\), \(.\)]\): \>\"", ",", " ", 
        RowBox[{"Simplify", "@", 
         RowBox[{"SeriesCoefficient", "[", 
          RowBox[{"f", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"dphi", " ", "/.", " ", "mathrepl"}], ",", "0", ",", 
             "1"}], "}"}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<\!\(\*SuperscriptBox[OverscriptBox[\(\[Phi]\), \(.\)], \(2\)]\): \
\>\"", ",", " ", 
        RowBox[{"Simplify", "@", 
         RowBox[{"SeriesCoefficient", "[", 
          RowBox[{"f", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"dphi", " ", "/.", " ", "mathrepl"}], ",", "0", ",", 
             "2"}], "}"}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<\!\(\*SuperscriptBox[\(\[Del]\), \(2\)]\)\[Phi]: \>\"", ",", " ", 
        
        RowBox[{"Simplify", "@", 
         RowBox[{"SeriesCoefficient", "[", 
          RowBox[{"f", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lphi", " ", "/.", " ", "mathrepl"}], ",", "0", ",", 
             "1"}], "}"}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<(\[Del]\[Phi]) (\[Del]\[Psi]): \>\"", ",", " ", 
        RowBox[{"Simplify", "@", 
         RowBox[{"SeriesCoefficient", "[", 
          RowBox[{"f", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"gphi", " ", "gPsi"}], " ", "/.", " ", "mathrepl"}], 
             ",", "0", ",", "1"}], "}"}]}], "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<V': \>\"", ",", " ", 
        RowBox[{"Simplify", "@", 
         RowBox[{"SeriesCoefficient", "[", 
          RowBox[{"f", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Vprime", " ", "/.", " ", "mathrepl"}], ",", "0", ",", 
             "1"}], "}"}]}], "]"}]}]}], "]"}], ";"}]}], "\[IndentingNewLine]",
     " ", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6627531980176563`*^9, 3.6627534772565737`*^9}, {
  3.662753507837038*^9, 3.662753534819117*^9}, {3.662753566267014*^9, 
  3.6627536642889643`*^9}, {3.662753818601787*^9, 3.6627538942127123`*^9}, {
  3.662753925566646*^9, 3.662753982929335*^9}, {3.662754040792706*^9, 
  3.662754120859701*^9}, {3.6627563008893223`*^9, 3.662756326272108*^9}, {
  3.6627573165178223`*^9, 3.6627573340623713`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["replacement rules for readability", "Subsection",
 CellChangeTimes->{{3.662756330170906*^9, 3.662756337794312*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"printrepl", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox["phi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "dphi"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["phi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "xphi"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["phi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "1", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "yphi"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["phi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "zphi"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       SuperscriptBox["phi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"2", ",", "0", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "ddphi"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["phi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "2", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "xxphi"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["phi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "2", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "yyphi"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["phi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "0", ",", "2"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "zzphi"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "[", "t", "]"}], " ", "\[Rule]", " ", "a"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"a", "'"}], "[", "t", "]"}], " ", "\[Rule]", " ", "da"}], ",", 
     
     RowBox[{
      RowBox[{
       RowBox[{"a", "''"}], "[", "t", "]"}], " ", "\[Rule]", " ", "dda"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"V", "[", 
       RowBox[{"phi", "[", 
        RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "]"}], " ", 
      "\[Rule]", " ", "V"}], ",", " ", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"V", "[", 
         RowBox[{"phi", "[", 
          RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "]"}], ",", 
        RowBox[{"phi", "[", 
         RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], "]"}], " ", 
      "\[Rule]", " ", "Vprime"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Psi", "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "Psi"}], ",", " ", 
     RowBox[{
      RowBox[{
       SuperscriptBox["Psi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "dPsi"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["Psi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "xPsi"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["Psi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "1", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "yPsi"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["Psi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "zPsi"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       SuperscriptBox["Psi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"2", ",", "0", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "ddPsi"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["Psi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "2", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "xxPsi"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["Psi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "2", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "yyPsi"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["Psi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "0", ",", "2"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "zzPsi"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       SuperscriptBox["Psi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "1", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "xdPsi"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["Psi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0", ",", "1", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "ydPsi"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["Psi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0", ",", "0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "zdPsi"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.659213914364317*^9, 3.65921392209678*^9}, {
   3.659214396071636*^9, 3.659214400462729*^9}, {3.6592144383026733`*^9, 
   3.659214534062351*^9}, {3.659214571991007*^9, 3.6592146891433773`*^9}, {
   3.659214787192404*^9, 3.65921479109603*^9}, {3.662742990338163*^9, 
   3.662743083577395*^9}, 3.662756343169889*^9, {3.6628290815125513`*^9, 
   3.6628291014635468`*^9}, {3.6628292399271717`*^9, 3.662829244141405*^9}, {
   3.662851658665413*^9, 3.66285168577603*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mathrepl", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"phi", " ", "\[Rule]", " ", "\[Phi]"}], ",", " ", 
     RowBox[{"dphi", " ", "\[Rule]", " ", 
      OverscriptBox["\[Phi]", "."]}], ",", 
     RowBox[{"xphi", " ", "\[Rule]", " ", 
      RowBox[{
       SubscriptBox["\[PartialD]", "x"], "\[Phi]"}]}], ",", 
     RowBox[{"yphi", " ", "\[Rule]", " ", 
      RowBox[{
       SubscriptBox["\[PartialD]", "y"], "\[Phi]"}]}], ",", 
     RowBox[{"zphi", " ", "\[Rule]", " ", 
      RowBox[{
       SubscriptBox["\[PartialD]", "z"], "\[Phi]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ddphi", " ", "\[Rule]", " ", "dd\[Phi]"}], ",", 
     RowBox[{"xxphi", " ", "\[Rule]", " ", 
      RowBox[{
       SubscriptBox["\[PartialD]", "x"], 
       RowBox[{
        SubscriptBox["\[PartialD]", "x"], "\[Phi]"}]}]}], ",", 
     RowBox[{"yyphi", " ", "\[Rule]", " ", 
      RowBox[{
       SubscriptBox["\[PartialD]", "y"], 
       RowBox[{
        SubscriptBox["\[PartialD]", "y"], "\[Phi]"}]}]}], ",", 
     RowBox[{"zzphi", " ", "\[Rule]", " ", 
      RowBox[{
       SubscriptBox["\[PartialD]", "z"], 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "\[Phi]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"delphi", " ", "\[Rule]", " ", "\[Delta]\[Phi]"}], ",", 
     RowBox[{"deldphi", " ", "\[Rule]", " ", 
      OverscriptBox["\[Delta]\[Phi]", "."]}], ",", " ", "\[IndentingNewLine]", 
     RowBox[{"da", " ", "\[Rule]", " ", 
      OverscriptBox["a", "."]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Vprime", " ", "\[Rule]", " ", 
      RowBox[{"V", "'"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"rhobar", " ", "\[Rule]", " ", 
      OverscriptBox["\[Rho]", "_"]}], ",", " ", "\[IndentingNewLine]", 
     RowBox[{"Psi", " ", "\[Rule]", " ", "\[Psi]"}], ",", " ", 
     RowBox[{"dPsi", " ", "\[Rule]", " ", 
      OverscriptBox["\[Psi]", "."]}], ",", 
     RowBox[{"xPsi", " ", "\[Rule]", " ", 
      RowBox[{
       SubscriptBox["\[PartialD]", "x"], "\[Psi]"}]}], ",", 
     RowBox[{"yPsi", " ", "\[Rule]", " ", 
      RowBox[{
       SubscriptBox["\[PartialD]", "y"], "\[Psi]"}]}], ",", 
     RowBox[{"zPsi", " ", "\[Rule]", " ", 
      RowBox[{
       SubscriptBox["\[PartialD]", "z"], "\[Psi]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"xdPsi", " ", "\[Rule]", " ", 
      RowBox[{
       SubscriptBox["\[PartialD]", "x"], 
       OverscriptBox["\[Psi]", "."]}]}], ",", " ", 
     RowBox[{"ydPsi", " ", "\[Rule]", " ", 
      RowBox[{
       SubscriptBox["\[PartialD]", "y"], 
       OverscriptBox["\[Psi]", "."]}]}], ",", " ", 
     RowBox[{"zdPsi", " ", "\[Rule]", " ", 
      RowBox[{
       SubscriptBox["\[PartialD]", "z"], 
       OverscriptBox["\[Psi]", "."]}]}], ",", " ", "\[IndentingNewLine]", 
     RowBox[{"lPsi", " ", "\[Rule]", " ", "\[CapitalDelta]\[Psi]"}], ",", " ", 
     RowBox[{"lphi", " ", "\[Rule]", "  ", "\[CapitalDelta]\[Phi]"}], ",", 
     " ", 
     RowBox[{
      RowBox[{"gphi", " ", "gPsi"}], " ", "\[Rule]", " ", 
      RowBox[{
       RowBox[{"\[Del]", "\[Phi]"}], " ", 
       RowBox[{"\[Del]", "\[Psi]"}]}]}], ",", " ", 
     RowBox[{
      SuperscriptBox["gphi", "2"], " ", "\[Rule]", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"\[Del]", "\[Phi]"}], ")"}], "2"]}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.662756419525899*^9, 3.662756424861803*^9}, {
  3.6627565720917788`*^9, 3.662756574747417*^9}, {3.662756718087454*^9, 
  3.662756719343575*^9}, {3.6627567592129307`*^9, 3.662756770248612*^9}, {
  3.662756860547024*^9, 3.662757007991002*^9}, {3.6627572563379297`*^9, 
  3.6627572729687433`*^9}, {3.662758017622628*^9, 3.662758035953719*^9}, {
  3.662758121195751*^9, 3.66275812803933*^9}, {3.662759911580743*^9, 
  3.662759938436405*^9}, {3.6628457970483627`*^9, 3.6628458003668747`*^9}, {
  3.662851699715782*^9, 3.662851753928875*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"oprepl", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"xxphi", " ", "\[Rule]", "  ", 
      RowBox[{"lphi", " ", "-", " ", "yyphi", " ", "-", " ", "zzphi"}]}], ",", 
     RowBox[{"xxPsi", " ", "\[Rule]", "  ", 
      RowBox[{"lPsi", " ", "-", " ", "yyPsi", " ", "-", " ", "zzPsi"}]}], ",",
      " ", 
     RowBox[{
      RowBox[{"xphi", " ", "xPsi"}], " ", "\[Rule]", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "yphi"}], " ", "yPsi"}], "-", 
       RowBox[{"zphi", " ", "zPsi"}], "  ", "+", " ", 
       RowBox[{"gphi", " ", "gPsi"}]}]}], ",", " ", 
     RowBox[{"da", " ", "\[Rule]", " ", 
      RowBox[{"H", " ", "a"}]}], ",", " ", 
     RowBox[{
      SuperscriptBox["xphi", "2"], " ", "\[Rule]", " ", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["yphi", "2"]}], " ", "-", " ", 
       SuperscriptBox["zphi", "2"], " ", "+", " ", 
       SuperscriptBox["gphi", "2"]}]}], ",", " ", 
     RowBox[{
      SuperscriptBox["xPsi", "2"], " ", "\[Rule]", " ", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["yPsi", "2"]}], " ", "-", " ", 
       SuperscriptBox["zPsi", "2"], " ", "+", " ", 
       SuperscriptBox["gPsi", "2"]}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.659214793541716*^9, 3.659214931155787*^9}, {
   3.659215044272204*^9, 3.659215066023184*^9}, {3.659215187363412*^9, 
   3.659215204714739*^9}, {3.6592156626027393`*^9, 3.659215663906513*^9}, {
   3.6592157005773363`*^9, 3.6592157422419577`*^9}, {3.659215957680072*^9, 
   3.6592159577599077`*^9}, {3.6592164270709352`*^9, 
   3.6592164534208717`*^9}, {3.6592881588968487`*^9, 3.659288181195691*^9}, 
   3.659288894571817*^9, {3.660940168303521*^9, 3.660940175150783*^9}, {
   3.6616292678887367`*^9, 3.661629314263686*^9}, 3.662756820532968*^9, {
   3.6628291250594177`*^9, 3.66282913391964*^9}, {3.6628291719415627`*^9, 
   3.66282918294094*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"opreplalt", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["\[PartialD]", "x"], 
       RowBox[{
        SubscriptBox["\[PartialD]", "x"], "\[Phi]"}]}], " ", "\[Rule]", "  ", 
      
      RowBox[{"\[CapitalDelta]\[Phi]", " ", "-", " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "y"], 
        RowBox[{
         SubscriptBox["\[PartialD]", "y"], "\[Phi]"}]}], " ", "-", " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "\[Phi]"}]}]}]}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        SubscriptBox["\[PartialD]", "x"], "\[Phi]"}], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "x"], "\[Psi]"}]}], "\[Rule]", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          SubscriptBox["\[PartialD]", "y"], "\[Phi]"}]}], " ", 
        RowBox[{
         SubscriptBox["\[PartialD]", "y"], "\[Psi]"}]}], "-", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "\[Phi]"}], " ", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "\[Psi]"}]}], "  ", "+", " ", 
       RowBox[{
        RowBox[{"\[Del]", "\[Phi]"}], " ", 
        RowBox[{"\[Del]", "\[Psi]"}]}]}]}], ",", " ", 
     RowBox[{
      OverscriptBox["a", "."], " ", "\[Rule]", " ", 
      RowBox[{"H", " ", "a"}]}], ",", " ", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["\[PartialD]", "x"], "\[Phi]"}], ")"}], "2"], " ", 
      "\[Rule]", " ", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["\[PartialD]", "y"], "\[Phi]"}], ")"}], "2"]}], " ", 
       "-", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], "\[Phi]"}], ")"}], "2"], " ", "+",
        " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"\[Del]", "\[Phi]"}], ")"}], "2"]}]}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.662756784735046*^9, 3.662756816037425*^9}, {
  3.662757014516102*^9, 3.662757014756444*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"quadPsirepl", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SuperscriptBox["dPsi", "2"], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      SuperscriptBox["ddPsi", "2"], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      SuperscriptBox["gPsi", "2"], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      SuperscriptBox["lPsi", "2"], "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"dPsi", " ", "Psi"}], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"ddPsi", " ", "Psi"}], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"lPsi", " ", "Psi"}], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"dPsi", " ", "ddPsi"}], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"lPsi", " ", "dPsi"}], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"lPsi", " ", "ddPsi"}], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"gPsi", " ", "Psi"}], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"gPsi", " ", "dPsi"}], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"Psi", " ", "xPsi"}], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"dPsi", " ", "xPsi"}], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"lPsi", " ", "xPsi"}], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"gPsi", " ", "xPsi"}], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"xdPsi", " ", "Psi"}], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"xdPsi", " ", "dPsi"}], " ", "\[Rule]", " ", "0"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6628378841784153`*^9, 3.662837903993519*^9}, {
  3.6628379859834623`*^9, 3.6628380344028893`*^9}, {3.6628419156664762`*^9, 
  3.662841938497369*^9}, {3.662851573298771*^9, 3.662851595135442*^9}, {
  3.6628518619606123`*^9, 3.6628518730948887`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "replacement rules for ",
 Cell[BoxData[
  FormBox[
   OverscriptBox["\[Psi]", "."], TraditionalForm]]],
 ", from Riotto --> WARNING"
}], "Subsection",
 CellChangeTimes->{{3.662756828648758*^9, 3.662756838900947*^9}, {
  3.6628510458396893`*^9, 3.6628510557267113`*^9}}],

Cell["TODO: check this, equation (162) in riotto", "Text",
 CellChangeTimes->{{3.661796968197307*^9, 3.6617970017465353`*^9}, {
  3.6618060515757437`*^9, 3.6618060552616777`*^9}, {3.6618073573887873`*^9, 
  3.661807358459631*^9}, {3.662740626010725*^9, 3.662740646181551*^9}, {
  3.662746727648795*^9, 3.662746728182457*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"einsteinPert00", " ", "=", " ", 
  RowBox[{
   RowBox[{"dPsi", " ", "+", " ", 
    RowBox[{"H", " ", "Psi"}]}], " ", "\[Equal]", " ", 
   RowBox[{
   "4", " ", "\[Pi]", " ", "Gnew", " ", "dphi", " ", "delphi"}]}]}]], "Input",\

 CellChangeTimes->{{3.6627403836259747`*^9, 3.6627404278896933`*^9}, {
  3.662740616529592*^9, 3.6627406177333403`*^9}, {3.662845676111105*^9, 
  3.662845682405367*^9}, {3.6628510417456408`*^9, 3.662851042049551*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dPsi", "+", 
   RowBox[{"H", " ", "Psi"}]}], "\[Equal]", 
  RowBox[{
  "4", " ", "delphi", " ", "dphi", " ", "Gnew", " ", "\[Pi]"}]}]], "Output",
 CellChangeTimes->{
  3.662740428575602*^9, {3.662740630022697*^9, 3.66274064779897*^9}, 
   3.662743096460888*^9, 3.6627450308461018`*^9, 3.6627467291341057`*^9, 
   3.662748328254634*^9, 3.662748727548037*^9, 3.662752571821464*^9, 
   3.662753683145281*^9, 3.66275684370263*^9, 3.662757023292243*^9, 
   3.6628223113214207`*^9, 3.662832586301961*^9, 3.6628372549193287`*^9, 
   3.662840316179882*^9, 3.6628417799374866`*^9, 3.662842689133383*^9, 
   3.662845686120531*^9, {3.66285103145431*^9, 3.662851042603631*^9}, 
   3.662851120943318*^9, 3.662907227110649*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dPsirepl", " ", "=", " ", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{"einsteinPert00", ",", " ", "dPsi"}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.662740434278263*^9, 3.662740461515856*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"dPsi", "\[Rule]", 
   RowBox[{
    RowBox[{"4", " ", "delphi", " ", "dphi", " ", "Gnew", " ", "\[Pi]"}], "-", 
    RowBox[{"H", " ", "Psi"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.662740449044674*^9, 3.662740462228839*^9}, {
   3.6627406317735653`*^9, 3.6627406482830887`*^9}, 3.6627430971271963`*^9, 
   3.662745031551919*^9, 3.662746729568194*^9, 3.662748330104965*^9, 
   3.662748728080297*^9, 3.662752572921196*^9, 3.6627536837790194`*^9, 
   3.6627570244090157`*^9, 3.66282231208654*^9, 3.662832587818285*^9, 
   3.662837255984922*^9, 3.6628403170458097`*^9, 3.662841781068246*^9, 
   3.6628426898501177`*^9, 3.662845689353958*^9, {3.662851037438757*^9, 
   3.6628510434375668`*^9}, 3.662851121563856*^9, 3.6629072272441998`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
replacement rule for numerics: 8 \[Pi] G = 1 (G = Gnew)\
\>", "Subsection",
 CellChangeTimes->{{3.662757031304235*^9, 3.662757046623557*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"grepl", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"Gnew", " ", "\[Rule]", " ", 
     FractionBox["1", 
      RowBox[{"8", " ", "\[Pi]"}]]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.661631228336399*^9, 3.661631249894232*^9}, 
   3.66275704904959*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["setup coordinates and metric and call RGtensors", "Subsection",
 CellChangeTimes->{{3.662757052526977*^9, 3.6627570592386913`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"coords", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.659213500185669*^9, 3.659213510640218*^9}, {
   3.661805265682004*^9, 3.661805267194525*^9}, 3.662757062864636*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"g", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "1"}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"Psi", "[", 
         RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], ",", "0", 
      ",", "0", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", " ", "-", " ", 
         RowBox[{"2", " ", 
          RowBox[{"Psi", "[", 
           RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], ")"}]}], 
      ",", "0", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", " ", "-", " ", 
         RowBox[{"2", " ", 
          RowBox[{"Psi", "[", 
           RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], ")"}]}], 
      ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0", ",", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", " ", "-", " ", 
         RowBox[{"2", " ", 
          RowBox[{"Psi", "[", 
           RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], ")"}]}]}], 
     "}"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"g", " ", "//", " ", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.6592132263670177`*^9, 3.659213327349605*^9}, {
   3.659213515554082*^9, 3.6592135156902237`*^9}, {3.659213549427917*^9, 
   3.659213562219933*^9}, 3.659214205885046*^9, {3.659287997316237*^9, 
   3.659288011285386*^9}, {3.659288783616477*^9, 3.65928879398288*^9}, {
   3.659288859455915*^9, 3.659288860144106*^9}, {3.660939909094689*^9, 
   3.660939913567176*^9}, {3.661189582767799*^9, 3.6611895896059523`*^9}, {
   3.661190896548168*^9, 3.661190912622839*^9}, {3.661808185832955*^9, 
   3.661808202158963*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "-", 
      RowBox[{"2", " ", 
       RowBox[{"Psi", "[", 
        RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], ",", "0", ",",
      "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"a", "[", "t", "]"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", " ", 
         RowBox[{"Psi", "[", 
          RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], ")"}]}], 
     ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"a", "[", "t", "]"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", " ", 
         RowBox[{"Psi", "[", 
          RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], ")"}]}], 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"a", "[", "t", "]"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", " ", 
         RowBox[{"Psi", "[", 
          RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], ")"}]}]}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.661793772634087*^9, 3.6617938945224543`*^9, 
  3.661799725358715*^9, 3.66180039626402*^9, 3.661800453003325*^9, 
  3.6618052689891977`*^9, 3.6618056132435017`*^9, 3.66180605964098*^9, 
  3.66180687269571*^9, 3.661807361829916*^9, 3.6618074174463997`*^9, 
  3.661808210141995*^9, 3.661809205347373*^9, 3.6618111636874638`*^9, 
  3.662740474339182*^9, 3.662740650389791*^9, 3.6627430987850227`*^9, 
  3.662745034604973*^9, 3.662746733268279*^9, 3.662748337888983*^9, 
  3.6627487298137207`*^9, 3.6627525808550367`*^9, 3.662753685269641*^9, 
  3.662757064375226*^9, 3.662822314504046*^9, 3.662832591485196*^9, 
  3.662837260702496*^9, 3.662840265574698*^9, 3.662841784784895*^9, 
  3.66284269228055*^9, 3.662851061509326*^9, 3.662851127515671*^9, 
  3.662906881784751*^9, 3.662912387363076*^9, 3.6629164089970407`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", "1"}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"Psi", "[", 
         RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], "0", "0", 
      "0"},
     {"0", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"2", " ", 
          RowBox[{"Psi", "[", 
           RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], ")"}]}], 
      "0", "0"},
     {"0", "0", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"2", " ", 
          RowBox[{"Psi", "[", 
           RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], ")"}]}], 
      "0"},
     {"0", "0", "0", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"2", " ", 
          RowBox[{"Psi", "[", 
           RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], ")"}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.661793772634087*^9, 3.6617938945224543`*^9, 
  3.661799725358715*^9, 3.66180039626402*^9, 3.661800453003325*^9, 
  3.6618052689891977`*^9, 3.6618056132435017`*^9, 3.66180605964098*^9, 
  3.66180687269571*^9, 3.661807361829916*^9, 3.6618074174463997`*^9, 
  3.661808210141995*^9, 3.661809205347373*^9, 3.6618111636874638`*^9, 
  3.662740474339182*^9, 3.662740650389791*^9, 3.6627430987850227`*^9, 
  3.662745034604973*^9, 3.662746733268279*^9, 3.662748337888983*^9, 
  3.6627487298137207`*^9, 3.6627525808550367`*^9, 3.662753685269641*^9, 
  3.662757064375226*^9, 3.662822314504046*^9, 3.662832591485196*^9, 
  3.662837260702496*^9, 3.662840265574698*^9, 3.662841784784895*^9, 
  3.66284269228055*^9, 3.662851061509326*^9, 3.662851127515671*^9, 
  3.662906881784751*^9, 3.662912387363076*^9, 3.662916409000333*^9}]
}, Open  ]],

Cell["\<\
do everything as series expansion in \[Psi] around 0 up to second order\
\>", "Text",
 CellChangeTimes->{{3.6627570689903603`*^9, 3.662757084421204*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gPert", " ", "=", " ", 
  RowBox[{"Series", "[", 
   RowBox[{"g", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Psi", "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], ",", "0", ",", 
      "expansionOrder"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.662748339342737*^9, 3.6627484142342777`*^9}, {
  3.6627484860361*^9, 3.662748486123426*^9}, {3.662832575145792*^9, 
  3.662832575201239*^9}, {3.662851131644011*^9, 3.6628511358149767`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     InterpretationBox[
      RowBox[{
       RowBox[{"-", "1"}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"Psi", "[", 
         RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], "+", 
       InterpretationBox[
        SuperscriptBox[
         RowBox[{"O", "[", 
          RowBox[{"Psi", "[", 
           RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "]"}], "2"],
        SeriesData[
         $CellContext`Psi[$CellContext`t, $CellContext`x, $CellContext`y, \
$CellContext`z], 0, {}, 0, 2, 1],
        Editable->False]}],
      SeriesData[
       $CellContext`Psi[$CellContext`t, $CellContext`x, $CellContext`y, \
$CellContext`z], 0, {-1, -2}, 0, 2, 1],
      Editable->False], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     InterpretationBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"a", "[", "t", "]"}], "2"], " ", 
        RowBox[{"Psi", "[", 
         RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], "+", 
       InterpretationBox[
        SuperscriptBox[
         RowBox[{"O", "[", 
          RowBox[{"Psi", "[", 
           RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "]"}], "2"],
        SeriesData[
         $CellContext`Psi[$CellContext`t, $CellContext`x, $CellContext`y, \
$CellContext`z], 0, {}, 0, 2, 1],
        Editable->False]}],
      SeriesData[
       $CellContext`Psi[$CellContext`t, $CellContext`x, $CellContext`y, \
$CellContext`z], 
       0, {$CellContext`a[$CellContext`t]^2, (-2) \
$CellContext`a[$CellContext`t]^2}, 0, 2, 1],
      Editable->False], ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     InterpretationBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"a", "[", "t", "]"}], "2"], " ", 
        RowBox[{"Psi", "[", 
         RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], "+", 
       InterpretationBox[
        SuperscriptBox[
         RowBox[{"O", "[", 
          RowBox[{"Psi", "[", 
           RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "]"}], "2"],
        SeriesData[
         $CellContext`Psi[$CellContext`t, $CellContext`x, $CellContext`y, \
$CellContext`z], 0, {}, 0, 2, 1],
        Editable->False]}],
      SeriesData[
       $CellContext`Psi[$CellContext`t, $CellContext`x, $CellContext`y, \
$CellContext`z], 
       0, {$CellContext`a[$CellContext`t]^2, (-2) \
$CellContext`a[$CellContext`t]^2}, 0, 2, 1],
      Editable->False], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", 
     InterpretationBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"a", "[", "t", "]"}], "2"], " ", 
        RowBox[{"Psi", "[", 
         RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], "+", 
       InterpretationBox[
        SuperscriptBox[
         RowBox[{"O", "[", 
          RowBox[{"Psi", "[", 
           RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "]"}], "2"],
        SeriesData[
         $CellContext`Psi[$CellContext`t, $CellContext`x, $CellContext`y, \
$CellContext`z], 0, {}, 0, 2, 1],
        Editable->False]}],
      SeriesData[
       $CellContext`Psi[$CellContext`t, $CellContext`x, $CellContext`y, \
$CellContext`z], 
       0, {$CellContext`a[$CellContext`t]^2, (-2) \
$CellContext`a[$CellContext`t]^2}, 0, 2, 1],
      Editable->False]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.662748376441906*^9, 3.662748414715137*^9}, 
   3.662748486551379*^9, 3.662748730849183*^9, 3.6627525840461817`*^9, 
   3.662753686520795*^9, {3.662757065596409*^9, 3.662757085381571*^9}, 
   3.6628223177385406`*^9, 3.662832592937862*^9, 3.662837263620222*^9, 
   3.6628426941352882`*^9, 3.662851063641857*^9, 3.6628511376747513`*^9, 
   3.662906883652844*^9, 3.662912388708728*^9, 3.6629164106899567`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RGtensors", "[", 
  RowBox[{"g", ",", "coords"}], "]"}]], "Input",
 CellChangeTimes->{{3.6592135276621113`*^9, 3.6592135335942593`*^9}, {
  3.662748384872767*^9, 3.662748385312427*^9}, {3.6628402725171432`*^9, 
  3.662840273132886*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"gdd = \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{
         RowBox[{"-", "1"}], "-", 
         RowBox[{"2", " ", 
          RowBox[{"Psi", "[", 
           RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], "0", "0", 
        "0"},
       {"0", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"a", "[", "t", "]"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"2", " ", 
            RowBox[{"Psi", "[", 
             RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], ")"}]}], 
        "0", "0"},
       {"0", "0", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"a", "[", "t", "]"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"2", " ", 
            RowBox[{"Psi", "[", 
             RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], ")"}]}], 
        "0"},
       {"0", "0", "0", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"a", "[", "t", "]"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"2", " ", 
            RowBox[{"Psi", "[", 
             RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], ")"}]}]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm["gdd = ", 
   MatrixForm[{{-1 - 
      2 $CellContext`Psi[$CellContext`t, $CellContext`x, $CellContext`y, \
$CellContext`z], 0, 0, 0}, {
     0, $CellContext`a[$CellContext`t]^2 (1 - 
       2 $CellContext`Psi[$CellContext`t, $CellContext`x, $CellContext`y, \
$CellContext`z]), 0, 0}, {
     0, 0, $CellContext`a[$CellContext`t]^2 (1 - 
       2 $CellContext`Psi[$CellContext`t, $CellContext`x, $CellContext`y, \
$CellContext`z]), 0}, {
     0, 0, 0, $CellContext`a[$CellContext`t]^2 (1 - 
       2 $CellContext`Psi[$CellContext`t, $CellContext`x, $CellContext`y, \
$CellContext`z])}}]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.66179377772738*^9, 3.661793895771625*^9, 3.661799726941099*^9, 
   3.661800398764287*^9, 3.661800454068523*^9, 3.6618052790584393`*^9, 
   3.6618056147933064`*^9, 3.661806061022974*^9, 3.66180687381091*^9, 
   3.661807363995236*^9, 3.661807417503338*^9, 3.661808210191555*^9, 
   3.6618092053979053`*^9, 3.661811163735736*^9, 3.662740477340228*^9, 
   3.662740651716485*^9, 3.662743100803165*^9, 3.662745038662101*^9, 
   3.662746734552472*^9, {3.662748386961813*^9, 3.662748415682102*^9}, 
   3.662748489688797*^9, 3.662748731898096*^9, 3.66275258604615*^9, 
   3.6627536873259077`*^9, 3.662757086011394*^9, 3.662822319419271*^9, 
   3.662832594369821*^9, 3.662837264536879*^9, 3.6628402741747503`*^9, 
   3.662841787852899*^9, 3.662842700534398*^9, 3.66285106540939*^9, 
   3.662851139015745*^9, 3.6629068849539833`*^9, 3.662912389258504*^9, 
   3.66291641154349*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"LineElement = \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"d", "[", "t", "]"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "-", 
        RowBox[{"2", " ", 
         RowBox[{"Psi", "[", 
          RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], ")"}]}], 
     "-", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"a", "[", "t", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"d", "[", "x", "]"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"Psi", "[", 
          RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], ")"}]}], 
     "-", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"a", "[", "t", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"d", "[", "y", "]"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"Psi", "[", 
          RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], ")"}]}], 
     "-", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"a", "[", "t", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"d", "[", "z", "]"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"Psi", "[", 
          RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], ")"}]}]}],
    Short[#, 32]& ]}],
  SequenceForm["LineElement = ", 
   Short[$CellContext`d[$CellContext`t]^2 (-1 - 
      2 $CellContext`Psi[$CellContext`t, $CellContext`x, $CellContext`y, \
$CellContext`z]) - $CellContext`a[$CellContext`t]^2 \
$CellContext`d[$CellContext`x]^2 (-1 + 
     2 $CellContext`Psi[$CellContext`t, $CellContext`x, $CellContext`y, \
$CellContext`z]) - $CellContext`a[$CellContext`t]^2 \
$CellContext`d[$CellContext`y]^2 (-1 + 
     2 $CellContext`Psi[$CellContext`t, $CellContext`x, $CellContext`y, \
$CellContext`z]) - $CellContext`a[$CellContext`t]^2 \
$CellContext`d[$CellContext`z]^2 (-1 + 
     2 $CellContext`Psi[$CellContext`t, $CellContext`x, $CellContext`y, \
$CellContext`z]), 32]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.66179377772738*^9, 3.661793895771625*^9, 3.661799726941099*^9, 
   3.661800398764287*^9, 3.661800454068523*^9, 3.6618052790584393`*^9, 
   3.6618056147933064`*^9, 3.661806061022974*^9, 3.66180687381091*^9, 
   3.661807363995236*^9, 3.661807417503338*^9, 3.661808210191555*^9, 
   3.6618092053979053`*^9, 3.661811163735736*^9, 3.662740477340228*^9, 
   3.662740651716485*^9, 3.662743100803165*^9, 3.662745038662101*^9, 
   3.662746734552472*^9, {3.662748386961813*^9, 3.662748415682102*^9}, 
   3.662748489688797*^9, 3.662748731898096*^9, 3.66275258604615*^9, 
   3.6627536873259077`*^9, 3.662757086011394*^9, 3.662822319419271*^9, 
   3.662832594369821*^9, 3.662837264536879*^9, 3.6628402741747503`*^9, 
   3.662841787852899*^9, 3.662842700534398*^9, 3.66285106540939*^9, 
   3.662851139015745*^9, 3.6629068849539833`*^9, 3.662912389258504*^9, 
   3.662916411547014*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"gUU = \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"-", 
         FractionBox["1", 
          RowBox[{"1", "+", 
           RowBox[{"2", " ", 
            RowBox[{"Psi", "[", 
             RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}]]}], "0", 
        "0", "0"},
       {"0", 
        RowBox[{"-", 
         FractionBox["1", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"a", "[", "t", "]"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"2", " ", 
              RowBox[{"Psi", "[", 
               RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], 
            ")"}]}]]}], "0", "0"},
       {"0", "0", 
        RowBox[{"-", 
         FractionBox["1", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"a", "[", "t", "]"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"2", " ", 
              RowBox[{"Psi", "[", 
               RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], 
            ")"}]}]]}], "0"},
       {"0", "0", "0", 
        RowBox[{"-", 
         FractionBox["1", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"a", "[", "t", "]"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"2", " ", 
              RowBox[{"Psi", "[", 
               RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], 
            ")"}]}]]}]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm["gUU = ", 
   MatrixForm[{{(-1)/(1 + 
      2 $CellContext`Psi[$CellContext`t, $CellContext`x, $CellContext`y, \
$CellContext`z]), 0, 0, 0}, {
     0, -$CellContext`a[$CellContext`t]^(-2)/(-1 + 
      2 $CellContext`Psi[$CellContext`t, $CellContext`x, $CellContext`y, \
$CellContext`z]), 0, 0}, {
     0, 0, -$CellContext`a[$CellContext`t]^(-2)/(-1 + 
      2 $CellContext`Psi[$CellContext`t, $CellContext`x, $CellContext`y, \
$CellContext`z]), 0}, {
     0, 0, 0, -$CellContext`a[$CellContext`t]^(-2)/(-1 + 
      2 $CellContext`Psi[$CellContext`t, $CellContext`x, $CellContext`y, \
$CellContext`z])}}]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.66179377772738*^9, 3.661793895771625*^9, 3.661799726941099*^9, 
   3.661800398764287*^9, 3.661800454068523*^9, 3.6618052790584393`*^9, 
   3.6618056147933064`*^9, 3.661806061022974*^9, 3.66180687381091*^9, 
   3.661807363995236*^9, 3.661807417503338*^9, 3.661808210191555*^9, 
   3.6618092053979053`*^9, 3.661811163735736*^9, 3.662740477340228*^9, 
   3.662740651716485*^9, 3.662743100803165*^9, 3.662745038662101*^9, 
   3.662746734552472*^9, {3.662748386961813*^9, 3.662748415682102*^9}, 
   3.662748489688797*^9, 3.662748731898096*^9, 3.66275258604615*^9, 
   3.6627536873259077`*^9, 3.662757086011394*^9, 3.662822319419271*^9, 
   3.662832594369821*^9, 3.662837264536879*^9, 3.6628402741747503`*^9, 
   3.662841787852899*^9, 3.662842700534398*^9, 3.66285106540939*^9, 
   3.662851139015745*^9, 3.6629068849539833`*^9, 3.662912389258504*^9, 
   3.662916411550397*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"gUU computed in \"\>", "\[InvisibleSpace]", 
   "0.00408099999999989`", "\[InvisibleSpace]", "\<\" sec\"\>"}],
  SequenceForm["gUU computed in ", 0.00408099999999989, " sec"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.66179377772738*^9, 3.661793895771625*^9, 3.661799726941099*^9, 
   3.661800398764287*^9, 3.661800454068523*^9, 3.6618052790584393`*^9, 
   3.6618056147933064`*^9, 3.661806061022974*^9, 3.66180687381091*^9, 
   3.661807363995236*^9, 3.661807417503338*^9, 3.661808210191555*^9, 
   3.6618092053979053`*^9, 3.661811163735736*^9, 3.662740477340228*^9, 
   3.662740651716485*^9, 3.662743100803165*^9, 3.662745038662101*^9, 
   3.662746734552472*^9, {3.662748386961813*^9, 3.662748415682102*^9}, 
   3.662748489688797*^9, 3.662748731898096*^9, 3.66275258604615*^9, 
   3.6627536873259077`*^9, 3.662757086011394*^9, 3.662822319419271*^9, 
   3.662832594369821*^9, 3.662837264536879*^9, 3.6628402741747503`*^9, 
   3.662841787852899*^9, 3.662842700534398*^9, 3.66285106540939*^9, 
   3.662851139015745*^9, 3.6629068849539833`*^9, 3.662912389258504*^9, 
   3.662916411552994*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Gamma computed in \"\>", "\[InvisibleSpace]", 
   "0.005917999999999979`", "\[InvisibleSpace]", "\<\" sec\"\>"}],
  SequenceForm["Gamma computed in ", 0.005917999999999979, " sec"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.66179377772738*^9, 3.661793895771625*^9, 3.661799726941099*^9, 
   3.661800398764287*^9, 3.661800454068523*^9, 3.6618052790584393`*^9, 
   3.6618056147933064`*^9, 3.661806061022974*^9, 3.66180687381091*^9, 
   3.661807363995236*^9, 3.661807417503338*^9, 3.661808210191555*^9, 
   3.6618092053979053`*^9, 3.661811163735736*^9, 3.662740477340228*^9, 
   3.662740651716485*^9, 3.662743100803165*^9, 3.662745038662101*^9, 
   3.662746734552472*^9, {3.662748386961813*^9, 3.662748415682102*^9}, 
   3.662748489688797*^9, 3.662748731898096*^9, 3.66275258604615*^9, 
   3.6627536873259077`*^9, 3.662757086011394*^9, 3.662822319419271*^9, 
   3.662832594369821*^9, 3.662837264536879*^9, 3.6628402741747503`*^9, 
   3.662841787852899*^9, 3.662842700534398*^9, 3.66285106540939*^9, 
   3.662851139015745*^9, 3.6629068849539833`*^9, 3.662912389258504*^9, 
   3.66291641155556*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Riemann(dddd) computed in \"\>", "\[InvisibleSpace]", 
   "0.025626000000000038`", "\[InvisibleSpace]", "\<\" sec\"\>"}],
  SequenceForm["Riemann(dddd) computed in ", 0.025626000000000038`, " sec"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.66179377772738*^9, 3.661793895771625*^9, 3.661799726941099*^9, 
   3.661800398764287*^9, 3.661800454068523*^9, 3.6618052790584393`*^9, 
   3.6618056147933064`*^9, 3.661806061022974*^9, 3.66180687381091*^9, 
   3.661807363995236*^9, 3.661807417503338*^9, 3.661808210191555*^9, 
   3.6618092053979053`*^9, 3.661811163735736*^9, 3.662740477340228*^9, 
   3.662740651716485*^9, 3.662743100803165*^9, 3.662745038662101*^9, 
   3.662746734552472*^9, {3.662748386961813*^9, 3.662748415682102*^9}, 
   3.662748489688797*^9, 3.662748731898096*^9, 3.66275258604615*^9, 
   3.6627536873259077`*^9, 3.662757086011394*^9, 3.662822319419271*^9, 
   3.662832594369821*^9, 3.662837264536879*^9, 3.6628402741747503`*^9, 
   3.662841787852899*^9, 3.662842700534398*^9, 3.66285106540939*^9, 
   3.662851139015745*^9, 3.6629068849539833`*^9, 3.662912389258504*^9, 
   3.662916411557921*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Riemann(Uddd) computed in \"\>", "\[InvisibleSpace]", 
   "0.050377000000000005`", "\[InvisibleSpace]", "\<\" sec\"\>"}],
  SequenceForm["Riemann(Uddd) computed in ", 0.050377000000000005`, " sec"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.66179377772738*^9, 3.661793895771625*^9, 3.661799726941099*^9, 
   3.661800398764287*^9, 3.661800454068523*^9, 3.6618052790584393`*^9, 
   3.6618056147933064`*^9, 3.661806061022974*^9, 3.66180687381091*^9, 
   3.661807363995236*^9, 3.661807417503338*^9, 3.661808210191555*^9, 
   3.6618092053979053`*^9, 3.661811163735736*^9, 3.662740477340228*^9, 
   3.662740651716485*^9, 3.662743100803165*^9, 3.662745038662101*^9, 
   3.662746734552472*^9, {3.662748386961813*^9, 3.662748415682102*^9}, 
   3.662748489688797*^9, 3.662748731898096*^9, 3.66275258604615*^9, 
   3.6627536873259077`*^9, 3.662757086011394*^9, 3.662822319419271*^9, 
   3.662832594369821*^9, 3.662837264536879*^9, 3.6628402741747503`*^9, 
   3.662841787852899*^9, 3.662842700534398*^9, 3.66285106540939*^9, 
   3.662851139015745*^9, 3.6629068849539833`*^9, 3.662912389258504*^9, 
   3.662916411599766*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Ricci computed in \"\>", "\[InvisibleSpace]", 
   "0.04303999999999997`", "\[InvisibleSpace]", "\<\" sec\"\>"}],
  SequenceForm["Ricci computed in ", 0.04303999999999997, " sec"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.66179377772738*^9, 3.661793895771625*^9, 3.661799726941099*^9, 
   3.661800398764287*^9, 3.661800454068523*^9, 3.6618052790584393`*^9, 
   3.6618056147933064`*^9, 3.661806061022974*^9, 3.66180687381091*^9, 
   3.661807363995236*^9, 3.661807417503338*^9, 3.661808210191555*^9, 
   3.6618092053979053`*^9, 3.661811163735736*^9, 3.662740477340228*^9, 
   3.662740651716485*^9, 3.662743100803165*^9, 3.662745038662101*^9, 
   3.662746734552472*^9, {3.662748386961813*^9, 3.662748415682102*^9}, 
   3.662748489688797*^9, 3.662748731898096*^9, 3.66275258604615*^9, 
   3.6627536873259077`*^9, 3.662757086011394*^9, 3.662822319419271*^9, 
   3.662832594369821*^9, 3.662837264536879*^9, 3.6628402741747503`*^9, 
   3.662841787852899*^9, 3.662842700534398*^9, 3.66285106540939*^9, 
   3.662851139015745*^9, 3.6629068849539833`*^9, 3.662912389258504*^9, 
   3.662916411645554*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Weyl computed in \"\>", "\[InvisibleSpace]", 
   "0.09847600000000001`", "\[InvisibleSpace]", "\<\" sec\"\>"}],
  SequenceForm["Weyl computed in ", 0.09847600000000001, " sec"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.66179377772738*^9, 3.661793895771625*^9, 3.661799726941099*^9, 
   3.661800398764287*^9, 3.661800454068523*^9, 3.6618052790584393`*^9, 
   3.6618056147933064`*^9, 3.661806061022974*^9, 3.66180687381091*^9, 
   3.661807363995236*^9, 3.661807417503338*^9, 3.661808210191555*^9, 
   3.6618092053979053`*^9, 3.661811163735736*^9, 3.662740477340228*^9, 
   3.662740651716485*^9, 3.662743100803165*^9, 3.662745038662101*^9, 
   3.662746734552472*^9, {3.662748386961813*^9, 3.662748415682102*^9}, 
   3.662748489688797*^9, 3.662748731898096*^9, 3.66275258604615*^9, 
   3.6627536873259077`*^9, 3.662757086011394*^9, 3.662822319419271*^9, 
   3.662832594369821*^9, 3.662837264536879*^9, 3.6628402741747503`*^9, 
   3.662841787852899*^9, 3.662842700534398*^9, 3.66285106540939*^9, 
   3.662851139015745*^9, 3.6629068849539833`*^9, 3.662912389258504*^9, 
   3.662916411740387*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Einstein computed in \"\>", "\[InvisibleSpace]", 
   "0.024990000000000068`", "\[InvisibleSpace]", "\<\" sec\"\>"}],
  SequenceForm["Einstein computed in ", 0.024990000000000068`, " sec"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.66179377772738*^9, 3.661793895771625*^9, 3.661799726941099*^9, 
   3.661800398764287*^9, 3.661800454068523*^9, 3.6618052790584393`*^9, 
   3.6618056147933064`*^9, 3.661806061022974*^9, 3.66180687381091*^9, 
   3.661807363995236*^9, 3.661807417503338*^9, 3.661808210191555*^9, 
   3.6618092053979053`*^9, 3.661811163735736*^9, 3.662740477340228*^9, 
   3.662740651716485*^9, 3.662743100803165*^9, 3.662745038662101*^9, 
   3.662746734552472*^9, {3.662748386961813*^9, 3.662748415682102*^9}, 
   3.662748489688797*^9, 3.662748731898096*^9, 3.66275258604615*^9, 
   3.6627536873259077`*^9, 3.662757086011394*^9, 3.662822319419271*^9, 
   3.662832594369821*^9, 3.662837264536879*^9, 3.6628402741747503`*^9, 
   3.662841787852899*^9, 3.662842700534398*^9, 3.66285106540939*^9, 
   3.662851139015745*^9, 3.6629068849539833`*^9, 3.662912389258504*^9, 
   3.6629164117798033`*^9}],

Cell[BoxData["\<\"All tasks completed in 0.258919 seconds\"\>"], "Print",
 CellChangeTimes->{
  3.66179377772738*^9, 3.661793895771625*^9, 3.661799726941099*^9, 
   3.661800398764287*^9, 3.661800454068523*^9, 3.6618052790584393`*^9, 
   3.6618056147933064`*^9, 3.661806061022974*^9, 3.66180687381091*^9, 
   3.661807363995236*^9, 3.661807417503338*^9, 3.661808210191555*^9, 
   3.6618092053979053`*^9, 3.661811163735736*^9, 3.662740477340228*^9, 
   3.662740651716485*^9, 3.662743100803165*^9, 3.662745038662101*^9, 
   3.662746734552472*^9, {3.662748386961813*^9, 3.662748415682102*^9}, 
   3.662748489688797*^9, 3.662748731898096*^9, 3.66275258604615*^9, 
   3.6627536873259077`*^9, 3.662757086011394*^9, 3.662822319419271*^9, 
   3.662832594369821*^9, 3.662837264536879*^9, 3.6628402741747503`*^9, 
   3.662841787852899*^9, 3.662842700534398*^9, 3.66285106540939*^9, 
   3.662851139015745*^9, 3.6629068849539833`*^9, 3.662912389258504*^9, 
   3.662916411782792*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sqg", " ", "=", " ", 
  RowBox[{
   RowBox[{"Sqrt", "[", 
    RowBox[{"-", 
     RowBox[{"Det", "[", "gdd", "]"}]}], "]"}], " ", "//", " ", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.662747142155484*^9, 3.6627471994151154`*^9}}],

Cell[BoxData[
 SqrtBox[
  RowBox[{
   RowBox[{"-", 
    SuperscriptBox[
     RowBox[{"a", "[", "t", "]"}], "6"]}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"Psi", "[", 
        RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], ")"}], "3"], 
   " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"2", " ", 
      RowBox[{"Psi", "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], 
    ")"}]}]]], "Output",
 CellChangeTimes->{{3.662747143578467*^9, 3.662747200020794*^9}, 
   3.6627484181987457`*^9, 3.662748491489305*^9, 3.662748733281488*^9, 
   3.662752588460341*^9, 3.6627536895446997`*^9, 3.6627570879973373`*^9, 
   3.66282232174938*^9, 3.6628326034531517`*^9, 3.6628372756152782`*^9, 
   3.662840276558627*^9, 3.662841789420085*^9, 3.6628427028684063`*^9, 
   3.662851066979053*^9, 3.662851141015153*^9, 3.662906886539125*^9, 
   3.662912391450754*^9, 3.662916412698245*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["compute the laplacian", "Subsection",
 CellChangeTimes->{{3.661800417974061*^9, 3.661800419924685*^9}, {
  3.6618062412926826`*^9, 3.661806242819202*^9}, {3.662753693604282*^9, 
  3.662753695444273*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"eomtmp", " ", "=", " ", 
   RowBox[{
    RowBox[{"Laplacian", "[", 
     RowBox[{"phi", "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "]"}], " ", "//", 
    " ", "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(", 
   RowBox[{"fullnice", "@", "eomtmp"}], ")"}], " ", "//.", " ", 
  "mathrepl"}]}], "Input",
 CellChangeTimes->{{3.659213984446457*^9, 3.6592140165301533`*^9}, {
  3.659214079454344*^9, 3.6592141197235193`*^9}, {3.6592143219106903`*^9, 
  3.659214381024578*^9}, {3.659214540282854*^9, 3.659214549824751*^9}, {
  3.659214698842856*^9, 3.6592147557365828`*^9}, {3.6592148287619553`*^9, 
  3.659214833049459*^9}, {3.659214941697033*^9, 3.659214950600512*^9}, {
  3.659215026730626*^9, 3.659215087767284*^9}, {3.659215333484338*^9, 
  3.6592153424571247`*^9}, {3.659215839196046*^9, 3.659215839323812*^9}, {
  3.6627529818061953`*^9, 3.6627530024671173`*^9}, {3.6627537009023523`*^9, 
  3.662753712029435*^9}, {3.662757095562229*^9, 3.662757097045944*^9}, {
  3.662757127854631*^9, 3.662757161973591*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"\[CapitalDelta]\[Phi]", "+", 
   RowBox[{"2", " ", "\[CapitalDelta]\[Phi]", " ", "\[Psi]"}], "-", 
   RowBox[{"4", " ", "\[Psi]", " ", 
    RowBox[{"\[Del]", "\[Phi]"}], " ", 
    RowBox[{"\[Del]", "\[Psi]"}]}], "+", 
   RowBox[{
    SuperscriptBox["a", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"dd\[Phi]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"2", " ", "\[Psi]"}]}], ")"}]}], "+", 
      RowBox[{
       OverscriptBox["\[Phi]", "."], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "3"}], " ", "H"}], "+", 
         RowBox[{"6", " ", "H", " ", "\[Psi]"}], "+", 
         RowBox[{"4", " ", 
          OverscriptBox["\[Psi]", "."]}], "-", 
         RowBox[{"4", " ", "\[Psi]", " ", 
          OverscriptBox["\[Psi]", "."]}]}], ")"}]}]}], ")"}]}]}], 
  SuperscriptBox["a", "2"]]], "Output",
 CellChangeTimes->{
  3.661793792937232*^9, 3.661793903273398*^9, 3.661799733253769*^9, 
   3.6618003576485367`*^9, 3.6618004269543877`*^9, 3.6618004607887907`*^9, 
   3.661805294135742*^9, 3.661805621080722*^9, 3.661806065716523*^9, 
   3.661806877948206*^9, 3.661808215784114*^9, 3.661809211579206*^9, 
   3.6627404817712812`*^9, 3.6627406594973717`*^9, 3.662743103278577*^9, 
   3.662745043248816*^9, 3.662746875599722*^9, 3.662747653033863*^9, 
   3.662747848571555*^9, 3.662748431344495*^9, 3.6627484952559223`*^9, 
   3.662748735090892*^9, 3.662752592339058*^9, 3.66275300273425*^9, {
   3.662753691045405*^9, 3.662753712509406*^9}, {3.662757091720694*^9, 
   3.662757097646819*^9}, {3.662757128804339*^9, 3.662757162657576*^9}, 
   3.662832606816484*^9, 3.662837280957508*^9, 3.662840282682785*^9, 
   3.662841795382069*^9, 3.662842708742938*^9, 3.662851069927387*^9, {
   3.6628511429850082`*^9, 3.6628511629518623`*^9}, 3.662906889775703*^9, 
   3.662912394074915*^9, 3.6629164157555304`*^9}]
}, Open  ]],

Cell["\<\
compare Laplacian function from RGTC with partly selfmade to make sure it \
does the correct thing\
\>", "Text",
 CellChangeTimes->{{3.662753728554631*^9, 3.662753745529592*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"eomtmp", " ", "\[Equal]", "  ", 
   RowBox[{"myLaplacian", "[", 
    RowBox[{"phi", "[", 
     RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "]"}]}], " ", "//", 
  " ", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.6627468972051487`*^9, 3.66274693029706*^9}, {
  3.662747455782144*^9, 3.6627474692399073`*^9}, {3.662747553426756*^9, 
  3.662747562249851*^9}, {3.662747625610468*^9, 3.662747640305155*^9}, {
  3.6627478670235567`*^9, 3.662747875302865*^9}, {3.662753011891333*^9, 
  3.662753023866515*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.662753024528319*^9, 3.66275372438043*^9, 
  3.662757176792893*^9, 3.662832609485159*^9, 3.6628372831927443`*^9, 
  3.6628402850291653`*^9, 3.6628417968967667`*^9, 3.662842710681488*^9, 
  3.6628510738622093`*^9, 3.662851165968256*^9, 3.662906894214403*^9, 
  3.662912395541505*^9, 3.662916417008304*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["compute the equation of motion", "Subsection",
 CellChangeTimes->{{3.661799601362871*^9, 3.661799611338211*^9}, {
   3.661800432332168*^9, 3.661800433411944*^9}, {3.661806172799053*^9, 
   3.661806175758717*^9}, {3.662753751161702*^9, 3.662753786583177*^9}, 
   3.66275419377452*^9, 3.662754270074642*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"eomtmp", " ", "\[Equal]", " ", "Vprime"}], ",", " ", 
      RowBox[{
       SuperscriptBox["phi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"2", ",", "0", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], " ", "//", " ", "FullSimplify"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"eomrepl1", " ", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", " ", 
     RowBox[{"%", " ", "/.", " ", "printrepl"}], ")"}], " ", "/.", " ", 
    "oprepl"}], " ", "//", " ", "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"getCoefficients", "[", 
  RowBox[{
   RowBox[{"Expand", "@", 
    RowBox[{"fullnice", "@", 
     RowBox[{"(", 
      RowBox[{"ddphi", " ", "/.", " ", "eomrepl1"}], ")"}]}]}], " ", "//.", 
   " ", "mathrepl"}], "]"}]}], "Input",
 CellChangeTimes->{{3.662907305085657*^9, 3.66290735881378*^9}, {
  3.6629073929862633`*^9, 3.662907416659627*^9}, {3.6629074530937147`*^9, 
  3.6629075006914988`*^9}, {3.662907551861684*^9, 3.662907577100823*^9}, {
  3.66291448747311*^9, 3.66291452905793*^9}, {3.6629145840417967`*^9, 
  3.662914584321857*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"ddphi", "\[Rule]", 
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"-", "4"}], " ", 
      SuperscriptBox["a", "2"], " ", "dphi", " ", "dPsi", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "Psi", "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["Psi", "2"]}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"2", " ", "Psi"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"lphi", "-", 
        RowBox[{"4", " ", "gphi", " ", "gPsi", " ", "Psi"}], "-", 
        RowBox[{"4", " ", "lphi", " ", 
         SuperscriptBox["Psi", "2"]}], "-", 
        RowBox[{
         SuperscriptBox["a", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"2", " ", "Psi"}]}], ")"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", " ", "dphi", " ", "H"}], "+", "Vprime", "+", 
           RowBox[{"2", " ", "Psi", " ", "Vprime"}]}], ")"}]}]}], ")"}]}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"2", " ", "Psi"}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"a", "-", 
        RowBox[{"2", " ", "a", " ", "Psi"}]}], ")"}], "2"]}]]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.6629073061706953`*^9, {3.662907347260847*^9, 3.662907360236577*^9}, {
   3.6629073936271772`*^9, 3.662907417104045*^9}, {3.6629074769211683`*^9, 
   3.662907501034855*^9}, {3.662907563013371*^9, 3.662907580279542*^9}, 
   3.662907690452921*^9, 3.6629079756228867`*^9, 3.662912398027493*^9, {
   3.662914510522875*^9, 3.6629145299415417`*^9}, 3.6629145847468433`*^9, 
   3.6629164196090927`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"full expression: \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"\[CapitalDelta]\[Phi]", " ", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", 
        SuperscriptBox["a", "2"]], "+", 
       FractionBox[
        RowBox[{"4", " ", "\[Psi]"}], 
        SuperscriptBox["a", "2"]]}], ")"}]}], "-", 
    FractionBox[
     RowBox[{"4", " ", "\[Psi]", " ", 
      RowBox[{"\[Del]", "\[Phi]"}], " ", 
      RowBox[{"\[Del]", "\[Psi]"}]}], 
     SuperscriptBox["a", "2"]], "+", 
    RowBox[{
     OverscriptBox["\[Phi]", "."], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "3"}], " ", "H"}], "+", 
       RowBox[{"4", " ", 
        OverscriptBox["\[Psi]", "."]}], "+", 
       RowBox[{"4", " ", "\[Psi]", " ", 
        OverscriptBox["\[Psi]", "."]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "-", 
       RowBox[{"2", " ", "\[Psi]"}]}], ")"}], " ", 
     SuperscriptBox["V", "\[Prime]",
      MultilineFunction->None]}]}]}],
  SequenceForm[
  "full expression: ", $CellContext`\[CapitalDelta]\[Phi] \
($CellContext`a^(-2) + 4 $CellContext`a^(-2) $CellContext`\[Psi]) - 
   4 $CellContext`a^(-2) $CellContext`\[Psi] Del[$CellContext`\[Phi]] 
   Del[$CellContext`\[Psi]] + 
   OverDot[$CellContext`\[Phi], 1] ((-3) $CellContext`H + 
     4 OverDot[$CellContext`\[Psi], 1] + 
     4 $CellContext`\[Psi] OverDot[$CellContext`\[Psi], 1]) + (-1 - 
     2 $CellContext`\[Psi]) Derivative[1][$CellContext`V]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.662907476930962*^9, 3.6629075010415363`*^9}, {
   3.6629075630207653`*^9, 3.6629075802821608`*^9}, 3.66290769045571*^9, 
   3.6629079756259212`*^9, 3.6629123980304327`*^9, {3.662914510529419*^9, 
   3.6629145299460897`*^9}, 3.662914584749611*^9, 3.66291641963914*^9}],

Cell[BoxData["\<\"coefficients of\"\>"], "Print",
 CellChangeTimes->{{3.662907476930962*^9, 3.6629075010415363`*^9}, {
   3.6629075630207653`*^9, 3.6629075802821608`*^9}, 3.66290769045571*^9, 
   3.6629079756259212`*^9, 3.6629123980304327`*^9, {3.662914510529419*^9, 
   3.6629145299460897`*^9}, 3.662914584749611*^9, 3.662916419640765*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*OverscriptBox[\\(\[Phi]\\), \\(.\\)]\\): \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "3"}], " ", "H"}], "+", 
    RowBox[{"4", " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", "\[Psi]"}], ")"}], " ", 
     OverscriptBox["\[Psi]", "."]}]}]}],
  SequenceForm[
  "\!\(\*OverscriptBox[\(\[Phi]\), \(.\)]\): ", (-3) $CellContext`H + 
   4 (1 + $CellContext`\[Psi]) OverDot[$CellContext`\[Psi], 1]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.662907476930962*^9, 3.6629075010415363`*^9}, {
   3.6629075630207653`*^9, 3.6629075802821608`*^9}, 3.66290769045571*^9, 
   3.6629079756259212`*^9, 3.6629123980304327`*^9, {3.662914510529419*^9, 
   3.6629145299460897`*^9}, 3.662914584749611*^9, 3.662916419643449*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SuperscriptBox[OverscriptBox[\\(\[Phi]\\), \\(.\\)], \
\\(2\\)]\\): \"\>", "\[InvisibleSpace]", "0"}],
  SequenceForm[
  "\!\(\*SuperscriptBox[OverscriptBox[\(\[Phi]\), \(.\)], \(2\)]\): ", 0],
  Editable->False]], "Print",
 CellChangeTimes->{{3.662907476930962*^9, 3.6629075010415363`*^9}, {
   3.6629075630207653`*^9, 3.6629075802821608`*^9}, 3.66290769045571*^9, 
   3.6629079756259212`*^9, 3.6629123980304327`*^9, {3.662914510529419*^9, 
   3.6629145299460897`*^9}, 3.662914584749611*^9, 3.6629164196458893`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SuperscriptBox[\\(\[Del]\\), \\(2\\)]\\)\[Phi]: \"\>",
    "\[InvisibleSpace]", 
   FractionBox[
    RowBox[{"1", "+", 
     RowBox[{"4", " ", "\[Psi]"}]}], 
    SuperscriptBox["a", "2"]]}],
  SequenceForm[
  "\!\(\*SuperscriptBox[\(\[Del]\), \(2\)]\)\[Phi]: ", $CellContext`a^(-2) (1 + 
    4 $CellContext`\[Psi])],
  Editable->False]], "Print",
 CellChangeTimes->{{3.662907476930962*^9, 3.6629075010415363`*^9}, {
   3.6629075630207653`*^9, 3.6629075802821608`*^9}, 3.66290769045571*^9, 
   3.6629079756259212`*^9, 3.6629123980304327`*^9, {3.662914510529419*^9, 
   3.6629145299460897`*^9}, 3.662914584749611*^9, 3.6629164196485643`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"(\[Del]\[Phi]) (\[Del]\[Psi]): \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"4", " ", "\[Psi]"}], 
     SuperscriptBox["a", "2"]]}]}],
  SequenceForm[
  "(\[Del]\[Phi]) (\[Del]\[Psi]): ", (-4) $CellContext`a^(-2) $CellContext`\
\[Psi]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.662907476930962*^9, 3.6629075010415363`*^9}, {
   3.6629075630207653`*^9, 3.6629075802821608`*^9}, 3.66290769045571*^9, 
   3.6629079756259212`*^9, 3.6629123980304327`*^9, {3.662914510529419*^9, 
   3.6629145299460897`*^9}, 3.662914584749611*^9, 3.662916419713223*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"V': \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"-", "1"}], "-", 
    RowBox[{"2", " ", "\[Psi]"}]}]}],
  SequenceForm["V': ", -1 - 2 $CellContext`\[Psi]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.662907476930962*^9, 3.6629075010415363`*^9}, {
   3.6629075630207653`*^9, 3.6629075802821608`*^9}, 3.66290769045571*^9, 
   3.6629079756259212`*^9, 3.6629123980304327`*^9, {3.662914510529419*^9, 
   3.6629145299460897`*^9}, 3.662914584749611*^9, 3.6629164197156067`*^9}]
}, Open  ]]
}, Open  ]],

Cell["with dpsirepl", "Text",
 CellChangeTimes->{{3.6629076332070217`*^9, 3.662907634950461*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rhs1", " ", "=", " ", 
  RowBox[{
   RowBox[{"fullnice", "@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"ddphi", " ", "/.", " ", "eomrepl1"}], ")"}], " ", "/.", " ", 
      "dPsirepl"}], ")"}]}], " ", "//.", " ", "mathrepl"}]}]], "Input",
 CellChangeTimes->{{3.661805779279746*^9, 3.661805895089813*^9}, {
  3.6618060255465527`*^9, 3.66180603024221*^9}, {3.6618063696925592`*^9, 
  3.661806384898467*^9}, {3.662749036657835*^9, 3.662749040961327*^9}, {
  3.66275724372755*^9, 3.6627572456079197`*^9}, {3.6629077927028637`*^9, 
  3.6629078041430283`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     FractionBox["\[CapitalDelta]\[Phi]", 
      SuperscriptBox["a", "2"]], "-", 
     RowBox[{"3", " ", "H", " ", 
      OverscriptBox["\[Phi]", "."]}], "+", 
     RowBox[{"4", " ", 
      OverscriptBox["\[Phi]", "."], " ", 
      OverscriptBox["\[Psi]", "."]}], "-", 
     SuperscriptBox["V", "\[Prime]",
      MultilineFunction->None]}], "/.", "\[VeryThinSpace]", "dPsirepl"}], 
   ")"}], "+", 
  RowBox[{"\[Psi]", " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"4", " ", "\[CapitalDelta]\[Phi]"}], 
      SuperscriptBox["a", "2"]], "-", 
     FractionBox[
      RowBox[{"4", " ", 
       RowBox[{"\[Del]", "\[Phi]"}], " ", 
       RowBox[{"\[Del]", "\[Psi]"}]}], 
      SuperscriptBox["a", "2"]], "+", 
     RowBox[{"4", " ", 
      OverscriptBox["\[Phi]", "."], " ", 
      OverscriptBox["\[Psi]", "."]}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox["V", "\[Prime]",
       MultilineFunction->None]}]}], ")"}], " ", 
   RowBox[{
    SuperscriptBox["ReplaceAll", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"1", ",", "0"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{
     RowBox[{
      FractionBox["\[CapitalDelta]\[Phi]", 
       SuperscriptBox["a", "2"]], "-", 
      RowBox[{"3", " ", "H", " ", 
       OverscriptBox["\[Phi]", "."]}], "+", 
      RowBox[{"4", " ", 
       OverscriptBox["\[Phi]", "."], " ", 
       OverscriptBox["\[Psi]", "."]}], "-", 
      SuperscriptBox["V", "\[Prime]",
       MultilineFunction->None]}], ",", "dPsirepl"}], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.661805785811984*^9, 3.66180579767973*^9}, {
   3.661805833632517*^9, 3.661805840749928*^9}, {3.661805884554347*^9, 
   3.66180589592165*^9}, 3.6618060721902857`*^9, 3.661806387241435*^9, 
   3.661806883561142*^9, 3.661808225265609*^9, 3.661809215180972*^9, 
   3.6627404953937283`*^9, 3.662740691203253*^9, 3.662743107330357*^9, 
   3.662745051433217*^9, 3.662748588849147*^9, 3.662748742898625*^9, 
   3.662749041465469*^9, 3.66275261173704*^9, 3.6627531782483*^9, 
   3.6627537974185247`*^9, {3.662757241096636*^9, 3.662757246017008*^9}, 
   3.662757280137897*^9, 3.66275734000231*^9, 3.662832614738265*^9, 
   3.6628372884216957`*^9, 3.662840294694439*^9, 3.6628403251298656`*^9, 
   3.6628418009383287`*^9, 3.662842717903638*^9, 3.66285116933572*^9, 
   3.662906900986314*^9, 3.662907233718072*^9, 3.662907616570225*^9, 
   3.6629078050562267`*^9, 3.662912401384811*^9, 3.662914591164363*^9, 
   3.662916421751831*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"getCoefficients", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"Expand", "@", "rhs1"}], ")"}], " ", "//.", " ", "mathrepl"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.662753798501981*^9, 3.6627538022158546`*^9}, {
  3.6628418152312517`*^9, 3.662841825094441*^9}, {3.662841860741919*^9, 
  3.6628418695640593`*^9}, {3.662841997253201*^9, 3.6628419992528152`*^9}, {
  3.662842041052329*^9, 3.662842051913952*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"full expression: \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["\[CapitalDelta]\[Phi]", 
        SuperscriptBox["a", "2"]], "-", 
       RowBox[{"3", " ", "H", " ", 
        OverscriptBox["\[Phi]", "."]}], "+", 
       RowBox[{"4", " ", 
        OverscriptBox["\[Phi]", "."], " ", 
        OverscriptBox["\[Psi]", "."]}], "-", 
       SuperscriptBox["V", "\[Prime]",
        MultilineFunction->None]}], "/.", "\[VeryThinSpace]", "dPsirepl"}], 
     ")"}], "+", 
    FractionBox[
     RowBox[{"4", " ", "\[CapitalDelta]\[Phi]", " ", "\[Psi]", " ", 
      RowBox[{
       SuperscriptBox["ReplaceAll", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{
        RowBox[{
         FractionBox["\[CapitalDelta]\[Phi]", 
          SuperscriptBox["a", "2"]], "-", 
         RowBox[{"3", " ", "H", " ", 
          OverscriptBox["\[Phi]", "."]}], "+", 
         RowBox[{"4", " ", 
          OverscriptBox["\[Phi]", "."], " ", 
          OverscriptBox["\[Psi]", "."]}], "-", 
         SuperscriptBox["V", "\[Prime]",
          MultilineFunction->None]}], ",", "dPsirepl"}], "]"}]}], 
     SuperscriptBox["a", "2"]], "-", 
    FractionBox[
     RowBox[{"4", " ", "\[Psi]", " ", 
      RowBox[{"\[Del]", "\[Phi]"}], " ", 
      RowBox[{"\[Del]", "\[Psi]"}], " ", 
      RowBox[{
       SuperscriptBox["ReplaceAll", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{
        RowBox[{
         FractionBox["\[CapitalDelta]\[Phi]", 
          SuperscriptBox["a", "2"]], "-", 
         RowBox[{"3", " ", "H", " ", 
          OverscriptBox["\[Phi]", "."]}], "+", 
         RowBox[{"4", " ", 
          OverscriptBox["\[Phi]", "."], " ", 
          OverscriptBox["\[Psi]", "."]}], "-", 
         SuperscriptBox["V", "\[Prime]",
          MultilineFunction->None]}], ",", "dPsirepl"}], "]"}]}], 
     SuperscriptBox["a", "2"]], "+", 
    RowBox[{"4", " ", "\[Psi]", " ", 
     OverscriptBox["\[Phi]", "."], " ", 
     OverscriptBox["\[Psi]", "."], " ", 
     RowBox[{
      SuperscriptBox["ReplaceAll", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{
       RowBox[{
        FractionBox["\[CapitalDelta]\[Phi]", 
         SuperscriptBox["a", "2"]], "-", 
        RowBox[{"3", " ", "H", " ", 
         OverscriptBox["\[Phi]", "."]}], "+", 
        RowBox[{"4", " ", 
         OverscriptBox["\[Phi]", "."], " ", 
         OverscriptBox["\[Psi]", "."]}], "-", 
        SuperscriptBox["V", "\[Prime]",
         MultilineFunction->None]}], ",", "dPsirepl"}], "]"}]}], "-", 
    RowBox[{"2", " ", "\[Psi]", " ", 
     SuperscriptBox["V", "\[Prime]",
      MultilineFunction->None], " ", 
     RowBox[{
      SuperscriptBox["ReplaceAll", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{
       RowBox[{
        FractionBox["\[CapitalDelta]\[Phi]", 
         SuperscriptBox["a", "2"]], "-", 
        RowBox[{"3", " ", "H", " ", 
         OverscriptBox["\[Phi]", "."]}], "+", 
        RowBox[{"4", " ", 
         OverscriptBox["\[Phi]", "."], " ", 
         OverscriptBox["\[Psi]", "."]}], "-", 
        SuperscriptBox["V", "\[Prime]",
         MultilineFunction->None]}], ",", "dPsirepl"}], "]"}]}]}]}],
  SequenceForm[
  "full expression: ", 
   ReplaceAll[$CellContext`a^(-2) $CellContext`\[CapitalDelta]\[Phi] - 
     3 $CellContext`H OverDot[$CellContext`\[Phi], 1] + 
     4 OverDot[$CellContext`\[Phi], 1] OverDot[$CellContext`\[Psi], 1] - 
     Derivative[1][$CellContext`V], $CellContext`dPsirepl] + 
   4 $CellContext`a^(-2) $CellContext`\[CapitalDelta]\[Phi] $CellContext`\
\[Psi] Derivative[1, 0][
     ReplaceAll][$CellContext`a^(-2) $CellContext`\[CapitalDelta]\[Phi] - 
      3 $CellContext`H OverDot[$CellContext`\[Phi], 1] + 
      4 OverDot[$CellContext`\[Phi], 1] OverDot[$CellContext`\[Psi], 1] - 
      Derivative[1][$CellContext`V], $CellContext`dPsirepl] - 
   4 $CellContext`a^(-2) $CellContext`\[Psi] Del[$CellContext`\[Phi]] 
   Del[$CellContext`\[Psi]] 
   Derivative[1, 0][
    ReplaceAll][$CellContext`a^(-2) $CellContext`\[CapitalDelta]\[Phi] - 
     3 $CellContext`H OverDot[$CellContext`\[Phi], 1] + 
     4 OverDot[$CellContext`\[Phi], 1] OverDot[$CellContext`\[Psi], 1] - 
     Derivative[1][$CellContext`V], $CellContext`dPsirepl] + 
   4 $CellContext`\[Psi] OverDot[$CellContext`\[Phi], 1] 
    OverDot[$CellContext`\[Psi], 1] 
    Derivative[1, 0][
     ReplaceAll][$CellContext`a^(-2) $CellContext`\[CapitalDelta]\[Phi] - 
      3 $CellContext`H OverDot[$CellContext`\[Phi], 1] + 
      4 OverDot[$CellContext`\[Phi], 1] OverDot[$CellContext`\[Psi], 1] - 
      Derivative[1][$CellContext`V], $CellContext`dPsirepl] - 
   2 $CellContext`\[Psi] Derivative[1][$CellContext`V] 
   Derivative[1, 0][
    ReplaceAll][$CellContext`a^(-2) $CellContext`\[CapitalDelta]\[Phi] - 
     3 $CellContext`H OverDot[$CellContext`\[Phi], 1] + 
     4 OverDot[$CellContext`\[Phi], 1] OverDot[$CellContext`\[Psi], 1] - 
     Derivative[1][$CellContext`V], $CellContext`dPsirepl]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.662753803434454*^9, 3.662753879442786*^9}, 
   3.6627539522801037`*^9, 3.662753988038238*^9, 3.662754056794243*^9, 
   3.662754141151984*^9, 3.662757286536223*^9, 3.662757340672339*^9, 
   3.662832615588217*^9, 3.66283728908817*^9, {3.662840299089066*^9, 
   3.6628403260136013`*^9}, {3.66284181631824*^9, 3.662841825556616*^9}, 
   3.6628418699794493`*^9, 3.6628420002263603`*^9, {3.662842043753207*^9, 
   3.6628420525334253`*^9}, 3.6628427230872993`*^9, 3.662851172193549*^9, 
   3.662907236302392*^9, 3.6629076269986753`*^9, 3.662907807272794*^9, 
   3.6629124035650597`*^9, 3.662914592413787*^9, 3.6629164225606194`*^9}],

Cell[BoxData["\<\"coefficients of\"\>"], "Print",
 CellChangeTimes->{{3.662753803434454*^9, 3.662753879442786*^9}, 
   3.6627539522801037`*^9, 3.662753988038238*^9, 3.662754056794243*^9, 
   3.662754141151984*^9, 3.662757286536223*^9, 3.662757340672339*^9, 
   3.662832615588217*^9, 3.66283728908817*^9, {3.662840299089066*^9, 
   3.6628403260136013`*^9}, {3.66284181631824*^9, 3.662841825556616*^9}, 
   3.6628418699794493`*^9, 3.6628420002263603`*^9, {3.662842043753207*^9, 
   3.6628420525334253`*^9}, 3.6628427230872993`*^9, 3.662851172193549*^9, 
   3.662907236302392*^9, 3.6629076269986753`*^9, 3.662907807272794*^9, 
   3.6629124035650597`*^9, 3.662914592413787*^9, 3.662916422562845*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*OverscriptBox[\\(\[Phi]\\), \\(.\\)]\\): \"\>", 
   "\[InvisibleSpace]", 
   FractionBox[
    RowBox[{
     RowBox[{
      SuperscriptBox["a", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "3"}], " ", "H"}], "+", 
        RowBox[{"4", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "\[Psi]"}], ")"}], " ", 
         OverscriptBox["\[Psi]", "."]}]}], ")"}], " ", 
      RowBox[{
       SuperscriptBox["ReplaceAll", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{
        RowBox[{
         FractionBox["\[CapitalDelta]\[Phi]", 
          SuperscriptBox["a", "2"]], "-", 
         SuperscriptBox["V", "\[Prime]",
          MultilineFunction->None]}], ",", "dPsirepl"}], "]"}]}], "-", 
     RowBox[{"2", " ", "\[Psi]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"3", " ", "H"}], "-", 
        RowBox[{"4", " ", 
         OverscriptBox["\[Psi]", "."]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "\[CapitalDelta]\[Phi]"}], "-", 
        RowBox[{"2", " ", 
         RowBox[{"\[Del]", "\[Phi]"}], " ", 
         RowBox[{"\[Del]", "\[Psi]"}]}], "-", 
        RowBox[{
         SuperscriptBox["a", "2"], " ", 
         SuperscriptBox["V", "\[Prime]",
          MultilineFunction->None]}]}], ")"}], " ", 
      RowBox[{
       SuperscriptBox["ReplaceAll", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"2", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{
        RowBox[{
         FractionBox["\[CapitalDelta]\[Phi]", 
          SuperscriptBox["a", "2"]], "-", 
         SuperscriptBox["V", "\[Prime]",
          MultilineFunction->None]}], ",", "dPsirepl"}], "]"}]}]}], 
    SuperscriptBox["a", "2"]]}],
  SequenceForm[
  "\!\(\*OverscriptBox[\(\[Phi]\), \(.\)]\): ", $CellContext`a^(-2) \
($CellContext`a^2 ((-3) $CellContext`H + 
      4 (1 + $CellContext`\[Psi]) OverDot[$CellContext`\[Psi], 1]) 
     Derivative[1, 0][
      ReplaceAll][$CellContext`a^(-2) $CellContext`\[CapitalDelta]\[Phi] - 
       Derivative[1][$CellContext`V], $CellContext`dPsirepl] - 
    2 $CellContext`\[Psi] (3 $CellContext`H - 4 
     OverDot[$CellContext`\[Psi], 1]) (2 $CellContext`\[CapitalDelta]\[Phi] - 
     2 Del[$CellContext`\[Phi]] Del[$CellContext`\[Psi]] - $CellContext`a^2 
     Derivative[1][$CellContext`V]) 
    Derivative[2, 0][
     ReplaceAll][$CellContext`a^(-2) $CellContext`\[CapitalDelta]\[Phi] - 
      Derivative[1][$CellContext`V], $CellContext`dPsirepl])],
  Editable->False]], "Print",
 CellChangeTimes->{{3.662753803434454*^9, 3.662753879442786*^9}, 
   3.6627539522801037`*^9, 3.662753988038238*^9, 3.662754056794243*^9, 
   3.662754141151984*^9, 3.662757286536223*^9, 3.662757340672339*^9, 
   3.662832615588217*^9, 3.66283728908817*^9, {3.662840299089066*^9, 
   3.6628403260136013`*^9}, {3.66284181631824*^9, 3.662841825556616*^9}, 
   3.6628418699794493`*^9, 3.6628420002263603`*^9, {3.662842043753207*^9, 
   3.6628420525334253`*^9}, 3.6628427230872993`*^9, 3.662851172193549*^9, 
   3.662907236302392*^9, 3.6629076269986753`*^9, 3.662907807272794*^9, 
   3.6629124035650597`*^9, 3.662914592413787*^9, 3.6629164225656843`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SuperscriptBox[OverscriptBox[\\(\[Phi]\\), \\(.\\)], \
\\(2\\)]\\): \"\>", "\[InvisibleSpace]", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"3", " ", "H"}], "-", 
       RowBox[{"4", " ", 
        OverscriptBox["\[Psi]", "."]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["a", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"3", " ", "H"}], "-", 
          RowBox[{"4", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"2", " ", "\[Psi]"}]}], ")"}], " ", 
           OverscriptBox["\[Psi]", "."]}]}], ")"}], " ", 
        RowBox[{
         SuperscriptBox["ReplaceAll", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"2", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{
          RowBox[{
           FractionBox["\[CapitalDelta]\[Phi]", 
            SuperscriptBox["a", "2"]], "-", 
           SuperscriptBox["V", "\[Prime]",
            MultilineFunction->None]}], ",", "dPsirepl"}], "]"}]}], "+", 
       RowBox[{"2", " ", "\[Psi]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"3", " ", "H"}], "-", 
          RowBox[{"4", " ", 
           OverscriptBox["\[Psi]", "."]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "\[CapitalDelta]\[Phi]"}], "-", 
          RowBox[{"2", " ", 
           RowBox[{"\[Del]", "\[Phi]"}], " ", 
           RowBox[{"\[Del]", "\[Psi]"}]}], "-", 
          RowBox[{
           SuperscriptBox["a", "2"], " ", 
           SuperscriptBox["V", "\[Prime]",
            MultilineFunction->None]}]}], ")"}], " ", 
        RowBox[{
         SuperscriptBox["ReplaceAll", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"3", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{
          RowBox[{
           FractionBox["\[CapitalDelta]\[Phi]", 
            SuperscriptBox["a", "2"]], "-", 
           SuperscriptBox["V", "\[Prime]",
            MultilineFunction->None]}], ",", "dPsirepl"}], "]"}]}]}], ")"}]}], 
    RowBox[{"2", " ", 
     SuperscriptBox["a", "2"]}]]}],
  SequenceForm[
  "\!\(\*SuperscriptBox[OverscriptBox[\(\[Phi]\), \(.\)], \(2\)]\): ", 
   Rational[1, 2] $CellContext`a^(-2) (3 $CellContext`H - 4 
    OverDot[$CellContext`\[Psi], 1]) ($CellContext`a^2 (3 $CellContext`H - 
      4 (1 + 2 $CellContext`\[Psi]) OverDot[$CellContext`\[Psi], 1]) 
     Derivative[2, 0][
      ReplaceAll][$CellContext`a^(-2) $CellContext`\[CapitalDelta]\[Phi] - 
       Derivative[1][$CellContext`V], $CellContext`dPsirepl] + 
    2 $CellContext`\[Psi] (3 $CellContext`H - 4 
      OverDot[$CellContext`\[Psi], 1]) (2 $CellContext`\[CapitalDelta]\[Phi] - 
      2 Del[$CellContext`\[Phi]] Del[$CellContext`\[Psi]] - $CellContext`a^2 
      Derivative[1][$CellContext`V]) 
     Derivative[3, 0][
      ReplaceAll][$CellContext`a^(-2) $CellContext`\[CapitalDelta]\[Phi] - 
       Derivative[1][$CellContext`V], $CellContext`dPsirepl])],
  Editable->False]], "Print",
 CellChangeTimes->{{3.662753803434454*^9, 3.662753879442786*^9}, 
   3.6627539522801037`*^9, 3.662753988038238*^9, 3.662754056794243*^9, 
   3.662754141151984*^9, 3.662757286536223*^9, 3.662757340672339*^9, 
   3.662832615588217*^9, 3.66283728908817*^9, {3.662840299089066*^9, 
   3.6628403260136013`*^9}, {3.66284181631824*^9, 3.662841825556616*^9}, 
   3.6628418699794493`*^9, 3.6628420002263603`*^9, {3.662842043753207*^9, 
   3.6628420525334253`*^9}, 3.6628427230872993`*^9, 3.662851172193549*^9, 
   3.662907236302392*^9, 3.6629076269986753`*^9, 3.662907807272794*^9, 
   3.6629124035650597`*^9, 3.662914592413787*^9, 3.6629164226145983`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SuperscriptBox[\\(\[Del]\\), \\(2\\)]\\)\[Phi]: \"\>",
    "\[InvisibleSpace]", 
   FractionBox[
    RowBox[{
     RowBox[{
      SuperscriptBox["a", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"4", " ", "\[Psi]"}]}], ")"}], " ", 
      RowBox[{
       SuperscriptBox["ReplaceAll", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          OverscriptBox["\[Phi]", "."], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "3"}], " ", "H"}], "+", 
            RowBox[{"4", " ", 
             OverscriptBox["\[Psi]", "."]}]}], ")"}]}], "-", 
         SuperscriptBox["V", "\[Prime]",
          MultilineFunction->None]}], ",", "dPsirepl"}], "]"}]}], "-", 
     RowBox[{"2", " ", "\[Psi]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         RowBox[{"\[Del]", "\[Phi]"}], " ", 
         RowBox[{"\[Del]", "\[Psi]"}]}], "+", 
        RowBox[{
         SuperscriptBox["a", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", 
            OverscriptBox["\[Phi]", "."], " ", 
            OverscriptBox["\[Psi]", "."]}], "+", 
           SuperscriptBox["V", "\[Prime]",
            MultilineFunction->None]}], ")"}]}]}], ")"}], " ", 
      RowBox[{
       SuperscriptBox["ReplaceAll", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"2", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          OverscriptBox["\[Phi]", "."], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "3"}], " ", "H"}], "+", 
            RowBox[{"4", " ", 
             OverscriptBox["\[Psi]", "."]}]}], ")"}]}], "-", 
         SuperscriptBox["V", "\[Prime]",
          MultilineFunction->None]}], ",", "dPsirepl"}], "]"}]}]}], 
    SuperscriptBox["a", "4"]]}],
  SequenceForm[
  "\!\(\*SuperscriptBox[\(\[Del]\), \(2\)]\)\[Phi]: ", $CellContext`a^(-4) \
($CellContext`a^2 (1 + 4 $CellContext`\[Psi]) 
     Derivative[1, 0][ReplaceAll][
      OverDot[$CellContext`\[Phi], 1] ((-3) $CellContext`H + 
         4 OverDot[$CellContext`\[Psi], 1]) - Derivative[
       1][$CellContext`V], $CellContext`dPsirepl] - 
    2 $CellContext`\[Psi] (
     2 Del[$CellContext`\[Phi]] 
      Del[$CellContext`\[Psi]] + $CellContext`a^2 ((-2) 
        OverDot[$CellContext`\[Phi], 1] OverDot[$CellContext`\[Psi], 1] + 
       Derivative[1][$CellContext`V])) 
    Derivative[2, 0][ReplaceAll][
     OverDot[$CellContext`\[Phi], 1] ((-3) $CellContext`H + 
        4 OverDot[$CellContext`\[Psi], 1]) - Derivative[
      1][$CellContext`V], $CellContext`dPsirepl])],
  Editable->False]], "Print",
 CellChangeTimes->{{3.662753803434454*^9, 3.662753879442786*^9}, 
   3.6627539522801037`*^9, 3.662753988038238*^9, 3.662754056794243*^9, 
   3.662754141151984*^9, 3.662757286536223*^9, 3.662757340672339*^9, 
   3.662832615588217*^9, 3.66283728908817*^9, {3.662840299089066*^9, 
   3.6628403260136013`*^9}, {3.66284181631824*^9, 3.662841825556616*^9}, 
   3.6628418699794493`*^9, 3.6628420002263603`*^9, {3.662842043753207*^9, 
   3.6628420525334253`*^9}, 3.6628427230872993`*^9, 3.662851172193549*^9, 
   3.662907236302392*^9, 3.6629076269986753`*^9, 3.662907807272794*^9, 
   3.6629124035650597`*^9, 3.662914592413787*^9, 3.662916422617937*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"(\[Del]\[Phi]) (\[Del]\[Psi]): \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"4", " ", "\[Psi]", " ", 
      RowBox[{
       SuperscriptBox["ReplaceAll", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{
        RowBox[{
         FractionBox["\[CapitalDelta]\[Phi]", 
          SuperscriptBox["a", "2"]], "+", 
         RowBox[{
          OverscriptBox["\[Phi]", "."], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "3"}], " ", "H"}], "+", 
            RowBox[{"4", " ", 
             OverscriptBox["\[Psi]", "."]}]}], ")"}]}], "-", 
         SuperscriptBox["V", "\[Prime]",
          MultilineFunction->None]}], ",", "dPsirepl"}], "]"}]}], 
     SuperscriptBox["a", "2"]]}]}],
  SequenceForm[
  "(\[Del]\[Phi]) (\[Del]\[Psi]): ", (-4) $CellContext`a^(-2) $CellContext`\
\[Psi] Derivative[1, 0][
    ReplaceAll][$CellContext`a^(-2) $CellContext`\[CapitalDelta]\[Phi] + 
     OverDot[$CellContext`\[Phi], 1] ((-3) $CellContext`H + 
       4 OverDot[$CellContext`\[Psi], 1]) - Derivative[
     1][$CellContext`V], $CellContext`dPsirepl]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.662753803434454*^9, 3.662753879442786*^9}, 
   3.6627539522801037`*^9, 3.662753988038238*^9, 3.662754056794243*^9, 
   3.662754141151984*^9, 3.662757286536223*^9, 3.662757340672339*^9, 
   3.662832615588217*^9, 3.66283728908817*^9, {3.662840299089066*^9, 
   3.6628403260136013`*^9}, {3.66284181631824*^9, 3.662841825556616*^9}, 
   3.6628418699794493`*^9, 3.6628420002263603`*^9, {3.662842043753207*^9, 
   3.6628420525334253`*^9}, 3.6628427230872993`*^9, 3.662851172193549*^9, 
   3.662907236302392*^9, 3.6629076269986753`*^9, 3.662907807272794*^9, 
   3.6629124035650597`*^9, 3.662914592413787*^9, 3.6629164227046833`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"V': \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"2", " ", "\[Psi]"}]}], ")"}], " ", 
       RowBox[{
        SuperscriptBox["ReplaceAll", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{
         RowBox[{
          FractionBox["\[CapitalDelta]\[Phi]", 
           SuperscriptBox["a", "2"]], "+", 
          RowBox[{
           OverscriptBox["\[Phi]", "."], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "3"}], " ", "H"}], "+", 
             RowBox[{"4", " ", 
              OverscriptBox["\[Psi]", "."]}]}], ")"}]}]}], ",", "dPsirepl"}], 
        "]"}]}], "+", 
      RowBox[{"4", " ", "\[Psi]", " ", 
       RowBox[{"(", 
        RowBox[{"\[CapitalDelta]\[Phi]", "-", 
         RowBox[{
          RowBox[{"\[Del]", "\[Phi]"}], " ", 
          RowBox[{"\[Del]", "\[Psi]"}]}], "+", 
         RowBox[{
          SuperscriptBox["a", "2"], " ", 
          OverscriptBox["\[Phi]", "."], " ", 
          OverscriptBox["\[Psi]", "."]}]}], ")"}], " ", 
       RowBox[{
        SuperscriptBox["ReplaceAll", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"2", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{
         RowBox[{
          FractionBox["\[CapitalDelta]\[Phi]", 
           SuperscriptBox["a", "2"]], "+", 
          RowBox[{
           OverscriptBox["\[Phi]", "."], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "3"}], " ", "H"}], "+", 
             RowBox[{"4", " ", 
              OverscriptBox["\[Psi]", "."]}]}], ")"}]}]}], ",", "dPsirepl"}], 
        "]"}]}]}], 
     SuperscriptBox["a", "2"]]}]}],
  SequenceForm[
  "V': ", -$CellContext`a^(-2) ($CellContext`a^2 (1 + 2 $CellContext`\[Psi]) 
     Derivative[1, 0][
      ReplaceAll][$CellContext`a^(-2) $CellContext`\[CapitalDelta]\[Phi] + 
       OverDot[$CellContext`\[Phi], 1] ((-3) $CellContext`H + 
         4 OverDot[$CellContext`\[Psi], 1]), $CellContext`dPsirepl] + 
    4 $CellContext`\[Psi] ($CellContext`\[CapitalDelta]\[Phi] - 
      Del[$CellContext`\[Phi]] 
      Del[$CellContext`\[Psi]] + $CellContext`a^2 
       OverDot[$CellContext`\[Phi], 1] OverDot[$CellContext`\[Psi], 1]) 
     Derivative[2, 0][
      ReplaceAll][$CellContext`a^(-2) $CellContext`\[CapitalDelta]\[Phi] + 
       OverDot[$CellContext`\[Phi], 1] ((-3) $CellContext`H + 
         4 OverDot[$CellContext`\[Psi], 1]), $CellContext`dPsirepl])],
  Editable->False]], "Print",
 CellChangeTimes->{{3.662753803434454*^9, 3.662753879442786*^9}, 
   3.6627539522801037`*^9, 3.662753988038238*^9, 3.662754056794243*^9, 
   3.662754141151984*^9, 3.662757286536223*^9, 3.662757340672339*^9, 
   3.662832615588217*^9, 3.66283728908817*^9, {3.662840299089066*^9, 
   3.6628403260136013`*^9}, {3.66284181631824*^9, 3.662841825556616*^9}, 
   3.6628418699794493`*^9, 3.6628420002263603`*^9, {3.662842043753207*^9, 
   3.6628420525334253`*^9}, 3.6628427230872993`*^9, 3.662851172193549*^9, 
   3.662907236302392*^9, 3.6629076269986753`*^9, 3.662907807272794*^9, 
   3.6629124035650597`*^9, 3.662914592413787*^9, 3.662916422749292*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
recompute the equation of motion, expand metric from beginning (maxOrder>=2 \
works, but not maxOrder=1 ??)\
\>", "Subsection",
 CellChangeTimes->{{3.661800407502512*^9, 3.661800411086266*^9}, {
  3.6618061113957357`*^9, 3.6618061156180143`*^9}, {3.662754260172935*^9, 
  3.6627542676189213`*^9}, {3.662757467873118*^9, 3.66275748736618*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"maxOrder", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"gUUlin", " ", "=", " ", 
  RowBox[{
   RowBox[{"Series", "[", 
    RowBox[{"gUU", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Psi", "[", 
        RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], ",", "0", ",", 
       "maxOrder"}], "}"}]}], "]"}], " ", "//", "Normal"}]}]}], "Input",
 CellChangeTimes->{{3.6616227595602694`*^9, 3.6616227766796503`*^9}, {
  3.6616228394594307`*^9, 3.661622872341851*^9}, {3.6616229402543592`*^9, 
  3.661622941989851*^9}, {3.661633359477593*^9, 3.661633360715611*^9}, {
  3.6627487537647057`*^9, 3.66274876936369*^9}, {3.6627490955324087`*^9, 
  3.662749106243683*^9}, {3.6627526508309917`*^9, 3.6627526512145567`*^9}, {
  3.6627527314079103`*^9, 3.6627527315578547`*^9}, {3.662757490479576*^9, 
  3.662757499935678*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"Psi", "[", 
        RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], "-", 
      RowBox[{"4", " ", 
       SuperscriptBox[
        RowBox[{"Psi", "[", 
         RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "2"]}]}], ",", 
     "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{
      FractionBox["1", 
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"]], "+", 
      FractionBox[
       RowBox[{"2", " ", 
        RowBox[{"Psi", "[", 
         RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], 
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"]], "+", 
      FractionBox[
       RowBox[{"4", " ", 
        SuperscriptBox[
         RowBox[{"Psi", "[", 
          RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "2"]}], 
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"]]}], ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{
      FractionBox["1", 
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"]], "+", 
      FractionBox[
       RowBox[{"2", " ", 
        RowBox[{"Psi", "[", 
         RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], 
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"]], "+", 
      FractionBox[
       RowBox[{"4", " ", 
        SuperscriptBox[
         RowBox[{"Psi", "[", 
          RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "2"]}], 
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"]]}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", 
     RowBox[{
      FractionBox["1", 
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"]], "+", 
      FractionBox[
       RowBox[{"2", " ", 
        RowBox[{"Psi", "[", 
         RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], 
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"]], "+", 
      FractionBox[
       RowBox[{"4", " ", 
        SuperscriptBox[
         RowBox[{"Psi", "[", 
          RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "2"]}], 
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"]]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.661793787143999*^9, 3.661793899839965*^9, 3.661800353877145*^9, {
   3.6618052744401693`*^9, 3.661805281458332*^9}, 3.661806272396303*^9, 
   3.661806426263158*^9, 3.6618066091999826`*^9, 3.661806731345622*^9, 
   3.6618068988474092`*^9, 3.661807427703924*^9, 3.661808239820046*^9, 
   3.662740767776395*^9, 3.662743117346212*^9, 3.6627486382890043`*^9, 
   3.662752654724299*^9, 3.6627527319146214`*^9, 3.6627527703939*^9, 
   3.66275736404543*^9, {3.662757497106732*^9, 3.662757500276216*^9}, 
   3.662757617621685*^9, 3.662832617438013*^9, 3.6628427259705343`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tolin", "@", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"gUUlin", ".", "gdd"}], " ", "/.", " ", "printrepl"}], 
   ")"}]}]], "Input",
 CellChangeTimes->{{3.66180649705748*^9, 3.661806518924033*^9}, {
  3.6627526578222*^9, 3.6627526582059526`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.661806499421392*^9, 3.661806519572693*^9}, 
   3.6618066098326073`*^9, 3.6618067320455713`*^9, 3.661806900129833*^9, 
   3.661808240670412*^9, 3.662740769026762*^9, 3.662743118264456*^9, 
   3.662748639138302*^9, {3.662752629227399*^9, 3.6627526584803057`*^9}, 
   3.662752733335868*^9, 3.6627527714255333`*^9, 3.6627573689457197`*^9, 
   3.662757501692306*^9, 3.662757618569172*^9, 3.662832628938995*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"eomtmp2", " ", "=", " ", 
   RowBox[{
    RowBox[{"covDiv", "[", 
     RowBox[{
      RowBox[{"gUUlin", ".", 
       RowBox[{"covD", "[", 
        RowBox[{"phi", "[", 
         RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "]"}]}], ",", 
      "1"}], "]"}], " ", "//", " ", "FullSimplify"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.659213984446457*^9, 3.6592140165301533`*^9}, {
   3.659214079454344*^9, 3.6592141197235193`*^9}, {3.6592143219106903`*^9, 
   3.659214381024578*^9}, {3.659214540282854*^9, 3.659214549824751*^9}, {
   3.659214698842856*^9, 3.6592147557365828`*^9}, {3.6592148287619553`*^9, 
   3.659214833049459*^9}, {3.659214941697033*^9, 3.659214950600512*^9}, {
   3.659215026730626*^9, 3.659215087767284*^9}, {3.659215333484338*^9, 
   3.6592153424571247`*^9}, {3.659215839196046*^9, 3.659215839323812*^9}, 
   3.66180643675191*^9, {3.661806575379574*^9, 3.6618065908254766`*^9}, {
   3.6627526359280148`*^9, 3.662752635999852*^9}, {3.6627526695134783`*^9, 
   3.66275269412805*^9}, {3.662757511503405*^9, 3.6627575222303333`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eomrepl2", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"fullnice", "@", 
        RowBox[{"(", "eomtmp2", ")"}]}], " ", "\[Equal]", " ", "Vprime"}], 
      ",", " ", "ddphi"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], " ", "//", " ", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.6618062171509247`*^9, 3.661806217238752*^9}, 
   3.661806298130126*^9, 3.661806441423592*^9, 3.661806588130539*^9, {
   3.661806722315258*^9, 3.6618067287679377`*^9}, {3.662748644771586*^9, 
   3.662748652689533*^9}, {3.6627575333254843`*^9, 3.66275755662044*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"ddphi", "\[Rule]", 
   FractionBox[
    RowBox[{
     RowBox[{"4", " ", "gphi", " ", "gPsi", " ", "Psi"}], "-", 
     RowBox[{"lphi", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"2", " ", "Psi"}]}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["a", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dphi", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", " ", "H"}], "+", 
           RowBox[{"4", " ", "dPsi", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "Psi"}], ")"}]}], "-", 
           RowBox[{"6", " ", "H", " ", "Psi"}]}], ")"}]}], "+", "Vprime"}], 
       ")"}]}]}], 
    RowBox[{
     SuperscriptBox["a", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"2", " ", "Psi"}]}], ")"}]}]]}], "}"}]], "Output",
 CellChangeTimes->{{3.661806277465447*^9, 3.661806298616666*^9}, {
   3.661806428063336*^9, 3.6618064417480507`*^9}, 3.66180653410758*^9, 
   3.661806611732627*^9, 3.661806733479459*^9, 3.6618069087261143`*^9, 
   3.661808244428018*^9, 3.6627407742398157`*^9, 3.662743119447315*^9, {
   3.662748641952942*^9, 3.6627486546195374`*^9}, 3.662752696044729*^9, 
   3.662752736854637*^9, 3.662752773966976*^9, 3.662757389898675*^9, 
   3.662757558822545*^9, 3.66283263150753*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rhs2", " ", "=", " ", 
  RowBox[{
   RowBox[{"fullnice", "@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"ddphi", " ", "/.", " ", "eomrepl2"}], ")"}], " ", "/.", " ", 
      "dPsirepl"}], ")"}]}], " ", "//.", " ", "mathrepl"}]}]], "Input",
 CellChangeTimes->{{3.661806263035693*^9, 3.6618062657875223`*^9}, {
  3.6627491171166487`*^9, 3.662749123922477*^9}, {3.6627573955971527`*^9, 
  3.6627573979002113`*^9}, {3.662757585464381*^9, 3.662757585584182*^9}, {
  3.662757622422583*^9, 3.6627576569333878`*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"\[CapitalDelta]\[Phi]", "+", 
   RowBox[{"4", " ", "\[CapitalDelta]\[Phi]", " ", "\[Psi]"}], "-", 
   RowBox[{"4", " ", "\[Psi]", " ", 
    RowBox[{"\[Del]", "\[Phi]"}], " ", 
    RowBox[{"\[Del]", "\[Psi]"}]}], "+", 
   RowBox[{
    SuperscriptBox["a", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "H"}], " ", 
       RowBox[{"(", 
        RowBox[{"3", "+", 
         RowBox[{"4", " ", "\[Psi]"}]}], ")"}], " ", 
       OverscriptBox["\[Phi]", "."]}], "+", 
      RowBox[{"16", " ", "Gnew", " ", "\[Pi]", " ", "\[Delta]\[Phi]", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Psi]"}], ")"}], " ", 
       SuperscriptBox[
        OverscriptBox["\[Phi]", "."], "2"]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"2", " ", "\[Psi]"}]}], ")"}], " ", 
       SuperscriptBox["V", "\[Prime]",
        MultilineFunction->None]}]}], ")"}]}]}], 
  SuperscriptBox["a", "2"]]], "Output",
 CellChangeTimes->{
  3.661806281546547*^9, 3.661806428846126*^9, 3.6618065350084476`*^9, 
   3.661806613234344*^9, 3.661806734429508*^9, 3.661806917914558*^9, 
   3.661808244619138*^9, 3.662740775352026*^9, 3.662743120047205*^9, {
   3.662748647975911*^9, 3.662748655367565*^9}, 3.662752697118284*^9, 
   3.662752737672475*^9, 3.662752774584453*^9, {3.662757392705769*^9, 
   3.662757398431739*^9}, 3.6627575874402027`*^9, 3.66275765772823*^9, 
   3.662832632801046*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"getCoefficients", "[", "rhs2", "]"}]], "Input",
 CellChangeTimes->{{3.66275759169621*^9, 3.662757624653698*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"full expression: \"\>", "\[InvisibleSpace]", 
   RowBox[{
    FractionBox[
     RowBox[{"\[CapitalDelta]\[Phi]", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"4", " ", "\[Psi]"}]}], ")"}]}], 
     SuperscriptBox["a", "2"]], "-", 
    FractionBox[
     RowBox[{"4", " ", "\[Psi]", " ", 
      RowBox[{"\[Del]", "\[Phi]"}], " ", 
      RowBox[{"\[Del]", "\[Psi]"}]}], 
     SuperscriptBox["a", "2"]], "-", 
    RowBox[{"H", " ", 
     RowBox[{"(", 
      RowBox[{"3", "+", 
       RowBox[{"4", " ", "\[Psi]"}]}], ")"}], " ", 
     OverscriptBox["\[Phi]", "."]}], "+", 
    RowBox[{"16", " ", "Gnew", " ", "\[Pi]", " ", "\[Delta]\[Phi]", " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", "\[Psi]"}], ")"}], " ", 
     SuperscriptBox[
      OverscriptBox["\[Phi]", "."], "2"]}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"2", " ", "\[Psi]"}]}], ")"}], " ", 
     SuperscriptBox["V", "\[Prime]",
      MultilineFunction->None]}]}]}],
  SequenceForm[
  "full expression: ", $CellContext`a^(-2) $CellContext`\[CapitalDelta]\[Phi] \
(1 + 4 $CellContext`\[Psi]) - 4 $CellContext`a^(-2) $CellContext`\[Psi] 
   Del[$CellContext`\[Phi]] 
   Del[$CellContext`\[Psi]] - $CellContext`H (3 + 4 $CellContext`\[Psi]) 
   OverDot[$CellContext`\[Phi], 1] + 
   16 $CellContext`Gnew 
    Pi $CellContext`\[Delta]\[Phi] (1 + $CellContext`\[Psi]) 
    OverDot[$CellContext`\[Phi], 1]^2 - (1 + 2 $CellContext`\[Psi]) 
   Derivative[1][$CellContext`V]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6627575964501667`*^9, 3.6627576585157003`*^9, 
  3.662832633773954*^9}],

Cell[BoxData["\<\"coefficients of\"\>"], "Print",
 CellChangeTimes->{3.6627575964501667`*^9, 3.6627576585157003`*^9, 
  3.662832633775717*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*OverscriptBox[\\(\[Phi]\\), \\(.\\)]\\): \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"-", "H"}], " ", 
    RowBox[{"(", 
     RowBox[{"3", "+", 
      RowBox[{"4", " ", "\[Psi]"}]}], ")"}]}]}],
  SequenceForm[
  "\!\(\*OverscriptBox[\(\[Phi]\), \(.\)]\): ", -$CellContext`H (3 + 
    4 $CellContext`\[Psi])],
  Editable->False]], "Print",
 CellChangeTimes->{3.6627575964501667`*^9, 3.6627576585157003`*^9, 
  3.66283263377741*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SuperscriptBox[OverscriptBox[\\(\[Phi]\\), \\(.\\)], \
\\(2\\)]\\): \"\>", "\[InvisibleSpace]", 
   RowBox[{"16", " ", "Gnew", " ", "\[Pi]", " ", "\[Delta]\[Phi]", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "\[Psi]"}], ")"}]}]}],
  SequenceForm[
  "\!\(\*SuperscriptBox[OverscriptBox[\(\[Phi]\), \(.\)], \(2\)]\): ", 
   16 $CellContext`Gnew 
   Pi $CellContext`\[Delta]\[Phi] (1 + $CellContext`\[Psi])],
  Editable->False]], "Print",
 CellChangeTimes->{3.6627575964501667`*^9, 3.6627576585157003`*^9, 
  3.662832633779212*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SuperscriptBox[\\(\[Del]\\), \\(2\\)]\\)\[Phi]: \"\>",
    "\[InvisibleSpace]", 
   FractionBox[
    RowBox[{"1", "+", 
     RowBox[{"4", " ", "\[Psi]"}]}], 
    SuperscriptBox["a", "2"]]}],
  SequenceForm[
  "\!\(\*SuperscriptBox[\(\[Del]\), \(2\)]\)\[Phi]: ", $CellContext`a^(-2) (1 + 
    4 $CellContext`\[Psi])],
  Editable->False]], "Print",
 CellChangeTimes->{3.6627575964501667`*^9, 3.6627576585157003`*^9, 
  3.6628326337811832`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"(\[Del]\[Phi]) (\[Del]\[Psi]): \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"4", " ", "\[Psi]"}], 
     SuperscriptBox["a", "2"]]}]}],
  SequenceForm[
  "(\[Del]\[Phi]) (\[Del]\[Psi]): ", (-4) $CellContext`a^(-2) $CellContext`\
\[Psi]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6627575964501667`*^9, 3.6627576585157003`*^9, 
  3.6628326338293047`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"V': \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"-", "1"}], "-", 
    RowBox[{"2", " ", "\[Psi]"}]}]}],
  SequenceForm["V': ", -1 - 2 $CellContext`\[Psi]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6627575964501667`*^9, 3.6627576585157003`*^9, 
  3.662832633832383*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["compare eom from different methods", "Subsection",
 CellChangeTimes->{{3.661806085548218*^9, 3.661806086571659*^9}, {
  3.662757668783618*^9, 3.6627576723114443`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"rhs1", " ", "\[Equal]", " ", "rhs2"}], " ", "//", " ", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.661806087947262*^9, 3.6618060924289713`*^9}, {
  3.6627450775021753`*^9, 3.6627450783581038`*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.661806092677208*^9, 3.661806285913765*^9, 3.6618068944460907`*^9, 
   3.6618082498188467`*^9, 3.661809236491927*^9, 3.662740793648086*^9, 
   3.66274312452699*^9, 3.66274507893983*^9, 3.662748702243635*^9, 
   3.66274877816827*^9, {3.662752748457547*^9, 3.662752778290757*^9}, {
   3.662757666714822*^9, 3.6627576765649567`*^9}, 3.6628326365900793`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["compute the stress energy", "Subsection",
 CellChangeTimes->{{3.6616300238827763`*^9, 3.661630030713537*^9}, {
  3.662743125985857*^9, 3.662743126863284*^9}, {3.662837305976869*^9, 
  3.662837307808751*^9}}],

Cell[TextData[{
 "this is ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["\[PartialD]", "\[Mu]"], "\[Phi]"}], " ", 
    RowBox[{
     SubscriptBox["\[PartialD]", "\[Nu]"], "\[Phi]"}]}], TraditionalForm]]]
}], "Text",
 CellChangeTimes->{{3.662757683047183*^9, 3.662757695565131*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"phidd", " ", "=", " ", 
   RowBox[{"Outer", "[", 
    RowBox[{"Times", ",", 
     RowBox[{"covD", "[", 
      RowBox[{"phi", "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "]"}], ",", 
     RowBox[{"covD", "[", 
      RowBox[{"phi", "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "]"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.661629699067011*^9, 3.661629707010198*^9}, {
  3.6616298103080263`*^9, 3.661629810723523*^9}, {3.662743172610839*^9, 
  3.662743201569762*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"phidd", " ", "\[Equal]", 
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{"covD", "[", 
       RowBox[{"phi", "[", 
        RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "]"}], "}"}], 
     "]"}], ".", 
    RowBox[{"{", 
     RowBox[{"covD", "[", 
      RowBox[{"phi", "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "]"}], "}"}]}]}], 
  " ", "//", " ", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.66276275989142*^9, 3.662762763449821*^9}, {
   3.6627628555273952`*^9, 3.6627629684545097`*^9}, 3.6627631040581503`*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.662762886312739*^9, 3.662762922998837*^9}, 
   3.6627629687763567`*^9, 3.662763104723186*^9, 3.662837310974032*^9, 
   3.662840338314197*^9, 3.662842734570718*^9, 3.662851194296184*^9, 
   3.662909664984165*^9, 3.662912415165132*^9, 3.66291642872149*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Tdd", " ", "=", 
   RowBox[{"phidd", " ", "-", " ", 
    RowBox[{"gdd", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"Contract", "[", 
         RowBox[{
          RowBox[{"Raise", "[", 
           RowBox[{"phidd", ",", "1"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], " ", "+", " ", 
       RowBox[{"V", "[", 
        RowBox[{"phi", "[", 
         RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "]"}]}], 
      ")"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.661629406378508*^9, 3.6616294504412746`*^9}, {
  3.661629502205143*^9, 3.66162952562075*^9}, {3.661629660880801*^9, 
  3.661629661358799*^9}, {3.661629712744615*^9, 3.661629723112254*^9}, {
  3.661629759962866*^9, 3.661629860547565*^9}, {3.6616300471229963`*^9, 
  3.6616300647456093`*^9}, {3.661793855965024*^9, 3.6617938564141283`*^9}, {
  3.6627432076734123`*^9, 3.662743212715396*^9}, {3.6627433509549637`*^9, 
  3.6627433761618147`*^9}, {3.662743451145049*^9, 3.662743452280691*^9}, {
  3.662744414986623*^9, 3.662744421665662*^9}, {3.662757707216219*^9, 
  3.66275773592704*^9}, {3.662757775807651*^9, 3.662757776743191*^9}, {
  3.662837515695465*^9, 3.662837515960487*^9}}],

Cell["short check:", "Text",
 CellChangeTimes->{{3.6627613753015537`*^9, 3.662761376909227*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"phidd", " ", "-", " ", 
    RowBox[{"gdd", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{
         RowBox[{"covD", "[", 
          RowBox[{"phi", "[", 
           RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "]"}], ".", 
         "gUU", ".", 
         RowBox[{"covD", "[", 
          RowBox[{"phi", "[", 
           RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "]"}]}]}], " ",
        "+", " ", 
       RowBox[{"V", "[", 
        RowBox[{"phi", "[", 
         RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "]"}]}], 
      ")"}]}]}], " ", "\[Equal]", " ", "Tdd"}], " ", "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.662761271247225*^9, 3.6627613996440573`*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.662761335226623*^9, 3.662761351702709*^9}, 
   3.662761400807509*^9, 3.66276311293773*^9, 3.662837315961763*^9, 
   3.662837520995545*^9, 3.6628403407425623`*^9, 3.6628427421575623`*^9, 
   3.662851197033424*^9, 3.6628512361584578`*^9, 3.662909667296289*^9, 
   3.6629124173013487`*^9, 3.6629164311209593`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"TUd", " ", "=", " ", 
   RowBox[{"Raise", "[", 
    RowBox[{"Tdd", ",", " ", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TUU", " ", "=", " ", 
   RowBox[{"Raise", "[", 
    RowBox[{"TUd", ",", " ", "2"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.661629935147769*^9, 3.661629953459831*^9}, {
  3.66163025235312*^9, 3.661630285600066*^9}, {3.662743416038641*^9, 
  3.662743493541897*^9}, {3.662837526694429*^9, 3.66283752690217*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"fullnice", "@", 
     RowBox[{"(", 
      RowBox[{"TUd", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], ")"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"dphi", ",", "gphi", ",", "V"}], "}"}]}], "]"}], " ", "//.", " ",
   "mathrepl"}]], "Input",
 CellChangeTimes->{{3.661630269263316*^9, 3.6616302763522797`*^9}, {
  3.661630372384804*^9, 3.661630384458547*^9}, {3.662743467719653*^9, 
  3.6627434716551332`*^9}, {3.662757917310246*^9, 3.662757918717752*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "V"}], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "-", 
      RowBox[{"2", " ", "\[Psi]"}]}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"\[Del]", "\[Phi]"}], ")"}], "2"]}], 
   RowBox[{"2", " ", 
    SuperscriptBox["a", "2"]}]], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{"2", " ", "\[Psi]"}]}], ")"}], " ", 
   SuperscriptBox[
    OverscriptBox["\[Phi]", "."], "2"]}]}]], "Output",
 CellChangeTimes->{
  3.661793939992509*^9, 3.661800491758067*^9, 3.661806674305538*^9, 
   3.661807382482053*^9, 3.6618074370887012`*^9, 3.661811174981587*^9, 
   3.662742579563703*^9, {3.662743472084729*^9, 3.662743496288517*^9}, 
   3.66274444144965*^9, 3.6627450897750063`*^9, 3.662748799638112*^9, 
   3.6627528784858503`*^9, {3.662757915295364*^9, 3.662757919235446*^9}, 
   3.662761467293191*^9, 3.662762067486122*^9, 3.662763135426798*^9, 
   3.662837331059388*^9, 3.6628375302482862`*^9, 3.662840345098542*^9, 
   3.6628427447227287`*^9, 3.662851199872779*^9, 3.662851237182131*^9, 
   3.662909669456009*^9, 3.662909750455159*^9, 3.662912422134965*^9, 
   3.662916432744698*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Tdd", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "/.", " ", "printrepl"}], 
    ")"}], " ", "/.", " ", "oprepl"}], " ", "//", " ", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fullnice", "@", 
    RowBox[{"Tdd", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1"}], "]"}], "]"}]}], " ", "/.", " ", "mathrepl"}], 
  " ", "//", " ", "Expand"}]}], "Input",
 CellChangeTimes->{{3.662837532083848*^9, 3.662837566383834*^9}, {
  3.6628394206604652`*^9, 3.6628394220604477`*^9}, {3.662840365455936*^9, 
  3.662840367567483*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     SuperscriptBox["gphi", "2"]}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"2", " ", "Psi"}]}], ")"}]}], "+", 
   RowBox[{
    SuperscriptBox["a", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"2", " ", "Psi"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["dphi", "2"], "+", 
      RowBox[{"2", " ", "V"}], "+", 
      RowBox[{"4", " ", "Psi", " ", "V"}]}], ")"}]}]}], 
  RowBox[{"2", " ", 
   SuperscriptBox["a", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{"2", " ", "Psi"}]}], ")"}]}]]], "Output",
 CellChangeTimes->{{3.6628375378860407`*^9, 3.662837566803282*^9}, 
   3.662839422350004*^9, {3.6628403463483686`*^9, 3.6628403681353807`*^9}, 
   3.662842745919441*^9, 3.662851200556074*^9, 3.662851237786113*^9, 
   3.6629096729653482`*^9, 3.6629124229308147`*^9, 3.662916433670162*^9}],

Cell[BoxData[
 RowBox[{"V", "+", 
  RowBox[{"2", " ", "V", " ", "\[Psi]"}], "+", 
  FractionBox[
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"\[Del]", "\[Phi]"}], ")"}], "2"], 
   RowBox[{"2", " ", 
    SuperscriptBox["a", "2"]}]], "+", 
  FractionBox[
   RowBox[{"2", " ", "\[Psi]", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"\[Del]", "\[Phi]"}], ")"}], "2"]}], 
   SuperscriptBox["a", "2"]], "+", 
  FractionBox[
   SuperscriptBox[
    OverscriptBox["\[Phi]", "."], "2"], "2"]}]], "Output",
 CellChangeTimes->{{3.6628375378860407`*^9, 3.662837566803282*^9}, 
   3.662839422350004*^9, {3.6628403463483686`*^9, 3.6628403681353807`*^9}, 
   3.662842745919441*^9, 3.662851200556074*^9, 3.662851237786113*^9, 
   3.6629096729653482`*^9, 3.6629124229308147`*^9, 3.6629164337016907`*^9}]
}, Open  ]],

Cell["check rho", "Text",
 CellChangeTimes->{{3.66284094416696*^9, 3.662840945515975*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"fullnice", "@", 
     RowBox[{"(", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"TUU", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], 
        RowBox[{"gUU", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]]}], ")"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"dphi", ",", " ", "gphi", ",", " ", "V"}], "}"}]}], "]"}], " ", "/.",
   " ", "mathrepl"}]], "Input",
 CellChangeTimes->{{3.6628409502072687`*^9, 3.662841025323824*^9}}],

Cell[BoxData[
 RowBox[{"V", "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"2", " ", "\[Psi]"}]}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"\[Del]", "\[Phi]"}], ")"}], "2"]}], 
   RowBox[{"2", " ", 
    SuperscriptBox["a", "2"]}]], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"2", " ", "\[Psi]"}]}], ")"}], " ", 
   SuperscriptBox[
    OverscriptBox["\[Phi]", "."], "2"]}]}]], "Output",
 CellChangeTimes->{{3.662840989051043*^9, 3.662841025605372*^9}, 
   3.6628427483561296`*^9, 3.662851202905798*^9, 3.6628512396366*^9, 
   3.662909674683793*^9, 3.662912424917721*^9, 3.6629164353621063`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Tdd", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "i"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2", ",", "4"}], "}"}]}], "]"}], " ", "/.", " ", 
     "printrepl"}], ")"}], " ", "/.", " ", "oprepl"}], " ", "//", " ", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fullnice", "@", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"Tdd", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "i"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "2", ",", "4"}], "}"}]}], "]"}]}], " ", "/.", " ", 
  "mathrepl"}]}], "Input",
 CellChangeTimes->{{3.662839379847125*^9, 3.662839397695595*^9}, {
  3.6628394503473673`*^9, 3.662839495800701*^9}, {3.662851225597476*^9, 
  3.6628512268464518`*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     SuperscriptBox["gphi", "2"]}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"2", " ", "Psi"}]}], ")"}]}], "+", 
   RowBox[{"3", " ", 
    SuperscriptBox["a", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["dphi", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"2", " ", "Psi"}]}], ")"}]}], "-", 
      RowBox[{"2", " ", "V"}], "+", 
      RowBox[{"8", " ", 
       SuperscriptBox["Psi", "2"], " ", "V"}]}], ")"}]}]}], 
  RowBox[{"2", "+", 
   RowBox[{"4", " ", "Psi"}]}]]], "Output",
 CellChangeTimes->{
  3.6628393997071333`*^9, {3.6628394376363993`*^9, 3.662839496174424*^9}, 
   3.6628403793827887`*^9, 3.6628410407738*^9, 3.6628427511636057`*^9, {
   3.662851204003113*^9, 3.662851240258844*^9}, 3.6629096759534817`*^9, 
   3.662912428876668*^9, 3.662916436657996*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"\[Del]", "\[Phi]"}], ")"}], "2"]}], "-", 
    RowBox[{"3", " ", 
     SuperscriptBox["a", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "V"}], "-", 
       RowBox[{"4", " ", "V", " ", "\[Psi]"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"4", " ", "\[Psi]"}]}], ")"}], " ", 
        SuperscriptBox[
         OverscriptBox["\[Phi]", "."], "2"]}]}], ")"}]}]}], ")"}]}]], "Output",\

 CellChangeTimes->{
  3.6628393997071333`*^9, {3.6628394376363993`*^9, 3.662839496174424*^9}, 
   3.6628403793827887`*^9, 3.6628410407738*^9, 3.6628427511636057`*^9, {
   3.662851204003113*^9, 3.662851240258844*^9}, 3.6629096759534817`*^9, 
   3.662912428876668*^9, 3.662916436695031*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["einstein tensor", "Subsection",
 CellChangeTimes->{{3.6628356350870857`*^9, 3.66283563790274*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Edd", " ", "=", " ", 
   RowBox[{
    RowBox[{"Lower", "[", 
     RowBox[{"EUd", ",", "1"}], "]"}], " ", "//", " ", "Simplify"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.662837597124399*^9, 3.662837610930882*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"fullnice", "@", 
   RowBox[{"(", 
    RowBox[{"Edd", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1"}], "]"}], "]"}], ")"}]}], " ", "//", " ", 
  "Expand"}], "\[IndentingNewLine]", 
 RowBox[{"%", " ", "/.", " ", "quadPsirepl"}]}], "Input",
 CellChangeTimes->{{3.6628356405491543`*^9, 3.662835763345641*^9}, {
  3.662837435541972*^9, 3.6628374655536337`*^9}, {3.6628376151461067`*^9, 
  3.662837618201888*^9}, {3.662837863830597*^9, 3.662837864963272*^9}, {
  3.66283952047889*^9, 3.6628395265016747`*^9}, {3.662840177009997*^9, 
  3.662840179402123*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"3", " ", 
   SuperscriptBox["dPsi", "2"]}], "+", 
  FractionBox[
   RowBox[{"3", " ", 
    SuperscriptBox["gPsi", "2"]}], 
   SuperscriptBox["a", "2"]], "-", 
  RowBox[{"6", " ", "dPsi", " ", "H"}], "+", 
  RowBox[{"3", " ", 
   SuperscriptBox["H", "2"]}], "+", 
  FractionBox[
   RowBox[{"2", " ", "lPsi"}], 
   SuperscriptBox["a", "2"]], "+", 
  RowBox[{"12", " ", 
   SuperscriptBox["dPsi", "2"], " ", "Psi"}], "+", 
  FractionBox[
   RowBox[{"24", " ", 
    SuperscriptBox["gPsi", "2"], " ", "Psi"}], 
   SuperscriptBox["a", "2"]], "-", 
  RowBox[{"12", " ", "dPsi", " ", "H", " ", "Psi"}], "+", 
  FractionBox[
   RowBox[{"12", " ", "lPsi", " ", "Psi"}], 
   SuperscriptBox["a", "2"]]}]], "Output",
 CellChangeTimes->{3.6628395413791513`*^9, 3.662840390541706*^9, 
  3.6628404289752293`*^9, 3.662841043089677*^9, 3.662842755629689*^9, 
  3.662851244664958*^9, 3.6629094553861*^9, 3.662909499027981*^9, 
  3.662912432122547*^9, 3.662916440377582*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "6"}], " ", "dPsi", " ", "H"}], "+", 
  RowBox[{"3", " ", 
   SuperscriptBox["H", "2"]}], "+", 
  FractionBox[
   RowBox[{"2", " ", "lPsi"}], 
   SuperscriptBox["a", "2"]]}]], "Output",
 CellChangeTimes->{3.6628395413791513`*^9, 3.662840390541706*^9, 
  3.6628404289752293`*^9, 3.662841043089677*^9, 3.662842755629689*^9, 
  3.662851244664958*^9, 3.6629094553861*^9, 3.662909499027981*^9, 
  3.662912432122547*^9, 3.6629164403795557`*^9}]
}, Open  ]],

Cell["check", "Text",
 CellChangeTimes->{{3.662845541683869*^9, 3.662845542027623*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"SeriesCoefficient", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Edd", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "/.", " ", "printrepl"}],
       ")"}], " ", "/.", " ", "oprepl"}], ",", 
    RowBox[{"{", 
     RowBox[{"Psi", ",", "0", ",", "0"}], "}"}]}], "]"}], " ", "/.", " ", 
  "quadPsirepl"}]], "Input",
 CellChangeTimes->{{3.662845451848196*^9, 3.662845485294786*^9}, {
  3.6628455253190193`*^9, 3.662845536696322*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "6"}], " ", "dPsi", " ", "H"}], "+", 
  RowBox[{"3", " ", 
   SuperscriptBox["H", "2"]}], "+", 
  FractionBox[
   RowBox[{"2", " ", "lPsi"}], 
   SuperscriptBox["a", "2"]]}]], "Output",
 CellChangeTimes->{{3.662845466000547*^9, 3.6628454858321447`*^9}, {
   3.662845526086566*^9, 3.662845537120949*^9}, 3.662851246610067*^9, 
   3.662909613549363*^9, 3.6629124358009987`*^9, 3.662916442377029*^9}]
}, Open  ]],

Cell["\<\
check with another independent package and manual computation\
\>", "Text",
 CellChangeTimes->{{3.662840551037323*^9, 3.662840551355151*^9}, {
  3.6628408799052963`*^9, 3.6628408918407593`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Import", "[", "\"\<EinsteinTensor.m\>\"", "]"}]}], "Input",
 CellChangeTimes->{{3.6628407586136427`*^9, 3.662840762289159*^9}, {
  3.662840797839612*^9, 3.662840825199603*^9}}],

Cell[BoxData["\<\"/Users/niki/Dropbox/Uni/Exercises/11Semester/MAPhysics/\
kipac_inflation/evaluation\"\>"], "Output",
 CellChangeTimes->{
  3.6628407628787127`*^9, {3.6628408016005783`*^9, 3.66284082577061*^9}, 
   3.66284104601416*^9, 3.66284276486734*^9, 3.662851272030732*^9, 
   3.6629096187457733`*^9, 3.6629124373688793`*^9, 3.662916444363714*^9}],

Cell[BoxData[
 RowBox[{"{", "EinsteinTensor", "}"}]], "Print",
 CellChangeTimes->{3.662840825841601*^9, 3.6628410460396957`*^9, 
  3.662842764891144*^9, 3.6628512721119823`*^9, 3.662909618833774*^9, 
  3.6629124374728622`*^9, 3.662916444438699*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Edd", " ", "\[Equal]", " ", 
   RowBox[{"EinsteinTensor", "[", 
    RowBox[{"g", ",", "coords"}], "]"}]}], " ", "//", " ", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.662840831220831*^9, 3.662840873675518*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.6628408438704576`*^9, 3.6628408744219007`*^9}, 
   3.6628410469057493`*^9, 3.662842766410707*^9, 3.662851273395516*^9, 
   3.662909620185878*^9, 3.662912438569676*^9, 3.662916445549183*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Eddalt", " ", "=", " ", 
   RowBox[{
    RowBox[{"Rdd", " ", "-", " ", 
     RowBox[{
      FractionBox["1", "2"], " ", "gdd", " ", "R"}]}], " ", "//", " ", 
    "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Eddalt", " ", "\[Equal]", " ", "Edd"}], " ", "//", 
  "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.6628405538529663`*^9, 3.662840580595978*^9}, {
  3.662851286508224*^9, 3.662851286899494*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.662851288647821*^9, 3.662909621161384*^9, 
  3.662912438858809*^9, 3.662916445839382*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["full einstein equations", "Subsection",
 CellChangeTimes->{{3.662837572097866*^9, 3.662837577201663*^9}, {
  3.6628411554514637`*^9, 3.6628411559379377`*^9}, {3.6629124392494087`*^9, 
  3.6629124401748962`*^9}, {3.66291644639305*^9, 3.662916447158888*^9}}],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{"einstein", " ", "=", " ", 
    RowBox[{"Edd", " ", "-", " ", 
     RowBox[{"8", " ", "\[Pi]", " ", "Gnew", " ", "Tdd"}]}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.6628375808219213`*^9, 3.662837595601864*^9}, {
  3.662837625616219*^9, 3.662837671438341*^9}, {3.662838693749514*^9, 
  3.66283870127652*^9}, {3.6628387395717773`*^9, 3.662838772504634*^9}, {
  3.6628399951008043`*^9, 3.662840021947027*^9}, {3.6628401845707483`*^9, 
  3.6628402055528316`*^9}, {3.662851306195644*^9, 3.662851310659032*^9}, {
  3.662851346507698*^9, 3.662851349043154*^9}, {3.662912449080551*^9, 
  3.662912453488081*^9}}],

Cell[CellGroupData[{

Cell["00 component", "Subsubsection",
 CellChangeTimes->{{3.662838660975135*^9, 3.6628386623493633`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"lPsirepl", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"fullnice", "@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"einstein", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "\[Equal]", " ", 
          "0"}], ")"}]}], ",", " ", "lPsi"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], " ", "/.", " ", "quadPsirepl"}], " ", "//",
    " ", "FullSimplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Expand", "@", 
      RowBox[{"(", 
       RowBox[{"fullnice", "@", 
        RowBox[{"(", 
         RowBox[{"lPsi", " ", "/.", "lPsirepl"}], ")"}]}], ")"}]}], "/.", " ",
      "quadPsirepl"}], ")"}], " ", "//", " ", "Simplify"}], " ", "//", " ", 
  "Expand"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Expand", "@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"SeriesCoefficient", "[", 
        RowBox[{"%", ",", 
         RowBox[{"{", 
          RowBox[{"Psi", ",", "0", ",", "#"}], "}"}]}], "]"}], " ", "/", " ", 
       
       RowBox[{"(", 
        RowBox[{"4", " ", "\[Pi]", " ", "Gnew"}], ")"}]}], " ", "/.", " ", 
      "mathrepl"}], ")"}]}], " ", "&"}], "/@", " ", 
  RowBox[{"{", 
   RowBox[{"0", ",", "1"}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.662837673460247*^9, 3.662837708179986*^9}, {
   3.662837739778674*^9, 3.662837750066557*^9}, 3.6628380539623547`*^9, {
   3.66283812806911*^9, 3.6628381291889973`*^9}, {3.6628387497864017`*^9, 
   3.6628387791363773`*^9}, {3.66284571611526*^9, 3.6628457234090853`*^9}, {
   3.662851355002821*^9, 3.66285141866778*^9}, {3.662910269485697*^9, 
   3.662910296889105*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"lPsi", "\[Rule]", 
   FractionBox[
    RowBox[{
     RowBox[{"4", " ", "Gnew", " ", 
      SuperscriptBox["gphi", "2"], " ", "\[Pi]", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"4", " ", "Psi", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"2", " ", "Psi"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"4", " ", 
            SuperscriptBox["Psi", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["a", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "3"}], " ", 
         SuperscriptBox["H", "2"]}], "+", 
        RowBox[{"6", " ", "dPsi", " ", "H", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"4", " ", 
            SuperscriptBox["Psi", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"2", " ", "Psi"}], "+", 
              RowBox[{"4", " ", 
               SuperscriptBox["Psi", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{"4", " ", "Gnew", " ", "\[Pi]", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["dphi", "2"], "+", 
           RowBox[{"2", " ", "V"}], "+", 
           RowBox[{"4", " ", "Psi", " ", "V"}]}], ")"}]}]}], ")"}]}]}], 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"2", " ", "Psi", " ", 
        RowBox[{"(", 
         RowBox[{"3", "+", 
          RowBox[{"2", " ", "Psi", " ", 
           RowBox[{"(", 
            RowBox[{"5", "+", 
             RowBox[{"2", " ", "Psi", " ", 
              RowBox[{"(", 
               RowBox[{"7", "+", 
                RowBox[{"18", " ", "Psi"}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}],
       ")"}]}]]}], "}"}]], "Output",
 CellChangeTimes->{{3.6628376818162823`*^9, 3.662837708901539*^9}, 
   3.662837761855192*^9, {3.662838040002232*^9, 3.662838054993759*^9}, 
   3.662838129477972*^9, 3.662838204419366*^9, {3.662838754207453*^9, 
   3.662838779598624*^9}, 3.6628398526958027`*^9, {3.662840003176179*^9, 
   3.6628400254147463`*^9}, {3.6628401902988873`*^9, 3.662840207350189*^9}, 
   3.662840446568553*^9, 3.6628410528900414`*^9, 3.662842776127714*^9, {
   3.66284570903468*^9, 3.6628457245620003`*^9}, 3.662845810691258*^9, 
   3.662851314157151*^9, 3.662851359180475*^9, {3.662851395526587*^9, 
   3.662851437698503*^9}, 3.662852078151123*^9, 3.662910061762722*^9, {
   3.6629102877390327`*^9, 3.66291029734028*^9}, 3.662912455992127*^9, 
   3.6629164499965563`*^9, 3.662920457599609*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"3", " ", 
   SuperscriptBox["a", "2"], " ", "dPsi", " ", "H"}], "-", 
  FractionBox[
   RowBox[{"3", " ", 
    SuperscriptBox["a", "2"], " ", 
    SuperscriptBox["H", "2"]}], "2"], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["a", "2"], " ", 
   SuperscriptBox["dphi", "2"], " ", "Gnew", " ", "\[Pi]"}], "+", 
  RowBox[{"2", " ", "Gnew", " ", 
   SuperscriptBox["gphi", "2"], " ", "\[Pi]"}], "+", 
  RowBox[{"9", " ", 
   SuperscriptBox["a", "2"], " ", 
   SuperscriptBox["H", "2"], " ", "Psi"}], "-", 
  RowBox[{"12", " ", 
   SuperscriptBox["a", "2"], " ", 
   SuperscriptBox["dphi", "2"], " ", "Gnew", " ", "\[Pi]", " ", "Psi"}], "-", 
  
  RowBox[{"4", " ", "Gnew", " ", 
   SuperscriptBox["gphi", "2"], " ", "\[Pi]", " ", "Psi"}], "+", 
  RowBox[{"60", " ", 
   SuperscriptBox["a", "2"], " ", "dPsi", " ", "H", " ", 
   SuperscriptBox["Psi", "2"]}], "-", 
  RowBox[{"24", " ", 
   SuperscriptBox["a", "2"], " ", 
   SuperscriptBox["H", "2"], " ", 
   SuperscriptBox["Psi", "2"]}], "+", 
  RowBox[{"32", " ", 
   SuperscriptBox["a", "2"], " ", 
   SuperscriptBox["dphi", "2"], " ", "Gnew", " ", "\[Pi]", " ", 
   SuperscriptBox["Psi", "2"]}], "-", 
  RowBox[{"144", " ", 
   SuperscriptBox["a", "2"], " ", "dPsi", " ", "H", " ", 
   SuperscriptBox["Psi", "3"]}], "+", 
  RowBox[{"48", " ", 
   SuperscriptBox["a", "2"], " ", 
   SuperscriptBox["H", "2"], " ", 
   SuperscriptBox["Psi", "3"]}], "-", 
  RowBox[{"64", " ", 
   SuperscriptBox["a", "2"], " ", 
   SuperscriptBox["dphi", "2"], " ", "Gnew", " ", "\[Pi]", " ", 
   SuperscriptBox["Psi", "3"]}], "+", 
  RowBox[{"288", " ", 
   SuperscriptBox["a", "2"], " ", "dPsi", " ", "H", " ", 
   SuperscriptBox["Psi", "4"]}], "-", 
  RowBox[{"96", " ", 
   SuperscriptBox["a", "2"], " ", 
   SuperscriptBox["H", "2"], " ", 
   SuperscriptBox["Psi", "4"]}], "+", 
  RowBox[{"128", " ", 
   SuperscriptBox["a", "2"], " ", 
   SuperscriptBox["dphi", "2"], " ", "Gnew", " ", "\[Pi]", " ", 
   SuperscriptBox["Psi", "4"]}], "+", 
  RowBox[{"4", " ", 
   SuperscriptBox["a", "2"], " ", "Gnew", " ", "\[Pi]", " ", "V"}], "-", 
  RowBox[{"16", " ", 
   SuperscriptBox["a", "2"], " ", "Gnew", " ", "\[Pi]", " ", "Psi", " ", 
   "V"}], "+", 
  RowBox[{"16", " ", 
   SuperscriptBox["a", "2"], " ", "Gnew", " ", "\[Pi]", " ", 
   SuperscriptBox["Psi", "2"], " ", "V"}]}]], "Output",
 CellChangeTimes->{{3.6628376818162823`*^9, 3.662837708901539*^9}, 
   3.662837761855192*^9, {3.662838040002232*^9, 3.662838054993759*^9}, 
   3.662838129477972*^9, 3.662838204419366*^9, {3.662838754207453*^9, 
   3.662838779598624*^9}, 3.6628398526958027`*^9, {3.662840003176179*^9, 
   3.6628400254147463`*^9}, {3.6628401902988873`*^9, 3.662840207350189*^9}, 
   3.662840446568553*^9, 3.6628410528900414`*^9, 3.662842776127714*^9, {
   3.66284570903468*^9, 3.6628457245620003`*^9}, 3.662845810691258*^9, 
   3.662851314157151*^9, 3.662851359180475*^9, {3.662851395526587*^9, 
   3.662851437698503*^9}, 3.662852078151123*^9, 3.662910061762722*^9, {
   3.6629102877390327`*^9, 3.66291029734028*^9}, 3.662912455992127*^9, 
   3.6629164499965563`*^9, 3.662920457708171*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"3", " ", 
       SuperscriptBox["a", "2"], " ", 
       SuperscriptBox["H", "2"]}], 
      RowBox[{"8", " ", "Gnew", " ", "\[Pi]"}]]}], "+", 
    RowBox[{
     SuperscriptBox["a", "2"], " ", "V"}], "+", 
    FractionBox[
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"\[Del]", "\[Phi]"}], ")"}], "2"], "2"], "+", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     SuperscriptBox["a", "2"], " ", 
     SuperscriptBox[
      OverscriptBox["\[Phi]", "."], "2"]}], "+", 
    FractionBox[
     RowBox[{"3", " ", 
      SuperscriptBox["a", "2"], " ", "H", " ", 
      OverscriptBox["\[Psi]", "."]}], 
     RowBox[{"4", " ", "Gnew", " ", "\[Pi]"}]]}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{"9", " ", 
      SuperscriptBox["a", "2"], " ", 
      SuperscriptBox["H", "2"]}], 
     RowBox[{"4", " ", "Gnew", " ", "\[Pi]"}]], "-", 
    RowBox[{"4", " ", 
     SuperscriptBox["a", "2"], " ", "V"}], "-", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"\[Del]", "\[Phi]"}], ")"}], "2"], "-", 
    RowBox[{"3", " ", 
     SuperscriptBox["a", "2"], " ", 
     SuperscriptBox[
      OverscriptBox["\[Phi]", "."], "2"]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6628376818162823`*^9, 3.662837708901539*^9}, 
   3.662837761855192*^9, {3.662838040002232*^9, 3.662838054993759*^9}, 
   3.662838129477972*^9, 3.662838204419366*^9, {3.662838754207453*^9, 
   3.662838779598624*^9}, 3.6628398526958027`*^9, {3.662840003176179*^9, 
   3.6628400254147463`*^9}, {3.6628401902988873`*^9, 3.662840207350189*^9}, 
   3.662840446568553*^9, 3.6628410528900414`*^9, 3.662842776127714*^9, {
   3.66284570903468*^9, 3.6628457245620003`*^9}, 3.662845810691258*^9, 
   3.662851314157151*^9, 3.662851359180475*^9, {3.662851395526587*^9, 
   3.662851437698503*^9}, 3.662852078151123*^9, 3.662910061762722*^9, {
   3.6629102877390327`*^9, 3.66291029734028*^9}, 3.662912455992127*^9, 
   3.6629164499965563`*^9, 3.66292045774296*^9}]
}, Open  ]],

Cell["check", "Text",
 CellChangeTimes->{{3.662852344081736*^9, 3.6628523444161386`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Simplify", "[", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"einstein", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "\[Equal]", " ", 
            "0"}], ")"}], " ", "/.", " ", "printrepl"}], ")"}], "]"}], " ", "/.",
        " ", "oprepl"}], ",", 
      RowBox[{"{", "lPsi", "}"}]}], " ", "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], " ", "//", " ", "FullSimplify"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Expand", "@", 
     RowBox[{"fullnice", "@", 
      RowBox[{"(", 
       RowBox[{"lPsi", " ", "/.", " ", "%"}], ")"}]}]}], " ", "/.", " ", 
    "quadPsirepl"}], " ", "//", " ", "FullSimplify"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Expand", "@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"SeriesCoefficient", "[", 
        RowBox[{"%", ",", 
         RowBox[{"{", 
          RowBox[{"Psi", ",", "0", ",", "#"}], "}"}]}], "]"}], " ", "/", " ", 
       
       RowBox[{"(", 
        RowBox[{"4", " ", "\[Pi]", " ", "Gnew"}], ")"}]}], " ", "/.", " ", 
      "mathrepl"}], ")"}]}], " ", "&"}], "/@", " ", 
  RowBox[{"{", 
   RowBox[{"0", ",", "1"}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.662852100828414*^9, 3.662852278726028*^9}, {
   3.66285234877962*^9, 3.662852414319208*^9}, 3.6628525432021847`*^9, 
   3.6629102539775057`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"3", " ", 
       SuperscriptBox["a", "2"], " ", 
       SuperscriptBox["H", "2"]}], 
      RowBox[{"8", " ", "Gnew", " ", "\[Pi]"}]]}], "+", 
    RowBox[{
     SuperscriptBox["a", "2"], " ", "V"}], "+", 
    FractionBox[
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"\[Del]", "\[Phi]"}], ")"}], "2"], "2"], "+", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     SuperscriptBox["a", "2"], " ", 
     SuperscriptBox[
      OverscriptBox["\[Phi]", "."], "2"]}], "+", 
    FractionBox[
     RowBox[{"3", " ", 
      SuperscriptBox["a", "2"], " ", "H", " ", 
      OverscriptBox["\[Psi]", "."]}], 
     RowBox[{"4", " ", "Gnew", " ", "\[Pi]"}]]}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{"9", " ", 
      SuperscriptBox["a", "2"], " ", 
      SuperscriptBox["H", "2"]}], 
     RowBox[{"4", " ", "Gnew", " ", "\[Pi]"}]], "-", 
    RowBox[{"4", " ", 
     SuperscriptBox["a", "2"], " ", "V"}], "-", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"\[Del]", "\[Phi]"}], ")"}], "2"], "-", 
    RowBox[{"3", " ", 
     SuperscriptBox["a", "2"], " ", 
     SuperscriptBox[
      OverscriptBox["\[Phi]", "."], "2"]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.662852152344488*^9, 3.6628522799367523`*^9}, {
   3.6628523469957943`*^9, 3.662852363663348*^9}, 3.6628524161519327`*^9, {
   3.662852543949893*^9, 3.6628525678257847`*^9}, 3.6629100726443653`*^9, 
   3.6629102562845*^9, 3.662912461039407*^9, 3.662916453319646*^9}]
}, Open  ]],

Cell["check 2", "Text",
 CellChangeTimes->{{3.6629102374933*^9, 3.662910238125016*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"fullnice", "@", 
        RowBox[{"Edd", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], " ", "\[Equal]", " ", 
       RowBox[{"8", " ", "\[Pi]", " ", "Gnew", " ", 
        RowBox[{"fullnice", "@", 
         RowBox[{"Tdd", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}]}], ",", " ", "lPsi"}], 
     "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], " ", "//", " ", "FullSimplify"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Expand", "@", 
     RowBox[{"fullnice", "@", 
      RowBox[{"(", 
       RowBox[{"lPsi", " ", "/.", " ", "%"}], ")"}]}]}], " ", "/.", " ", 
    "quadPsirepl"}], " ", "//", " ", "FullSimplify"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Expand", "@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"SeriesCoefficient", "[", 
        RowBox[{"%", ",", 
         RowBox[{"{", 
          RowBox[{"Psi", ",", "0", ",", "#"}], "}"}]}], "]"}], " ", "/", " ", 
       
       RowBox[{"(", 
        RowBox[{"4", " ", "\[Pi]", " ", "Gnew"}], ")"}]}], " ", "/.", " ", 
      "mathrepl"}], ")"}]}], " ", "&"}], "/@", " ", 
  RowBox[{"{", 
   RowBox[{"0", ",", "1"}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.662910077188126*^9, 3.662910178181398*^9}, {
   3.6629102088039923`*^9, 3.66291020957997*^9}, 3.662910255183424*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"3", " ", 
       SuperscriptBox["a", "2"], " ", 
       SuperscriptBox["H", "2"]}], 
      RowBox[{"8", " ", "Gnew", " ", "\[Pi]"}]]}], "+", 
    RowBox[{
     SuperscriptBox["a", "2"], " ", "V"}], "+", 
    FractionBox[
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"\[Del]", "\[Phi]"}], ")"}], "2"], "2"], "+", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     SuperscriptBox["a", "2"], " ", 
     SuperscriptBox[
      OverscriptBox["\[Phi]", "."], "2"]}], "+", 
    FractionBox[
     RowBox[{"3", " ", 
      SuperscriptBox["a", "2"], " ", "H", " ", 
      OverscriptBox["\[Psi]", "."]}], 
     RowBox[{"4", " ", "Gnew", " ", "\[Pi]"}]]}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{"9", " ", 
      SuperscriptBox["a", "2"], " ", 
      SuperscriptBox["H", "2"]}], 
     RowBox[{"4", " ", "Gnew", " ", "\[Pi]"}]], "-", 
    RowBox[{"4", " ", 
     SuperscriptBox["a", "2"], " ", "V"}], "-", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"\[Del]", "\[Phi]"}], ")"}], "2"], "-", 
    RowBox[{"3", " ", 
     SuperscriptBox["a", "2"], " ", 
     SuperscriptBox[
      OverscriptBox["\[Phi]", "."], "2"]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.662910119260808*^9, 3.662910127296739*^9}, {
   3.6629101582491093`*^9, 3.662910178692313*^9}, 3.662910210645834*^9, 
   3.662910257942589*^9, 3.6629124665682364`*^9, 3.662916456008399*^9}]
}, Open  ]],

Cell["check 3", "Text",
 CellChangeTimes->{{3.66291164647956*^9, 3.662911647805963*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"fullnice", "@", 
        RowBox[{"EUd", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], " ", "\[Equal]", " ", 
       RowBox[{"8", " ", "\[Pi]", " ", "Gnew", " ", 
        RowBox[{"fullnice", "@", 
         RowBox[{"TUd", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}]}], ",", " ", "lPsi"}], 
     "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], " ", "//", " ", "FullSimplify"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Expand", "@", 
     RowBox[{"fullnice", "@", 
      RowBox[{"(", 
       RowBox[{"lPsi", " ", "/.", " ", "%"}], ")"}]}]}], " ", "/.", " ", 
    "quadPsirepl"}], " ", "//", " ", "FullSimplify"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Expand", "@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"SeriesCoefficient", "[", 
        RowBox[{"%", ",", 
         RowBox[{"{", 
          RowBox[{"Psi", ",", "0", ",", "#"}], "}"}]}], "]"}], " ", "/", " ", 
       
       RowBox[{"(", 
        RowBox[{"4", " ", "\[Pi]", " ", "Gnew"}], ")"}]}], " ", "/.", " ", 
      "mathrepl"}], ")"}]}], " ", "&"}], "/@", " ", 
  RowBox[{"{", 
   RowBox[{"0", ",", "1"}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.662911658857451*^9, 3.6629116619771357`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"3", " ", 
       SuperscriptBox["a", "2"], " ", 
       SuperscriptBox["H", "2"]}], 
      RowBox[{"8", " ", "Gnew", " ", "\[Pi]"}]]}], "+", 
    RowBox[{
     SuperscriptBox["a", "2"], " ", "V"}], "+", 
    FractionBox[
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"\[Del]", "\[Phi]"}], ")"}], "2"], "2"], "+", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     SuperscriptBox["a", "2"], " ", 
     SuperscriptBox[
      OverscriptBox["\[Phi]", "."], "2"]}], "+", 
    FractionBox[
     RowBox[{"3", " ", 
      SuperscriptBox["a", "2"], " ", "H", " ", 
      OverscriptBox["\[Psi]", "."]}], 
     RowBox[{"4", " ", "Gnew", " ", "\[Pi]"}]]}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{"9", " ", 
      SuperscriptBox["a", "2"], " ", 
      SuperscriptBox["H", "2"]}], 
     RowBox[{"4", " ", "Gnew", " ", "\[Pi]"}]], "-", 
    RowBox[{"4", " ", 
     SuperscriptBox["a", "2"], " ", "V"}], "-", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"\[Del]", "\[Phi]"}], ")"}], "2"], "-", 
    RowBox[{"3", " ", 
     SuperscriptBox["a", "2"], " ", 
     SuperscriptBox[
      OverscriptBox["\[Phi]", "."], "2"]}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.6629116647907753`*^9, 3.662912468391817*^9, 
  3.662916458193151*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["0i components", "Subsubsection",
 CellChangeTimes->{{3.662844683432989*^9, 3.662844685192794*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Tdd", "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", "/.", " ", 
  "printrepl"}]], "Input",
 CellChangeTimes->{{3.662912850843449*^9, 3.662912886983438*^9}}],

Cell[BoxData[
 RowBox[{"dphi", " ", "xphi"}]], "Output",
 CellChangeTimes->{{3.662912859325769*^9, 3.662912887280281*^9}, 
   3.66291645994724*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Expand", "@", 
   RowBox[{"fullnice", "@", 
    RowBox[{"Edd", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], " ", "/.", " ", 
  "quadPsirepl"}]], "Input",
 CellChangeTimes->{{3.662912967045958*^9, 3.662913016186171*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", " ", "xdPsi"}], "+", 
  RowBox[{"2", " ", "H", " ", "xPsi"}]}]], "Output",
 CellChangeTimes->{{3.66291297217039*^9, 3.6629130163551598`*^9}, 
   3.662913251467265*^9, 3.662916460719722*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Expand", "[", 
  RowBox[{"fullnice", "@", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"einstein", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", "\[Equal]", " ", "0"}], 
    ")"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.662844852100308*^9, 3.662844950765876*^9}, {
  3.662845303191169*^9, 3.662845306943549*^9}, {3.662851481590166*^9, 
  3.662851504164876*^9}, {3.662851786619926*^9, 3.6628518039181423`*^9}, {
  3.662912318308612*^9, 3.662912318532426*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"xdPsi", "+", 
   RowBox[{"2", " ", "Psi", " ", "xdPsi"}], "+", 
   RowBox[{"dPsi", " ", "xPsi"}], "+", 
   RowBox[{"H", " ", "xPsi"}], "+", 
   RowBox[{"8", " ", "dPsi", " ", "Psi", " ", "xPsi"}], "-", 
   RowBox[{"2", " ", "H", " ", "Psi", " ", "xPsi"}]}], "\[Equal]", 
  RowBox[{
  "4", " ", "dphi", " ", "Gnew", " ", "\[Pi]", " ", "xphi"}]}]], "Output",
 CellChangeTimes->{{3.662844888201778*^9, 3.66284495120887*^9}, 
   3.662845307429389*^9, {3.662851470343027*^9, 3.662851507803363*^9}, 
   3.662851624601416*^9, {3.662851764997621*^9, 3.66285180447022*^9}, 
   3.6628518799276114`*^9, 3.662852570199247*^9, 3.662912197766724*^9, 
   3.66291231915035*^9, 3.662912471211574*^9, 3.662913253486395*^9, 
   3.662916461411975*^9}]
}, Open  ]],

Cell["check", "Text",
 CellChangeTimes->{{3.6629119051650953`*^9, 3.662911905452614*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Simplify", "[", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"einstein", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", "\[Equal]", " ", "0"}], 
      ")"}], " ", "/.", " ", "printrepl"}], ")"}], "]"}], " ", "/.", " ", 
  "oprepl"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Expand", "@", 
    RowBox[{"fullnice", "@", "%"}]}], " ", "/.", " ", "quadPsirepl"}], " ", "//",
   " ", "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.662911908649398*^9, 3.662911991185131*^9}, {
  3.66291216611639*^9, 3.6629121924349403`*^9}, {3.662912337043416*^9, 
  3.662912340050956*^9}, {3.662912545900371*^9, 3.6629125688257236`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"a", " ", "H", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"2", " ", "Psi"}]}], ")"}], "2"], " ", "xPsi"}], "+", 
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{"xdPsi", "-", 
         RowBox[{"4", " ", 
          SuperscriptBox["Psi", "2"], " ", "xdPsi"}], "+", 
         RowBox[{"dPsi", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"6", " ", "Psi"}]}], ")"}], " ", "xPsi"}]}], ")"}]}]}], 
     ")"}]}], 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"2", " ", "Psi"}]}], ")"}], "2"], " ", 
    RowBox[{"(", 
     RowBox[{"a", "+", 
      RowBox[{"2", " ", "a", " ", "Psi"}]}], ")"}]}]], "\[Equal]", 
  RowBox[{
  "8", " ", "dphi", " ", "Gnew", " ", "\[Pi]", " ", "xphi"}]}]], "Output",
 CellChangeTimes->{{3.662911927058467*^9, 3.6629119914516478`*^9}, {
   3.6629121686953087`*^9, 3.662912193409479*^9}, 3.662912340474284*^9, 
   3.66291249863763*^9, {3.662912548662695*^9, 3.6629125693149242`*^9}, 
   3.662913254553087*^9, 3.662916462602565*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"xdPsi", "+", 
   RowBox[{"H", " ", "xPsi"}]}], "\[Equal]", 
  RowBox[{
  "4", " ", "dphi", " ", "Gnew", " ", "\[Pi]", " ", "xphi"}]}]], "Output",
 CellChangeTimes->{{3.662911927058467*^9, 3.6629119914516478`*^9}, {
   3.6629121686953087`*^9, 3.662912193409479*^9}, 3.662912340474284*^9, 
   3.66291249863763*^9, {3.662912548662695*^9, 3.6629125693149242`*^9}, 
   3.662913254553087*^9, 3.662916462636628*^9}]
}, Open  ]],

Cell["check2", "Text",
 CellChangeTimes->{{3.6629122200793858`*^9, 3.662912220847054*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"(", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"fullnice", "@", 
      RowBox[{"Edd", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}]}], " ", "\[Equal]", " ", 
     RowBox[{"8", " ", "\[Pi]", " ", "Gnew", " ", 
      RowBox[{"Tdd", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], ")"}], " ", "/.", " ", 
   "printrepl"}], ")"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Expand", "@", 
    RowBox[{"fullnice", "@", "%"}]}], " ", "/.", " ", "quadPsirepl"}], " ", "//",
   " ", "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.662912230112905*^9, 3.6629123030302973`*^9}, {
  3.662912514675992*^9, 3.66291251602041*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", " ", 
   RowBox[{"(", 
    RowBox[{"xdPsi", "+", 
     RowBox[{"2", " ", "Psi", " ", "xdPsi"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"dPsi", "+", "H", "+", 
        RowBox[{"8", " ", "dPsi", " ", "Psi"}], "-", 
        RowBox[{"2", " ", "H", " ", "Psi"}]}], ")"}], " ", "xPsi"}]}], 
    ")"}]}], "\[Equal]", 
  RowBox[{
  "8", " ", "dphi", " ", "Gnew", " ", "\[Pi]", " ", "xphi"}]}]], "Output",
 CellChangeTimes->{{3.662912239982243*^9, 3.662912303437743*^9}, {
   3.66291250000333*^9, 3.6629125163310966`*^9}, 3.662912573790531*^9, 
   3.662913255743003*^9, 3.662916464844735*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"xdPsi", "+", 
   RowBox[{"H", " ", "xPsi"}]}], "\[Equal]", 
  RowBox[{
  "4", " ", "dphi", " ", "Gnew", " ", "\[Pi]", " ", "xphi"}]}]], "Output",
 CellChangeTimes->{{3.662912239982243*^9, 3.662912303437743*^9}, {
   3.66291250000333*^9, 3.6629125163310966`*^9}, 3.662912573790531*^9, 
   3.662913255743003*^9, 3.662916464847247*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["11 component", "Subsubsection",
 CellChangeTimes->{{3.662838666461183*^9, 3.662838669148559*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Expand", "[", 
    RowBox[{"fullnice", "@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"einstein", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "i"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", "4"}], "}"}]}], "]"}], " ", "\[Equal]", 
       " ", "0"}], ")"}]}], "]"}], " ", "/.", " ", "quadPsirepl"}], " ", "//",
   " ", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.66283868115659*^9, 3.662838689052863*^9}, {
  3.662838793206758*^9, 3.662838816661948*^9}, {3.662838879531052*^9, 
  3.662838891890024*^9}, {3.662838930591992*^9, 3.6628389763061533`*^9}, {
  3.662851908794909*^9, 3.662852031901939*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"4", " ", "Gnew", " ", 
    SuperscriptBox["gphi", "2"], " ", "\[Pi]"}], "+", 
   RowBox[{"6", " ", "a", " ", "dda", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"4", " ", "Psi"}]}], ")"}]}], "+", 
   RowBox[{"3", " ", 
    SuperscriptBox["a", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "ddPsi"}], "+", 
      RowBox[{"8", " ", "dPsi", " ", "H"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["H", "2"], "+", 
         RowBox[{"4", " ", 
          SuperscriptBox["dphi", "2"], " ", "Gnew", " ", "\[Pi]"}]}], ")"}], 
       " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"4", " ", "Psi"}]}], ")"}]}], "+", 
      RowBox[{"8", " ", "Gnew", " ", "\[Pi]", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"2", " ", "Psi"}]}], ")"}], " ", "V"}]}], ")"}]}]}], 
  "\[Equal]", "0"}]], "Output",
 CellChangeTimes->{{3.6628389507335997`*^9, 3.6628389767056637`*^9}, 
   3.662841088788989*^9, 3.662842811344705*^9, {3.662851890703116*^9, 
   3.662851919963339*^9}, {3.662851967804535*^9, 3.662852032461166*^9}, 
   3.662852571733755*^9, 3.662916468237691*^9}]
}, Open  ]],

Cell["check", "Text",
 CellChangeTimes->{{3.662914657644808*^9, 3.662914657995442*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"Tdd", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "i"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "2", ",", "4"}], "}"}]}], "]"}], " ", "/.", 
      "printrepl"}], ")"}], " ", "/.", " ", "oprepl"}], " ", "//", " ", 
   "Simplify"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Tspacesum", " ", "=", " ", 
  RowBox[{
   RowBox[{"Expand", "@", 
    RowBox[{"fullnice", "@", "%"}]}], " ", "/.", " ", 
   "quadPsirepl"}]}]}], "Input",
 CellChangeTimes->{{3.662915547685666*^9, 3.662915573005748*^9}, 
   3.6629156750331173`*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"3", " ", 
    SuperscriptBox["a", "2"], " ", 
    SuperscriptBox["dphi", "2"]}], "2"], "-", 
  FractionBox[
   SuperscriptBox["gphi", "2"], "2"], "-", 
  RowBox[{"6", " ", 
   SuperscriptBox["a", "2"], " ", 
   SuperscriptBox["dphi", "2"], " ", "Psi"}], "-", 
  RowBox[{"3", " ", 
   SuperscriptBox["a", "2"], " ", "V"}], "+", 
  RowBox[{"6", " ", 
   SuperscriptBox["a", "2"], " ", "Psi", " ", "V"}]}]], "Output",
 CellChangeTimes->{{3.662915548432954*^9, 3.662915573619638*^9}, 
   3.66291567560817*^9, 3.6629164695495577`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"Edd", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "i"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "2", ",", "4"}], "}"}]}], "]"}], " ", "/.", 
      "printrepl"}], ")"}], " ", "/.", " ", "oprepl"}], " ", "//", " ", 
   "Simplify"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Gspacesum", " ", "=", " ", 
  RowBox[{
   RowBox[{"Expand", "@", 
    RowBox[{"fullnice", "@", "%"}]}], " ", "/.", " ", 
   "quadPsirepl"}]}]}], "Input",
 CellChangeTimes->{{3.662915487793066*^9, 3.662915531984672*^9}, {
   3.662915575213893*^9, 3.6629155772297707`*^9}, 3.662915667440955*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "6"}], " ", "a", " ", "dda"}], "+", 
  RowBox[{"6", " ", 
   SuperscriptBox["a", "2"], " ", "ddPsi"}], "+", 
  RowBox[{"24", " ", 
   SuperscriptBox["a", "2"], " ", "dPsi", " ", "H"}], "-", 
  RowBox[{"3", " ", 
   SuperscriptBox["a", "2"], " ", 
   SuperscriptBox["H", "2"]}], "+", 
  RowBox[{"24", " ", "a", " ", "dda", " ", "Psi"}], "+", 
  RowBox[{"12", " ", 
   SuperscriptBox["a", "2"], " ", 
   SuperscriptBox["H", "2"], " ", "Psi"}]}]], "Output",
 CellChangeTimes->{{3.6629154901540937`*^9, 3.662915532441818*^9}, 
   3.662915577781536*^9, 3.662915668594832*^9, 3.662916470369801*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Gspacesum", " ", "\[Equal]", " ", 
   RowBox[{"8", " ", "\[Pi]", " ", "Gnew", " ", "Tspacesum"}]}], " ", "//", 
  " ", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.66291558004014*^9, 3.662915593204425*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"4", " ", "Gnew", " ", 
    SuperscriptBox["gphi", "2"], " ", "\[Pi]"}], "+", 
   RowBox[{"6", " ", "a", " ", "dda", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"4", " ", "Psi"}]}], ")"}]}], "+", 
   RowBox[{"3", " ", 
    SuperscriptBox["a", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "ddPsi"}], "+", 
      RowBox[{"8", " ", "dPsi", " ", "H"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["H", "2"], "+", 
         RowBox[{"4", " ", 
          SuperscriptBox["dphi", "2"], " ", "Gnew", " ", "\[Pi]"}]}], ")"}], 
       " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"4", " ", "Psi"}]}], ")"}]}], "+", 
      RowBox[{"8", " ", "Gnew", " ", "\[Pi]", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"2", " ", "Psi"}]}], ")"}], " ", "V"}]}], ")"}]}]}], 
  "\[Equal]", "0"}]], "Output",
 CellChangeTimes->{3.6629155944478083`*^9, 3.662915670720838*^9, 
  3.662916471088472*^9}]
}, Open  ]],

Cell["check 2", "Text",
 CellChangeTimes->{{3.662915610521109*^9, 3.662915613408506*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"einstein", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "i"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "2", ",", "4"}], "}"}]}], "]"}], " ", "\[Equal]",
         " ", "0"}], ")"}], " ", "/.", " ", "printrepl"}], ")"}], "]"}], " ", 
   "/.", " ", "oprepl"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Expand", "@", 
    RowBox[{"fullnice", "@", "%"}]}], " ", "/.", " ", "quadPsirepl"}], " ", "//",
   " ", "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.662915200537732*^9, 3.662915218899558*^9}, 
   3.662915666242989*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"4", " ", "Gnew", " ", 
    SuperscriptBox["gphi", "2"], " ", "\[Pi]"}], "+", 
   RowBox[{"6", " ", "a", " ", "dda", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"4", " ", "Psi"}]}], ")"}]}], "+", 
   RowBox[{"3", " ", 
    SuperscriptBox["a", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "ddPsi"}], "+", 
      RowBox[{"8", " ", "dPsi", " ", "H"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["H", "2"], "+", 
         RowBox[{"4", " ", 
          SuperscriptBox["dphi", "2"], " ", "Gnew", " ", "\[Pi]"}]}], ")"}], 
       " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"4", " ", "Psi"}]}], ")"}]}], "+", 
      RowBox[{"8", " ", "Gnew", " ", "\[Pi]", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"2", " ", "Psi"}]}], ")"}], " ", "V"}]}], ")"}]}]}], 
  "\[Equal]", "0"}]], "Output",
 CellChangeTimes->{3.662915189594696*^9, 3.6629154618630533`*^9, 
  3.662915672830235*^9, 3.662916472429555*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
compute the perturbed stress energy by subtracting background\
\>", "Subsection",
 CellChangeTimes->{{3.662837336319007*^9, 3.662837348358368*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"rhoeq", " ", "=", " ", 
   RowBox[{"rho", " ", "\[Equal]", "  ", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"TUU", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], 
      RowBox[{"gUU", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}]]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"fullnice", "@", 
     RowBox[{"(", 
      RowBox[{"rho", " ", "/.", " ", 
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{"fullnice", "@", "rhoeq"}], ",", "rho"}], "]"}]}], ")"}]}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"dphi", ",", " ", 
      SuperscriptBox["gphi", "2"], ",", "V"}], "}"}]}], "]"}], " ", "//.", 
  "mathrepl"}]}], "Input",
 CellChangeTimes->{{3.662743545909696*^9, 3.6627436160062323`*^9}, {
  3.6627579379828987`*^9, 3.662757988087451*^9}, {3.662762138828431*^9, 
  3.662762139356111*^9}, {3.662762171262698*^9, 3.662762252633892*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"V", "+", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"2", " ", "\[Psi]"}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"\[Del]", "\[Phi]"}], ")"}], "2"]}], 
    RowBox[{"2", " ", 
     SuperscriptBox["a", "2"]}]], "+", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"2", " ", "\[Psi]"}]}], ")"}], " ", 
    SuperscriptBox[
     OverscriptBox["\[Phi]", "."], "2"]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.662743584037521*^9, 3.662743616351469*^9}, 
   3.662744443100094*^9, 3.6627450954008017`*^9, 3.662748800621792*^9, 
   3.6627528802539167`*^9, {3.662757938418261*^9, 3.662757945781913*^9}, 
   3.662757988327489*^9, 3.662758047334311*^9, 3.6627585083181543`*^9, {
   3.662762140237484*^9, 3.662762253352045*^9}, 3.6627631362145844`*^9, 
   3.662837351255205*^9, 3.662841114593178*^9, 3.6628505410311537`*^9, 
   3.662852573941716*^9, 3.6629157567638617`*^9, 3.6629164797716503`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    RowBox[{"gUU", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1"}], "]"}], "]"}]}], " ", 
   RowBox[{"gdd", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}]}], " ", "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.6627449839595947`*^9, 3.662745002802326*^9}, {
  3.662745172948123*^9, 3.662745190875626*^9}, {3.662748813600501*^9, 
  3.66274881400038*^9}}],

Cell[BoxData[
 RowBox[{"-", "1"}]], "Output",
 CellChangeTimes->{{3.6627449938599863`*^9, 3.662745003132964*^9}, 
   3.6627451403904676`*^9, 3.662745191286292*^9, {3.662748804356111*^9, 
   3.6627488145238333`*^9}, 3.662758057676618*^9, 3.66275852232537*^9, 
   3.662762259331847*^9, 3.6627631373619337`*^9, 3.6628373521443233`*^9, 
   3.662841115981524*^9, 3.6628505424851503`*^9, 3.6628525750862017`*^9, 
   3.662915758027396*^9, 3.662916492840131*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TU0d0bar", " ", "=", " ", 
  RowBox[{
   RowBox[{"fullnice", "@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", " ", 
       RowBox[{"gdd", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], " ", 
      RowBox[{"gUU", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "rhobar"}], ")"}]}], "//",
    " ", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.6627622817199993`*^9, 3.66276239435714*^9}}],

Cell[BoxData[
 RowBox[{"-", "rhobar"}]], "Output",
 CellChangeTimes->{{3.662762365974269*^9, 3.662762394914197*^9}, 
   3.6627631383264513`*^9, 3.66283735265718*^9, 3.6628411402155*^9, 
   3.66285054318509*^9, 3.6628525761023493`*^9, 3.662915758605898*^9, 
   3.6629165038295317`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"delTU0d0", " ", "=", " ", 
   RowBox[{
    RowBox[{"TUd", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "-", " ", "TU0d0bar"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fullnice", "@", "delTU0d0"}], " ", "/.", " ", 
  "mathrepl"}]}], "Input",
 CellChangeTimes->{{3.66163080643683*^9, 3.661630814199485*^9}, {
   3.661811146371718*^9, 3.661811147954337*^9}, {3.6618111836258717`*^9, 
   3.6618112192550907`*^9}, {3.662744261299913*^9, 3.662744262539584*^9}, {
   3.6627452319873247`*^9, 3.6627452337712603`*^9}, {3.662745299577922*^9, 
   3.662745331968676*^9}, {3.662745973109149*^9, 3.66274597316857*^9}, {
   3.662746065148644*^9, 3.662746072931921*^9}, {3.662758065494596*^9, 
   3.662758069846237*^9}, {3.6627621130404587`*^9, 3.6627621226241207`*^9}, {
   3.6627622685522013`*^9, 3.6627622771672792`*^9}, {3.662762404892385*^9, 
   3.6627624116278267`*^9}, 3.662850772568591*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "V"}], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"2", " ", "\[Psi]"}]}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"\[Del]", "\[Phi]"}], ")"}], "2"]}], 
   RowBox[{"2", " ", 
    SuperscriptBox["a", "2"]}]], "+", 
  OverscriptBox["\[Rho]", "_"], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "2"]}], "+", "\[Psi]"}], ")"}], " ", 
   SuperscriptBox[
    OverscriptBox["\[Phi]", "."], "2"]}]}]], "Output",
 CellChangeTimes->{
  3.6617939475101137`*^9, 3.661800498290098*^9, 3.6618066779899178`*^9, 
   3.661807384715397*^9, 3.661807440604303*^9, {3.6618111795694427`*^9, 
   3.661811219738153*^9}, 3.662742641245392*^9, 3.662745234965672*^9, {
   3.662745307832551*^9, 3.6627453322004747`*^9}, 3.662745975737452*^9, {
   3.662746057084778*^9, 3.662746102091341*^9}, 3.66274881803074*^9, {
   3.662758065936771*^9, 3.662758070253277*^9}, 3.662758258341201*^9, 
   3.662758471028612*^9, 3.662758530036748*^9, 3.662761670313796*^9, {
   3.662762098755374*^9, 3.662762123985456*^9}, 3.662762411991742*^9, 
   3.662763139294332*^9, 3.66283735316044*^9, 3.662841144451611*^9, 
   3.662850544169145*^9, 3.662850773077409*^9, 3.6628525768355417`*^9, 
   3.662915759172412*^9, 3.6629165143879766`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Td0d0bar", " ", "=", " ", 
  RowBox[{
   RowBox[{"fullnice", "@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"gdd", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], " ", "rhobar"}], ")"}]}], 
   " ", "//", " ", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.662850680220354*^9, 3.6628507100178823`*^9}}],

Cell[BoxData[
 RowBox[{"rhobar", "+", 
  RowBox[{"2", " ", "Psi", " ", "rhobar"}]}]], "Output",
 CellChangeTimes->{3.6628507104661922`*^9, 3.6628507748771257`*^9, 
  3.662852577859168*^9, 3.6629157598224382`*^9, 3.662916515518927*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"delTd0d0", " ", "=", " ", 
   RowBox[{
    RowBox[{"Tdd", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "-", " ", "Td0d0bar"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fullnice", "@", "delTd0d0"}], " ", "/.", " ", 
  "mathrepl"}]}], "Input",
 CellChangeTimes->{{3.662850570808607*^9, 3.6628505750261183`*^9}, {
  3.6628506549649057`*^9, 3.662850668308735*^9}, {3.662850718456582*^9, 
  3.66285075952274*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"4", " ", "\[Psi]"}]}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"\[Del]", "\[Phi]"}], ")"}], "2"]}], "+", 
   RowBox[{
    SuperscriptBox["a", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"2", " ", "\[Psi]"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "V"}], "+", 
         OverscriptBox["\[Rho]", "_"]}], ")"}]}], "+", 
      SuperscriptBox[
       OverscriptBox["\[Phi]", "."], "2"]}], ")"}]}]}], 
  RowBox[{"2", " ", 
   SuperscriptBox["a", "2"]}]]], "Output",
 CellChangeTimes->{{3.662850755008911*^9, 3.6628507757440243`*^9}, 
   3.662852578636146*^9, 3.6629157603439817`*^9, 3.662916516325583*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["perturbed einstein tensor", "Subsection",
 CellChangeTimes->{{3.662828783861096*^9, 3.662828794123268*^9}, {
  3.662835609040531*^9, 3.662835611736215*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"g0dd", " ", "=", " ", 
   RowBox[{
    RowBox[{"gdd", " ", "/.", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Psi", "[", 
        RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
       " ", "0"}], "}"}]}], " ", "//", " ", "Simplify"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6628286001220083`*^9, 3.662828632123192*^9}, 
   3.662850908592029*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"g0UU", " ", "=", " ", 
   RowBox[{
    RowBox[{"1", "/", "g0dd"}], " ", "/.", " ", 
    RowBox[{"ComplexInfinity", "\[Rule]", " ", "0"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6628286387276907`*^9, 3.662828683115971*^9}, 
   3.662850910719558*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"g0dd", ".", "g0UU"}]], "Input",
 CellChangeTimes->{{3.6628509005775337`*^9, 3.6628509032154408`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6628509044959173`*^9, 3.662850912162225*^9}, 
   3.6628525816832323`*^9, 3.662915763230743*^9, 3.6629165209002123`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"delgdd", " ", "=", " ", 
   RowBox[{
    RowBox[{"gdd", " ", "-", " ", "g0dd"}], " ", "//", " ", "Simplify"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6628286889232273`*^9, 3.6628287085207653`*^9}, 
   3.662850914655305*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"delgUU", " ", "=", " ", 
   RowBox[{
    RowBox[{"gUU", " ", "-", " ", "g0UU"}], " ", "//", " ", "Simplify"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.662828730069447*^9, 3.6628287519124317`*^9}, 
   3.6628509163590527`*^9}],

Cell["check", "Text",
 CellChangeTimes->{{3.6629167238787117`*^9, 3.6629167265519037`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"delgUU", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "\[Equal]", " ", 
   RowBox[{
    RowBox[{"-", " ", 
     SuperscriptBox[
      RowBox[{"gUU", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], "2"]}], " ", 
    RowBox[{"delgdd", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], " ", "//", " ", 
  "fullnice"}]], "Input",
 CellChangeTimes->{{3.6629167284407263`*^9, 3.6629167824358673`*^9}, {
  3.662916991735115*^9, 3.662916994318287*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.662916757484515*^9, 3.6629167827756033`*^9}, 
   3.66291699463325*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"hdd", " ", "=", " ", "delgdd"}], ";"}]], "Input",
 CellChangeTimes->{{3.662832098969548*^9, 3.6628321047584467`*^9}, 
   3.6628509403416767`*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"delRd0d0", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      FractionBox["1", 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"a", "[", "t", "]"}], "2"]}]], " ", 
      RowBox[{"Laplacian", "[", 
       RowBox[{"hdd", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}]}], " ", "+", " ", 
     RowBox[{
      FractionBox["3", "2"], " ", 
      FractionBox[
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"a", "[", "t", "]"}], ",", "t"}], "]"}], 
       RowBox[{"a", "[", "t", "]"}]], " ", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"hdd", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "t"}], "]"}]}], " ", 
     "+", " ", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"a", "[", "t", "]"}], "2"]}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"hdd", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "i"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "2"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "2", ",", "4"}], "}"}]}], "]"}], " ", "-", " ", 
        RowBox[{"2", " ", 
         FractionBox[
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"a", "[", "t", "]"}], ",", "t"}], "]"}], 
          RowBox[{"a", "[", "t", "]"}]], " ", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"hdd", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "i"}], "]"}], "]"}], ",", "t"}], "]"}], ",", 
           
           RowBox[{"{", 
            RowBox[{"i", ",", "2", ",", "4"}], "}"}]}], "]"}]}], " ", "+", 
        " ", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            SuperscriptBox[
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"a", "[", "t", "]"}], ",", "t"}], "]"}], "2"], 
            SuperscriptBox[
             RowBox[{"a", "[", "t", "]"}], "2"]], "-", 
           FractionBox[
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"a", "[", "t", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"t", ",", "2"}], "}"}]}], "]"}], 
            RowBox[{"a", "[", "t", "]"}]]}], ")"}], " ", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"hdd", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "i"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "2", ",", "4"}], "}"}]}], "]"}]}]}], ")"}]}]}], 
    " ", "//", " ", "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"delRd0d0", " ", "/.", " ", "printrepl"}], ")"}], " ", "/.", " ", 
   "oprepl"}], " ", "//", " ", "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.662832205930285*^9, 3.662832455255748*^9}, {
   3.662832714255979*^9, 3.662832852260991*^9}, {3.662832945800969*^9, 
   3.662832970370872*^9}, 3.662833956905594*^9, {3.662842887751902*^9, 
   3.662842921717724*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    RowBox[{"-", "3"}], " ", 
    SuperscriptBox["a", "4"], " ", 
    RowBox[{"(", 
     RowBox[{"ddPsi", "+", 
      RowBox[{"3", " ", "dPsi", " ", "H"}]}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"4", " ", 
        SuperscriptBox["Psi", "2"]}]}], ")"}], "2"]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"2", " ", "Psi"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"4", " ", 
       SuperscriptBox["gPsi", "2"], " ", "Psi"}], "+", 
      RowBox[{"lPsi", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"4", " ", 
          SuperscriptBox["Psi", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
   RowBox[{
    SuperscriptBox["a", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"2", " ", "Psi"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "ddPsi"}], "+", 
      RowBox[{"4", " ", 
       RowBox[{"(", 
        RowBox[{"ddPsi", "+", 
         RowBox[{"3", " ", "dPsi", " ", "H"}]}], ")"}], " ", 
       SuperscriptBox["Psi", "2"]}], "+", 
      RowBox[{"dPsi", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "3"}], " ", "H"}], "+", 
         RowBox[{"4", " ", "dPsi", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "Psi"}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
  RowBox[{
   SuperscriptBox["a", "4"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"4", " ", 
       SuperscriptBox["Psi", "2"]}]}], ")"}], "2"]}]]], "Output",
 CellChangeTimes->{{3.662832823845142*^9, 3.662832853084094*^9}, {
   3.662832950993417*^9, 3.6628329706439543`*^9}, 3.6628339572330217`*^9, 
   3.662841303954865*^9, 3.6628428355864773`*^9, 3.6628429502022142`*^9, 
   3.662850447519423*^9, 3.662850942728744*^9, 3.6628525841001997`*^9, 
   3.6629157674747343`*^9, 3.6629170341079187`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"delRd1d1", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "2"]}], " ", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"hdd", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "2"}], "}"}]}], "]"}]}], " ", "-", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"a", "[", "t", "]"}], ",", "t"}], "]"}], "2"]}], " ", "+",
         " ", 
        RowBox[{
         RowBox[{"a", "[", "t", "]"}], " ", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"a", "[", "t", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "2"}], "}"}]}], "]"}]}]}], ")"}], " ", 
      RowBox[{"hdd", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}]}], " ", "-", " ", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"a", "[", "t", "]"}], " ", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"a", "[", "t", "]"}], ",", "t"}], "]"}], " ", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"hdd", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "t"}], "]"}]}], " ", 
     "+", " ", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"a", "[", "t", "]"}], "2"]}]], " ", 
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"Laplacian", "[", 
         RowBox[{"hdd", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}], "]"}], " ", "-", " ", 
        RowBox[{"2", " ", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"hdd", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", "x"}], "]"}], 
             ",", 
             RowBox[{"coords", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "2", ",", "4"}], "}"}]}], "]"}]}], " ", "+", 
        " ", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"hdd", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "i"}], "]"}], "]"}], ",", "x"}], "]"}], ",",
             "x"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "2", ",", "4"}], "}"}]}], "]"}]}], ")"}]}], " ", 
     "-", " ", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"hdd", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "2"}], "}"}]}], "]"}]}], " ", "+", " ", 
     RowBox[{
      FractionBox[
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"a", "[", "t", "]"}], ",", "t"}], "]"}], 
       RowBox[{"2", " ", 
        RowBox[{"a", "[", "t", "]"}]}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"hdd", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", "t"}], "]"}], " ", 
        "-", " ", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"hdd", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "i"}], "]"}], "]"}], ",", "t"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "2", ",", "4"}], "}"}]}], "]"}]}], ")"}]}], " ", 
     "+", " ", 
     RowBox[{
      FractionBox[
       SuperscriptBox[
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"a", "[", "t", "]"}], ",", "t"}], "]"}], "2"], 
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", " ", "2"}], " ", 
         RowBox[{"hdd", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}]}], " ", "+", " ", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"hdd", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "i"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "2", ",", "4"}], "}"}]}], "]"}]}], ")"}]}]}], 
    " ", "//", " ", "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"delRd1d1", " ", "/.", " ", "printrepl"}], ")"}], " ", "/.", " ", 
   "oprepl"}], " ", "//", " ", "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.662832990711499*^9, 3.662833328973629*^9}, {
  3.662833360022496*^9, 3.662833558985722*^9}, {3.662833618597446*^9, 
  3.662833620285187*^9}, {3.662833663993142*^9, 3.662833671024334*^9}, {
  3.6628337092053843`*^9, 3.6628337296962*^9}, {3.662833937576158*^9, 
  3.662833943459455*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"a", "-", 
      RowBox[{"4", " ", "a", " ", 
       SuperscriptBox["Psi", "2"]}]}], ")"}], "2"]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"2", " ", "a", " ", "dda", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", " ", "Psi"}]}], ")"}], "2"], " ", "Psi", " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"2", " ", "Psi"}]}], ")"}]}], "+", 
    RowBox[{"4", " ", 
     SuperscriptBox["a", "3"], " ", "dda", " ", "Psi", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"4", " ", 
         SuperscriptBox["Psi", "2"]}]}], ")"}], "2"]}], "+", 
    RowBox[{
     SuperscriptBox["a", "4"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"4", " ", 
         SuperscriptBox["Psi", "2"]}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{"ddPsi", "+", 
       RowBox[{"H", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"7", " ", "dPsi"}], "+", 
          RowBox[{"8", " ", "H", " ", "Psi"}]}], ")"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"2", " ", "Psi"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"4", " ", 
        SuperscriptBox["gPsi", "2"], " ", "Psi"}], "+", 
       RowBox[{"lPsi", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["Psi", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox["a", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"2", " ", "Psi"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"4", " ", 
        SuperscriptBox["dPsi", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "Psi"}], ")"}]}], "+", 
       RowBox[{"ddPsi", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["Psi", "2"]}]}], ")"}]}], "+", 
       RowBox[{"8", " ", 
        SuperscriptBox["H", "2"], " ", "Psi", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["Psi", "2"]}]}], ")"}]}], "+", 
       RowBox[{"dPsi", " ", "H", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "7"}], "+", 
          RowBox[{"4", " ", "Psi", " ", 
           RowBox[{"(", 
            RowBox[{"2", "+", 
             RowBox[{"9", " ", "Psi"}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{{3.662833714385233*^9, 3.662833730307898*^9}, {
   3.662833938099081*^9, 3.662833944297701*^9}, 3.6628413107020683`*^9, 
   3.662842956447257*^9, 3.662850448558136*^9, 3.6628525866559153`*^9, 
   3.662915768733302*^9, 3.6629170364813147`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"delRd2d2", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "2"]}], " ", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"hdd", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"y", ",", "2"}], "}"}]}], "]"}]}], " ", "-", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"a", "[", "t", "]"}], ",", "t"}], "]"}], "2"]}], " ", "+",
         " ", 
        RowBox[{
         RowBox[{"a", "[", "t", "]"}], " ", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"a", "[", "t", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "2"}], "}"}]}], "]"}]}]}], ")"}], " ", 
      RowBox[{"hdd", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}]}], " ", "-", " ", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"a", "[", "t", "]"}], " ", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"a", "[", "t", "]"}], ",", "t"}], "]"}], " ", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"hdd", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "t"}], "]"}]}], " ", 
     "+", " ", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"a", "[", "t", "]"}], "2"]}]], " ", 
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"Laplacian", "[", 
         RowBox[{"hdd", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "3"}], "]"}], "]"}], "]"}], " ", "-", " ", 
        RowBox[{"2", " ", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"hdd", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "3"}], "]"}], "]"}], ",", "y"}], "]"}], 
             ",", 
             RowBox[{"coords", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "2", ",", "4"}], "}"}]}], "]"}]}], " ", "+", 
        " ", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"hdd", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "i"}], "]"}], "]"}], ",", "y"}], "]"}], ",",
             "y"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "2", ",", "4"}], "}"}]}], "]"}]}], ")"}]}], " ", 
     "-", " ", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"hdd", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "3"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "2"}], "}"}]}], "]"}]}], " ", "+", " ", 
     RowBox[{
      FractionBox[
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"a", "[", "t", "]"}], ",", "t"}], "]"}], 
       RowBox[{"2", " ", 
        RowBox[{"a", "[", "t", "]"}]}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"hdd", "[", 
           RowBox[{"[", 
            RowBox[{"3", ",", "3"}], "]"}], "]"}], ",", "t"}], "]"}], " ", 
        "-", " ", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"hdd", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "i"}], "]"}], "]"}], ",", "t"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "2", ",", "4"}], "}"}]}], "]"}]}], ")"}]}], " ", 
     "+", " ", 
     RowBox[{
      FractionBox[
       SuperscriptBox[
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"a", "[", "t", "]"}], ",", "t"}], "]"}], "2"], 
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", " ", "2"}], " ", 
         RowBox[{"hdd", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "3"}], "]"}], "]"}]}], " ", "+", " ", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"hdd", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "i"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "2", ",", "4"}], "}"}]}], "]"}]}], ")"}]}]}], 
    " ", "//", " ", "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"delRd2d2", " ", "/.", " ", "printrepl"}], ")"}], " ", "/.", " ", 
   "oprepl"}], " ", "//", " ", "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.662833779573344*^9, 3.6628338708930607`*^9}, {
  3.6628339350962954`*^9, 3.662833947079002*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"a", "-", 
      RowBox[{"4", " ", "a", " ", 
       SuperscriptBox["Psi", "2"]}]}], ")"}], "2"]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"2", " ", "a", " ", "dda", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", " ", "Psi"}]}], ")"}], "2"], " ", "Psi", " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"2", " ", "Psi"}]}], ")"}]}], "+", 
    RowBox[{"4", " ", 
     SuperscriptBox["a", "3"], " ", "dda", " ", "Psi", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"4", " ", 
         SuperscriptBox["Psi", "2"]}]}], ")"}], "2"]}], "+", 
    RowBox[{
     SuperscriptBox["a", "4"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"4", " ", 
         SuperscriptBox["Psi", "2"]}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{"ddPsi", "+", 
       RowBox[{"H", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"7", " ", "dPsi"}], "+", 
          RowBox[{"8", " ", "H", " ", "Psi"}]}], ")"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"2", " ", "Psi"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"4", " ", 
        SuperscriptBox["gPsi", "2"], " ", "Psi"}], "+", 
       RowBox[{"lPsi", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["Psi", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox["a", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"2", " ", "Psi"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"4", " ", 
        SuperscriptBox["dPsi", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "Psi"}], ")"}]}], "+", 
       RowBox[{"ddPsi", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["Psi", "2"]}]}], ")"}]}], "+", 
       RowBox[{"8", " ", 
        SuperscriptBox["H", "2"], " ", "Psi", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["Psi", "2"]}]}], ")"}]}], "+", 
       RowBox[{"dPsi", " ", "H", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "7"}], "+", 
          RowBox[{"4", " ", "Psi", " ", 
           RowBox[{"(", 
            RowBox[{"2", "+", 
             RowBox[{"9", " ", "Psi"}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{{3.66283386435966*^9, 3.6628338716235857`*^9}, 
   3.66283395176503*^9, 3.66284131266953*^9, 3.6628429576135197`*^9, 
   3.662850449343623*^9, 3.6628525876214848`*^9, 3.662915768861988*^9, 
   3.662917036611422*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"delRd3d3", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "2"]}], " ", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"hdd", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"z", ",", "2"}], "}"}]}], "]"}]}], " ", "-", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"a", "[", "t", "]"}], ",", "t"}], "]"}], "2"]}], " ", "+",
         " ", 
        RowBox[{
         RowBox[{"a", "[", "t", "]"}], " ", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"a", "[", "t", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "2"}], "}"}]}], "]"}]}]}], ")"}], " ", 
      RowBox[{"hdd", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}]}], " ", "-", " ", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"a", "[", "t", "]"}], " ", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"a", "[", "t", "]"}], ",", "t"}], "]"}], " ", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"hdd", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "t"}], "]"}]}], " ", 
     "+", " ", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"a", "[", "t", "]"}], "2"]}]], " ", 
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"Laplacian", "[", 
         RowBox[{"hdd", "[", 
          RowBox[{"[", 
           RowBox[{"4", ",", "4"}], "]"}], "]"}], "]"}], " ", "-", " ", 
        RowBox[{"2", " ", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"hdd", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "4"}], "]"}], "]"}], ",", "z"}], "]"}], 
             ",", 
             RowBox[{"coords", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "2", ",", "4"}], "}"}]}], "]"}]}], " ", "+", 
        " ", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"hdd", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "i"}], "]"}], "]"}], ",", "z"}], "]"}], ",",
             "z"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "2", ",", "4"}], "}"}]}], "]"}]}], ")"}]}], " ", 
     "-", " ", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"hdd", "[", 
         RowBox[{"[", 
          RowBox[{"4", ",", "4"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "2"}], "}"}]}], "]"}]}], " ", "+", " ", 
     RowBox[{
      FractionBox[
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"a", "[", "t", "]"}], ",", "t"}], "]"}], 
       RowBox[{"2", " ", 
        RowBox[{"a", "[", "t", "]"}]}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"hdd", "[", 
           RowBox[{"[", 
            RowBox[{"4", ",", "4"}], "]"}], "]"}], ",", "t"}], "]"}], " ", 
        "-", " ", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"hdd", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "i"}], "]"}], "]"}], ",", "t"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "2", ",", "4"}], "}"}]}], "]"}]}], ")"}]}], " ", 
     "+", " ", 
     RowBox[{
      FractionBox[
       SuperscriptBox[
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"a", "[", "t", "]"}], ",", "t"}], "]"}], "2"], 
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", " ", "2"}], " ", 
         RowBox[{"hdd", "[", 
          RowBox[{"[", 
           RowBox[{"4", ",", "4"}], "]"}], "]"}]}], " ", "+", " ", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"hdd", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "i"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "2", ",", "4"}], "}"}]}], "]"}]}], ")"}]}]}], 
    " ", "//", " ", "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"delRd3d3", " ", "/.", " ", "printrepl"}], ")"}], " ", "/.", " ", 
   "oprepl"}], " ", "//", " ", "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.662833885839982*^9, 3.6628339498548317`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"a", "-", 
      RowBox[{"4", " ", "a", " ", 
       SuperscriptBox["Psi", "2"]}]}], ")"}], "2"]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"2", " ", "a", " ", "dda", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", " ", "Psi"}]}], ")"}], "2"], " ", "Psi", " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"2", " ", "Psi"}]}], ")"}]}], "+", 
    RowBox[{"4", " ", 
     SuperscriptBox["a", "3"], " ", "dda", " ", "Psi", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"4", " ", 
         SuperscriptBox["Psi", "2"]}]}], ")"}], "2"]}], "+", 
    RowBox[{
     SuperscriptBox["a", "4"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"4", " ", 
         SuperscriptBox["Psi", "2"]}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{"ddPsi", "+", 
       RowBox[{"H", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"7", " ", "dPsi"}], "+", 
          RowBox[{"8", " ", "H", " ", "Psi"}]}], ")"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"2", " ", "Psi"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"4", " ", 
        SuperscriptBox["gPsi", "2"], " ", "Psi"}], "+", 
       RowBox[{"lPsi", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["Psi", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox["a", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"2", " ", "Psi"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"4", " ", 
        SuperscriptBox["dPsi", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "Psi"}], ")"}]}], "+", 
       RowBox[{"ddPsi", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["Psi", "2"]}]}], ")"}]}], "+", 
       RowBox[{"8", " ", 
        SuperscriptBox["H", "2"], " ", "Psi", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["Psi", "2"]}]}], ")"}]}], "+", 
       RowBox[{"dPsi", " ", "H", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "7"}], "+", 
          RowBox[{"4", " ", "Psi", " ", 
           RowBox[{"(", 
            RowBox[{"2", "+", 
             RowBox[{"9", " ", "Psi"}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{{3.662833929466352*^9, 3.662833950274877*^9}, 
   3.6628413153203506`*^9, 3.662842959381081*^9, 3.66285045014924*^9, 
   3.662852588375553*^9, 3.662915770396019*^9, 3.6629170380539703`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"delRd1d1", " ", "\[Equal]", " ", "delRd2d2"}], " ", "//", " ", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"delRd1d1", " ", "\[Equal]", " ", "delRd3d3"}], " ", "//", " ", 
  "Simplify"}]}], "Input",
 CellChangeTimes->{{3.662833960794265*^9, 3.662833986683981*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.66283396889907*^9, 3.662833987117696*^9}, 
   3.662841317102336*^9, 3.662842960912754*^9, 3.662850451041936*^9, 
   3.662852590130868*^9, 3.66291577130759*^9, 3.662917039488401*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.66283396889907*^9, 3.662833987117696*^9}, 
   3.662841317102336*^9, 3.662842960912754*^9, 3.662850451041936*^9, 
   3.662852590130868*^9, 3.66291577130759*^9, 3.6629170394904222`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"delRdd", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"delRd0d0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "delRd1d1", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "delRd2d2", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "delRd3d3"}], "}"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6628339960016737`*^9, 3.6628340337309103`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"delR", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Contract", "[", 
      RowBox[{
       RowBox[{"Outer", "[", 
        RowBox[{"Times", ",", "delgUU", ",", "Rdd"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "4"}], "}"}]}], "]"}], " ", "+", " ", 
     RowBox[{"Contract", "[", 
      RowBox[{
       RowBox[{"Raise", "[", 
        RowBox[{"delRdd", ",", "1"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], " ", "//", " ", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"delR", " ", "/.", " ", "printrepl"}], ")"}], " ", "/.", " ", 
   "oprepl"}], " ", "//", " ", "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.6628340475241623`*^9, 3.662834108462454*^9}, {
  3.662834208128641*^9, 3.662834233343232*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   FractionBox["1", 
    RowBox[{
     SuperscriptBox["a", "4"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"4", " ", 
         SuperscriptBox["Psi", "2"]}]}], ")"}], "3"]}]], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"6", " ", "dda", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"2", " ", "Psi"}]}], ")"}], "2"], " ", "Psi", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"a", "+", 
          RowBox[{"2", " ", "a", " ", "Psi"}]}], ")"}], "3"]}], "+", 
      RowBox[{"3", " ", "a", " ", "dda", " ", "Psi", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"4", " ", 
           SuperscriptBox["Psi", "2"]}]}], ")"}], "2"]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"6", " ", "Psi"}], "+", 
         RowBox[{"8", " ", 
          SuperscriptBox["Psi", "2"]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"4", " ", 
          SuperscriptBox["gPsi", "2"], " ", "Psi"}], "+", 
         RowBox[{"lPsi", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"4", " ", 
             SuperscriptBox["Psi", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
      RowBox[{"3", " ", 
       SuperscriptBox["a", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"2", " ", "Psi"}]}], ")"}], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"2", " ", "Psi"}]}], ")"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", 
          SuperscriptBox["dPsi", "2"], " ", "Psi"}], "+", 
         RowBox[{"ddPsi", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", "Psi"}]}], ")"}]}], "+", 
         RowBox[{"5", " ", "dPsi", " ", "H", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", "Psi"}]}], ")"}]}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["H", "2"], " ", "Psi", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "3"}], "+", 
            RowBox[{"4", " ", "Psi", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", "Psi"}], ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"4", " ", 
          SuperscriptBox["dPsi", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "Psi"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", "Psi"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"4", " ", "Psi"}]}], ")"}]}], "+", 
         RowBox[{"ddPsi", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"2", " ", "Psi"}]}], ")"}], "2"], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"6", " ", "Psi"}], "+", 
            RowBox[{"8", " ", 
             SuperscriptBox["Psi", "2"]}]}], ")"}]}], "+", 
         RowBox[{"3", " ", "dPsi", " ", "H", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", "Psi"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"2", " ", "Psi"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "3"}], "+", 
            RowBox[{"2", " ", "Psi"}], "+", 
            RowBox[{"20", " ", 
             SuperscriptBox["Psi", "2"]}]}], ")"}]}], "+", 
         RowBox[{"2", " ", "Psi", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"2", " ", "Psi"}]}], ")"}], "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["gPsi", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"3", "+", 
               RowBox[{"6", " ", "Psi"}]}], ")"}]}], "-", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"2", " ", "Psi"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"lPsi", "+", 
               RowBox[{
                SuperscriptBox["H", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{"3", "-", 
                  RowBox[{"6", " ", "Psi"}]}], ")"}]}], "+", 
               RowBox[{"2", " ", "lPsi", " ", "Psi"}]}], ")"}]}]}], ")"}]}]}],
         ")"}]}]}], ")"}]}]}]}]], "Output",
 CellChangeTimes->{
  3.6628341091916933`*^9, {3.662834213844461*^9, 3.662834233629496*^9}, 
   3.662841331741221*^9, 3.6628429688444653`*^9, 3.662850453414235*^9, 
   3.662852596685473*^9, 3.662853079294394*^9, 3.6629157782337933`*^9, 
   3.662917046579398*^9}]
}, Open  ]],

Cell["check", "Text",
 CellChangeTimes->{{3.6628430821588373`*^9, 3.662843082462438*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Contract", "[", 
    RowBox[{
     RowBox[{"Raise", "[", 
      RowBox[{"delRdd", ",", "1"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], "]"}], " ", "\[Equal]", " ", 
   RowBox[{"Tr", "[", 
    RowBox[{"gUU", ".", "delRdd"}], "]"}]}], " ", "//", " ", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.6628430846012917`*^9, 3.6628431161676807`*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.662843107169938*^9, 3.6628431174266243`*^9}, 
   3.662850455021266*^9, 3.662852598481786*^9, 3.6628530816056004`*^9, 
   3.6629157809841833`*^9, 3.662917046832158*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"delGd0d0", " ", "=", " ", 
   RowBox[{
    RowBox[{"delRd0d0", " ", "-", " ", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"delgdd", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "R"}], " ", "-", " ", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"gdd", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "delR"}]}], " ", "//", 
    " ", "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Expand", "@", 
   RowBox[{"fullnice", "@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"fullnice", "@", "delGd0d0"}], " ", "/.", " ", "quadPsirepl"}], 
     ")"}]}]}], " ", "/.", " ", "quadPsirepl"}]}], "Input",
 CellChangeTimes->{{3.662834245861018*^9, 3.662834264449923*^9}, {
  3.662834382818123*^9, 3.6628344409335127`*^9}, {3.662834571862228*^9, 
  3.6628346682144747`*^9}, {3.6628413770428057`*^9, 3.662841421444656*^9}, {
  3.662843336618699*^9, 3.662843336906989*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"2", " ", "ddPsi"}], 
   SuperscriptBox["a", "2"]], "+", 
  RowBox[{"6", " ", "dPsi", " ", "H"}], "+", 
  FractionBox[
   RowBox[{"12", " ", "dPsi", " ", "H"}], 
   SuperscriptBox["a", "2"]], "-", 
  FractionBox[
   RowBox[{"2", " ", "lPsi"}], 
   SuperscriptBox["a", "4"]], "+", 
  FractionBox[
   RowBox[{"3", " ", "dda", " ", "Psi"}], 
   SuperscriptBox["a", "3"]], "+", 
  FractionBox[
   RowBox[{"12", " ", "dda", " ", "Psi"}], "a"], "+", 
  RowBox[{"24", " ", 
   SuperscriptBox["H", "2"], " ", "Psi"}], "+", 
  FractionBox[
   RowBox[{"12", " ", 
    SuperscriptBox["H", "2"], " ", "Psi"}], 
   SuperscriptBox["a", "2"]]}]], "Output",
 CellChangeTimes->{{3.662834420933765*^9, 3.662834441352648*^9}, {
   3.662834630221817*^9, 3.6628346687094383`*^9}, 3.6628413469000883`*^9, {
   3.662841379429982*^9, 3.662841421913822*^9}, 3.66284297434262*^9, 
   3.662843337686421*^9, 3.662850456025853*^9, 3.662852601835631*^9, 
   3.6628530827914133`*^9, 3.6629157854463253`*^9, 3.662917049664919*^9}]
}, Open  ]],

Cell["check", "Text",
 CellChangeTimes->{{3.662852637153297*^9, 3.662852637529009*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"delGd0d0semi", " ", "=", " ", 
   RowBox[{
    RowBox[{"delRd0d0", " ", "-", " ", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"delgdd", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "bgR"}], " ", "-", " ", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"g0dd", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "delR"}]}], " ", "//", 
    " ", "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Expand", "@", 
   RowBox[{"fullnice", "@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"fullnice", "@", "delGd0d0semi"}], " ", "/.", " ", 
      "quadPsirepl"}], ")"}]}]}], " ", "/.", " ", "quadPsirepl"}]}], "Input",
 CellChangeTimes->{{3.6628433473947363`*^9, 3.6628433711436357`*^9}, {
  3.662843425439674*^9, 3.6628434357401667`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"2", " ", "ddPsi"}], 
   SuperscriptBox["a", "2"]], "+", 
  RowBox[{"6", " ", "dPsi", " ", "H"}], "+", 
  FractionBox[
   RowBox[{"12", " ", "dPsi", " ", "H"}], 
   SuperscriptBox["a", "2"]], "-", 
  FractionBox[
   RowBox[{"2", " ", "lPsi"}], 
   SuperscriptBox["a", "4"]], "+", 
  FractionBox[
   RowBox[{"3", " ", "dda", " ", "Psi"}], 
   SuperscriptBox["a", "3"]], "+", 
  FractionBox[
   RowBox[{"12", " ", "dda", " ", "Psi"}], "a"], "+", 
  RowBox[{"24", " ", 
   SuperscriptBox["H", "2"], " ", "Psi"}], "+", 
  FractionBox[
   RowBox[{"12", " ", 
    SuperscriptBox["H", "2"], " ", "Psi"}], 
   SuperscriptBox["a", "2"]]}]], "Output",
 CellChangeTimes->{3.662843374217101*^9, 3.662843436946529*^9, 
  3.662850457143064*^9, 3.662852605455297*^9, 3.6628530842239122`*^9, 
  3.662915797288948*^9, 3.6629170521964006`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"delGd0d0red", " ", "=", " ", 
  RowBox[{
   RowBox[{"6", " ", "dPsi", " ", "H"}], " ", "+", " ", 
   RowBox[{"24", " ", 
    SuperscriptBox["H", "2"], " ", "Psi"}], " ", "-", " ", 
   RowBox[{"2", " ", 
    FractionBox["lPsi", 
     SuperscriptBox["a", "4"]]}]}]}]], "Input",
 CellChangeTimes->{{3.66284372278026*^9, 3.662843777602454*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"6", " ", "dPsi", " ", "H"}], "-", 
  FractionBox[
   RowBox[{"2", " ", "lPsi"}], 
   SuperscriptBox["a", "4"]], "+", 
  RowBox[{"24", " ", 
   SuperscriptBox["H", "2"], " ", "Psi"}]}]], "Output",
 CellChangeTimes->{3.662843793751412*^9, 3.662850461226643*^9, 
  3.662852643027443*^9, 3.662915849415002*^9, 3.6629170545779457`*^9, 
  3.662917803190608*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
solve perturbed einstein equations\
\>", "Subsection",
 CellChangeTimes->{{3.6629176597521057`*^9, 3.662917665894277*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"fullnice", "@", 
       RowBox[{"(", 
        RowBox[{"delGd0d0", " ", "-", " ", 
         RowBox[{"8", " ", "\[Pi]", " ", "Gnew", " ", "delTd0d0"}]}], ")"}]}],
       " ", "\[Equal]", " ", "0"}], ",", "lPsi"}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}], " ", "//", " ", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Expand", "@", 
     RowBox[{"fullnice", "@", 
      RowBox[{"(", 
       RowBox[{"lPsi", " ", "/.", " ", "%"}], ")"}]}]}], " ", "/.", " ", 
    "quadPsirepl"}], " ", "//", " ", "FullSimplify"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Expand", "@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"SeriesCoefficient", "[", 
        RowBox[{"%", ",", 
         RowBox[{"{", 
          RowBox[{"Psi", ",", "0", ",", "#"}], "}"}]}], "]"}], " ", "/", " ", 
       
       RowBox[{"(", 
        RowBox[{"4", " ", "\[Pi]", " ", "Gnew"}], ")"}]}], " ", "/.", " ", 
      "mathrepl"}], ")"}]}], " ", "&"}], "/@", " ", 
  RowBox[{"{", 
   RowBox[{"0", ",", "1"}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.6628526701987047`*^9, 3.6628527796236343`*^9}, {
  3.662852818190736*^9, 3.6628528184630527`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"lPsi", "\[Rule]", 
   RowBox[{"-", 
    RowBox[{
     FractionBox["1", 
      RowBox[{
       RowBox[{"-", "2"}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "5"}], "+", 
          RowBox[{"3", " ", 
           SuperscriptBox["a", "2"]}]}], ")"}], " ", "Psi"}]}]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"3", " ", "a", " ", "dda", " ", "Psi"}], "+", 
       RowBox[{"12", " ", 
        SuperscriptBox["a", "3"], " ", "dda", " ", "Psi"}], "+", 
       RowBox[{"8", " ", 
        SuperscriptBox["gPsi", "2"], " ", "Psi"}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["a", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"8", " ", 
           SuperscriptBox["gPsi", "2"], " ", "Psi"}], "+", 
          RowBox[{"6", " ", 
           SuperscriptBox["H", "2"], " ", "Psi"}], "+", 
          RowBox[{"ddPsi", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "Psi"}], ")"}]}], "+", 
          RowBox[{"3", " ", "dPsi", " ", "H", " ", 
           RowBox[{"(", 
            RowBox[{"2", "+", "Psi"}], ")"}]}], "-", 
          RowBox[{"4", " ", 
           SuperscriptBox["dPsi", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"2", " ", "Psi"}]}], ")"}]}], "-", 
          RowBox[{"2", " ", "Gnew", " ", 
           SuperscriptBox["gphi", "2"], " ", "\[Pi]", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"4", " ", "Psi"}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["a", "4"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"3", " ", "dPsi", " ", "H"}], "+", 
          RowBox[{"6", " ", 
           SuperscriptBox["dPsi", "2"], " ", "Psi"}], "+", 
          RowBox[{"12", " ", 
           SuperscriptBox["H", "2"], " ", "Psi"}], "-", 
          RowBox[{"2", " ", "Gnew", " ", "\[Pi]", " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["dphi", "2"], "-", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"2", " ", "Psi"}]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"rhobar", "-", "V"}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
      ")"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.662852710674835*^9, 3.662852780125396*^9}, 
   3.662852819245022*^9, 3.662853085257346*^9, 3.662915803306222*^9, 
   3.6629170530507727`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{
      SuperscriptBox["a", "2"], " ", "ddPsi"}], 
     RowBox[{"4", " ", "Gnew", " ", "\[Pi]"}]], "-", 
    RowBox[{
     SuperscriptBox["a", "4"], " ", "V"}], "-", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     SuperscriptBox["a", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"\[Del]", "\[Phi]"}], ")"}], "2"]}], "+", 
    RowBox[{
     SuperscriptBox["a", "4"], " ", 
     OverscriptBox["\[Rho]", "_"]}], "-", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     SuperscriptBox["a", "4"], " ", 
     SuperscriptBox[
      OverscriptBox["\[Phi]", "."], "2"]}], "+", 
    FractionBox[
     RowBox[{"3", " ", 
      SuperscriptBox["a", "2"], " ", "H", " ", 
      OverscriptBox["\[Psi]", "."]}], 
     RowBox[{"2", " ", "Gnew", " ", "\[Pi]"}]], "+", 
    FractionBox[
     RowBox[{"3", " ", 
      SuperscriptBox["a", "4"], " ", "H", " ", 
      OverscriptBox["\[Psi]", "."]}], 
     RowBox[{"4", " ", "Gnew", " ", "\[Pi]"}]]}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{"3", " ", "a", " ", "dda"}], 
     RowBox[{"8", " ", "Gnew", " ", "\[Pi]"}]], "+", 
    FractionBox[
     RowBox[{"3", " ", 
      SuperscriptBox["a", "3"], " ", "dda"}], 
     RowBox[{"2", " ", "Gnew", " ", "\[Pi]"}]], "+", 
    FractionBox[
     RowBox[{"3", " ", 
      SuperscriptBox["a", "2"], " ", 
      SuperscriptBox["H", "2"]}], 
     RowBox[{"2", " ", "Gnew", " ", "\[Pi]"}]], "+", 
    FractionBox[
     RowBox[{"3", " ", 
      SuperscriptBox["a", "4"], " ", 
      SuperscriptBox["H", "2"]}], 
     RowBox[{"Gnew", " ", "\[Pi]"}]], "+", 
    RowBox[{"3", " ", 
     SuperscriptBox["a", "4"], " ", "V"}], "-", 
    RowBox[{"3", " ", 
     SuperscriptBox["a", "6"], " ", "V"}], "+", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     SuperscriptBox["a", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"\[Del]", "\[Phi]"}], ")"}], "2"]}], "-", 
    RowBox[{
     FractionBox["3", "2"], " ", 
     SuperscriptBox["a", "4"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"\[Del]", "\[Phi]"}], ")"}], "2"]}], "-", 
    RowBox[{"3", " ", 
     SuperscriptBox["a", "4"], " ", 
     OverscriptBox["\[Rho]", "_"]}], "+", 
    RowBox[{"3", " ", 
     SuperscriptBox["a", "6"], " ", 
     OverscriptBox["\[Rho]", "_"]}], "+", 
    RowBox[{
     FractionBox["5", "2"], " ", 
     SuperscriptBox["a", "4"], " ", 
     SuperscriptBox[
      OverscriptBox["\[Phi]", "."], "2"]}], "-", 
    RowBox[{
     FractionBox["3", "2"], " ", 
     SuperscriptBox["a", "6"], " ", 
     SuperscriptBox[
      OverscriptBox["\[Phi]", "."], "2"]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.662852710674835*^9, 3.662852780125396*^9}, 
   3.662852819245022*^9, 3.662853085257346*^9, 3.662915803306222*^9, 
   3.662917054483488*^9}]
}, Open  ]],

Cell["check", "Text",
 CellChangeTimes->{{3.6629171050346813`*^9, 3.66291710537691*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"fullnice", "@", 
        RowBox[{"(", "delGd0d0", ")"}]}], " ", "\[Equal]", " ", 
       RowBox[{"fullnice", "@", 
        RowBox[{"(", " ", 
         RowBox[{"8", " ", "\[Pi]", " ", "Gnew", " ", "delTd0d0"}], ")"}]}]}],
       ",", "lPsi"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], " ", "//", " ", "FullSimplify"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Expand", "@", 
     RowBox[{"fullnice", "@", 
      RowBox[{"(", 
       RowBox[{"lPsi", " ", "/.", " ", "%"}], ")"}]}]}], " ", "/.", " ", 
    "quadPsirepl"}], " ", "//", " ", "FullSimplify"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Expand", "@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"SeriesCoefficient", "[", 
        RowBox[{"%", ",", 
         RowBox[{"{", 
          RowBox[{"Psi", ",", "0", ",", "#"}], "}"}]}], "]"}], " ", "/", " ", 
       
       RowBox[{"(", 
        RowBox[{"4", " ", "\[Pi]", " ", "Gnew"}], ")"}]}], " ", "/.", " ", 
      "mathrepl"}], ")"}]}], " ", "&"}], "/@", " ", 
  RowBox[{"{", 
   RowBox[{"0", ",", "1"}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.662917121991952*^9, 3.662917133503914*^9}, 
   3.662917767619985*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{
      SuperscriptBox["a", "2"], " ", "ddPsi"}], 
     RowBox[{"4", " ", "Gnew", " ", "\[Pi]"}]], "-", 
    RowBox[{
     SuperscriptBox["a", "4"], " ", "V"}], "-", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     SuperscriptBox["a", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"\[Del]", "\[Phi]"}], ")"}], "2"]}], "+", 
    RowBox[{
     SuperscriptBox["a", "4"], " ", 
     OverscriptBox["\[Rho]", "_"]}], "-", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     SuperscriptBox["a", "4"], " ", 
     SuperscriptBox[
      OverscriptBox["\[Phi]", "."], "2"]}], "+", 
    FractionBox[
     RowBox[{"3", " ", 
      SuperscriptBox["a", "2"], " ", "H", " ", 
      OverscriptBox["\[Psi]", "."]}], 
     RowBox[{"2", " ", "Gnew", " ", "\[Pi]"}]], "+", 
    FractionBox[
     RowBox[{"3", " ", 
      SuperscriptBox["a", "4"], " ", "H", " ", 
      OverscriptBox["\[Psi]", "."]}], 
     RowBox[{"4", " ", "Gnew", " ", "\[Pi]"}]]}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{"3", " ", "a", " ", "dda"}], 
     RowBox[{"8", " ", "Gnew", " ", "\[Pi]"}]], "+", 
    FractionBox[
     RowBox[{"3", " ", 
      SuperscriptBox["a", "3"], " ", "dda"}], 
     RowBox[{"2", " ", "Gnew", " ", "\[Pi]"}]], "+", 
    FractionBox[
     RowBox[{"3", " ", 
      SuperscriptBox["a", "2"], " ", 
      SuperscriptBox["H", "2"]}], 
     RowBox[{"2", " ", "Gnew", " ", "\[Pi]"}]], "+", 
    FractionBox[
     RowBox[{"3", " ", 
      SuperscriptBox["a", "4"], " ", 
      SuperscriptBox["H", "2"]}], 
     RowBox[{"Gnew", " ", "\[Pi]"}]], "+", 
    RowBox[{"3", " ", 
     SuperscriptBox["a", "4"], " ", "V"}], "-", 
    RowBox[{"3", " ", 
     SuperscriptBox["a", "6"], " ", "V"}], "+", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     SuperscriptBox["a", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"\[Del]", "\[Phi]"}], ")"}], "2"]}], "-", 
    RowBox[{
     FractionBox["3", "2"], " ", 
     SuperscriptBox["a", "4"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"\[Del]", "\[Phi]"}], ")"}], "2"]}], "-", 
    RowBox[{"3", " ", 
     SuperscriptBox["a", "4"], " ", 
     OverscriptBox["\[Rho]", "_"]}], "+", 
    RowBox[{"3", " ", 
     SuperscriptBox["a", "6"], " ", 
     OverscriptBox["\[Rho]", "_"]}], "+", 
    RowBox[{
     FractionBox["5", "2"], " ", 
     SuperscriptBox["a", "4"], " ", 
     SuperscriptBox[
      OverscriptBox["\[Phi]", "."], "2"]}], "-", 
    RowBox[{
     FractionBox["3", "2"], " ", 
     SuperscriptBox["a", "6"], " ", 
     SuperscriptBox[
      OverscriptBox["\[Phi]", "."], "2"]}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.662917134948503*^9, 3.6629177679544783`*^9}]
}, Open  ]],

Cell["check 2", "Text",
 CellChangeTimes->{{3.662917684638468*^9, 3.662917685077036*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"delGd0d0", " ", "\[Equal]", " ", 
           RowBox[{"8", " ", "\[Pi]", " ", "Gnew", " ", "delTd0d0"}]}], ")"}],
          " ", "/.", " ", "printrepl"}], ")"}], " ", "/.", " ", "oprepl"}], 
      ",", "lPsi"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], " ", "//", " ", "FullSimplify"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Expand", "@", 
     RowBox[{"fullnice", "@", 
      RowBox[{"(", 
       RowBox[{"lPsi", " ", "/.", " ", "%"}], ")"}]}]}], " ", "/.", " ", 
    "quadPsirepl"}], " ", "//", " ", "FullSimplify"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Expand", "@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"SeriesCoefficient", "[", 
        RowBox[{"%", ",", 
         RowBox[{"{", 
          RowBox[{"Psi", ",", "0", ",", "#"}], "}"}]}], "]"}], " ", "/", " ", 
       
       RowBox[{"(", 
        RowBox[{"4", " ", "\[Pi]", " ", "Gnew"}], ")"}]}], " ", "/.", " ", 
      "mathrepl"}], ")"}]}], " ", "&"}], "/@", " ", 
  RowBox[{"{", 
   RowBox[{"0", ",", "1"}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.6629177027969313`*^9, 3.662917766596187*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{
      SuperscriptBox["a", "2"], " ", "ddPsi"}], 
     RowBox[{"4", " ", "Gnew", " ", "\[Pi]"}]], "-", 
    RowBox[{
     SuperscriptBox["a", "4"], " ", "V"}], "-", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     SuperscriptBox["a", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"\[Del]", "\[Phi]"}], ")"}], "2"]}], "+", 
    RowBox[{
     SuperscriptBox["a", "4"], " ", 
     OverscriptBox["\[Rho]", "_"]}], "-", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     SuperscriptBox["a", "4"], " ", 
     SuperscriptBox[
      OverscriptBox["\[Phi]", "."], "2"]}], "+", 
    FractionBox[
     RowBox[{"3", " ", 
      SuperscriptBox["a", "2"], " ", "H", " ", 
      OverscriptBox["\[Psi]", "."]}], 
     RowBox[{"2", " ", "Gnew", " ", "\[Pi]"}]], "+", 
    FractionBox[
     RowBox[{"3", " ", 
      SuperscriptBox["a", "4"], " ", "H", " ", 
      OverscriptBox["\[Psi]", "."]}], 
     RowBox[{"4", " ", "Gnew", " ", "\[Pi]"}]]}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{"3", " ", "a", " ", "dda"}], 
     RowBox[{"8", " ", "Gnew", " ", "\[Pi]"}]], "+", 
    FractionBox[
     RowBox[{"3", " ", 
      SuperscriptBox["a", "3"], " ", "dda"}], 
     RowBox[{"2", " ", "Gnew", " ", "\[Pi]"}]], "+", 
    FractionBox[
     RowBox[{"3", " ", 
      SuperscriptBox["a", "2"], " ", 
      SuperscriptBox["H", "2"]}], 
     RowBox[{"2", " ", "Gnew", " ", "\[Pi]"}]], "+", 
    FractionBox[
     RowBox[{"3", " ", 
      SuperscriptBox["a", "4"], " ", 
      SuperscriptBox["H", "2"]}], 
     RowBox[{"Gnew", " ", "\[Pi]"}]], "+", 
    RowBox[{"3", " ", 
     SuperscriptBox["a", "4"], " ", "V"}], "-", 
    RowBox[{"3", " ", 
     SuperscriptBox["a", "6"], " ", "V"}], "+", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     SuperscriptBox["a", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"\[Del]", "\[Phi]"}], ")"}], "2"]}], "-", 
    RowBox[{
     FractionBox["3", "2"], " ", 
     SuperscriptBox["a", "4"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"\[Del]", "\[Phi]"}], ")"}], "2"]}], "-", 
    RowBox[{"3", " ", 
     SuperscriptBox["a", "4"], " ", 
     OverscriptBox["\[Rho]", "_"]}], "+", 
    RowBox[{"3", " ", 
     SuperscriptBox["a", "6"], " ", 
     OverscriptBox["\[Rho]", "_"]}], "+", 
    RowBox[{
     FractionBox["5", "2"], " ", 
     SuperscriptBox["a", "4"], " ", 
     SuperscriptBox[
      OverscriptBox["\[Phi]", "."], "2"]}], "-", 
    RowBox[{
     FractionBox["3", "2"], " ", 
     SuperscriptBox["a", "6"], " ", 
     SuperscriptBox[
      OverscriptBox["\[Phi]", "."], "2"]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.662917752733962*^9, 3.6629177697213697`*^9}}]
}, Open  ]],

Cell["\<\
with cherrypicked terms of einstein tensor\
\>", "Text",
 CellChangeTimes->{{3.662917792672729*^9, 3.6629177981029997`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{
    RowBox[{"Collect", "[", 
     RowBox[{
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{"Simplify", "[", 
         RowBox[{"delGd0d0red", " ", "\[Equal]", " ", 
          RowBox[{"8", " ", "\[Pi]", " ", "Gnew", " ", 
           RowBox[{"(", 
            RowBox[{"fullnice", "@", "delTd0d0"}], ")"}]}]}], "]"}], ",", " ",
         "lPsi"}], "]"}], ",", " ", 
      RowBox[{"{", "Psi", "}"}]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Expand", "@", 
    RowBox[{"(", 
     RowBox[{"fullnice", "@", 
      RowBox[{"(", 
       RowBox[{"lPsi", " ", "/.", "%"}], ")"}]}], ")"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Expand", "@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"SeriesCoefficient", "[", 
          RowBox[{"%", ",", 
           RowBox[{"{", 
            RowBox[{"Psi", ",", "0", ",", "#"}], "}"}]}], "]"}], " ", "/", 
         " ", 
         RowBox[{"(", 
          RowBox[{"4", " ", "\[Pi]", " ", "Gnew"}], ")"}]}], " ", "/.", " ", 
        "mathrepl"}], ")"}]}], " ", "&"}], "/@", " ", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.662850470647148*^9, 3.662850481984383*^9}, {
  3.662850519990283*^9, 3.662850521725955*^9}, {3.6628507966153173`*^9, 
  3.6628508243490763`*^9}, {3.6629157391927347`*^9, 3.662915752262141*^9}, {
  3.66291585931971*^9, 3.662915900884267*^9}, {3.662915932645899*^9, 
  3.662915993027171*^9}, {3.662916026869155*^9, 3.6629160414522*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"lPsi", "\[Rule]", 
   RowBox[{
    RowBox[{
     SuperscriptBox["a", "2"], " ", "Psi", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"12", " ", 
        SuperscriptBox["a", "2"], " ", 
        SuperscriptBox["H", "2"]}], "-", 
       RowBox[{"8", " ", "Gnew", " ", 
        SuperscriptBox["gphi", "2"], " ", "\[Pi]"}], "+", 
       RowBox[{"8", " ", 
        SuperscriptBox["a", "2"], " ", "Gnew", " ", "\[Pi]", " ", "rhobar"}], 
       "-", 
       RowBox[{"8", " ", 
        SuperscriptBox["a", "2"], " ", "Gnew", " ", "\[Pi]", " ", "V"}]}], 
      ")"}]}], "+", 
    RowBox[{
     SuperscriptBox["a", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"3", " ", 
        SuperscriptBox["a", "2"], " ", "dPsi", " ", "H"}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["a", "2"], " ", 
        SuperscriptBox["dphi", "2"], " ", "Gnew", " ", "\[Pi]"}], "-", 
       RowBox[{"2", " ", "Gnew", " ", 
        SuperscriptBox["gphi", "2"], " ", "\[Pi]"}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["a", "2"], " ", "Gnew", " ", "\[Pi]", " ", "rhobar"}], 
       "-", 
       RowBox[{"4", " ", 
        SuperscriptBox["a", "2"], " ", "Gnew", " ", "\[Pi]", " ", "V"}]}], 
      ")"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.662850462444787*^9, {3.662850789759602*^9, 3.662850825366576*^9}, {
   3.662915850301506*^9, 3.6629158674544363`*^9}, 3.6629159012263603`*^9, {
   3.6629159349945993`*^9, 3.662915993597645*^9}, 3.662916042081637*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"3", " ", 
   SuperscriptBox["a", "4"], " ", "dPsi", " ", "H"}], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox["a", "4"], " ", 
   SuperscriptBox["dphi", "2"], " ", "Gnew", " ", "\[Pi]"}], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox["a", "2"], " ", "Gnew", " ", 
   SuperscriptBox["gphi", "2"], " ", "\[Pi]"}], "+", 
  RowBox[{"12", " ", 
   SuperscriptBox["a", "4"], " ", 
   SuperscriptBox["H", "2"], " ", "Psi"}], "-", 
  RowBox[{"8", " ", 
   SuperscriptBox["a", "2"], " ", "Gnew", " ", 
   SuperscriptBox["gphi", "2"], " ", "\[Pi]", " ", "Psi"}], "+", 
  RowBox[{"4", " ", 
   SuperscriptBox["a", "4"], " ", "Gnew", " ", "\[Pi]", " ", "rhobar"}], "+", 
  
  RowBox[{"8", " ", 
   SuperscriptBox["a", "4"], " ", "Gnew", " ", "\[Pi]", " ", "Psi", " ", 
   "rhobar"}], "-", 
  RowBox[{"4", " ", 
   SuperscriptBox["a", "4"], " ", "Gnew", " ", "\[Pi]", " ", "V"}], "-", 
  RowBox[{"8", " ", 
   SuperscriptBox["a", "4"], " ", "Gnew", " ", "\[Pi]", " ", "Psi", " ", 
   "V"}]}]], "Output",
 CellChangeTimes->{
  3.662850462444787*^9, {3.662850789759602*^9, 3.662850825366576*^9}, {
   3.662915850301506*^9, 3.6629158674544363`*^9}, 3.6629159012263603`*^9, {
   3.6629159349945993`*^9, 3.662915993597645*^9}, 3.66291604208462*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["a", "4"]}], " ", "V"}], "-", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     SuperscriptBox["a", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"\[Del]", "\[Phi]"}], ")"}], "2"]}], "+", 
    RowBox[{
     SuperscriptBox["a", "4"], " ", 
     OverscriptBox["\[Rho]", "_"]}], "-", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     SuperscriptBox["a", "4"], " ", 
     SuperscriptBox[
      OverscriptBox["\[Phi]", "."], "2"]}], "+", 
    FractionBox[
     RowBox[{"3", " ", 
      SuperscriptBox["a", "4"], " ", "H", " ", 
      OverscriptBox["\[Psi]", "."]}], 
     RowBox[{"4", " ", "Gnew", " ", "\[Pi]"}]]}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{"3", " ", 
      SuperscriptBox["a", "4"], " ", 
      SuperscriptBox["H", "2"]}], 
     RowBox[{"Gnew", " ", "\[Pi]"}]], "-", 
    RowBox[{"2", " ", 
     SuperscriptBox["a", "4"], " ", "V"}], "-", 
    RowBox[{"2", " ", 
     SuperscriptBox["a", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"\[Del]", "\[Phi]"}], ")"}], "2"]}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["a", "4"], " ", 
     OverscriptBox["\[Rho]", "_"]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.662850462444787*^9, {3.662850789759602*^9, 3.662850825366576*^9}, {
   3.662915850301506*^9, 3.6629158674544363`*^9}, 3.6629159012263603`*^9, {
   3.6629159349945993`*^9, 3.662915993597645*^9}, 3.662916042086589*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
einstein equation for 00 component of perturbations with Einstein tensor from \
Riotto --> WARNING\
\>", "Subsection",
 CellChangeTimes->{{3.6616307652302732`*^9, 3.6616307764121513`*^9}, {
  3.6628373682544003`*^9, 3.662837385212431*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"delGU0d0pre", " ", "=", " ", 
  RowBox[{
   RowBox[{"6", " ", 
    SuperscriptBox["a", "2"], " ", "H", " ", 
    RowBox[{"(", 
     RowBox[{"dPsi", " ", "+", " ", 
      RowBox[{"H", " ", "Psi"}]}], ")"}]}], " ", "-", " ", 
   RowBox[{"2", " ", "lPsi"}]}]}]], "Input",
 CellChangeTimes->{{3.662745423231152*^9, 3.662745490399662*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "2"}], " ", "lPsi"}], "+", 
  RowBox[{"6", " ", 
   SuperscriptBox["a", "2"], " ", "H", " ", 
   RowBox[{"(", 
    RowBox[{"dPsi", "+", 
     RowBox[{"H", " ", "Psi"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.662745477904375*^9, 3.662745492978382*^9}, 
   3.662745976936425*^9, 3.662746103946541*^9, 3.6627488201239853`*^9, 
   3.662758086988419*^9, 3.662758134272799*^9, 3.66275847266223*^9, 
   3.662758537343689*^9, 3.66276167759365*^9, 3.662762415999522*^9, 
   3.6627631411520157`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"delGU0d0", " ", "=", " ", 
  RowBox[{
   RowBox[{"delGU0d0pre", " ", "/.", " ", "dPsirepl"}], " ", "//", " ", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.66163082172047*^9, 3.6616308516153708`*^9}, {
  3.661630893662703*^9, 3.6616309015429707`*^9}, {3.661631014821237*^9, 
  3.661631020292776*^9}, {3.661631115091764*^9, 3.661631121426675*^9}, {
  3.662744265979701*^9, 3.662744267307514*^9}, {3.662745483812049*^9, 
  3.662745509208728*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "2"}], " ", "lPsi"}], "+", 
  RowBox[{"24", " ", 
   SuperscriptBox["a", "2"], " ", "delphi", " ", "dphi", " ", "Gnew", " ", 
   "H", " ", "\[Pi]"}]}]], "Output",
 CellChangeTimes->{
  3.661793948893825*^9, 3.6618005000256968`*^9, 3.661806678691257*^9, 
   3.661807385598629*^9, 3.661807441371648*^9, 3.661811465682858*^9, {
   3.6627455017349863`*^9, 3.6627455097533827`*^9}, 3.662745978377392*^9, 
   3.6627461048129663`*^9, 3.662748821107233*^9, 3.662758092534487*^9, 
   3.6627581353873653`*^9, 3.662758473246187*^9, 3.6627585386515713`*^9, 
   3.662761690478779*^9, 3.6627617461780863`*^9, 3.662762416716219*^9, 
   3.662763142153545*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"poisseq", " ", "=", " ", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"Simplify", "[", 
       RowBox[{"delGU0d0", " ", "\[Equal]", " ", 
        RowBox[{"8", " ", "\[Pi]", " ", "Gnew", " ", 
         RowBox[{"(", 
          RowBox[{"fullnice", "@", "delTU0d0"}], ")"}]}]}], "]"}], ",", " ", 
      "lPsi"}], "]"}], ",", " ", 
    RowBox[{"{", "Psi", "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"poisseqnum", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"poisseq", " ", "/.", " ", "grepl"}], " ", "//.", " ", 
    "mathrepl"}], " ", "//", " ", "FullSimplify"}]}]}], "Input",
 CellChangeTimes->{{3.661811486541999*^9, 3.661811487516386*^9}, {
  3.662744276053907*^9, 3.662744280213585*^9}, {3.662745537647946*^9, 
  3.662745592471999*^9}, {3.662758145820099*^9, 3.6627581479316807`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"lPsi", "\[Rule]", 
    RowBox[{
     FractionBox[
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", 
          SuperscriptBox["a", "2"], " ", 
          SuperscriptBox["dphi", "2"], " ", "Gnew", " ", "\[Pi]"}], "+", 
         RowBox[{"2", " ", "Gnew", " ", 
          SuperscriptBox["gphi", "2"], " ", "\[Pi]"}]}], ")"}], " ", "Psi"}], 
      
      SuperscriptBox["a", "2"]], "+", 
     FractionBox[
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["a", "2"], " ", 
          SuperscriptBox["dphi", "2"], " ", "Gnew", " ", "\[Pi]"}], "+", 
         RowBox[{"Gnew", " ", 
          SuperscriptBox["gphi", "2"], " ", "\[Pi]"}], "+", 
         RowBox[{"6", " ", 
          SuperscriptBox["a", "4"], " ", "delphi", " ", "dphi", " ", "Gnew", 
          " ", "H", " ", "\[Pi]"}], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox["a", "2"], " ", "Gnew", " ", "\[Pi]", " ", 
          "rhobar"}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["a", "2"], " ", "Gnew", " ", "\[Pi]", " ", "V"}]}], 
        ")"}]}], 
      SuperscriptBox["a", "2"]]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.661811488068265*^9, 3.661811762644429*^9, {3.6627455275815573`*^9, 
   3.662745549126107*^9}, {3.6627455846238813`*^9, 3.662745592654739*^9}, 
   3.662745979617917*^9, 3.662746105431583*^9, 3.66274882194337*^9, {
   3.6627581364437637`*^9, 3.6627581719116364`*^9}, 3.662758473796574*^9, 
   3.662758539569366*^9, 3.662758831255583*^9, 3.662761747219388*^9, 
   3.662762417571588*^9, 3.662763143075591*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"\[CapitalDelta]\[Psi]", "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"2", " ", "\[Psi]"}]}], ")"}], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"\[Del]", "\[Phi]"}], ")"}], "2"]}], "+", 
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "V"}], "-", 
         RowBox[{"2", " ", 
          OverscriptBox["\[Rho]", "_"]}], "+", 
         RowBox[{
          OverscriptBox["\[Phi]", "."], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"6", " ", 
             SuperscriptBox["a", "2"], " ", "H", " ", "\[Delta]\[Phi]"}], "+", 
            OverscriptBox["\[Phi]", "."], "-", 
            RowBox[{"2", " ", "\[Psi]", " ", 
             OverscriptBox["\[Phi]", "."]}]}], ")"}]}]}], ")"}]}]}], 
     RowBox[{"4", " ", 
      SuperscriptBox["a", "2"]}]]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.661811488068265*^9, 3.661811762644429*^9, {3.6627455275815573`*^9, 
   3.662745549126107*^9}, {3.6627455846238813`*^9, 3.662745592654739*^9}, 
   3.662745979617917*^9, 3.662746105431583*^9, 3.66274882194337*^9, {
   3.6627581364437637`*^9, 3.6627581719116364`*^9}, 3.662758473796574*^9, 
   3.662758539569366*^9, 3.662758831255583*^9, 3.662761747219388*^9, 
   3.662762417571588*^9, 3.6627631430787153`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SeriesCoefficient", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"lPsi", " ", "/.", "poisseq"}], ")"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"Psi", ",", "0", ",", "0"}], "}"}]}], "]"}], " ", "/", " ", 
    RowBox[{"(", 
     RowBox[{"4", " ", "\[Pi]", " ", "Gnew"}], ")"}]}], " ", "/.", " ", 
   "mathrepl"}], " ", "//", " ", "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SeriesCoefficient", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"lPsi", " ", "/.", "poisseq"}], ")"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"Psi", ",", "0", ",", "1"}], "}"}]}], "]"}], " ", "/", " ", 
    RowBox[{"(", 
     RowBox[{"4", " ", "\[Pi]", " ", "Gnew"}], ")"}]}], " ", "/.", " ", 
   "mathrepl"}], " ", "//", " ", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.661631344657805*^9, 3.6616314117905807`*^9}, {
  3.661632383122077*^9, 3.661632385172401*^9}, {3.662745605374497*^9, 
  3.662745607622202*^9}, {3.662745712087785*^9, 3.662745713854576*^9}, {
  3.6627457497068787`*^9, 3.662745759194162*^9}, {3.662748877727683*^9, 
  3.662748885468869*^9}, {3.662758177874404*^9, 3.6627582071443367`*^9}, {
  3.6627618075414343`*^9, 3.662761818245296*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"2", " ", "V"}], "+", 
    FractionBox[
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"\[Del]", "\[Phi]"}], ")"}], "2"], 
     SuperscriptBox["a", "2"]], "-", 
    RowBox[{"2", " ", 
     OverscriptBox["\[Rho]", "_"]}], "+", 
    RowBox[{"6", " ", 
     SuperscriptBox["a", "2"], " ", "H", " ", "\[Delta]\[Phi]", " ", 
     OverscriptBox["\[Phi]", "."]}], "+", 
    SuperscriptBox[
     OverscriptBox["\[Phi]", "."], "2"]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.6617939531279497`*^9, 3.661800504925428*^9, 3.661806680855898*^9, 
   3.661807387948921*^9, 3.661807444454797*^9, 3.66181176409492*^9, 
   3.661812020391513*^9, 3.662745610179883*^9, 3.662745715601344*^9, 
   3.6627457601067038`*^9, 3.6627459820812063`*^9, 3.662746106047245*^9, 
   3.66274882334037*^9, {3.6627488819459133`*^9, 3.662748885882215*^9}, {
   3.662758193361709*^9, 3.6627582074177027`*^9}, 3.6627584750314293`*^9, 
   3.662758540869134*^9, 3.66275884372663*^9, {3.662761748877301*^9, 
   3.6627617647137403`*^9}, {3.6627618090680647`*^9, 3.6627618185383244`*^9}, 
   3.6627624183665457`*^9, 3.662763144044959*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"\[Del]", "\[Phi]"}], ")"}], "2"], 
   SuperscriptBox["a", "2"]], "-", 
  SuperscriptBox[
   OverscriptBox["\[Phi]", "."], "2"]}]], "Output",
 CellChangeTimes->{
  3.6617939531279497`*^9, 3.661800504925428*^9, 3.661806680855898*^9, 
   3.661807387948921*^9, 3.661807444454797*^9, 3.66181176409492*^9, 
   3.661812020391513*^9, 3.662745610179883*^9, 3.662745715601344*^9, 
   3.6627457601067038`*^9, 3.6627459820812063`*^9, 3.662746106047245*^9, 
   3.66274882334037*^9, {3.6627488819459133`*^9, 3.662748885882215*^9}, {
   3.662758193361709*^9, 3.6627582074177027`*^9}, 3.6627584750314293`*^9, 
   3.662758540869134*^9, 3.66275884372663*^9, {3.662761748877301*^9, 
   3.6627617647137403`*^9}, {3.6627618090680647`*^9, 3.6627618185383244`*^9}, 
   3.6627624183665457`*^9, 3.662763144047724*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
einstein equations with the perturbed stress energy from Riotto --> WARNING\
\>", "Subsection",
 CellChangeTimes->{{3.66275977198975*^9, 3.662759784075783*^9}, {
  3.66283739177223*^9, 3.662837396987858*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"delTU0d0rio", " ", "=", " ", 
  RowBox[{
   SuperscriptBox["a", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Psi", " ", 
      SuperscriptBox["dphi", "2"]}], " ", "-", " ", 
     RowBox[{"dphi", " ", "deldphi"}], " ", "-", " ", 
     RowBox[{"Vprime", " ", "delphi"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.662759786388011*^9, 3.662759795372281*^9}, {
  3.662759879708849*^9, 3.6627599048099546`*^9}}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["a", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "deldphi"}], " ", "dphi"}], "+", 
    RowBox[{
     SuperscriptBox["dphi", "2"], " ", "Psi"}], "-", 
    RowBox[{"delphi", " ", "Vprime"}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.662759942721858*^9, {3.6627617517602587`*^9, 3.662761766064101*^9}, 
   3.662762420094655*^9, 3.66276314570968*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"poisseq2", " ", "=", " ", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"Simplify", "[", 
        RowBox[{"delGU0d0", " ", "\[Equal]", " ", 
         RowBox[{"8", " ", "\[Pi]", " ", "Gnew", " ", 
          RowBox[{"(", "delTU0d0rio", ")"}]}]}], "]"}], ",", " ", "lPsi"}], 
      "]"}], ",", " ", 
     RowBox[{"{", "Psi", "}"}]}], "]"}], " ", "//", " ", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.662759972230689*^9, 3.662759991295415*^9}, {
  3.6627600902056627`*^9, 3.662760120611054*^9}, {3.662760186413355*^9, 
  3.6627602100051823`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"lPsi", "\[Rule]", 
    RowBox[{"4", " ", 
     SuperscriptBox["a", "2"], " ", "Gnew", " ", "\[Pi]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"dphi", " ", 
        RowBox[{"(", 
         RowBox[{"deldphi", "+", 
          RowBox[{"3", " ", "delphi", " ", "H"}], "-", 
          RowBox[{"dphi", " ", "Psi"}]}], ")"}]}], "+", 
       RowBox[{"delphi", " ", "Vprime"}]}], ")"}]}]}], "}"}], "}"}]], "Output",\

 CellChangeTimes->{{3.662759984011827*^9, 3.6627599915216427`*^9}, {
   3.662760099234188*^9, 3.6627601213522*^9}, {3.662760192297823*^9, 
   3.6627602104789457`*^9}, {3.6627617529119673`*^9, 3.6627617666301126`*^9}, 
   3.662762421158305*^9, 3.662763146311283*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SeriesCoefficient", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"lPsi", " ", "/.", "poisseq2"}], ")"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"Psi", ",", "0", ",", "0"}], "}"}]}], "]"}], " ", "/", " ", 
    RowBox[{"(", 
     RowBox[{"4", " ", "\[Pi]", " ", "Gnew"}], ")"}]}], " ", "/.", " ", 
   "mathrepl"}], " ", "//", " ", "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SeriesCoefficient", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"lPsi", " ", "/.", "poisseq2"}], ")"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"Psi", ",", "0", ",", "1"}], "}"}]}], "]"}], " ", "/", " ", 
    RowBox[{"(", 
     RowBox[{"4", " ", "\[Pi]", " ", "Gnew"}], ")"}]}], " ", "/.", " ", 
   "mathrepl"}], " ", "//", " ", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.662761780668063*^9, 3.662761781331772*^9}}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["a", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"deldphi", "+", 
       RowBox[{"3", " ", "H", " ", "\[Delta]\[Phi]"}]}], ")"}], " ", 
     OverscriptBox["\[Phi]", "."]}], "+", 
    RowBox[{"\[Delta]\[Phi]", " ", 
     SuperscriptBox["V", "\[Prime]",
      MultilineFunction->None]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.6627617817487707`*^9, 3.6627624217792883`*^9, 
  3.662763146810731*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   SuperscriptBox["a", "2"]}], " ", 
  SuperscriptBox[
   OverscriptBox["\[Phi]", "."], "2"]}]], "Output",
 CellChangeTimes->{3.6627617817487707`*^9, 3.6627624217792883`*^9, 
  3.6627631468129463`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"lPsi", " ", "/.", " ", "poisseq"}], ")"}], " ", "/", " ", 
   RowBox[{"(", 
    RowBox[{"4", " ", "\[Pi]", " ", "Gnew"}], ")"}]}], " ", "//", " ", 
  "Expand"}]], "Input",
 CellChangeTimes->{{3.6627602015177507`*^9, 3.662760224131855*^9}, {
  3.662760258078446*^9, 3.662760266422142*^9}, {3.662763338655388*^9, 
  3.662763365606051*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    SuperscriptBox["dphi", "2"], "2"], "+", 
   FractionBox[
    SuperscriptBox["gphi", "2"], 
    RowBox[{"2", " ", 
     SuperscriptBox["a", "2"]}]], "+", 
   RowBox[{"3", " ", 
    SuperscriptBox["a", "2"], " ", "delphi", " ", "dphi", " ", "H"}], "-", 
   RowBox[{
    SuperscriptBox["dphi", "2"], " ", "Psi"}], "+", 
   FractionBox[
    RowBox[{
     SuperscriptBox["gphi", "2"], " ", "Psi"}], 
    SuperscriptBox["a", "2"]], "-", "rhobar", "+", "V"}], "}"}]], "Output",
 CellChangeTimes->{{3.662760213880733*^9, 3.662760224481051*^9}, 
   3.6627602692542973`*^9, {3.6627617538018703`*^9, 3.662761770914645*^9}, 
   3.662762422476144*^9, 3.662763147261776*^9, {3.662763344294311*^9, 
   3.6627633658310547`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"lPsi", " ", "/.", " ", "poisseq2"}], ")"}], " ", "/", " ", 
   RowBox[{"(", 
    RowBox[{"4", " ", "\[Pi]", " ", "Gnew"}], ")"}]}], " ", "//", " ", 
  "Expand"}]], "Input",
 CellChangeTimes->{{3.662760227301721*^9, 3.6627602339714127`*^9}, {
  3.662760270773934*^9, 3.662760273402809*^9}, {3.662763312618493*^9, 
  3.6627633285281277`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SuperscriptBox["a", "2"], " ", "deldphi", " ", "dphi"}], "+", 
   RowBox[{"3", " ", 
    SuperscriptBox["a", "2"], " ", "delphi", " ", "dphi", " ", "H"}], "-", 
   RowBox[{
    SuperscriptBox["a", "2"], " ", 
    SuperscriptBox["dphi", "2"], " ", "Psi"}], "+", 
   RowBox[{
    SuperscriptBox["a", "2"], " ", "delphi", " ", "Vprime"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.6627602305276117`*^9, 3.662760234329958*^9}, 
   3.662760273861278*^9, 3.6627617746316957`*^9, 3.6627624230921164`*^9, 
   3.662763148077119*^9, {3.662763314345231*^9, 3.6627633289966784`*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
full perturbation of stress energy --> INCOMPLETE, WRONG?\
\>", "Subsection",
 CellChangeTimes->{{3.662822063312989*^9, 3.662822065205432*^9}, {
  3.662822101826337*^9, 3.662822103640915*^9}, {3.662837405051355*^9, 
  3.662837411451036*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"delTd0d0", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"2", "deldphi", " ", "dphi"}], " ", "+", " ", 
    RowBox[{"2", " ", "Psi", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], " ", "+", " ", 
          RowBox[{"2", " ", "Psi"}]}], ")"}], " ", 
        SuperscriptBox["dphi", "2"]}], " ", "+", " ", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"2", " ", 
          SuperscriptBox["a", "2"]}]], " ", 
        RowBox[{"(", 
         RowBox[{"1", " ", "+", " ", 
          RowBox[{"2", " ", "Psi"}]}], ")"}], " ", 
        SuperscriptBox["gphi", "2"]}], " ", "+", " ", "V"}], ")"}]}], " ", 
    "+", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", " ", "+", " ", 
       RowBox[{"2", " ", "Psi"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Psi", " ", 
        SuperscriptBox["dphi", "2"]}], " ", "+", " ", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"2", " ", 
          SuperscriptBox["a", "2"]}]], " ", "2", " ", "Psi", " ", 
        SuperscriptBox["gphi", "2"]}], " ", "+", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], " ", "+", " ", 
          RowBox[{"2", " ", "Psi"}]}], ")"}], " ", "deldphi", " ", "dphi"}], 
       " ", "+", " ", 
       RowBox[{
        FractionBox["1", 
         SuperscriptBox["a", "2"]], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"2", " ", "Psi"}]}], ")"}], " ", "gphi", " ", "gdelphi"}], 
       " ", "+", " ", 
       RowBox[{"Vprime", " ", "delphi"}]}], ")"}]}]}], " ", "//", " ", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.662822109082316*^9, 3.662822259680626*^9}, {
  3.662822389397994*^9, 3.66282239315028*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"gphi", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"2", " ", "Psi"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"gdelphi", "+", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{"gdelphi", "+", "gphi"}], ")"}], " ", "Psi"}]}], ")"}]}], "+", 
   RowBox[{
    SuperscriptBox["a", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"deldphi", " ", 
       RowBox[{"(", 
        RowBox[{"dphi", "+", 
         RowBox[{"4", " ", "dphi", " ", 
          SuperscriptBox["Psi", "2"]}]}], ")"}]}], "+", 
      RowBox[{"delphi", " ", "Vprime"}], "+", 
      RowBox[{"2", " ", "Psi", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          SuperscriptBox["dphi", "2"], " ", "Psi"}], "+", "V", "+", 
         RowBox[{"delphi", " ", "Vprime"}]}], ")"}]}]}], ")"}]}]}], 
  SuperscriptBox["a", "2"]]], "Output",
 CellChangeTimes->{3.662822265464591*^9, 3.662822334805821*^9, 
  3.662822393976385*^9, 3.662824045621584*^9, 3.662825135322667*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Series", "[", 
  RowBox[{"delTd0d0", ",", 
   RowBox[{"{", 
    RowBox[{"Psi", ",", "0", ",", "3"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6628224583401957`*^9, 3.662822465945422*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"deldphi", " ", "dphi"}], "+", 
     FractionBox[
      RowBox[{"gdelphi", " ", "gphi"}], 
      SuperscriptBox["a", "2"]], "+", 
     RowBox[{"delphi", " ", "Vprime"}]}], ")"}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"4", " ", "gdelphi", " ", "gphi"}], 
       SuperscriptBox["a", "2"]], "+", 
      FractionBox[
       RowBox[{"2", " ", 
        SuperscriptBox["gphi", "2"]}], 
       SuperscriptBox["a", "2"]], "+", 
      RowBox[{"2", " ", "V"}], "+", 
      RowBox[{"2", " ", "delphi", " ", "Vprime"}]}], ")"}], " ", "Psi"}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"4", " ", "deldphi", " ", "dphi"}], "+", 
      RowBox[{"4", " ", 
       SuperscriptBox["dphi", "2"]}], "+", 
      FractionBox[
       RowBox[{"4", " ", "gdelphi", " ", "gphi"}], 
       SuperscriptBox["a", "2"]], "+", 
      FractionBox[
       RowBox[{"4", " ", 
        SuperscriptBox["gphi", "2"]}], 
       SuperscriptBox["a", "2"]]}], ")"}], " ", 
    SuperscriptBox["Psi", "2"]}], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "Psi", "]"}], "4"],
    SeriesData[$CellContext`Psi, 0, {}, 0, 4, 1],
    Editable->False]}],
  SeriesData[$CellContext`Psi, 
   0, {$CellContext`deldphi $CellContext`dphi + $CellContext`a^(-2) \
$CellContext`gdelphi $CellContext`gphi + $CellContext`delphi \
$CellContext`Vprime, 
    4 $CellContext`a^(-2) $CellContext`gdelphi $CellContext`gphi + 
    2 $CellContext`a^(-2) $CellContext`gphi^2 + 2 $CellContext`V + 
    2 $CellContext`delphi $CellContext`Vprime, 
    4 $CellContext`deldphi $CellContext`dphi + 4 $CellContext`dphi^2 + 
    4 $CellContext`a^(-2) $CellContext`gdelphi $CellContext`gphi + 
    4 $CellContext`a^(-2) $CellContext`gphi^2}, 0, 4, 1],
  Editable->False]], "Output",
 CellChangeTimes->{3.662822466987405*^9, 3.662824047286113*^9, 
  3.662825139238078*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"delGd0d0", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "6"}], " ", "H", " ", 
    SuperscriptBox["a", "2"], " ", "dPsi"}], " ", "+", " ", 
   RowBox[{"2", " ", "lPsi"}]}]}]], "Input",
 CellChangeTimes->{{3.662822276303261*^9, 3.662822290915846*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "6"}], " ", 
   SuperscriptBox["a", "2"], " ", "dPsi", " ", "H"}], "+", 
  RowBox[{"2", " ", "lPsi"}]}]], "Output",
 CellChangeTimes->{3.6628223358717833`*^9, 3.662822405363515*^9, 
  3.662824047937777*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"poisseq3", " ", "=", " ", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"fullnice", "@", 
       RowBox[{"Simplify", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"delGd0d0", " ", "/.", " ", "dPsirepl"}], ")"}], " ", 
         "\[Equal]", " ", 
         RowBox[{"8", " ", "\[Pi]", " ", "Gnew", " ", "delTd0d0"}]}], "]"}]}],
       ",", " ", "lPsi"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"Psi", ",", 
      SuperscriptBox["Psi", "2"], ",", 
      SuperscriptBox["Psi", "3"]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.662822337651938*^9, 3.662822386908084*^9}, {
  3.662822485395455*^9, 3.66282255209101*^9}, {3.662822594962028*^9, 
  3.662822600945496*^9}, {3.662822681757328*^9, 3.662822708435459*^9}, {
  3.6628251464788313`*^9, 3.6628251479183693`*^9}, {3.662825225075016*^9, 
  3.6628252358979807`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"lPsi", "\[Rule]", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"Psi", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"3", " ", 
           SuperscriptBox["a", "4"], " ", 
           SuperscriptBox["H", "2"]}], "-", 
          RowBox[{
          "16", " ", "gdelphi", " ", "Gnew", " ", "gphi", " ", "\[Pi]"}], "-", 
          RowBox[{"8", " ", "Gnew", " ", 
           SuperscriptBox["gphi", "2"], " ", "\[Pi]"}], "-", 
          RowBox[{"8", " ", 
           SuperscriptBox["a", "2"], " ", "Gnew", " ", "\[Pi]", " ", "V"}], 
          "-", 
          RowBox[{"8", " ", 
           SuperscriptBox["a", "2"], " ", "delphi", " ", "Gnew", " ", "\[Pi]",
            " ", "Vprime"}]}], ")"}]}], 
       SuperscriptBox["a", "2"]]}], "-", 
     FractionBox[
      RowBox[{
       RowBox[{
        RowBox[{"-", "4"}], " ", 
        SuperscriptBox["a", "2"], " ", "deldphi", " ", "dphi", " ", "Gnew", 
        " ", "\[Pi]"}], "-", 
       RowBox[{"4", " ", "gdelphi", " ", "Gnew", " ", "gphi", " ", "\[Pi]"}], 
       "-", 
       RowBox[{"12", " ", 
        SuperscriptBox["a", "4"], " ", "delphi", " ", "dphi", " ", "Gnew", 
        " ", "H", " ", "\[Pi]"}], "-", 
       RowBox[{"4", " ", 
        SuperscriptBox["a", "2"], " ", "delphi", " ", "Gnew", " ", "\[Pi]", 
        " ", "Vprime"}]}], 
      SuperscriptBox["a", "2"]]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.662822492759294*^9, 3.6628225216670847`*^9}, 
   3.6628225526621103`*^9, 3.662822601399829*^9, {3.662822682792787*^9, 
   3.662822709018484*^9}, 3.662824048622305*^9, 3.6628251488241663`*^9, {
   3.662825226202837*^9, 3.662825236383121*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"lPsi", " ", "/.", " ", "poisseq3"}], ")"}], " ", "/", " ", 
   RowBox[{"(", 
    RowBox[{"4", " ", "\[Pi]", " ", "Gnew"}], ")"}]}], " ", "//", " ", 
  "Expand"}]], "Input",
 CellChangeTimes->{{3.662822555098357*^9, 3.66282255521021*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"deldphi", " ", "dphi"}], "+", 
   FractionBox[
    RowBox[{"gdelphi", " ", "gphi"}], 
    SuperscriptBox["a", "2"]], "+", 
   RowBox[{"3", " ", 
    SuperscriptBox["a", "2"], " ", "delphi", " ", "dphi", " ", "H"}], "+", 
   FractionBox[
    RowBox[{"4", " ", "gdelphi", " ", "gphi", " ", "Psi"}], 
    SuperscriptBox["a", "2"]], "+", 
   FractionBox[
    RowBox[{"2", " ", 
     SuperscriptBox["gphi", "2"], " ", "Psi"}], 
    SuperscriptBox["a", "2"]], "-", 
   FractionBox[
    RowBox[{"3", " ", 
     SuperscriptBox["a", "2"], " ", 
     SuperscriptBox["H", "2"], " ", "Psi"}], 
    RowBox[{"4", " ", "Gnew", " ", "\[Pi]"}]], "+", 
   RowBox[{"2", " ", "Psi", " ", "V"}], "+", 
   RowBox[{"delphi", " ", "Vprime"}], "+", 
   RowBox[{"2", " ", "delphi", " ", "Psi", " ", "Vprime"}]}], "}"}]], "Output",\

 CellChangeTimes->{
  3.662822555696931*^9, 3.662822603366753*^9, {3.662822691575659*^9, 
   3.662822710678945*^9}, 3.662824049339192*^9, 3.662825150021476*^9, {
   3.662825227096457*^9, 3.662825237930982*^9}}]
}, Open  ]]
}, Closed]]
}, Open  ]]
},
WindowSize->{1440, 851},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
ShowSelection->True,
FrontEndVersion->"8.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (February 23, \
2011)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 132, 3, 67, "Section"],
Cell[714, 27, 117, 2, 27, "Input"],
Cell[834, 31, 388, 8, 49, "Input"],
Cell[1225, 41, 328, 9, 47, "Input"],
Cell[1556, 52, 427, 10, 46, "Input"],
Cell[1986, 64, 444, 12, 27, "Input"],
Cell[2433, 78, 668, 15, 27, "Input"],
Cell[3104, 95, 795, 21, 27, "Input"],
Cell[3902, 118, 309, 7, 27, "Input"],
Cell[4214, 127, 703, 16, 27, "Input"],
Cell[4920, 145, 645, 15, 27, "Input"],
Cell[5568, 162, 653, 19, 62, "Input"],
Cell[6224, 183, 896, 25, 27, "Input"],
Cell[7123, 210, 519, 15, 62, "Input"],
Cell[7645, 227, 309, 8, 46, "Input"],
Cell[7957, 237, 979, 25, 27, "Input"],
Cell[8939, 264, 372, 8, 27, "Input"],
Cell[9314, 274, 524, 12, 27, "Input"],
Cell[9841, 288, 974, 26, 27, "Input"],
Cell[10818, 316, 336, 8, 27, "Input"],
Cell[11157, 326, 357, 10, 27, "Input"],
Cell[11517, 338, 235, 5, 27, "Input"],
Cell[11755, 345, 1584, 41, 79, "Input"],
Cell[13342, 388, 526, 15, 51, "Input"],
Cell[13871, 405, 516, 16, 47, "Input"],
Cell[14390, 423, 1661, 45, 55, "Input"],
Cell[16054, 470, 1000, 27, 27, "Input"],
Cell[17057, 499, 231, 6, 27, "Input"],
Cell[17291, 507, 129, 2, 27, "Input"],
Cell[17423, 511, 331, 10, 27, "Input"],
Cell[17757, 523, 666, 13, 27, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[18460, 541, 427, 14, 42, "Section"],
Cell[18890, 557, 120, 2, 27, "Input"],
Cell[19013, 561, 1239, 31, 108, "Input"],
Cell[20255, 594, 861, 22, 27, "Input"],
Cell[21119, 618, 1070, 26, 27, "Input"],
Cell[22192, 646, 1604, 33, 53, "Input"],
Cell[23799, 681, 524, 14, 27, "Input"],
Cell[24326, 697, 93, 1, 26, "Text"],
Cell[24422, 700, 392, 10, 27, "Input"],
Cell[24817, 712, 100, 1, 26, "Text"],
Cell[24920, 715, 419, 12, 27, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[25376, 732, 177, 4, 37, "Section"],
Cell[25556, 738, 120, 2, 27, "Input"],
Cell[25679, 742, 206, 5, 33, "Input"],
Cell[25888, 749, 290, 7, 27, "Input"],
Cell[26181, 758, 1117, 22, 64, "Input"],
Cell[27301, 782, 861, 22, 27, "Input"],
Cell[28165, 806, 1070, 26, 27, "Input"],
Cell[29238, 834, 1130, 29, 53, "Input"],
Cell[30371, 865, 524, 14, 27, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[30932, 884, 229, 7, 37, "Section"],
Cell[31164, 893, 4235, 106, 207, "Input"],
Cell[35402, 1001, 682, 18, 58, "Input"],
Cell[36087, 1021, 686, 20, 62, "Input"],
Cell[36776, 1043, 596, 17, 63, "Input"],
Cell[37375, 1062, 745, 17, 33, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[38157, 1084, 243, 5, 37, "Section"],
Cell[38403, 1091, 1376, 35, 108, "Text"],
Cell[39782, 1128, 172, 3, 27, "Input"],
Cell[CellGroupData[{
Cell[39979, 1135, 96, 1, 34, "Subsection"],
Cell[40078, 1138, 621, 13, 61, "Input"],
Cell[40702, 1153, 584, 13, 43, "Input"],
Cell[41289, 1168, 467, 11, 27, "Input"],
Cell[41759, 1181, 306, 7, 27, "Input"],
Cell[42068, 1190, 470, 12, 43, "Input"],
Cell[42541, 1204, 348, 8, 43, "Input"],
Cell[42892, 1214, 422, 11, 43, "Input"],
Cell[43317, 1227, 911, 23, 43, "Input"],
Cell[44231, 1252, 322, 6, 27, "Input"],
Cell[44556, 1260, 465, 13, 27, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45058, 1278, 95, 1, 34, "Subsection"],
Cell[45156, 1281, 322, 8, 47, "Input"],
Cell[45481, 1291, 284, 7, 27, "Input"],
Cell[45768, 1300, 111, 3, 27, "Input"],
Cell[45882, 1305, 231, 6, 27, "Input"],
Cell[46116, 1313, 409, 7, 27, "Input"],
Cell[46528, 1322, 179, 5, 27, "Input"],
Cell[46710, 1329, 317, 7, 33, "Input"],
Cell[47030, 1338, 745, 17, 33, "Input"],
Cell[47778, 1357, 94, 1, 27, "Input"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[47921, 1364, 89, 1, 37, "Section"],
Cell[48013, 1367, 118, 2, 27, "Input"],
Cell[48134, 1371, 292, 8, 33, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[48463, 1384, 101, 1, 37, "Section"],
Cell[48567, 1387, 500, 14, 47, "Input"],
Cell[49070, 1403, 785, 21, 46, "Input"],
Cell[49858, 1426, 176, 4, 27, "Input"],
Cell[50037, 1432, 2361, 65, 285, "Input"],
Cell[52401, 1499, 94, 1, 27, "Input"],
Cell[52498, 1502, 1201, 34, 50, "Input"],
Cell[CellGroupData[{
Cell[53724, 1540, 111, 1, 34, "Subsection"],
Cell[53838, 1543, 818, 23, 58, "Input"],
Cell[54659, 1568, 772, 23, 58, "Input"],
Cell[55434, 1593, 1811, 44, 88, "Input"],
Cell[57248, 1639, 724, 12, 27, "Input"],
Cell[57975, 1653, 285, 8, 27, "Input"],
Cell[58263, 1663, 981, 26, 73, "Input"],
Cell[59247, 1691, 291, 7, 27, "Input"],
Cell[59541, 1700, 994, 27, 58, "Input"],
Cell[60538, 1729, 199, 4, 26, "Text"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[60786, 1739, 105, 1, 37, "Section"],
Cell[60894, 1742, 120, 2, 27, "Input"],
Cell[61017, 1746, 1841, 53, 105, "Input"],
Cell[62861, 1801, 928, 23, 58, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[63826, 1829, 109, 1, 37, "Section"],
Cell[63938, 1832, 1253, 32, 48, "Input"],
Cell[65194, 1866, 296, 7, 27, "Input"],
Cell[65493, 1875, 354, 9, 27, "Input"],
Cell[65850, 1886, 403, 10, 27, "Input"],
Cell[66256, 1898, 352, 9, 27, "Input"],
Cell[66611, 1909, 455, 12, 27, "Input"],
Cell[67069, 1923, 504, 12, 27, "Input"],
Cell[67576, 1937, 456, 12, 27, "Input"],
Cell[68035, 1951, 681, 19, 27, "Input"],
Cell[68719, 1972, 1349, 39, 33, "Input"],
Cell[70071, 2013, 94, 1, 27, "Input"],
Cell[70168, 2016, 201, 4, 27, "Input"],
Cell[70372, 2022, 973, 26, 27, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[71382, 2053, 114, 1, 37, "Section"],
Cell[71499, 2056, 138, 3, 27, "Input"],
Cell[71640, 2061, 232, 6, 30, "Input"],
Cell[71875, 2069, 713, 17, 33, "Input"],
Cell[72591, 2088, 873, 21, 33, "Input"],
Cell[73467, 2111, 502, 11, 27, "Input"],
Cell[73972, 2124, 324, 8, 27, "Input"],
Cell[74299, 2134, 220, 5, 27, "Input"],
Cell[74522, 2141, 495, 10, 43, "Input"],
Cell[75020, 2153, 263, 7, 33, "Input"],
Cell[75286, 2162, 295, 8, 49, "Input"],
Cell[75584, 2172, 422, 8, 27, "Input"],
Cell[76009, 2182, 587, 15, 33, "Input"],
Cell[76599, 2199, 376, 9, 27, "Input"],
Cell[76978, 2210, 410, 8, 27, "Input"],
Cell[77391, 2220, 488, 12, 27, "Input"],
Cell[77882, 2234, 481, 12, 27, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[78400, 2251, 117, 1, 37, "Section"],
Cell[78520, 2254, 136, 3, 27, "Input"],
Cell[78659, 2259, 512, 16, 27, "Input"],
Cell[79174, 2277, 1143, 35, 27, "Input"],
Cell[80320, 2314, 688, 19, 33, "Input"],
Cell[81011, 2335, 938, 25, 33, "Input"],
Cell[81952, 2362, 339, 9, 27, "Input"],
Cell[CellGroupData[{
Cell[82316, 2375, 127, 1, 34, "Subsection"],
Cell[82446, 2378, 457, 10, 30, "Input"],
Cell[82906, 2390, 405, 9, 27, "Input"],
Cell[83314, 2401, 669, 18, 33, "Input"],
Cell[83986, 2421, 281, 6, 46, "Input"],
Cell[84270, 2429, 320, 9, 27, "Input"],
Cell[84593, 2440, 401, 12, 33, "Input"],
Cell[84997, 2454, 661, 20, 33, "Input"],
Cell[85661, 2476, 807, 23, 33, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[86505, 2504, 128, 1, 34, "Subsection"],
Cell[86636, 2507, 548, 10, 27, "Input"],
Cell[87187, 2519, 481, 10, 27, "Input"],
Cell[87671, 2531, 267, 5, 27, "Input"],
Cell[87941, 2538, 283, 6, 27, "Input"],
Cell[88227, 2546, 670, 14, 49, "Input"],
Cell[88900, 2562, 766, 18, 46, "Input"],
Cell[89669, 2582, 764, 20, 27, "Input"],
Cell[90436, 2604, 168, 3, 27, "Input"],
Cell[90607, 2609, 167, 4, 66, "Input"],
Cell[90777, 2615, 693, 15, 66, "Input"],
Cell[91473, 2632, 570, 14, 33, "Input"],
Cell[92046, 2648, 601, 14, 27, "Input"],
Cell[92650, 2664, 870, 23, 27, "Input"],
Cell[93523, 2689, 256, 5, 27, "Input"],
Cell[93782, 2696, 383, 9, 27, "Input"],
Cell[94168, 2707, 347, 10, 27, "Input"],
Cell[94518, 2719, 355, 9, 27, "Input"],
Cell[94876, 2730, 309, 7, 27, "Input"],
Cell[95188, 2739, 251, 5, 27, "Input"],
Cell[95442, 2746, 1049, 27, 58, "Input"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[96540, 2779, 142, 3, 37, "Section"],
Cell[CellGroupData[{
Cell[96707, 2786, 154, 2, 34, "Subsection"],
Cell[96864, 2790, 156, 3, 27, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[97057, 2798, 144, 3, 34, "Subsection"],
Cell[97204, 2803, 318, 9, 27, "Input"],
Cell[CellGroupData[{
Cell[97547, 2816, 3165, 94, 70, "Input"],
Cell[100715, 2912, 2967, 94, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[103719, 3011, 1128, 23, 33, "Input"],
Cell[104850, 3036, 753, 17, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[105640, 3058, 248, 6, 47, "Input"],
Cell[105891, 3066, 480, 9, 46, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[106408, 3080, 246, 5, 27, "Input"],
Cell[106657, 3087, 437, 7, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[107131, 3099, 1274, 28, 49, "Input"],
Cell[108408, 3129, 912, 22, 33, "Output"],
Cell[109323, 3153, 1209, 31, 85, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[110569, 3189, 160, 3, 27, "Input"],
Cell[CellGroupData[{
Cell[110754, 3196, 1559, 38, 78, "Print"],
Cell[112316, 3236, 1368, 34, 23, "Print"],
Cell[113687, 3272, 1659, 42, 106, "Print"],
Cell[115349, 3316, 604, 10, 20, "Print"],
Cell[115956, 3328, 602, 10, 20, "Print"],
Cell[116561, 3340, 623, 10, 20, "Print"],
Cell[117187, 3352, 623, 10, 20, "Print"],
Cell[117813, 3364, 606, 10, 20, "Print"],
Cell[118422, 3376, 607, 10, 20, "Print"],
Cell[119032, 3388, 499, 10, 28, "Print"],
Cell[119534, 3400, 612, 10, 20, "Print"],
Cell[120149, 3412, 417, 5, 20, "Print"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[120627, 3424, 201, 3, 34, "Subsection"],
Cell[CellGroupData[{
Cell[120853, 3431, 957, 19, 43, "Input"],
Cell[121813, 3452, 2037, 59, 55, "Output"],
Cell[123853, 3513, 626, 15, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[124516, 3533, 447, 12, 27, "Input"],
Cell[124966, 3547, 99, 1, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[125102, 3553, 722, 18, 43, "Input"],
Cell[125827, 3573, 509, 11, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[126373, 3589, 695, 14, 27, "Input"],
Cell[127071, 3605, 489, 10, 47, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[127621, 3622, 180, 2, 37, "Section"],
Cell[127804, 3626, 138, 3, 27, "Input"],
Cell[CellGroupData[{
Cell[127967, 3633, 158, 2, 34, "Subsection"],
Cell[128128, 3637, 128, 2, 27, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[128293, 3644, 123, 1, 34, "Subsection"],
Cell[CellGroupData[{
Cell[128441, 3649, 201, 4, 27, "Input"],
Cell[128645, 3655, 229, 4, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[128911, 3664, 683, 19, 33, "Input"],
Cell[129597, 3685, 700, 19, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[130334, 3709, 159, 3, 27, "Input"],
Cell[CellGroupData[{
Cell[130518, 3716, 1352, 35, 78, "Print"],
Cell[131873, 3753, 1161, 31, 23, "Print"],
Cell[133037, 3786, 1452, 39, 106, "Print"],
Cell[134492, 3827, 395, 7, 20, "Print"],
Cell[134890, 3836, 400, 7, 20, "Print"],
Cell[135293, 3845, 418, 7, 20, "Print"],
Cell[135714, 3854, 413, 7, 20, "Print"],
Cell[136130, 3863, 399, 7, 20, "Print"],
Cell[136532, 3872, 398, 7, 20, "Print"],
Cell[136933, 3881, 292, 7, 28, "Print"],
Cell[137228, 3890, 407, 7, 20, "Print"],
Cell[137638, 3899, 210, 2, 20, "Print"]
}, Open  ]]
}, Open  ]],
Cell[137875, 3905, 253, 5, 27, "Input"],
Cell[138131, 3912, 482, 12, 29, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[138650, 3929, 133, 1, 34, "Subsection"],
Cell[138786, 3932, 636, 16, 43, "Input"],
Cell[139425, 3950, 470, 12, 27, "Input"],
Cell[139898, 3964, 799, 14, 27, "Input"],
Cell[140700, 3980, 3349, 78, 199, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[144086, 4063, 121, 1, 34, "Subsection"],
Cell[144210, 4066, 7899, 229, 138, "Input"],
Cell[152112, 4297, 3906, 90, 183, "Input"],
Cell[156021, 4389, 1916, 42, 33, "Input"],
Cell[157940, 4433, 2209, 67, 33, "Input"],
Cell[160152, 4502, 1992, 45, 53, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[162181, 4552, 287, 8, 39, "Subsection"],
Cell[162471, 4562, 325, 4, 26, "Text"],
Cell[CellGroupData[{
Cell[162821, 4570, 469, 10, 27, "Input"],
Cell[163293, 4582, 748, 14, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[164078, 4601, 263, 6, 27, "Input"],
Cell[164344, 4609, 780, 13, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[165173, 4628, 151, 3, 26, "Subsection"],
Cell[165327, 4633, 295, 8, 47, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[165659, 4646, 137, 1, 34, "Subsection"],
Cell[165799, 4649, 289, 6, 27, "Input"],
Cell[CellGroupData[{
Cell[166113, 4659, 2039, 53, 49, "Input"],
Cell[168155, 4714, 2165, 55, 33, "Output"],
Cell[170323, 4771, 2480, 63, 97, "Output"]
}, Open  ]],
Cell[172818, 4837, 163, 3, 26, "Text"],
Cell[CellGroupData[{
Cell[173006, 4844, 495, 11, 27, "Input"],
Cell[173504, 4857, 4131, 107, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[177672, 4969, 260, 5, 27, "Input"],
Cell[CellGroupData[{
Cell[177957, 4978, 3335, 81, 78, "Print"],
Cell[181295, 5061, 3148, 78, 23, "Print"],
Cell[184446, 5141, 3701, 92, 116, "Print"],
Cell[188150, 5235, 1149, 19, 20, "Print"],
Cell[189302, 5256, 1154, 19, 20, "Print"],
Cell[190459, 5277, 1172, 19, 20, "Print"],
Cell[191634, 5298, 1172, 19, 20, "Print"],
Cell[192809, 5319, 1153, 19, 20, "Print"],
Cell[193965, 5340, 1151, 19, 20, "Print"],
Cell[195119, 5361, 1164, 19, 20, "Print"],
Cell[196286, 5382, 968, 14, 20, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[197303, 5402, 265, 7, 27, "Input"],
Cell[197571, 5411, 998, 26, 39, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[198618, 5443, 209, 3, 34, "Subsection"],
Cell[CellGroupData[{
Cell[198852, 5450, 1093, 21, 43, "Input"],
Cell[199948, 5473, 1942, 42, 53, "Output"]
}, Open  ]],
Cell[201905, 5518, 188, 4, 26, "Text"],
Cell[CellGroupData[{
Cell[202118, 5526, 550, 11, 27, "Input"],
Cell[202671, 5539, 356, 5, 27, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[203076, 5550, 311, 4, 34, "Subsection"],
Cell[CellGroupData[{
Cell[203412, 5558, 1317, 34, 64, "Input"],
Cell[204732, 5594, 1739, 47, 55, "Output"],
Cell[CellGroupData[{
Cell[206496, 5645, 1859, 47, 40, "Print"],
Cell[208358, 5694, 340, 4, 20, "Print"],
Cell[208701, 5700, 804, 18, 24, "Print"],
Cell[209508, 5720, 574, 10, 25, "Print"],
Cell[210085, 5732, 697, 15, 40, "Print"],
Cell[210785, 5749, 637, 14, 40, "Print"],
Cell[211425, 5765, 536, 11, 20, "Print"]
}, Open  ]]
}, Open  ]],
Cell[211988, 5780, 97, 1, 26, "Text"],
Cell[CellGroupData[{
Cell[212110, 5785, 604, 13, 27, "Input"],
Cell[212717, 5800, 2551, 63, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[215305, 5868, 437, 9, 27, "Input"],
Cell[CellGroupData[{
Cell[215767, 5881, 6087, 144, 102, "Print"],
Cell[221857, 6027, 695, 9, 20, "Print"],
Cell[222555, 6038, 3365, 82, 51, "Print"],
Cell[225923, 6122, 3826, 91, 51, "Print"],
Cell[229752, 6215, 3594, 91, 46, "Print"],
Cell[233349, 6308, 1953, 44, 51, "Print"],
Cell[235305, 6354, 3456, 85, 51, "Print"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[238822, 6446, 352, 6, 34, "Subsection"],
Cell[CellGroupData[{
Cell[239199, 6456, 869, 18, 43, "Input"],
Cell[240071, 6476, 2962, 81, 98, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[243070, 6562, 269, 7, 27, "Input"],
Cell[243342, 6571, 797, 16, 27, "Output"]
}, Open  ]],
Cell[244154, 6590, 1091, 20, 27, "Input"],
Cell[CellGroupData[{
Cell[245270, 6614, 651, 15, 27, "Input"],
Cell[245924, 6631, 1386, 36, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[247347, 6672, 557, 12, 27, "Input"],
Cell[247907, 6686, 1472, 36, 57, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[249416, 6727, 136, 2, 27, "Input"],
Cell[CellGroupData[{
Cell[249577, 6733, 1659, 43, 40, "Print"],
Cell[251239, 6778, 142, 2, 20, "Print"],
Cell[251384, 6782, 501, 14, 24, "Print"],
Cell[251888, 6798, 589, 13, 25, "Print"],
Cell[252480, 6813, 499, 13, 40, "Print"],
Cell[252982, 6828, 441, 12, 40, "Print"],
Cell[253426, 6842, 336, 9, 20, "Print"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[253823, 6858, 173, 2, 26, "Subsection"],
Cell[CellGroupData[{
Cell[254021, 6864, 237, 5, 27, "Input"],
Cell[254261, 6871, 409, 6, 27, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[254719, 6883, 213, 3, 26, "Subsection"],
Cell[254935, 6888, 307, 10, 29, "Text"],
Cell[255245, 6900, 554, 14, 27, "Input"],
Cell[CellGroupData[{
Cell[255824, 6918, 610, 16, 27, "Input"],
Cell[256437, 6936, 308, 4, 27, "Output"]
}, Open  ]],
Cell[256760, 6943, 1291, 28, 46, "Input"],
Cell[258054, 6973, 96, 1, 26, "Text"],
Cell[CellGroupData[{
Cell[258175, 6978, 803, 23, 46, "Input"],
Cell[258981, 7003, 364, 5, 27, "Output"]
}, Open  ]],
Cell[259360, 7011, 499, 11, 43, "Input"],
Cell[CellGroupData[{
Cell[259884, 7026, 559, 14, 27, "Input"],
Cell[260446, 7042, 1261, 32, 50, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[261744, 7079, 670, 19, 43, "Input"],
Cell[262417, 7100, 989, 29, 54, "Output"],
Cell[263409, 7131, 805, 21, 52, "Output"]
}, Open  ]],
Cell[264229, 7155, 90, 1, 26, "Text"],
Cell[CellGroupData[{
Cell[264344, 7160, 573, 17, 50, "Input"],
Cell[264920, 7179, 720, 21, 50, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[265677, 7205, 886, 26, 43, "Input"],
Cell[266566, 7233, 927, 27, 51, "Output"],
Cell[267496, 7262, 926, 27, 45, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[268471, 7295, 104, 1, 34, "Subsection"],
Cell[268578, 7298, 252, 7, 27, "Input"],
Cell[CellGroupData[{
Cell[268855, 7309, 595, 13, 43, "Input"],
Cell[269453, 7324, 989, 27, 50, "Output"],
Cell[270445, 7353, 489, 12, 47, "Output"]
}, Open  ]],
Cell[270949, 7368, 87, 1, 26, "Text"],
Cell[CellGroupData[{
Cell[271061, 7373, 535, 15, 27, "Input"],
Cell[271599, 7390, 448, 11, 47, "Output"]
}, Open  ]],
Cell[272062, 7404, 204, 4, 26, "Text"],
Cell[CellGroupData[{
Cell[272291, 7412, 306, 5, 43, "Input"],
Cell[272600, 7419, 354, 5, 27, "Output"],
Cell[272957, 7426, 248, 4, 20, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[273242, 7435, 254, 6, 27, "Input"],
Cell[273499, 7443, 243, 3, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[273779, 7451, 465, 12, 64, "Input"],
Cell[274247, 7465, 142, 2, 27, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[274438, 7473, 262, 3, 34, "Subsection"],
Cell[274703, 7478, 660, 13, 27, "Input"],
Cell[CellGroupData[{
Cell[275388, 7495, 105, 1, 24, "Subsubsection"],
Cell[CellGroupData[{
Cell[275518, 7500, 1759, 48, 58, "Input"],
Cell[277280, 7550, 2596, 64, 53, "Output"],
Cell[279879, 7616, 3131, 73, 68, "Output"],
Cell[283013, 7691, 2029, 51, 50, "Output"]
}, Open  ]],
Cell[285057, 7745, 89, 1, 26, "Text"],
Cell[CellGroupData[{
Cell[285171, 7750, 1562, 47, 58, "Input"],
Cell[286736, 7799, 1546, 44, 50, "Output"]
}, Open  ]],
Cell[288297, 7846, 87, 1, 26, "Text"],
Cell[CellGroupData[{
Cell[288409, 7851, 1504, 45, 58, "Input"],
Cell[289916, 7898, 1470, 43, 50, "Output"]
}, Open  ]],
Cell[291401, 7944, 88, 1, 26, "Text"],
Cell[CellGroupData[{
Cell[291514, 7949, 1433, 44, 58, "Input"],
Cell[292950, 7995, 1349, 42, 50, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[294348, 8043, 104, 1, 24, "Subsubsection"],
Cell[CellGroupData[{
Cell[294477, 8048, 216, 6, 27, "Input"],
Cell[294696, 8056, 147, 3, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[294880, 8064, 283, 8, 27, "Input"],
Cell[295166, 8074, 228, 5, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[295431, 8084, 514, 12, 27, "Input"],
Cell[295948, 8098, 766, 15, 27, "Output"]
}, Open  ]],
Cell[296729, 8116, 89, 1, 26, "Text"],
Cell[CellGroupData[{
Cell[296843, 8121, 742, 19, 43, "Input"],
Cell[297588, 8142, 1205, 34, 55, "Output"],
Cell[298796, 8178, 443, 9, 27, "Output"]
}, Open  ]],
Cell[299254, 8190, 90, 1, 26, "Text"],
Cell[CellGroupData[{
Cell[299369, 8195, 727, 20, 43, "Input"],
Cell[300099, 8217, 638, 16, 27, "Output"],
Cell[300740, 8235, 367, 8, 27, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[301156, 8249, 103, 1, 24, "Subsubsection"],
Cell[CellGroupData[{
Cell[301284, 8254, 762, 19, 27, "Input"],
Cell[302049, 8275, 1267, 35, 33, "Output"]
}, Open  ]],
Cell[303331, 8313, 87, 1, 26, "Text"],
Cell[CellGroupData[{
Cell[303443, 8318, 702, 21, 43, "Input"],
Cell[304148, 8341, 580, 16, 48, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[304765, 8362, 748, 21, 43, "Input"],
Cell[305516, 8385, 643, 16, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[306196, 8406, 246, 5, 27, "Input"],
Cell[306445, 8413, 1096, 33, 33, "Output"]
}, Open  ]],
Cell[307556, 8449, 89, 1, 26, "Text"],
Cell[CellGroupData[{
Cell[307670, 8454, 795, 23, 43, "Input"],
Cell[308468, 8479, 1118, 33, 33, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[309647, 8519, 157, 3, 34, "Subsection"],
Cell[CellGroupData[{
Cell[309829, 8526, 1007, 29, 72, "Input"],
Cell[310839, 8557, 1056, 26, 50, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[311932, 8588, 439, 13, 27, "Input"],
Cell[312374, 8603, 454, 7, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[312865, 8615, 482, 14, 27, "Input"],
Cell[313350, 8631, 284, 5, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[313671, 8641, 965, 19, 43, "Input"],
Cell[314639, 8662, 1343, 32, 50, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[316019, 8699, 382, 11, 27, "Input"],
Cell[316404, 8712, 234, 4, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[316675, 8721, 490, 13, 43, "Input"],
Cell[317168, 8736, 881, 28, 57, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[318098, 8770, 162, 2, 34, "Subsection"],
Cell[318263, 8774, 415, 11, 27, "Input"],
Cell[318681, 8787, 287, 7, 27, "Input"],
Cell[CellGroupData[{
Cell[318993, 8798, 125, 2, 27, "Input"],
Cell[319121, 8802, 511, 12, 27, "Output"]
}, Open  ]],
Cell[319647, 8817, 263, 7, 27, "Input"],
Cell[319913, 8826, 263, 7, 27, "Input"],
Cell[320179, 8835, 91, 1, 26, "Text"],
Cell[CellGroupData[{
Cell[320295, 8840, 569, 17, 30, "Input"],
Cell[320867, 8859, 124, 2, 27, "Output"]
}, Open  ]],
Cell[321006, 8864, 180, 4, 27, "Input"],
Cell[CellGroupData[{
Cell[321211, 8872, 3292, 95, 131, "Input"],
Cell[324506, 8969, 2001, 61, 59, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[326544, 9035, 5079, 152, 151, "Input"],
Cell[331626, 9189, 2948, 90, 76, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[334611, 9284, 4890, 149, 151, "Input"],
Cell[339504, 9435, 2921, 90, 76, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[342462, 9530, 4839, 148, 151, "Input"],
Cell[347304, 9680, 2895, 89, 76, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[350236, 9774, 317, 7, 43, "Input"],
Cell[350556, 9783, 235, 3, 27, "Output"],
Cell[350794, 9788, 237, 3, 27, "Output"]
}, Open  ]],
Cell[351046, 9794, 544, 14, 27, "Input"],
Cell[CellGroupData[{
Cell[351615, 9812, 940, 26, 43, "Input"],
Cell[352558, 9840, 5165, 148, 96, "Output"]
}, Open  ]],
Cell[357738, 9991, 89, 1, 26, "Text"],
Cell[CellGroupData[{
Cell[357852, 9996, 427, 12, 27, "Input"],
Cell[358282, 10010, 221, 3, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[358540, 10018, 1023, 26, 64, "Input"],
Cell[359566, 10046, 1048, 27, 50, "Output"]
}, Open  ]],
Cell[360629, 10076, 87, 1, 26, "Text"],
Cell[CellGroupData[{
Cell[360741, 10081, 891, 24, 64, "Input"],
Cell[361635, 10107, 875, 25, 50, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[362547, 10137, 364, 9, 47, "Input"],
Cell[362914, 10148, 390, 10, 47, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[363353, 10164, 132, 3, 34, "Subsection"],
Cell[CellGroupData[{
Cell[363510, 10171, 1308, 39, 58, "Input"],
Cell[364821, 10212, 2512, 67, 80, "Output"],
Cell[367336, 10281, 2842, 86, 50, "Output"]
}, Open  ]],
Cell[370193, 10370, 88, 1, 26, "Text"],
Cell[CellGroupData[{
Cell[370306, 10375, 1334, 41, 58, "Input"],
Cell[371643, 10418, 2746, 84, 50, "Output"]
}, Open  ]],
Cell[374404, 10505, 89, 1, 26, "Text"],
Cell[CellGroupData[{
Cell[374518, 10510, 1342, 41, 58, "Input"],
Cell[375863, 10553, 2748, 84, 50, "Output"]
}, Open  ]],
Cell[378626, 10640, 134, 3, 26, "Text"],
Cell[CellGroupData[{
Cell[378785, 10647, 1596, 42, 58, "Input"],
Cell[380384, 10691, 1523, 39, 33, "Output"],
Cell[381910, 10732, 1263, 30, 30, "Output"],
Cell[383176, 10764, 1511, 45, 50, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[384736, 10815, 249, 5, 34, "Subsection"],
Cell[CellGroupData[{
Cell[385010, 10824, 358, 9, 30, "Input"],
Cell[385371, 10835, 547, 13, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[385955, 10853, 474, 9, 27, "Input"],
Cell[386432, 10864, 694, 14, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[387163, 10883, 874, 20, 43, "Input"],
Cell[388040, 10905, 1701, 42, 52, "Output"],
Cell[389744, 10949, 1454, 37, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[391235, 10991, 1388, 34, 43, "Input"],
Cell[392626, 11027, 1201, 27, 52, "Output"],
Cell[393830, 11056, 882, 18, 50, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[394761, 11080, 218, 4, 26, "Subsection"],
Cell[CellGroupData[{
Cell[395004, 11088, 443, 11, 33, "Input"],
Cell[395450, 11101, 418, 12, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[395905, 11118, 644, 16, 27, "Input"],
Cell[396552, 11136, 742, 18, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[397331, 11159, 1041, 29, 43, "Input"],
Cell[398375, 11190, 483, 14, 34, "Output"],
Cell[398861, 11206, 241, 7, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[399139, 11218, 402, 10, 27, "Input"],
Cell[399544, 11230, 772, 20, 50, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[400353, 11255, 405, 10, 27, "Input"],
Cell[400761, 11267, 630, 15, 33, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[401440, 11288, 251, 5, 26, "Subsection"],
Cell[CellGroupData[{
Cell[401716, 11297, 1847, 53, 81, "Input"],
Cell[403566, 11352, 1048, 30, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[404651, 11387, 218, 5, 27, "Input"],
Cell[404872, 11394, 1971, 53, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[406880, 11452, 285, 7, 30, "Input"],
Cell[407168, 11461, 257, 7, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[407462, 11473, 915, 22, 33, "Input"],
Cell[408380, 11497, 1709, 42, 80, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[410126, 11544, 302, 8, 27, "Input"],
Cell[410431, 11554, 1069, 28, 50, "Output"]
}, Open  ]]
}, Closed]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
