(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    171885,       5094]
NotebookOptionsPosition[    160304,       4749]
NotebookOutlinePosition[    160681,       4766]
CellTagsIndexPosition[    160638,       4763]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
mk_fourier_spectral_operators revisited\
\>", "Section",
 CellChangeTimes->{{3.655590744365844*^9, 3.655590772491901*^9}}],

Cell[BoxData[
 RowBox[{"Quit", "[", "]"}]], "Input",
 CellChangeTimes->{{3.655153761350109*^9, 3.65515376261451*^9}}],

Cell[BoxData[
 RowBox[{"origPoints", " ", "=", " ", 
  RowBox[{
   RowBox[{"-", "\[Pi]"}], "+", 
   FractionBox[
    RowBox[{"2", " ", "\[Pi]", " ", "i"}], "Np"]}]}]], "Input",
 CellChangeTimes->{{3.655150793279812*^9, 3.655150831239789*^9}, {
  3.655151342142723*^9, 3.655151343158386*^9}, {3.6551513859324837`*^9, 
  3.655151386100369*^9}, {3.655153718216855*^9, 3.655153720832675*^9}}],

Cell[BoxData[
 RowBox[{"scaledPoints", " ", "=", " ", 
  RowBox[{
   RowBox[{"origPoints", " ", "*", " ", 
    FractionBox[
     RowBox[{"(", 
      RowBox[{"b", "-", "a"}], ")"}], 
     RowBox[{"2", " ", "\[Pi]"}]]}], " ", "//", " ", "Simplify"}]}]], "Input",\

 CellChangeTimes->{{3.655150834467767*^9, 3.655150877661848*^9}}],

Cell[BoxData[
 RowBox[{"shiftandscaledPoints", " ", "=", " ", 
  RowBox[{
   RowBox[{"scaledPoints", " ", "+", " ", 
    FractionBox[
     RowBox[{"(", 
      RowBox[{"b", "-", "a"}], ")"}], "2"], "+", " ", "a"}], " ", "//", " ", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.655150906522875*^9, 3.655150929202509*^9}, {
  3.655151199181274*^9, 3.655151247611217*^9}, {3.655151513774433*^9, 
  3.655151514374119*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Simplify", "@", "origPoints"}], " ", "==", " ", 
  RowBox[{"Simplify", "@", 
   RowBox[{"(", 
    RowBox[{"shiftandscaledPoints", " ", "/.", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", "\[Rule]", " ", 
        RowBox[{"-", "\[Pi]"}]}], ",", " ", 
       RowBox[{"b", "\[Rule]", " ", "\[Pi]"}]}], "}"}]}], ")"}]}]}]], "Input",\

 CellChangeTimes->{{3.655150973200231*^9, 3.655151065676188*^9}}],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"shiftandscaledPoints", " ", "/.", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", "\[Rule]", " ", 
        RowBox[{"-", "\[Pi]"}]}], ",", " ", 
       RowBox[{"b", "\[Rule]", " ", "\[Pi]"}], ",", " ", 
       RowBox[{"Np", "\[Rule]", " ", "51"}]}], "}"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "0", ",", "50"}], "}"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6551509378460503`*^9, 3.655150967377304*^9}, {
  3.655151089707018*^9, 3.6551511004832*^9}, {3.655151310888871*^9, 
  3.655151321111948*^9}, {3.655153730007979*^9, 3.655153731584453*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"x", "[", 
    RowBox[{"asub_", ",", "bsub_", ",", "Nsub_"}], "]"}], " ", ":=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"N", "@", "shiftandscaledPoints"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", 
         RowBox[{"Nsub", "-", "1"}]}], "}"}]}], "]"}], " ", "//.", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", "\[Rule]", " ", "asub"}], ",", " ", 
       RowBox[{"b", "\[Rule]", " ", "bsub"}], ",", " ", 
       RowBox[{"Np", "\[Rule]", " ", "Nsub"}]}], "}"}]}], ")"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.655153852104765*^9, 3.6551538865208282`*^9}, {
  3.6551545981978273`*^9, 3.655154646506571*^9}, {3.655156822438856*^9, 
  3.655156830774581*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"asub", "=", 
   RowBox[{"-", "\[Pi]"}]}], ";", " ", 
  RowBox[{"bsub", "=", "\[Pi]"}], ";", " ", 
  RowBox[{"Nsub", " ", "=", " ", "51"}], ";"}]], "Input",
 CellChangeTimes->{{3.655154667869948*^9, 3.6551546834085712`*^9}, {
  3.655156788272337*^9, 3.6551567903920517`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"N", "@", 
      RowBox[{"Min", "@", "#"}]}], ",", 
     RowBox[{"N", "@", 
      RowBox[{"Max", "@", "#"}]}], ",", 
     RowBox[{"Length", "@", "#"}]}], "}"}], "&"}], "@", " ", 
  RowBox[{"x", "[", 
   RowBox[{"asub", ",", "bsub", ",", "Nsub"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.655151143711863*^9, 3.6551511681763487`*^9}, {
   3.655151268571808*^9, 3.655151276394033*^9}, 3.65515373432936*^9, {
   3.655153780535063*^9, 3.6551537830226927`*^9}, 3.655153850572686*^9, {
   3.655153890808606*^9, 3.65515389167177*^9}, {3.655154664625476*^9, 
   3.655154688921275*^9}, {3.6551568371267223`*^9, 3.655156838518098*^9}}],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"shiftandscaledPoints", " ", "/.", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", "\[Rule]", " ", "2"}], ",", " ", 
       RowBox[{"b", "\[Rule]", " ", "10"}], ",", " ", 
       RowBox[{"Np", "\[Rule]", " ", "Nsub"}]}], "}"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "0", ",", 
      RowBox[{"Nsub", "-", "1"}]}], "}"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.655151123857177*^9, 3.6551511288893023`*^9}, 
   3.655153736496399*^9, {3.655153841650893*^9, 3.65515384524258*^9}, {
   3.65515390507996*^9, 3.65515390953561*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"d1", " ", "=", " ", 
   FractionBox[
    RowBox[{"\[Pi]", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"-", "1"}], ")"}], 
      RowBox[{"i", "+", "j"}]]}], 
    RowBox[{
     RowBox[{"Sin", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"i", "-", "j"}], ")"}], " ", 
       FractionBox["\[Pi]", "Np"]}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{"b", "-", "a"}], ")"}]}]]}], ";"}]], "Input",
 CellChangeTimes->{{3.6551532693442097`*^9, 3.6551533235169764`*^9}, 
   3.6551537394969482`*^9, {3.655154411022931*^9, 3.655154416862465*^9}, {
   3.655154486475398*^9, 3.655154486811421*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"d1mat", "[", 
    RowBox[{"asub_", ",", "bsub_", ",", "Nsub_"}], "]"}], ":=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"i", "\[Equal]", "j"}], ",", "0.0", ",", 
         RowBox[{"N", "@", "d1"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", 
         RowBox[{"Np", "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "0", ",", 
         RowBox[{"Np", "-", "1"}]}], "}"}]}], "]"}], " ", "//.", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Np", "\[Rule]", " ", "Nsub"}], ",", " ", 
       RowBox[{"a", "\[Rule]", " ", "asub"}], ",", " ", 
       RowBox[{"b", "\[Rule]", " ", "bsub"}]}], "}"}]}], ")"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6551541974309607`*^9, 3.655154254327396*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"d1orig", " ", "=", " ", 
   FractionBox[
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"-", "1"}], ")"}], 
     RowBox[{"i", "+", "j"}]], 
    RowBox[{"2", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"i", "-", "j"}], ")"}], " ", 
       FractionBox["\[Pi]", "Np"]}], "]"}]}]]}], ";"}]], "Input",
 CellChangeTimes->{{3.6551534945160437`*^9, 3.655153568440838*^9}, 
   3.6551537515517817`*^9, {3.655154421278438*^9, 3.655154422206341*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Simplify", "[", 
   RowBox[{"d1orig", " ", 
    FractionBox[
     RowBox[{"2", " ", "\[Pi]"}], 
     RowBox[{"b", "-", "a"}]]}], "]"}], " ", "\[Equal]", " ", 
  RowBox[{"Simplify", "[", "d1", "]"}]}]], "Input",
 CellChangeTimes->{{3.6551554034666*^9, 3.655155432691915*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"d1matorig", "[", "Nsub_", "]"}], " ", ":=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"i", "\[Equal]", "j"}], ",", "0.0", ",", 
         RowBox[{"N", "@", "d1orig"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", 
         RowBox[{"Np", "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "0", ",", 
         RowBox[{"Np", "-", "1"}]}], "}"}]}], "]"}], " ", "//.", " ", 
     RowBox[{"{", 
      RowBox[{"Np", "\[Rule]", " ", "Nsub"}], "}"}]}], ")"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.655153579785368*^9, 3.6551535870392323`*^9}, {
  3.655153752999508*^9, 3.6551537560949783`*^9}, {3.6551538035489264`*^9, 
  3.655153827883072*^9}, {3.655153975308917*^9, 3.655153975588518*^9}, {
  3.655154264870474*^9, 3.655154280813568*^9}, {3.65515434047404*^9, 
  3.655154346482342*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"d1matorig", "[", "Nsub", "]"}], " ", "\[Equal]", " ", 
  RowBox[{"d1mat", "[", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], ",", "\[Pi]", ",", "Nsub"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6551542878096447`*^9, 3.655154315258739*^9}, {
  3.655154355521289*^9, 3.6551543572807713`*^9}, {3.6551547179512157`*^9, 
  3.655154721518672*^9}}],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"#", ",", 
      RowBox[{"Sin", "[", "#", "]"}]}], "}"}], "&"}], "/@", 
   RowBox[{"x", "[", 
    RowBox[{"asub", ",", "bsub", ",", "Nsub"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.655153829770914*^9, 3.655153831066245*^9}, {
  3.655153992922329*^9, 3.6551540280495033`*^9}, {3.655154732646964*^9, 
  3.655154734830585*^9}, {3.65515507990329*^9, 3.6551550862371187`*^9}, {
  3.655156884596385*^9, 3.655156885947163*^9}}],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"ListPlot", "[", 
    RowBox[{"Thread", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"asub", ",", "bsub", ",", "Nsub"}], "]"}], ",", 
       RowBox[{
        RowBox[{"d1mat", "[", 
         RowBox[{"asub", ",", "bsub", ",", "Nsub"}], "]"}], ".", 
        RowBox[{"Sin", "[", 
         RowBox[{"x", "[", 
          RowBox[{"asub", ",", "bsub", ",", "Nsub"}], "]"}], "]"}]}]}], "}"}],
      "]"}], "]"}], ",", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"Cos", "[", "x", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}]}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.655154104305175*^9, 3.655154116724783*^9}, {
  3.65515455175161*^9, 3.655154557390983*^9}, {3.655154748456993*^9, 
  3.655154760501253*^9}, {3.655155094237002*^9, 3.655155233334446*^9}, {
  3.655156892395446*^9, 3.6551569000036707`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"d1mat", "[", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], ",", "\[Pi]", ",", "5"}], "]"}], " ", "//", " ", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.6551545416875143`*^9, 3.655154546687203*^9}, {
  3.6551548964275627`*^9, 3.655154908333261*^9}, {3.6551549478434153`*^9, 
  3.655154949915141*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"d1mat", "[", 
    RowBox[{
     RowBox[{"-", "\[Pi]"}], ",", "\[Pi]", ",", "5"}], "]"}], ".", 
   RowBox[{"d1mat", "[", 
    RowBox[{
     RowBox[{"-", "\[Pi]"}], ",", "\[Pi]", ",", "5"}], "]"}]}], " ", "//", 
  " ", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.655231010707868*^9, 3.6552310108999567`*^9}}],

Cell[BoxData[
 RowBox[{"x", "[", 
  RowBox[{
   RowBox[{"-", "\[Pi]"}], ",", "\[Pi]", ",", "5"}], "]"}]], "Input",
 CellChangeTimes->{{3.6551549233143587`*^9, 3.6551549265323467`*^9}, {
  3.655156907745607*^9, 3.6551569168651867`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"d2orig", " ", "=", " ", 
   FractionBox[
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", "Mp"}], ")"}], "2"], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"j", "-", "i"}], ")"}], " ", "\[Pi]", " ", 
          FractionBox[
           RowBox[{"(", 
            RowBox[{"Np", "-", "2"}], ")"}], "Np"]}], "]"}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"j", "-", "i"}], ")"}], " ", 
           FractionBox["\[Pi]", "Np"]}], "]"}], "3"], " "}]], "+", 
      RowBox[{
       SuperscriptBox["Mp", "2"], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"j", "-", "i"}], ")"}], " ", "\[Pi]", " ", 
         FractionBox[
          RowBox[{"(", 
           RowBox[{"Np", "+", "2"}], ")"}], "Np"]}], "]"}]}]}], ")"}], 
    RowBox[{"4", " ", "Np"}]]}], ";"}]], "Input",
 CellChangeTimes->{{3.6551553748492317`*^9, 3.6551553824615307`*^9}, {
  3.655155467825651*^9, 3.655155544982834*^9}, {3.655155711888338*^9, 
  3.655155720877603*^9}, {3.655155765045697*^9, 3.655155784600442*^9}, {
  3.6551558322746277`*^9, 3.655155867183258*^9}, {3.655155929723876*^9, 
  3.6551560338077803`*^9}, {3.655156407596376*^9, 3.655156432541626*^9}, {
  3.65515653459939*^9, 3.655156546605783*^9}, {3.655156635569347*^9, 
  3.655156636625766*^9}, {3.6551576018498783`*^9, 3.6551576357204037`*^9}}],

Cell[BoxData[
 RowBox[{"d2", " ", "=", " ", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{"-", "1"}], 
     SuperscriptBox["Np", "2"]], 
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox[
       RowBox[{"2", " ", "\[Pi]"}], 
       RowBox[{"b", "-", "a"}]], ")"}], "2"], " ", "*", " ", "d2orig"}], " ", 
   "//", " ", "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.6551560509924*^9, 3.655156089403677*^9}, {
  3.6551567610738*^9, 3.6551567688257017`*^9}, {3.655157644670623*^9, 
  3.6551576521900787`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "Mp"}], " ", 
     FractionBox[
      RowBox[{"(", 
       RowBox[{"1", "+", "Mp"}], ")"}], "3"]}], " ", "/.", " ", 
    RowBox[{"{", 
     RowBox[{"Mp", "\[Rule]", 
      FractionBox[
       RowBox[{"(", 
        RowBox[{"Np", "-", "1"}], ")"}], "2"]}], "}"}]}], ")"}], " ", "//", 
  " ", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.655156214344034*^9, 3.655156283249818*^9}, {
  3.65515650788913*^9, 3.6551565279730988`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"d2mat", "[", 
    RowBox[{"asub_", ",", "bsub_", ",", "Nsub_"}], "]"}], ":=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"i", "\[Equal]", "j"}], ",", " ", 
         RowBox[{
          FractionBox[
           RowBox[{"-", "1"}], 
           SuperscriptBox["Np", "2"]], 
          FractionBox[
           RowBox[{"(", 
            RowBox[{"1", "-", 
             SuperscriptBox["Np", "2"]}], ")"}], "12"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"2", " ", 
             FractionBox["\[Pi]", 
              RowBox[{"b", "-", "a"}]]}], ")"}], "2"]}], ",", 
         RowBox[{"N", "@", "d2"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", 
         RowBox[{"Np", "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "0", ",", 
         RowBox[{"Np", "-", "1"}]}], "}"}]}], "]"}], " ", "//.", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Mp", "\[Rule]", " ", 
        FractionBox[
         RowBox[{"(", 
          RowBox[{"Nsub", "-", "1"}], ")"}], "2"]}], ",", 
       RowBox[{"Np", "\[Rule]", " ", "Nsub"}], ",", " ", 
       RowBox[{"a", "\[Rule]", " ", "asub"}], ",", " ", 
       RowBox[{"b", "\[Rule]", " ", "bsub"}]}], "}"}]}], ")"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.655156103139421*^9, 3.655156109531315*^9}, {
  3.6551563151372833`*^9, 3.655156343919249*^9}, {3.655156467826412*^9, 
  3.655156487759646*^9}, {3.6551566472093267`*^9, 3.655156690647347*^9}, {
  3.6551576679672194`*^9, 3.655157685837167*^9}}],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"ListPlot", "[", 
    RowBox[{"Thread", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"asub", ",", "bsub", ",", "Nsub"}], "]"}], ",", 
       RowBox[{
        RowBox[{"d2mat", "[", 
         RowBox[{"asub", ",", "bsub", ",", "Nsub"}], "]"}], ".", 
        RowBox[{"Sin", "[", 
         RowBox[{"x", "[", 
          RowBox[{"asub", ",", "bsub", ",", "Nsub"}], "]"}], "]"}]}]}], "}"}],
      "]"}], "]"}], ",", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Sin", "[", "x", "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}]}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.655156128129233*^9, 3.655156132528862*^9}, {
  3.6551569565042048`*^9, 3.65515696523018*^9}, {3.655157113481565*^9, 
  3.655157128327496*^9}, {3.6551574939589653`*^9, 3.6551575765301533`*^9}, {
  3.655157749490309*^9, 3.655157770400722*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"d2mat", "[", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], ",", "\[Pi]", ",", "5"}], "]"}], " ", "//", " ", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.655230984539833*^9, 3.65523098476413*^9}}],

Cell[BoxData[
 RowBox[{"Nsub", " ", "=", " ", "11"}]], "Input",
 CellChangeTimes->{{3.655157827989543*^9, 3.655157834155653*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}]}], "}"}], "\[ConjugateTranspose]"}], 
  "  ", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.6551580006965437`*^9, 3.6551580732324467`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"d1mat", "[", 
    RowBox[{"asub", ",", "bsub", ",", "Nsub"}], "]"}], " ", "+", " ", 
   RowBox[{
    RowBox[{"d1mat", "[", 
     RowBox[{"asub", ",", "bsub", ",", "Nsub"}], "]"}], 
    "\[ConjugateTranspose]"}]}], " ", "//", " ", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.6551569749764423`*^9, 3.655156981382307*^9}, {
  3.655157133118905*^9, 3.655157156749825*^9}, {3.655157734113798*^9, 
  3.655157735265071*^9}, {3.655157794135144*^9, 3.6551578192451363`*^9}, {
  3.6551578543639383`*^9, 3.655157862674376*^9}, {3.6551579606404133`*^9, 
  3.655157995261882*^9}, {3.655158078624186*^9, 3.6551580957593317`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "solving wave equation with ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[Phi]", "2"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " and ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[Phi]", "4"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " potential"
}], "Section",
 CellChangeTimes->{{3.655575111199752*^9, 3.655575114645688*^9}, {
  3.655590787668131*^9, 3.655590842472245*^9}}],

Cell[BoxData[
 RowBox[{"Quit", "[", "]"}]], "Input",
 CellChangeTimes->{{3.655576157110862*^9, 3.6555761597959414`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"m", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", " ", "=", " ", "100"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Vprime", " ", "=", " ", 
   RowBox[{
    RowBox[{
     SuperscriptBox["m", "2"], " ", 
     RowBox[{"\[Phi]", "[", 
      RowBox[{"x", ",", "t"}], "]"}]}], " ", "+", " ", 
    RowBox[{
     FractionBox["g", "6"], " ", 
     SuperscriptBox[
      RowBox[{"\[Phi]", "[", 
       RowBox[{"x", ",", "t"}], "]"}], "3"]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Phi]init", " ", "=", " ", 
   RowBox[{"Sin", "[", "x", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d\[Phi]init", " ", "=", " ", 
   RowBox[{"-", 
    RowBox[{"Cos", "[", "x", "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.655576703488723*^9, 3.655576710833851*^9}, {
  3.655576883083097*^9, 3.655576883227063*^9}, {3.655577149159746*^9, 
  3.655577149423852*^9}, {3.655577373533228*^9, 3.655577373684922*^9}, {
  3.6555774374752417`*^9, 3.655577437585413*^9}, {3.65558085456282*^9, 
  3.655580949179134*^9}, {3.655580979913741*^9, 3.6555810061439466`*^9}, {
  3.655581201594098*^9, 3.655581207863261*^9}, {3.6555828020702553`*^9, 
  3.655582804732607*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"eqn", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"x", ",", "t"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "2"}], "}"}]}], "]"}], " ", "-", " ", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"x", ",", "t"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "2"}], "}"}]}], "]"}], " ", "+", " ", "Vprime"}], 
    " ", "\[Equal]", " ", "0"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.655575846843227*^9, 3.655575849034733*^9}, {
  3.65557656569197*^9, 3.6555766002163067`*^9}, {3.655576716442801*^9, 
  3.65557671814624*^9}, {3.6555768804782457`*^9, 3.655576891243807*^9}, {
  3.655576991349042*^9, 3.655577007378632*^9}, {3.6555809102516336`*^9, 
  3.655580912971179*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ic", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Phi]", "[", 
       RowBox[{
        RowBox[{"-", "\[Pi]"}], ",", "t"}], "]"}], "\[Equal]", " ", 
      RowBox[{"\[Phi]", "[", 
       RowBox[{"\[Pi]", ",", "t"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"\[Phi]", "[", 
       RowBox[{"x", ",", "0"}], "]"}], "\[Equal]", "\[Phi]init"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Derivative", "[", 
         RowBox[{"0", ",", "1"}], "]"}], "[", "\[Phi]", "]"}], "[", 
       RowBox[{"x", ",", "0"}], "]"}], "\[Equal]", "d\[Phi]init"}]}], "}"}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.655575850673994*^9, 3.655575866747387*^9}, {
  3.655575907913494*^9, 3.655575930672083*^9}, {3.6555763295763893`*^9, 
  3.655576331503717*^9}, {3.6555763759376717`*^9, 3.655576378037133*^9}, {
  3.6555764327087717`*^9, 3.655576452656415*^9}, {3.655576667597452*^9, 
  3.655576686588431*^9}, {3.655576737201189*^9, 3.65557673926538*^9}, {
  3.6555809301655283`*^9, 3.65558094624299*^9}}],

Cell[BoxData[
 RowBox[{"sol", " ", "=", " ", 
  RowBox[{
   RowBox[{"NDSolve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"eqn", ",", "ic"}], "}"}], ",", "\[Phi]", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"MaxStepFraction", "\[Rule]", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "2"}]]}], ",", " ", 
     RowBox[{"MaxStepSize", "\[Rule]", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "2"}]]}], ",", " ", 
     RowBox[{"Method", "\[Rule]", " ", 
      RowBox[{"{", "\"\<ExplicitRungeKutta\>\"", "}"}]}]}], "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "1"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.655575452228568*^9, 3.655575611224907*^9}, {
  3.655575801889556*^9, 3.655575864577633*^9}, {3.655575934047493*^9, 
  3.6555759355597153`*^9}, {3.655575985577696*^9, 3.655575986263809*^9}, {
  3.655576386647546*^9, 3.6555764196074877`*^9}, {3.6555764893278027`*^9, 
  3.655576504902896*^9}, {3.655576624111209*^9, 3.6555766245750227`*^9}, {
  3.655576690843895*^9, 3.655576691395462*^9}, {3.655577352246397*^9, 
  3.65557737107928*^9}, {3.6555834248502398`*^9, 3.655583462613618*^9}, {
  3.655583499436181*^9, 3.655583500467737*^9}, {3.655583563924025*^9, 
  3.655583611264083*^9}, {3.6555836953002853`*^9, 3.655583707702157*^9}, {
  3.6555837469900723`*^9, 3.6555837934372387`*^9}, {3.6555838323532143`*^9, 
  3.655583893835231*^9}, {3.65558392615555*^9, 3.655583927987*^9}}],

Cell[BoxData[
 RowBox[{"Plot3D", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"\[Phi]", "/.", "sol"}], ")"}], "[", 
    RowBox[{"x", ",", "t"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "\[Pi]"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.655576462212126*^9, 3.6555765338030863`*^9}, {
  3.655576628414688*^9, 3.6555766285027733`*^9}, {3.655576694515492*^9, 
  3.655576694819356*^9}}],

Cell["not working", "Text",
 CellChangeTimes->{{3.655590858439865*^9, 3.655590859471366*^9}}],

Cell[BoxData[
 RowBox[{"exact", " ", "=", " ", 
  RowBox[{"DSolve", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"FullSimplify", "[", "eqn", "]"}], ",", 
      RowBox[{"FullSimplify", "[", "ic", "]"}]}], "}"}], ",", "\[Phi]", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "t"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.655577384661108*^9, 3.655577413217811*^9}}],

Cell["generally working:", "Text",
 CellChangeTimes->{{3.655590861551161*^9, 3.655590863646982*^9}}],

Cell[BoxData[
 RowBox[{"DSolve", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"y", "[", "x", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "2"}], "}"}]}], "]"}], " ", "-", " ", "5"}], " ", 
     "\[Equal]", " ", "0"}], "}"}], ",", "y", ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.655576199099813*^9, 3.655576289688387*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
further nonlinear potentials...\
\>", "Section",
 CellChangeTimes->{{3.6555882075010843`*^9, 3.6555882174267807`*^9}, {
  3.655590900862691*^9, 3.655590901149006*^9}}],

Cell[BoxData[
 RowBox[{"Quit", "[", "]"}]], "Input",
 CellChangeTimes->{{3.655589819877903*^9, 3.6555898210950613`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"func", " ", "=", " ", 
   RowBox[{"Tanh", "[", 
    SuperscriptBox["x", "4"], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.655588377883973*^9, 3.6555883840535994`*^9}}],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{"func", ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6555882186333027`*^9, 3.655588277024762*^9}, {
  3.6555883671593227`*^9, 3.655588389045083*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Vprime", " ", "=", " ", 
   RowBox[{"Tanh", "[", 
    SuperscriptBox[
     RowBox[{"\[Phi]", "[", 
      RowBox[{"x", ",", "t"}], "]"}], "4"], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Phi]init", " ", "=", " ", 
   RowBox[{"Sin", "[", "x", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d\[Phi]init", " ", "=", " ", "0"}], ";"}]}], "Input",
 CellChangeTimes->{{3.655576703488723*^9, 3.655576710833851*^9}, {
  3.655576883083097*^9, 3.655576883227063*^9}, {3.655577149159746*^9, 
  3.655577149423852*^9}, {3.655577373533228*^9, 3.655577373684922*^9}, {
  3.6555774374752417`*^9, 3.655577437585413*^9}, {3.65558085456282*^9, 
  3.655580949179134*^9}, {3.655580979913741*^9, 3.6555810061439466`*^9}, {
  3.655581201594098*^9, 3.655581207863261*^9}, {3.6555828020702553`*^9, 
  3.655582804732607*^9}, {3.6555885789334497`*^9, 3.6555885939883204`*^9}, {
  3.65558863691512*^9, 3.655588644545599*^9}, {3.655589868473386*^9, 
  3.6555898709124928`*^9}, {3.655590315738106*^9, 3.655590324440093*^9}, {
  3.6555903847396297`*^9, 3.655590385490342*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"eqn", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"x", ",", "t"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "2"}], "}"}]}], "]"}], " ", "-", " ", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"x", ",", "t"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "2"}], "}"}]}], "]"}], " ", "+", " ", "Vprime"}], 
    " ", "\[Equal]", " ", "0"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.655575846843227*^9, 3.655575849034733*^9}, {
  3.65557656569197*^9, 3.6555766002163067`*^9}, {3.655576716442801*^9, 
  3.65557671814624*^9}, {3.6555768804782457`*^9, 3.655576891243807*^9}, {
  3.655576991349042*^9, 3.655577007378632*^9}, {3.6555809102516336`*^9, 
  3.655580912971179*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ic", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Phi]", "[", 
       RowBox[{
        RowBox[{"-", "\[Pi]"}], ",", "t"}], "]"}], "\[Equal]", " ", 
      RowBox[{"\[Phi]", "[", 
       RowBox[{"\[Pi]", ",", "t"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"\[Phi]", "[", 
       RowBox[{"x", ",", "0"}], "]"}], "\[Equal]", "\[Phi]init"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Derivative", "[", 
         RowBox[{"0", ",", "1"}], "]"}], "[", "\[Phi]", "]"}], "[", 
       RowBox[{"x", ",", "0"}], "]"}], "\[Equal]", "d\[Phi]init"}]}], "}"}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.655575850673994*^9, 3.655575866747387*^9}, {
  3.655575907913494*^9, 3.655575930672083*^9}, {3.6555763295763893`*^9, 
  3.655576331503717*^9}, {3.6555763759376717`*^9, 3.655576378037133*^9}, {
  3.6555764327087717`*^9, 3.655576452656415*^9}, {3.655576667597452*^9, 
  3.655576686588431*^9}, {3.655576737201189*^9, 3.65557673926538*^9}, {
  3.6555809301655283`*^9, 3.65558094624299*^9}}],

Cell[BoxData[
 RowBox[{"sol", " ", "=", " ", 
  RowBox[{
   RowBox[{"NDSolve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"eqn", ",", "ic"}], "}"}], ",", "\[Phi]", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"MaxStepFraction", "\[Rule]", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "3"}]]}], ",", " ", 
     RowBox[{"MaxStepSize", "\[Rule]", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "3"}]]}], ",", " ", 
     RowBox[{"Method", "\[Rule]", " ", "Automatic"}]}], "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "1"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQnRfQ/rnE5rVjgVE6eymQtiu3kQfRP6qF1EG0QOtB
fRBt8PIjmK6pMTID0QqFHmB6046QDBDdVVCcA6JjarVKQXTbE5lyEM3Wz9wG
oqelCYFpA8boPhC9YHkOmK55xP4QRJd1Jj0G0Vqm0jcqgPShRZfvgGijr7kP
QfSW731geu7E2pcgOq444z2I/jD75U8QLVRR9htEr1kXz1AJpO/81WUD0R2+
3Nwg2mzXLiEQ7fLriBiIbpz6H0zHvzmeUw2kwxSegWnOv52WNUDa/O8qMF2X
1GsPoiUW3QDTALGnkYs=
  "]],

Cell[BoxData[
 RowBox[{"Plot3D", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"\[Phi]", "/.", "sol"}], ")"}], "[", 
    RowBox[{"x", ",", "t"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "\[Pi]"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.655576462212126*^9, 3.6555765338030863`*^9}, {
  3.655576628414688*^9, 3.6555766285027733`*^9}, {3.655576694515492*^9, 
  3.655576694819356*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "evaluate C vs ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " results"
}], "Section",
 CellChangeTimes->{{3.6555894195941668`*^9, 3.655589425905847*^9}, {
  3.6555909075661507`*^9, 3.655590908156703*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"compareCtoMath", "[", 
    RowBox[{"filenum_", ",", " ", "Nxloc_", ",", " ", "mathres_"}], "]"}], 
   " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SetDirectory", "[", 
       RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dt", " ", "=", 
       RowBox[{"0.1", " ", "*", " ", 
        SuperscriptBox["2", 
         RowBox[{"-", "filenum"}]]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"xvec", " ", "=", " ", 
       RowBox[{"N", "@", 
        RowBox[{"Most", "@", 
         RowBox[{"Range", "[", 
          RowBox[{
           RowBox[{"-", "\[Pi]"}], ",", "\[Pi]", ",", 
           RowBox[{"2", " ", 
            RowBox[{"\[Pi]", " ", "/", " ", 
             RowBox[{"(", "Nxloc", ")"}]}]}]}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vec", " ", "=", " ", 
       RowBox[{"Flatten", "@", 
        RowBox[{"Import", "[", 
         RowBox[{
          RowBox[{"\"\<vector_00\>\"", "<>", 
           RowBox[{"ToString", "[", "filenum", "]"}], "<>", "\"\<.txt\>\""}], 
          ",", "\"\<csv\>\""}], "]"}]}]}], ";", 
      RowBox[{"Nt", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "@", "vec"}], " ", "/", " ", "Nxloc"}], " ", "/", 
        " ", "2"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tvec", " ", "=", " ", 
       RowBox[{"Range", "[", 
        RowBox[{"0", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Nt", "-", "1"}], ")"}], " ", "dt"}], ",", " ", "dt"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"A", " ", "=", " ", 
       RowBox[{"Partition", "[", 
        RowBox[{"vec", ",", 
         RowBox[{"2", " ", "Nxloc"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"phi", "[", "filenum", "]"}], " ", "=", " ", 
       RowBox[{"A", "[", 
        RowBox[{"[", 
         RowBox[{";;", ",", 
          RowBox[{"1", ";;", "Nxloc"}]}], "]"}], "]"}]}], ";", 
      RowBox[{
       RowBox[{"phimath", "[", "filenum", "]"}], " ", "=", " ", 
       RowBox[{
        RowBox[{"Partition", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"\[Phi]", "/.", "sol"}], ")"}], "[", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}], " ", "&"}], "/@", " ", 
           RowBox[{"Tuples", "[", 
            RowBox[{"{", 
             RowBox[{"xvec", ",", "tvec"}], "}"}], "]"}]}], ",", "Nt"}], 
         "]"}], "\[ConjugateTranspose]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"diff", "[", "filenum", "]"}], "=", 
       RowBox[{"ListPlot3D", "[", 
        RowBox[{
         RowBox[{"phi", "[", "filenum", "]"}], " ", "-", " ", 
         RowBox[{"phimath", "[", "filenum", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"errors", "[", "filenum", "]"}], " ", "=", " ", 
       RowBox[{"Norm", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"phi", "[", "filenum", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}], "-", 
          RowBox[{
           RowBox[{"phimath", "[", "filenum", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}]}], ",", "2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{
        RowBox[{"errors", "[", "filenum", "]"}], ",", "Module"}], "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.655588919527837*^9, 3.655589210733796*^9}, 
   3.655589243557563*^9, {3.6555893295961514`*^9, 3.655589340273295*^9}, {
   3.655589464611271*^9, 3.655589479578299*^9}, {3.6555896263721657`*^9, 
   3.6555896829858093`*^9}, {3.655589794866194*^9, 3.655589795586275*^9}, {
   3.655589904244278*^9, 3.655589904587906*^9}, {3.655589938129221*^9, 
   3.655589950095606*^9}, 3.65558998267797*^9, {3.655590054031611*^9, 
   3.655590094514122*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Nx", " ", "=", " ", "51"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"files", " ", "=", " ", "7"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"errs", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"compareCtoMath", "[", 
      RowBox[{"#", ",", " ", "Nx", ",", " ", 
       RowBox[{"(", 
        RowBox[{"\[Phi]", " ", "/.", " ", "sol"}], ")"}]}], "]"}], " ", "&"}],
     " ", "/@", " ", 
    RowBox[{"Range", "[", 
     RowBox[{"0", ",", 
      RowBox[{"files", "-", "1"}]}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.655589345975498*^9, 3.655589530917797*^9}, {
  3.655589589898863*^9, 3.655589593482731*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dts", " ", "=", " ", 
   RowBox[{"0.1", "*", 
    SuperscriptBox["2", 
     RowBox[{"-", 
      RowBox[{"Range", "[", 
       RowBox[{"0", ",", 
        RowBox[{"files", "-", "1"}]}], "]"}]}]]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plotvalues", "=", 
   RowBox[{"Thread", "[", 
    RowBox[{"{", 
     RowBox[{"dts", ",", "errs"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListLogLogPlot", "[", 
  RowBox[{"plotvalues", ",", 
   RowBox[{"PlotRange", "\[Rule]", " ", "All"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6555906149413633`*^9, 3.655590618221045*^9}, {
  3.655590656067631*^9, 3.655590663308737*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"gooduntil", " ", "=", " ", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fitvals", " ", "=", 
   RowBox[{"Reverse", "@", 
    RowBox[{"plotvalues", "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", "gooduntil"}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fit", " ", "=", " ", 
   RowBox[{"FindFit", "[", 
    RowBox[{"fitvals", ",", " ", 
     RowBox[{"a", " ", 
      SuperscriptBox["x", "4"]}], ",", "a", ",", "x"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.6555906772904453`*^9, 3.655590706690441*^9}}],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"a", " ", 
        SuperscriptBox["x", "4"]}], " ", "/.", " ", "fit"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "0", ",", "0.1"}], "}"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", " ", "All"}]}], "]"}], ",", 
    RowBox[{"ListPlot", "[", "fitvals", "]"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.655584122123846*^9, 3.655584144964012*^9}, {
  3.6555841942080717`*^9, 3.655584262702096*^9}, {3.655584306355706*^9, 
  3.655584324139279*^9}, {3.655584433655712*^9, 3.6555844468062487`*^9}, {
  3.655584501405294*^9, 3.6555846179746027`*^9}, {3.655584695058155*^9, 
  3.6555847087125063`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
read data for comparison (development, now packaged)\
\>", "Section",
 CellChangeTimes->{{3.655581600107958*^9, 3.655581602026174*^9}, {
  3.655582772821844*^9, 3.655582774300695*^9}, {3.655590873398472*^9, 
  3.655590879686368*^9}}],

Cell[TextData[{
 "that was for:\n",
 Cell[BoxData[{
  RowBox[{
   RowBox[{"m", "=", "5"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"g", " ", "=", " ", "100"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Vprime", " ", "=", " ", 
    RowBox[{
     RowBox[{
      SuperscriptBox["m", "2"], " ", 
      RowBox[{"\[Phi]", "[", 
       RowBox[{"x", ",", "t"}], "]"}]}], " ", "+", " ", 
     RowBox[{
      FractionBox["g", "6"], " ", 
      SuperscriptBox[
       RowBox[{"\[Phi]", "[", 
        RowBox[{"x", ",", "t"}], "]"}], "3"]}]}]}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"\[Phi]init", " ", "=", " ", 
    RowBox[{"Sin", "[", "x", "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"d\[Phi]init", " ", "=", " ", 
    RowBox[{"-", 
     RowBox[{"Cos", "[", "x", "]"}]}]}], ";"}]}],
  CellChangeTimes->{{3.655576703488723*^9, 3.655576710833851*^9}, {
   3.655576883083097*^9, 3.655576883227063*^9}, {3.655577149159746*^9, 
   3.655577149423852*^9}, {3.655577373533228*^9, 3.655577373684922*^9}, {
   3.6555774374752417`*^9, 3.655577437585413*^9}, {3.65558085456282*^9, 
   3.655580949179134*^9}, {3.655580979913741*^9, 3.6555810061439466`*^9}, {
   3.655581201594098*^9, 3.655581207863261*^9}, {3.6555828020702553`*^9, 
   3.655582804732607*^9}}]
}], "Text",
 CellChangeTimes->{{3.655588501731317*^9, 3.655588536310463*^9}}],

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.655581552788537*^9, 3.6555815596944027`*^9}}],

Cell[CellGroupData[{

Cell["compute", "Subsection",
 CellChangeTimes->{{3.6555839522959223`*^9, 3.65558395284798*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"filenum", " ", "=", " ", "6"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Nx", " ", "=", " ", "51"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"dt", " ", "=", 
  RowBox[{"0.1", " ", "*", " ", 
   SuperscriptBox["2", 
    RowBox[{"-", "filenum"}]]}]}]}], "Input",
 CellChangeTimes->{{3.65558164928697*^9, 3.655581651185041*^9}, {
  3.6555818667305403`*^9, 3.65558187196279*^9}, {3.6555825586946898`*^9, 
  3.6555825806713343`*^9}, {3.655582952194742*^9, 3.655583009334552*^9}, {
  3.655583058468197*^9, 3.655583113345252*^9}, {3.655583935778722*^9, 
  3.6555839871755466`*^9}}],

Cell[BoxData[{
 RowBox[{"xvec", " ", "=", " ", 
  RowBox[{"N", "@", 
   RowBox[{"Most", "@", 
    RowBox[{"Range", "[", 
     RowBox[{
      RowBox[{"-", "\[Pi]"}], ",", "\[Pi]", ",", 
      RowBox[{"2", " ", 
       RowBox[{"\[Pi]", " ", "/", " ", 
        RowBox[{"(", "Nx", ")"}]}]}]}], "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"Length", "@", "xvec"}]}], "Input",
 CellChangeTimes->{{3.65558163511928*^9, 3.6555816803425694`*^9}, {
  3.65558175899343*^9, 3.655581857464614*^9}, {3.655582598271306*^9, 
  3.65558259849452*^9}, {3.6555828383316708`*^9, 3.6555828406431217`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"vec", " ", "=", " ", 
   RowBox[{"Flatten", "@", 
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{"\"\<vector_00\>\"", "<>", 
       RowBox[{"ToString", "[", "filenum", "]"}], "<>", "\"\<.txt\>\""}], 
      ",", "\"\<csv\>\""}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.655581524207985*^9, 3.655581539925984*^9}, {
  3.6555815718760366`*^9, 3.6555815794042387`*^9}, {3.655582604653244*^9, 
  3.655582615613431*^9}}],

Cell[BoxData[
 RowBox[{"Nt", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "@", "vec"}], " ", "/", " ", "Nx"}], " ", "/", " ", 
   "2"}]}]], "Input",
 CellChangeTimes->{{3.655581613866681*^9, 3.6555816148407707`*^9}, {
   3.655581903139007*^9, 3.6555819180239983`*^9}, 3.655582623619564*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tvec", " ", "=", " ", 
   RowBox[{"Range", "[", 
    RowBox[{"0", ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Nt", "-", "1"}], ")"}], " ", "dt"}], ",", " ", "dt"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "@", "tvec"}]}], "Input",
 CellChangeTimes->{{3.655581929712533*^9, 3.655581981795143*^9}, {
  3.655582627811273*^9, 3.6555826309228563`*^9}, {3.6555828450511627`*^9, 
  3.655582853578472*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"A", " ", "=", " ", 
   RowBox[{"Partition", "[", 
    RowBox[{"vec", ",", 
     RowBox[{"2", " ", "Nx"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", "A", "]"}]}], "Input",
 CellChangeTimes->{{3.655582121574016*^9, 3.655582213998741*^9}, {
  3.655582639540071*^9, 3.65558263982006*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"phi", " ", "=", " ", 
   RowBox[{"A", "[", 
    RowBox[{"[", 
     RowBox[{";;", ",", 
      RowBox[{"1", ";;", "Nx"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", "phi", "]"}]}], "Input",
 CellChangeTimes->{{3.655582227767475*^9, 3.655582253222035*^9}, {
  3.655582310748623*^9, 3.655582332939929*^9}, {3.6555826452103*^9, 
  3.655582647793869*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"phimath", " ", "=", " ", 
   RowBox[{
    RowBox[{"Partition", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Phi]", "/.", "sol"}], ")"}], "[", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "]"}], " ", "&"}], "/@", " ", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"xvec", ",", "tvec"}], "}"}], "]"}]}], ",", "Nt"}], "]"}], 
    "\[ConjugateTranspose]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", "phimath", "]"}]}], "Input",
 CellChangeTimes->{{3.6555823923207703`*^9, 3.655582451612816*^9}, {
  3.6555824845952597`*^9, 3.655582530905471*^9}, {3.655582654138753*^9, 
  3.655582665657631*^9}, {3.655582861483913*^9, 3.655582862714487*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"ListPlot3D", "[", 
   RowBox[{"phi", " ", "-", " ", "phimath"}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.6555824534276047`*^9, 3.6555824643290854`*^9}, {
   3.655582525120594*^9, 3.655582542479354*^9}, 3.655582669057219*^9, {
   3.655583069643276*^9, 3.655583075370717*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"errors", "[", "filenum", "]"}], " ", "=", " ", 
  RowBox[{"Norm", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"phi", "[", 
      RowBox[{"[", 
       RowBox[{"-", "1"}], "]"}], "]"}], "-", 
     RowBox[{"phimath", "[", 
      RowBox[{"[", 
       RowBox[{"-", "1"}], "]"}], "]"}]}], ",", "2"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.655582890575121*^9, 3.655582944826137*^9}, {
  3.655583018381768*^9, 3.6555830376128397`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["compare", "Subsection",
 CellChangeTimes->{{3.655583946864855*^9, 3.655583947384153*^9}}],

Cell[BoxData[{
 RowBox[{"dts", " ", "=", " ", 
  RowBox[{"0.1", "*", 
   SuperscriptBox["2", 
    RowBox[{"-", 
     RowBox[{"Range", "[", 
      RowBox[{"0", ",", "6"}], "]"}]}]]}]}], "\[IndentingNewLine]", 
 RowBox[{"Length", "@", "dts"}]}], "Input",
 CellChangeTimes->{{3.6555831708401403`*^9, 3.6555832169393463`*^9}}],

Cell[BoxData[
 RowBox[{"errs", " ", "=", " ", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"errors", "[", "i", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "0", ",", "6"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6555832402143087`*^9, 3.6555832511612864`*^9}}],

Cell[BoxData[
 RowBox[{"Thread", "[", 
  RowBox[{"{", 
   RowBox[{"dts", ",", "errs"}], "}"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"plotvalues", "=", 
   RowBox[{"Thread", "[", 
    RowBox[{"{", 
     RowBox[{"dts", ",", "errs"}], "}"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.655584078658087*^9, 3.65558408334231*^9}}],

Cell[BoxData[
 RowBox[{"ListLogLogPlot", "[", 
  RowBox[{"plotvalues", ",", 
   RowBox[{"PlotRange", "\[Rule]", " ", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.655583123735519*^9, 3.655583151022378*^9}, {
  3.655583221819365*^9, 3.655583254497882*^9}, {3.6555832904406853`*^9, 
  3.655583394256915*^9}, {3.655584003395084*^9, 3.6555840067938623`*^9}, {
  3.6555840775993547`*^9, 3.655584086740675*^9}}],

Cell[BoxData[
 RowBox[{"fitvals", " ", "=", 
  RowBox[{"Reverse", "@", 
   RowBox[{"plotvalues", "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "3"}], "]"}], "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{"fit", " ", "=", " ", 
  RowBox[{"FindFit", "[", 
   RowBox[{"fitvals", ",", " ", 
    RowBox[{"a", " ", 
     SuperscriptBox["x", "4"]}], ",", "a", ",", "x"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.655584390237035*^9, 3.655584490748826*^9}, {
  3.655584688881825*^9, 3.655584689688484*^9}}],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"a", " ", 
        SuperscriptBox["x", "4"]}], " ", "/.", " ", "fit"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "0", ",", "0.1"}], "}"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", " ", "All"}]}], "]"}], ",", 
    RowBox[{"ListPlot", "[", "fitvals", "]"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.655584122123846*^9, 3.655584144964012*^9}, {
  3.6555841942080717`*^9, 3.655584262702096*^9}, {3.655584306355706*^9, 
  3.655584324139279*^9}, {3.655584433655712*^9, 3.6555844468062487`*^9}, {
  3.655584501405294*^9, 3.6555846179746027`*^9}, {3.655584695058155*^9, 
  3.6555847087125063`*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.655583412983626*^9, 3.6555834135935087`*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["misc", "Section",
 CellChangeTimes->{{3.655592328674733*^9, 3.655592328857212*^9}}],

Cell[BoxData[
 RowBox[{"Quit", "[", "]"}]], "Input",
 CellChangeTimes->{{3.655669687359812*^9, 3.655669688178329*^9}}],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"Tanh", "[", 
    SuperscriptBox["x", "50"], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.65559233085631*^9, 3.655592349509688*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["filter windows..?", "Section",
 CellChangeTimes->{{3.65567217515525*^9, 3.655672177532392*^9}}],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"1", "-", 
    RowBox[{"Tanh", "[", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"1", "-", 
        SuperscriptBox["x", "6"]}]], "-", "1"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", " ", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6557479648176613`*^9, 3.6557481167385883`*^9}, {
  3.655748181960585*^9, 3.655748233534898*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Tanh", "[", 
       RowBox[{"1", "-", 
        SuperscriptBox[
         RowBox[{"(", 
          FractionBox["1", "x"], ")"}], "#"]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", 
       RowBox[{"3", "\[Pi]"}]}], "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", " ", "All"}]}], "]"}], " ", "&"}], "/@", 
  " ", 
  RowBox[{"Range", "[", 
   RowBox[{"2", ",", "10", ",", "2"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.65566877600126*^9, 3.655668813008852*^9}, {
  3.6556720327432632`*^9, 3.655672085613254*^9}, {3.655672183396626*^9, 
  3.65567221019565*^9}, {3.6557478456393213`*^9, 3.655747847928521*^9}, {
  3.65574788791123*^9, 3.655747950350522*^9}}],

Cell[BoxData[
 RowBox[{"N", "@", 
  RowBox[{"Tanh", "[", 
   RowBox[{"2", " ", "\[Pi]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.655747856919943*^9, 3.6557478847023478`*^9}}],

Cell[BoxData[{
 RowBox[{"Nx", " ", "=", " ", "501"}], "\[IndentingNewLine]", 
 RowBox[{"nc", " ", "=", " ", 
  RowBox[{
   RowBox[{"Floor", "[", 
    FractionBox["Nx", "2"], "]"}], "+", "1"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lowbnd", "=", " ", 
   RowBox[{"-", "\[Pi]"}]}], ";", " ", 
  RowBox[{"upbnd", " ", "=", " ", "\[Pi]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"coFraction", " ", "=", " ", "0.1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"nmax", " ", "=", " ", 
  RowBox[{"Ceiling", "[", 
   RowBox[{"nc", " ", "*", " ", 
    RowBox[{"(", 
     RowBox[{"1", " ", "-", " ", "coFraction"}], ")"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"coIndices", " ", "=", " ", 
  RowBox[{"Range", "[", 
   RowBox[{"0", ",", " ", 
    RowBox[{"nmax", "-", "1"}], ",", " ", "1"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Length", "@", "coIndices"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"w", " ", "=", " ", 
   RowBox[{"1", "-", 
    RowBox[{"Tanh", "[", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"1", "-", 
        SuperscriptBox["x", "8"]}]], "-", "1"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"coPoints", " ", "=", " ", 
   RowBox[{
    RowBox[{
     FractionBox["#", "nmax"], " ", "&"}], "/@", " ", "coIndices"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"wpart", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"N", "@", 
      RowBox[{"(", 
       RowBox[{"w", " ", "/.", " ", 
        RowBox[{"{", 
         RowBox[{"x", "\[Rule]", " ", "#"}], "}"}]}], ")"}]}], " ", "&"}], "/@",
     "coPoints"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"wtot", " ", "=", " ", 
   RowBox[{"wpart", "~", "Join", "~", 
    RowBox[{"Table", "[", 
     RowBox[{"0", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"nc", "-", "nmax"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "@", "wtot"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", "wtot", "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.655747440661509*^9, 3.655747539627924*^9}, {
  3.655747605857692*^9, 3.6557477499023457`*^9}, {3.655747783599494*^9, 
  3.6557477913677*^9}, {3.6557478227543488`*^9, 3.655747823306357*^9}, {
  3.655748150666367*^9, 3.655748172281501*^9}, {3.6557482558790817`*^9, 
  3.655748608436201*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6557475124878674`*^9, 3.655747513135872*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{
         FractionBox["1", 
          RowBox[{
           SuperscriptBox["x", "#"], "-", "1"}]], "+", "1"}], "]"}], ",", 
       RowBox[{"1", "-", 
        RowBox[{"Tanh", "[", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"1", "-", 
            SuperscriptBox["x", "#"]}]], "-", "1"}], "]"}]}], ",", " ", 
       FractionBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{
            SuperscriptBox["x", "#"], " ", "\[Pi]"}], "]"}], "+", "1"}], 
         ")"}], "2"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", " ", "All"}]}], "]"}], "&"}], "/@", " ", 
  
  RowBox[{"Range", "[", 
   RowBox[{"2", ",", "8", ",", "2"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.655672095707308*^9, 3.655672159228774*^9}, {
  3.6556722159723673`*^9, 3.655672253602542*^9}, {3.655758714337641*^9, 
  3.655758807892972*^9}, {3.6557588427619333`*^9, 3.655758890388562*^9}, {
  3.655759035280382*^9, 3.6557590858626003`*^9}}],

Cell[CellGroupData[{

Cell["planck taper window", "Subsection",
 CellChangeTimes->{{3.6556723362643414`*^9, 3.6556723387275887`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"windowl", "[", 
    RowBox[{"n_", ",", "a_", ",", "Nx_"}], "]"}], ":=", " ", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"Exp", "[", 
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{"Nx", "-", "1"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", "n"], "+", 
         FractionBox["1", 
          RowBox[{"n", " ", "-", " ", 
           RowBox[{"a", 
            RowBox[{"(", 
             RowBox[{"Nx", "-", "1"}], ")"}]}]}]]}], ")"}]}], "]"}], "+", 
     "1"}]]}], ";"}]], "Input",
 CellChangeTimes->{{3.655670339928615*^9, 3.655670394963986*^9}, {
   3.655670443501973*^9, 3.655670448396937*^9}, {3.6556704882681227`*^9, 
   3.655670491931326*^9}, 3.65567063008241*^9, {3.6556707075544977`*^9, 
   3.655670707986185*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"windowr", "[", 
    RowBox[{"n_", ",", "a_", ",", "Nx_"}], "]"}], ":=", " ", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"Exp", "[", 
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{"Nx", "-", "1"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", 
          RowBox[{"Nx", "-", "1", "-", "n"}]], "+", 
         FractionBox["1", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", " ", "-", " ", "a"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"Nx", "-", "1"}], ")"}]}], " ", "-", " ", "n"}]]}], 
        ")"}]}], "]"}], "+", "1"}]]}], ";"}]], "Input",
 CellChangeTimes->{{3.655670632315949*^9, 3.6556707106182537`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"window", "[", 
    RowBox[{"n_", ",", "a_", ",", "Nx_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Piecewise", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"windowl", "[", 
          RowBox[{"n", ",", " ", "a", ",", " ", "Nx"}], "]"}], ",", " ", 
         RowBox[{"0", " ", "<", " ", "n", " ", "<", " ", 
          RowBox[{"a", " ", 
           RowBox[{"(", 
            RowBox[{"Nx", "-", "1"}], ")"}]}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"windowr", "[", 
          RowBox[{"n", ",", "a", ",", "Nx"}], "]"}], ",", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", " ", "-", " ", "a"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"Nx", "-", "1"}], ")"}]}], " ", "<", " ", "n", " ", "<", 
          " ", 
          RowBox[{"(", 
           RowBox[{"Nx", "-", "1"}], ")"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"0", ",", " ", 
         RowBox[{
          RowBox[{"n", "==", "0"}], " ", "||", "  ", 
          RowBox[{"n", " ", "==", " ", 
           RowBox[{"Nx", "-", "1"}]}]}]}], "}"}]}], "\[IndentingNewLine]", 
      "}"}], ",", "1"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.65567070042552*^9, 3.6556709437761917`*^9}, {
   3.655671076541554*^9, 3.655671123692505*^9}, {3.6556711661016083`*^9, 
   3.6556711950312243`*^9}, {3.6556712315755053`*^9, 3.655671239111113*^9}, {
   3.655671292919773*^9, 3.6556714168959846`*^9}, {3.6556714806914997`*^9, 
   3.6556715167226763`*^9}, 3.655671609833127*^9, {3.6557472073517942`*^9, 
   3.655747209927526*^9}, {3.655747284038015*^9, 3.655747291229854*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Nxval", "=", "101"}], ";", " ", 
  RowBox[{"aval", "=", "0.6"}], ";"}]], "Input",
 CellChangeTimes->{{3.6556695076727867`*^9, 3.65566971874549*^9}, {
  3.6556697526843643`*^9, 3.655669783321762*^9}, {3.655669823121037*^9, 
  3.655669823665029*^9}, {3.655669887759918*^9, 3.6556699386303*^9}, {
  3.6556699860466833`*^9, 3.655670051181448*^9}, {3.65567008364431*^9, 
  3.6556701244016323`*^9}, {3.6556703220652227`*^9, 3.655670332720265*^9}, {
  3.655670401827641*^9, 3.655670402107211*^9}, {3.6556704584847937`*^9, 
  3.655670474907835*^9}, {3.655671012359703*^9, 3.655671048259953*^9}, {
  3.655747213046093*^9, 3.655747273500115*^9}, {3.6557473077796087`*^9, 
  3.6557473304027977`*^9}}],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"window", "[", 
     RowBox[{"#", ",", "aval", ",", "Nxval"}], "]"}], "&"}], "/@", " ", 
   RowBox[{"Range", "[", 
    RowBox[{"0", ",", 
     RowBox[{"Nxval", "-", "1"}], ",", "1"}], "]"}]}], "]"}]], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Nxval", "=", "101"}], ";", " ", 
  RowBox[{"aval", "=", " ", "0.9"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cutoffpoints", " ", "=", " ", 
   RowBox[{"Range", "[", 
    RowBox[{
     RowBox[{"Floor", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "aval"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"Nxval", "-", "1"}], ")"}]}], "+", "1"}], "]"}], ",", " ", 
     RowBox[{"Nxval", "-", "1"}], ",", " ", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "@", "cutoffpoints"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"windowr", "[", 
     RowBox[{"#", ",", "aval", ",", "Nxval"}], "]"}], " ", "&"}], "/@", " ", 
   "cutoffpoints"}], "]"}]}], "Input",
 CellChangeTimes->{{3.655746964811496*^9, 3.6557471855339413`*^9}, {
  3.6557473577011023`*^9, 3.655747358267585*^9}, {3.655747391259076*^9, 
  3.655747391634488*^9}}],

Cell[BoxData[
 RowBox[{"Nmax", " ", "=", " ", 
  RowBox[{"Floor", "[", 
   RowBox[{"aval", " ", 
    RowBox[{"(", 
     RowBox[{"Nxval", "-", "1"}], ")"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.655671026100792*^9, 3.655671026414804*^9}, {
  3.655672291933659*^9, 3.655672296633713*^9}}],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{
    FractionBox["1", 
     RowBox[{
      RowBox[{"Exp", "[", 
       RowBox[{"a", " ", "L", " ", 
        RowBox[{"(", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"L", "-", "x"}]], "+", 
          FractionBox["1", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "a"}], ")"}], " ", "L"}], " ", "-", "x"}]]}], 
         ")"}]}], "]"}], "+", "1"}]], "/.", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"a", "\[Rule]", " ", "0.5"}], ",", " ", 
      RowBox[{"L", "\[Rule]", " ", "\[Pi]"}]}], "}"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", " ", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.655669343012413*^9, 3.655669411801002*^9}, {
  3.655670564367304*^9, 3.65567057974466*^9}, {3.655671651837233*^9, 
  3.655671656884831*^9}, {3.655671703930113*^9, 3.655671994000031*^9}}],

Cell["\<\
TODO: how to do this with the fftw3 fourier coefficients\
\>", "Text",
 CellChangeTimes->{{3.6556725512556353`*^9, 3.655672565885275*^9}, {
  3.6556904832163467`*^9, 3.655690501383005*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["energy considerations", "Section",
 CellChangeTimes->{{3.655764464502252*^9, 3.65576446694173*^9}}],

Cell[BoxData[
 RowBox[{"Quit", "[", "]"}]], "Input",
 CellChangeTimes->{{3.655764631276184*^9, 3.6557646321490793`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"potential", "[", "f_", "]"}], ":=", "0"}], ";", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     FractionBox["1", "2"], " ", 
     SuperscriptBox["mass", "2"], " ", 
     SuperscriptBox["f", "2"]}], ";"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"energy", "[", 
    RowBox[{"f_", ",", " ", "V_"}], "]"}], ":=", " ", 
   RowBox[{
    RowBox[{
     FractionBox["1", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Derivative", "[", 
          RowBox[{"1", ",", "0"}], "]"}], "[", "f", "]"}], "[", 
        RowBox[{"t", ",", "x"}], "]"}], ")"}], "2"]}], " ", "+", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Derivative", "[", 
          RowBox[{"0", ",", "1"}], "]"}], "[", "f", "]"}], "[", 
        RowBox[{"t", ",", "x"}], "]"}], ")"}], "2"]}], "+", " ", 
    RowBox[{"V", "[", 
     RowBox[{"f", "[", 
      RowBox[{"t", ",", "x"}], "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"phi", "[", 
    RowBox[{"t_", ",", "x_"}], "]"}], ":=", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"x", "-", "t"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Plot3D", "[", 
  RowBox[{
   RowBox[{"phi", "[", 
    RowBox[{"t", ",", "x"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "\[Pi]"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6557646059231377`*^9, 3.655764621455084*^9}, {
  3.6557646546456127`*^9, 3.6557646823246098`*^9}, {3.655764808699465*^9, 
  3.655764883913089*^9}, {3.655765032878912*^9, 3.6557650602949553`*^9}, {
  3.655766096280905*^9, 3.655766117589837*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"energy", "[", 
   RowBox[{"phi", ",", "potential"}], "]"}], " ", "//", " ", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{"etot", " ", "=", " ", 
  RowBox[{"Integrate", "[", 
   RowBox[{"%", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"etot", " ", "/.", " ", 
    RowBox[{"{", 
     RowBox[{"mass", " ", "\[Rule]", " ", "1"}], "}"}]}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "\[Pi]"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.655764639226564*^9, 3.6557646530038633`*^9}, {
  3.65576478264515*^9, 3.655764787437419*^9}, {3.655764860382167*^9, 
  3.655764862125753*^9}, {3.65576489375073*^9, 3.6557648954786673`*^9}, {
  3.655764962067686*^9, 3.6557650003150177`*^9}, {3.6557651161081343`*^9, 
  3.655765150044228*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["tests for differentiation", "Section",
 CellChangeTimes->{{3.65636054188503*^9, 3.656360547171227*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"Sin", "[", "x", "]"}], " ", 
    RowBox[{"Sin", "[", "y", "]"}], " ", 
    RowBox[{"Sin", "[", "z", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], 
       SuperscriptBox["x", "2"]}], " ", "-", " ", 
      RowBox[{"4", " ", 
       SuperscriptBox["y", "2"]}], " ", "-", " ", 
      RowBox[{"1.5", " ", 
       SuperscriptBox["z", "2"]}]}], "]"}], " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"2", " ", "x"}], "]"}], " ", 
    RowBox[{"Cos", "[", "y", "]"}], " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"4", " ", "z"}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.656360590952383*^9, 3.656360621509795*^9}, {
  3.656364809803401*^9, 3.656364811050968*^9}, {3.658686850981612*^9, 
  3.6586868939819317`*^9}, {3.658687181155744*^9, 3.658687197961093*^9}, {
  3.658689615397028*^9, 3.658689627741432*^9}, {3.6586897273028803`*^9, 
  3.658689734117703*^9}, {3.6586898310590363`*^9, 3.6586898311147346`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"x", ",", "y", ",", "z"}], "]"}], " ", "//", " ", 
   "FullSimplify"}], " ", "//", " ", "CForm"}]], "Input",
 CellChangeTimes->{{3.6586880217192574`*^9, 3.658688029035473*^9}, {
  3.6586882952219048`*^9, 3.658688295781736*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", "x"}], "]"}], " ", "//", 
   " ", "FullSimplify"}], " ", "//", " ", "CForm"}]], "Input",
 CellChangeTimes->{{3.658686932066678*^9, 3.6586870041048613`*^9}, {
  3.6586882807122517`*^9, 3.658688281886812*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", "y"}], "]"}], " ", "//", 
   " ", "FullSimplify"}], " ", "//", " ", "CForm"}]], "Input",
 CellChangeTimes->{{3.658686980604033*^9, 3.658686980916299*^9}, {
  3.6586881865643044`*^9, 3.658688190035398*^9}, {3.6586882866780043`*^9, 
  3.658688287430367*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", "z"}], "]"}], " ", "//", 
   " ", "FullSimplify"}], " ", "//", " ", "CForm"}]], "Input",
 CellChangeTimes->{{3.658688192955077*^9, 3.6586881935708323`*^9}, {
  3.658688290726048*^9, 3.658688291461948*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "2"}], "}"}]}], "]"}], " ", "//", " ", 
   "FullSimplify"}], " ", "//", " ", "CForm"}]], "Input",
 CellChangeTimes->{{3.658686932066678*^9, 3.6586870041048613`*^9}, {
  3.6586882807122517`*^9, 3.658688281886812*^9}, {3.65868839030774*^9, 
  3.658688399483282*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", "2"}], "}"}]}], "]"}], " ", "//", " ", 
   "FullSimplify"}], " ", "//", " ", "CForm"}]], "Input",
 CellChangeTimes->{{3.658686980604033*^9, 3.658686980916299*^9}, {
  3.6586881865643044`*^9, 3.658688190035398*^9}, {3.6586882866780043`*^9, 
  3.658688287430367*^9}, {3.658688404747316*^9, 3.6586884066600857`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"z", ",", "2"}], "}"}]}], "]"}], " ", "//", " ", 
   "FullSimplify"}], " ", "//", " ", "CForm"}]], "Input",
 CellChangeTimes->{{3.658688192955077*^9, 3.6586881935708323`*^9}, {
  3.658688290726048*^9, 3.658688291461948*^9}, {3.6586884098833437`*^9, 
  3.658688410907889*^9}}],

Cell[BoxData[
 RowBox[{"grad", " ", "=", " ", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", "x"}], "]"}], ",", " ", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", "y"}], "]"}], ",", " ", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", "z"}], "]"}]}], "}"}], 
   " ", "//", " ", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.656366347869278*^9, 3.656366448550291*^9}, {
  3.658686925560841*^9, 3.658686928177321*^9}}],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "4"}], " ", 
        SuperscriptBox["x", "2"]}], "]"}], " ", 
      RowBox[{"Cos", "[", "x", "]"}]}], ",", " ", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "4"}], " ", 
           SuperscriptBox["y", "2"]}], "]"}], " ", 
         RowBox[{"Cos", "[", "y", "]"}]}], ",", "y"}], "]"}], " ", "/.", " ", 
      
      RowBox[{"y", "\[Rule]", " ", "x"}]}], ",", " ", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "4"}], " ", 
           SuperscriptBox["y", "2"]}], "]"}], " ", 
         RowBox[{"Cos", "[", "y", "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"y", ",", "2"}], "}"}]}], "]"}], " ", "/.", " ", 
      RowBox[{"y", "\[Rule]", " ", "x"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.658689363141218*^9, 3.658689405600234*^9}, {
  3.658689449745226*^9, 3.658689602798375*^9}, {3.658689656469162*^9, 
  3.6586896609728003`*^9}, {3.658689865744318*^9, 3.658689888359207*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6586897750565367`*^9, 3.658689777555394*^9}}],

Cell[BoxData[
 RowBox[{"gradsq", " ", "=", " ", 
  RowBox[{
   RowBox[{"grad", ".", "grad"}], " ", "//", " ", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.656366450300317*^9, 3.656366456893032*^9}}],

Cell[BoxData[
 RowBox[{"lap", " ", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "2"}], "}"}]}], "]"}], " ", "+", " ", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", "2"}], "}"}]}], "]"}], " ", "+", " ", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"z", ",", "2"}], "}"}]}], "]"}]}], " ", "//", " ", 
    "Simplify"}], " ", "//", " ", "CForm"}]}]], "Input",
 CellChangeTimes->{{3.656364624240137*^9, 3.6563647227350893`*^9}, {
  3.656364789069483*^9, 3.656364792453143*^9}, {3.656366388391911*^9, 
  3.6563664204961023`*^9}, {3.6586872068166943`*^9, 3.658687208681076*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["higgs metastability potential", "Section",
 CellChangeTimes->{{3.658678708474242*^9, 3.658678713120556*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Quit", "[", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.6586787304590178`*^9, 3.658678732529181*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"l", "=", 
   SuperscriptBox["10", 
    RowBox[{"-", "7"}]]}], ";"}]], "Input",
 CellChangeTimes->{{3.6586978746780777`*^9, 3.658697886201949*^9}, {
  3.6587019813170843`*^9, 3.658701981398814*^9}}],

Cell[BoxData[
 RowBox[{"repl", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"a", " ", "\[Rule]", "  ", 
     RowBox[{
      SuperscriptBox["10", 
       RowBox[{"-", "2"}]], "/", "l"}]}], ",", " ", 
    RowBox[{"b", " ", "\[Rule]", "  ", 
     RowBox[{"1", "/", "l"}]}], ",", " ", 
    RowBox[{"\[CapitalLambda]", " ", "\[Rule]", " ", 
     RowBox[{
      SuperscriptBox["10", 
       RowBox[{"-", "10"}]], "/", "l"}]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.658676150906073*^9, 3.6586761577835283`*^9}, {
  3.658676366714904*^9, 3.658676378370571*^9}, {3.658676424609541*^9, 
  3.6586764576242228`*^9}, {3.658677130514017*^9, 3.658677135450574*^9}, {
  3.65869786452682*^9, 3.65869787131874*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"pot", "[", "h_", "]"}], " ", ":=", " ", 
   RowBox[{"\[CapitalLambda]", " ", "+", " ", 
    RowBox[{"a", " ", 
     RowBox[{"(", 
      RowBox[{"1", " ", "-", " ", 
       RowBox[{
        SuperscriptBox["10", 
         RowBox[{"-", "1"}]], " ", 
        RowBox[{"Log10", "[", 
         RowBox[{
          SuperscriptBox["10", "19"], " ", 
          RowBox[{"Abs", "[", "h", "]"}]}], "]"}]}]}], ")"}], " ", 
     SuperscriptBox["h", "4"]}], " ", "+", " ", 
    RowBox[{"b", " ", 
     SuperscriptBox["h", "6"]}]}]}], " ", ";"}]], "Input",
 CellChangeTimes->{{3.658676159938664*^9, 3.658676283842246*^9}, 
   3.658676343114794*^9, {3.658676385051181*^9, 3.658676387021325*^9}, {
   3.658677073603652*^9, 3.6586770806510763`*^9}, {3.658677147394457*^9, 
   3.658677150234144*^9}, {3.658677419996299*^9, 3.6586774209566927`*^9}}],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"pot", "[", "h", "]"}], " ", "/.", " ", "repl"}], ",", 
   RowBox[{"{", 
    RowBox[{"h", ",", 
     RowBox[{"-", "0.085"}], ",", "0.085"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.658676555638276*^9, 3.658676625953596*^9}, {
  3.658676660981907*^9, 3.6586767284201727`*^9}, {3.658677291217704*^9, 
  3.658677355026973*^9}, {3.65867742453238*^9, 3.6586774255302763`*^9}, {
  3.658682007118511*^9, 3.6586820540027103`*^9}}],

Cell[BoxData[
 RowBox[{"NMinimize", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"pot", "[", "h", "]"}], " ", "/.", " ", "repl"}], ",", "h"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.658676844376781*^9, 3.6586768520351067`*^9}, {
  3.65867736894036*^9, 3.6586773757144327`*^9}, {3.65867743489174*^9, 
  3.658677435448063*^9}}],

Cell[BoxData[
 RowBox[{"Limit", "[", 
  RowBox[{
   RowBox[{"pot", "[", "h", "]"}], ",", " ", 
   RowBox[{"h", "\[Rule]", " ", "0"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6586823422558327`*^9, 3.658682349704027*^9}}],

Cell[BoxData[{
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"pot", "[", "h", "]"}], ",", "h"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Limit", "[", 
  RowBox[{"%", ",", " ", 
   RowBox[{"h", "\[Rule]", " ", "0"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.658677393958007*^9, 3.65867740799751*^9}, {
  3.658677456436062*^9, 3.658677457019738*^9}, {3.6586774873263903`*^9, 
  3.65867752591813*^9}, {3.658677637035894*^9, 3.658677638763074*^9}, {
  3.6586822326697683`*^9, 3.6586822661331053`*^9}}],

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"Log10", "[", 
    RowBox[{
     RowBox[{"Abs", "[", "h", "]"}], " ", 
     SuperscriptBox["10", "19"]}], "]"}], ",", "h"}], "]"}]], "Input",
 CellChangeTimes->{{3.658677815699524*^9, 3.658677837827643*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Log10", "[", "x", "]"}], " ", "\[Equal]", " ", 
   FractionBox[
    RowBox[{"Log", "[", "x", "]"}], 
    RowBox[{"Log", "[", "10", "]"}]]}], " ", "//", " ", "Simplify"}]], "Input",\

 CellChangeTimes->{{3.658677962931679*^9, 3.658678024546041*^9}}],

Cell[BoxData[
 RowBox[{"replphi", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"phi0", " ", "\[Rule]", " ", "0.04"}], ",", " ", 
    RowBox[{"\[Lambda]", " ", "\[Rule]", " ", "20"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.6586956422035*^9, 3.658695674744548*^9}, {
  3.658695875899352*^9, 3.658695878595769*^9}, {3.658696366281871*^9, 
  3.658696393623845*^9}, {3.658702073616803*^9, 3.658702073767063*^9}}],

Cell[BoxData[
 RowBox[{"phi", " ", "=", " ", 
  RowBox[{"phi0", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Cos", "[", "x", "]"}], " ", "+", " ", "1"}], ")"}], 
   RowBox[{
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", "\[Lambda]"}], " ", 
      SuperscriptBox["x", "2"]}], "]"}], " ", "/", " ", "2"}], 
   "k"}]}]], "Input",
 CellChangeTimes->{{3.658695622542513*^9, 3.6586956401457148`*^9}, {
   3.658695679432623*^9, 3.6586956900960712`*^9}, {3.658695854636318*^9, 
   3.658695871916758*^9}, {3.658702099623028*^9, 3.658702100510827*^9}, 
   3.6587030657376757`*^9}],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"phi", "  ", "/.", " ", "replphi"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", " ", 
   RowBox[{"PlotRange", " ", "\[Rule]", " ", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.658695692571021*^9, 3.6586957884530067`*^9}, 
   3.658695865267981*^9}],

Cell[BoxData[
 RowBox[{"phitrunc", " ", "=", " ", 
  RowBox[{"FourierSeries", "[", 
   RowBox[{
    RowBox[{"phi", " ", "/.", " ", "replphi"}], ",", " ", "x", ",", " ", 
    "30"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6586958280751*^9, 3.658695845899353*^9}, {
  3.658695885114416*^9, 3.658695893183707*^9}, {3.658695937651341*^9, 
  3.658695940411051*^9}, {3.658696051720496*^9, 3.6586960534242887`*^9}}],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Re", "[", "phitrunc", "]"}], ",", " ", 
     RowBox[{"phi", " ", "/.", " ", "replphi"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", " ", 
   RowBox[{"PlotRange", " ", "\[Rule]", " ", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.658695907069496*^9, 3.6586959628498507`*^9}, {
  3.658696000673581*^9, 3.658696014273355*^9}}],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"Abs", "[", 
    RowBox[{
     RowBox[{"Re", "[", "phitrunc", "]"}], " ", "-", " ", 
     RowBox[{"(", " ", 
      RowBox[{"phi", " ", "/.", " ", "replphi"}], ")"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", " ", 
   RowBox[{"PlotRange", " ", "\[Rule]", " ", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.658696035521145*^9, 3.658696043816153*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["solve poisson equation tests", "Section",
 CellChangeTimes->{{3.6591988773222933`*^9, 3.6591988844403687`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Quit", "[", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.661118598921228*^9, 3.661118600193193*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"lap", "[", "f_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"f", ",", " ", 
      RowBox[{"{", 
       RowBox[{"x", ",", "2"}], "}"}]}], "]"}], " ", "+", " ", 
    RowBox[{"D", "[", 
     RowBox[{"f", ",", " ", 
      RowBox[{"{", 
       RowBox[{"y", ",", "2"}], "}"}]}], "]"}], " ", "+", " ", 
    RowBox[{"D", "[", 
     RowBox[{"f", ",", " ", 
      RowBox[{"{", 
       RowBox[{"z", ",", "2"}], "}"}]}], "]"}]}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"gradsq", "[", "f_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"f", ",", " ", 
        RowBox[{"{", 
         RowBox[{"x", ",", "1"}], "}"}]}], "]"}], ",", " ", 
      RowBox[{"D", "[", 
       RowBox[{"f", ",", " ", 
        RowBox[{"{", 
         RowBox[{"y", ",", "1"}], "}"}]}], "]"}], ",", " ", 
      RowBox[{"D", "[", 
       RowBox[{"f", ",", " ", 
        RowBox[{"{", 
         RowBox[{"z", ",", "1"}], "}"}]}], "]"}]}], "}"}], ".", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"f", ",", " ", 
        RowBox[{"{", 
         RowBox[{"x", ",", "1"}], "}"}]}], "]"}], ",", " ", 
      RowBox[{"D", "[", 
       RowBox[{"f", ",", " ", 
        RowBox[{"{", 
         RowBox[{"y", ",", "1"}], "}"}]}], "]"}], ",", " ", 
      RowBox[{"D", "[", 
       RowBox[{"f", ",", " ", 
        RowBox[{"{", 
         RowBox[{"z", ",", "1"}], "}"}]}], "]"}]}], "}"}]}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.6611184039272833`*^9, 3.6611184180425797`*^9}, {
  3.661118453517564*^9, 3.66111847313911*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"getmean", "[", "f_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"NIntegrate", "[", 
     RowBox[{"f", ",", " ", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"y", ",", 
        RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"z", ",", 
        RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}]}], "]"}], " ", "/", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"2", " ", "\[Pi]"}], ")"}], "3"]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.661118353426215*^9, 3.661118353634137*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"solvepoisson", "[", "f_", "]"}], " ", ":=", " ", 
   RowBox[{"InverseFourierTransform", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"FourierTransform", "[", 
        RowBox[{"f", ",", " ", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"kx", ",", "ky", ",", "kz"}], "}"}]}], "]"}]}], " ", "/", 
      " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["kx", "2"], " ", "+", " ", 
        SuperscriptBox["ky", "2"], " ", "+", " ", 
        SuperscriptBox["kz", "2"]}], ")"}]}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"kx", ",", "ky", ",", "kz"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.661118179881118*^9, 3.6611182714674892`*^9}, {
  3.6611192870125523`*^9, 3.661119287164083*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"potential", "[", "f_", "]"}], " ", ":=", " ", "lambdaval"}], ";", 
  " ", 
  RowBox[{
   RowBox[{"potentialprime", "[", "f_", "]"}], " ", ":=", " ", "0"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6611185247416687`*^9, 3.661118535407083*^9}, {
  3.661121807229641*^9, 3.661121815029346*^9}}],

Cell[CellGroupData[{

Cell["first attempt (WARNING: wrong equation)", "Subsection",
 CellChangeTimes->{{3.661117429782316*^9, 3.661117442354233*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rho", " ", ":=", " ", 
   RowBox[{
    RowBox[{"Sin", "[", "x", "]"}], " ", 
    RowBox[{"Sin", "[", "y", "]"}], "  ", 
    RowBox[{"Sin", "[", "z", "]"}], " ", 
    SuperscriptBox["x", "2"]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.659199491812096*^9, 3.659199525643435*^9}, {
  3.659201128659953*^9, 3.659201129691625*^9}, {3.659201757092486*^9, 
  3.659201764516315*^9}, {3.659201803899922*^9, 3.659201806040609*^9}}],

Cell[BoxData[
 RowBox[{"ft", " ", "=", " ", 
  RowBox[{"FourierTransform", "[", 
   RowBox[{"rho", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"kx", ",", "ky", ",", "kz"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6592009493121634`*^9, 3.659200977996911*^9}, {
   3.6592010514943113`*^9, 3.659201052614066*^9}, 3.65920115577127*^9}],

Cell[BoxData[
 RowBox[{"sol", " ", "=", " ", 
  RowBox[{"InverseFourierTransform", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"-", "ft"}], " ", "/", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["kx", "2"], " ", "+", " ", 
        SuperscriptBox["ky", "2"], " ", "+", " ", 
        SuperscriptBox["kz", "2"]}], ")"}]}], " ", "/", " ", "2"}], ",", " ", 
    
    RowBox[{"{", 
     RowBox[{"kx", ",", "ky", ",", "kz"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.659200991417697*^9, 3.6592010559740973`*^9}, {
  3.659201111388873*^9, 3.659201112404662*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"lap", "[", "sol", "]"}], " ", "\[Equal]", " ", 
   FractionBox["rho", "2"]}], " ", "//", " ", "Simplify"}]], "Input",
 CellChangeTimes->{{3.659201078509356*^9, 3.6592010860251627`*^9}, {
  3.659201161938549*^9, 3.659201169681944*^9}}],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Sin", "[", "x", "]"}], " ", 
    RowBox[{"x", "^", "2"}]}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.659205745669917*^9, 3.659205765551742*^9}}],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", "10"}], " ", 
      SuperscriptBox["x", "2"]}], "]"}], " ", 
    RowBox[{"Cos", "[", "x", "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6592059048941917`*^9, 3.659205918092626*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"N", "@", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "10"}], " ", 
           SuperscriptBox["y", "2"]}], "]"}], " ", 
         RowBox[{"Cos", "[", "y", "]"}]}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"y", ",", "#"}], "}"}]}], "]"}], "&"}], "/@", 
     RowBox[{"Range", "[", 
      RowBox[{"0", ",", "15"}], "]"}]}], ")"}]}], " ", "/.", " ", 
  RowBox[{"y", "\[Rule]", " ", 
   RowBox[{"-", "\[Pi]"}]}]}]], "Input",
 CellChangeTimes->{{3.659205958436131*^9, 3.6592060222148237`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "10"}], " ", 
           SuperscriptBox["y", "2"]}], "]"}], " ", 
         RowBox[{"Cos", "[", "y", "]"}]}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"y", ",", "#"}], "}"}]}], "]"}], " ", "/.", " ", 
      RowBox[{"y", "\[Rule]", " ", "x"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}]}], "]"}], "&"}], "/@", 
  RowBox[{"{", 
   RowBox[{"0", ",", "1", ",", "2", ",", "3", ",", "4"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.659205779775818*^9, 3.6592058271310873`*^9}, {
  3.659205857752942*^9, 3.659205877768262*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["new (hopefully) correct poisson equation", "Subsection",
 CellChangeTimes->{{3.661117447281817*^9, 3.661117456841508*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"meanval", " ", "=", " ", "0.5"}], ";", " ", 
  RowBox[{"amplitude", "=", "0.1"}], ";", " ", 
  RowBox[{"lambdaval", " ", "=", " ", "0.2"}], ";", " ", 
  RowBox[{"a", " ", "=", " ", "1"}], ";"}]], "Input",
 CellChangeTimes->{{3.66111786060599*^9, 3.661117890131344*^9}, {
  3.6611183618173637`*^9, 3.661118361985569*^9}, {3.661118540182921*^9, 
  3.66111854620674*^9}, {3.661118663647174*^9, 3.661118666052952*^9}, {
  3.661120578952927*^9, 3.6611205791124697`*^9}, {3.661187527136989*^9, 
  3.66118752740724*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"phi", " ", "=", " ", 
   RowBox[{"meanval", " ", "+", " ", 
    RowBox[{"amplitude", " ", 
     RowBox[{"Cos", "[", "x", "]"}], " ", 
     RowBox[{"Cos", "[", "y", "]"}], " ", 
     RowBox[{"Cos", "[", "z", "]"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.661117854542988*^9, 3.661117855758225*^9}, {
  3.661117896314724*^9, 3.66111792955473*^9}, {3.6611183662894697`*^9, 
  3.66111836648941*^9}, {3.661120773765421*^9, 3.661120780204867*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"phiavg", " ", "=", " ", 
  RowBox[{"getmean", "[", "phi", "]"}]}]], "Input",
 CellChangeTimes->{{3.6611179484809837`*^9, 3.661118007765349*^9}, {
  3.66111810958882*^9, 3.6611181133638153`*^9}, {3.661118371152939*^9, 
  3.661118371376709*^9}}],

Cell[BoxData["0.5`"], "Output",
 CellChangeTimes->{3.661187530461575*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dphiinit", " ", "=", " ", 
  RowBox[{"D", "[", 
   RowBox[{"phi", ",", "t"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.66111863629392*^9, 3.661118647156226*^9}, {
  3.661121577331017*^9, 3.661121634366547*^9}, {3.661121896594157*^9, 
  3.661121900666191*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.661187531877369*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rho", " ", "=", " ", 
  RowBox[{
   RowBox[{
    FractionBox[
     SuperscriptBox["dphiinit", "2"], "2"], " ", "+", " ", 
    FractionBox[
     RowBox[{"gradsq", "[", "phi", "]"}], "2"], "+", " ", 
    RowBox[{"potential", "[", "phi", "]"}]}], " ", "//", " ", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.6611180244221287`*^9, 3.6611180276408577`*^9}, {
  3.661118122805884*^9, 3.661118143270019*^9}, {3.661118383784891*^9, 
  3.661118389632369*^9}, {3.661118504968216*^9, 3.66111852148015*^9}, {
  3.661118563014887*^9, 3.661118568998028*^9}, {3.661118644895751*^9, 
  3.661118645198226*^9}, {3.661121903443006*^9, 3.661121904282711*^9}}],

Cell[BoxData[
 RowBox[{"0.2`", "\[VeryThinSpace]", "+", 
  RowBox[{"0.005000000000000001`", " ", 
   SuperscriptBox[
    RowBox[{"Cos", "[", "x", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"Cos", "[", "z", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "y", "]"}], "2"]}], "+", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"Cos", "[", "y", "]"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"0.005000000000000001`", " ", 
      SuperscriptBox[
       RowBox[{"Cos", "[", "z", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"Sin", "[", "x", "]"}], "2"]}], "+", 
     RowBox[{"0.005000000000000001`", " ", 
      SuperscriptBox[
       RowBox[{"Cos", "[", "x", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"Sin", "[", "z", "]"}], "2"]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.661187533051556*^9, 3.6611875724664917`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"valnum", " ", "=", " ", "32"}], ";", " ", 
  RowBox[{"vals", " ", "=", " ", 
   RowBox[{"N", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "\[Pi]"}], " ", "+", " ", 
       FractionBox[
        RowBox[{"2", "\[Pi]", " ", "i", " "}], "valnum"]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "0", ",", 
        RowBox[{"valnum", "-", "1"}]}], "}"}]}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.661119849304035*^9, 3.661119979553144*^9}, {
  3.661120036134975*^9, 3.661120039398033*^9}, {3.661120085973114*^9, 
  3.6611201250429487`*^9}, {3.661120533940102*^9, 3.661120534780281*^9}, {
  3.6611227168936987`*^9, 3.661122717173088*^9}, {3.66112312267507*^9, 
  3.661123123081437*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "@", 
  RowBox[{"Flatten", "@", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"N", "@", 
      RowBox[{"(", 
       RowBox[{"rho", " ", "/.", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "\[Rule]", " ", "xv"}], ",", " ", 
          RowBox[{"y", "\[Rule]", " ", "yv"}], ",", " ", 
          RowBox[{"z", "\[Rule]", " ", "zv"}]}], "}"}]}], ")"}]}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"xv", ",", "vals"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"yv", ",", "vals"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"zv", ",", "vals"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6611228191368093`*^9, 3.661122827088469*^9}, {
  3.6611228941872*^9, 3.661122896201623*^9}}],

Cell[BoxData["32768"], "Output",
 CellChangeTimes->{3.661187537964211*^9, 3.661187574677278*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rhoavg", " ", "=", " ", 
  RowBox[{"getmean", "[", "rho", "]"}]}]], "Input",
 CellChangeTimes->{{3.661118582736814*^9, 3.6611185962290297`*^9}}],

Cell[BoxData["0.201875`"], "Output",
 CellChangeTimes->{3.661187581558028*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"hub", " ", "=", " ", 
  SqrtBox[
   FractionBox["rhoavg", "3"]]}]], "Input",
 CellChangeTimes->{{3.66111866942756*^9, 3.6611186956615763`*^9}}],

Cell[BoxData["0.2594063736045563`"], "Output",
 CellChangeTimes->{3.6611875828333883`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"dphi", " ", "=", " ", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{"lap", "[", "phi", "]"}], 
     SuperscriptBox["a", "2"]], " ", "-", " ", 
    RowBox[{"3", " ", "hub", " ", "dphiinit"}], " ", "-", " ", 
    RowBox[{"potentialprime", "[", "phi", "]"}]}], " ", "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"dphi", " ", "=", " ", "dphiinit"}]}], "Input",
 CellChangeTimes->{
  3.6611216442706537`*^9, {3.6611217373703413`*^9, 3.661121740176528*^9}, {
   3.661121789463975*^9, 3.661121798630067*^9}, {3.661121833253372*^9, 
   3.661121851108987*^9}, {3.661121910202621*^9, 3.661121911027185*^9}, {
   3.661122659326313*^9, 3.661122664213954*^9}}],

Cell[BoxData[
 RowBox[{"0.`", "\[VeryThinSpace]", "-", 
  RowBox[{"0.30000000000000004`", " ", 
   RowBox[{"Cos", "[", "x", "]"}], " ", 
   RowBox[{"Cos", "[", "y", "]"}], " ", 
   RowBox[{"Cos", "[", "z", "]"}]}]}]], "Output",
 CellChangeTimes->{3.661187586617569*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.661187586619041*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rhs", " ", "=", " ", 
  RowBox[{
   RowBox[{"0.5", " ", "*", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"3", " ", "hub", " ", 
       SuperscriptBox["a", "2"], " ", "dphi", " ", 
       RowBox[{"(", 
        RowBox[{"phi", " ", "-", " ", "phiavg"}], ")"}]}], " ", "-", " ", 
      "rho", " ", "+", " ", "rhoavg"}], ")"}]}], " ", "//", " ", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.661117535963876*^9, 3.6611175873022947`*^9}, {
  3.661118707240749*^9, 3.661118710144456*^9}, {3.6611229494809523`*^9, 
  3.661122949999699*^9}}],

Cell[BoxData[
 RowBox[{"0.0009374999999999939`", "\[VeryThinSpace]", "-", 
  RowBox[{"0.0025000000000000005`", " ", 
   SuperscriptBox[
    RowBox[{"Cos", "[", "x", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"Cos", "[", "z", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "y", "]"}], "2"]}], "+", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"Cos", "[", "y", "]"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "0.0025000000000000005`"}], " ", 
      SuperscriptBox[
       RowBox[{"Cos", "[", "z", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"Sin", "[", "x", "]"}], "2"]}], "-", 
     RowBox[{"0.0025000000000000005`", " ", 
      SuperscriptBox[
       RowBox[{"Cos", "[", "x", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"Sin", "[", "z", "]"}], "2"]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.661187596036214*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sol", " ", "=", " ", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"Re", "[", 
     RowBox[{"solvepoisson", "[", "rhs", "]"}], "]"}], ",", 
    RowBox[{"Assumptions", "\[Rule]", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x", "\[Element]", "Reals"}], ",", " ", 
       RowBox[{"y", "\[Element]", "Reals"}], ",", " ", 
       RowBox[{"z", "\[Element]", "Reals"}]}], "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.661118718204278*^9, 3.661118759120831*^9}, {
  3.661118814002905*^9, 3.661118817818591*^9}, {3.661118866112235*^9, 
  3.661118909196939*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"0.`", "\[VeryThinSpace]", "-", 
   RowBox[{"4.7704895589362195`*^-17", " ", 
    SuperscriptBox["z", "2"]}], "+", 
   RowBox[{
    RowBox[{"Cos", "[", 
     RowBox[{"2", " ", "y"}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{"0.0012304382770095637`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.0006152191385047818`", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "z"}], "]"}]}]}], ")"}]}], "+", 
   RowBox[{
    RowBox[{"Cos", "[", 
     RowBox[{"2", " ", "x"}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{"0.0012304382770095637`", "\[VeryThinSpace]", "+", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "y"}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "0.0006152191385047818`"}], "-", 
         RowBox[{"0.0012304382770095637`", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "z"}], "]"}]}]}], ")"}]}], "-", 
      RowBox[{"0.0006152191385047818`", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "z"}], "]"}]}]}], ")"}]}], "+", 
   RowBox[{"0.0012304382770095637`", " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"2", " ", "z"}], "]"}]}]}], 
  RowBox[{"2", " ", 
   SqrtBox["2"], " ", 
   SuperscriptBox["\[Pi]", 
    RowBox[{"3", "/", "2"}]]}]]], "Output",
 CellChangeTimes->{3.66118760406949*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"solcomp", " ", "=", " ", 
   RowBox[{"Flatten", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"N", "@", 
       RowBox[{"(", 
        RowBox[{"sol", " ", "/.", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x", "\[Rule]", " ", "xv"}], ",", " ", 
           RowBox[{"y", "\[Rule]", " ", "yv"}], ",", " ", 
           RowBox[{"z", "\[Rule]", " ", "zv"}]}], "}"}]}], ")"}]}], ",", " ", 
      
      RowBox[{"{", 
       RowBox[{"xv", ",", "vals"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"yv", ",", "vals"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"zv", ",", "vals"}], "}"}]}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.661119982594017*^9, 3.661120070455111*^9}, {
  3.6611201166205072`*^9, 3.6611201493596973`*^9}, {3.661120673991028*^9, 
  3.661120677438554*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"filename", " ", "=", " ", 
  RowBox[{"SystemDialogInput", "[", 
   RowBox[{"\"\<FileOpen\>\"", ",", 
    RowBox[{"NotebookDirectory", "[", "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.661120244221681*^9, 3.661120281621773*^9}}],

Cell[BoxData["\<\"/Users/niki/Dropbox/Uni/Exercises/11Semester/MAPhysics/data/\
run.h5\"\>"], "Output",
 CellChangeTimes->{3.661187613346149*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Import", "[", 
    RowBox[{"filename", ",", " ", 
     RowBox[{"{", 
      RowBox[{"\"\<Datasets\>\"", ",", "\"\</a\>\""}], "}"}]}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}], " ", "\[Equal]", " ", "a"}]], "Input",
 CellChangeTimes->{{3.661120812952992*^9, 3.661120813504758*^9}, {
  3.661121078051072*^9, 3.6611211029461184`*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.661187614949122*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Import", "[", 
    RowBox[{"filename", ",", " ", 
     RowBox[{"{", 
      RowBox[{"\"\<Datasets\>\"", ",", "\"\</rho\>\""}], "}"}]}], "]"}], "[", 
   
   RowBox[{"[", "1", "]"}], "]"}], " ", "\[Equal]", " ", "rhoavg"}]], "Input",\

 CellChangeTimes->{{3.6611210515052547`*^9, 3.661121075259079*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.66118761618674*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"solnumraw", " ", "=", " ", 
   RowBox[{"Import", "[", 
    RowBox[{"filename", ",", " ", 
     RowBox[{"{", 
      RowBox[{"\"\<Datasets\>\"", ",", "\"\</psi\>\""}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6611202928610287`*^9, 3.661120305221711*^9}, {
  3.661120345109941*^9, 3.661120410638591*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"solnum", " ", "=", " ", 
   RowBox[{"solnumraw", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.661120412648725*^9, 3.661120423686034*^9}, {
  3.6611207048782053`*^9, 3.66112070497305*^9}, {3.661120825184596*^9, 
  3.661120825288353*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Max", "[", 
  RowBox[{"Abs", "[", 
   RowBox[{"solnum", "  ", "-", " ", "solcomp"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.661120430379613*^9, 3.6611204579093943`*^9}, {
  3.6611206354998426`*^9, 3.661120641267309*^9}}],

Cell[BoxData["3.0466081046842675`*^-17"], "Output",
 CellChangeTimes->{3.661187621828817*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"err", " ", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"Re", "[", 
     RowBox[{
      RowBox[{"lap", "[", "sol", "]"}], " ", "-", " ", "rhs"}], "]"}], ",", 
    RowBox[{"Assumptions", "\[Rule]", "  ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x", "\[Element]", "Reals"}], ",", " ", 
       RowBox[{"y", "\[Element]", "Reals"}], ",", " ", 
       RowBox[{"z", "\[Element]", "Reals"}]}], "}"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Maximize", "[", 
  RowBox[{
   RowBox[{"Re", "[", "err", "]"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Minimize", "[", 
  RowBox[{
   RowBox[{"Re", "[", "err", "]"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.661118754267967*^9, 3.6611187958197308`*^9}, {
  3.661119332613393*^9, 3.66111944664178*^9}, {3.661119569372998*^9, 
  3.661119569885344*^9}, {3.661121963623767*^9, 3.661121974934758*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"2.168404344971009`*^-19", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "+", 
  RowBox[{"1.0842021724855044`*^-19", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"2", " ", "y"}], "]"}]}], "-", 
  RowBox[{"5.421010862427522`*^-20", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{
     RowBox[{"2", " ", "y"}], "-", 
     RowBox[{"2", " ", "z"}]}], "]"}]}], "+", 
  RowBox[{"1.0842021724855044`*^-19", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"2", " ", "z"}], "]"}]}], "-", 
  RowBox[{"5.421010862427522`*^-20", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"y", "+", "z"}], ")"}]}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"Cos", "[", 
    RowBox[{"2", " ", "x"}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1.0842021724855044`*^-19"}], "+", 
          RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "-", 
        RowBox[{"3.2526065174565133`*^-19", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "y"}], "]"}]}]}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "z"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"2.168404344971009`*^-19", "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"Sin", "[", "y", "]"}], "2"]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.661187624597137*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"7.589198643092929`*^-19", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x", "\[Rule]", "1.5679861019544818`"}], ",", 
     RowBox[{"y", "\[Rule]", "0.0031825214599251607`"}], ",", 
     RowBox[{"z", "\[Rule]", 
      RowBox[{"-", "0.0026349134733709306`"}]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.661187624663879*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "1.0842010874336654`*^-19"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x", "\[Rule]", "0.00010273567056460939`"}], ",", 
     RowBox[{"y", "\[Rule]", 
      RowBox[{"-", "0.00031396661271653327`"}]}], ",", 
     RowBox[{"z", "\[Rule]", 
      RowBox[{"-", "0.00012636580624003835`"}]}]}], "}"}]}], "}"}]], "Output",\

 CellChangeTimes->{3.6611876247027817`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
equations of motion with scalar perturbation\
\>", "Section",
 CellChangeTimes->{{3.659213014104723*^9, 3.659213021975371*^9}, {
  3.659213222484356*^9, 3.6592132237242527`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Quit", "[", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.659214211589732*^9, 3.6592142130562477`*^9}}],

Cell[BoxData[
 RowBox[{"<<", " ", "EDCRGTCcode.m"}]], "Input",
 CellChangeTimes->{{3.659213467062601*^9, 3.659213488856326*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"coords", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.659213500185669*^9, 3.659213510640218*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "}"}]], "Output",
 CellChangeTimes->{3.661189571726431*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"g", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", " ", "-", " ", 
         RowBox[{"2", " ", 
          RowBox[{"Psi", "[", 
           RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], ")"}]}], 
      ",", "0", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", " ", "-", " ", 
         RowBox[{"2", " ", 
          RowBox[{"Psi", "[", 
           RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], ")"}]}], 
      ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0", ",", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", " ", "-", " ", 
         RowBox[{"2", " ", 
          RowBox[{"Psi", "[", 
           RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], ")"}]}]}], 
     "}"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"g", " ", "=", " ", 
  RowBox[{"-", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "+", 
        RowBox[{"2", " ", 
         RowBox[{"Psi", "[", 
          RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], ",", "0", 
       ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"a", "[", "t", "]"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], " ", "+", " ", 
          RowBox[{"2", " ", 
           RowBox[{"Psi", "[", 
            RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], ")"}]}], 
       ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"a", "[", "t", "]"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], " ", "+", " ", 
          RowBox[{"2", " ", 
           RowBox[{"Psi", "[", 
            RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], ")"}]}], 
       ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"a", "[", "t", "]"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], " ", "+", " ", 
          RowBox[{"2", " ", 
           RowBox[{"Psi", "[", 
            RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], ")"}]}]}],
       "}"}]}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"g", " ", "//", " ", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.6592132263670177`*^9, 3.659213327349605*^9}, {
   3.659213515554082*^9, 3.6592135156902237`*^9}, {3.659213549427917*^9, 
   3.659213562219933*^9}, 3.659214205885046*^9, {3.659287997316237*^9, 
   3.659288011285386*^9}, {3.659288783616477*^9, 3.65928879398288*^9}, {
   3.659288859455915*^9, 3.659288860144106*^9}, {3.660939909094689*^9, 
   3.660939913567176*^9}, {3.661189582767799*^9, 3.6611895896059523`*^9}, {
   3.661190896548168*^9, 3.661190912622839*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"a", "[", "t", "]"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", " ", 
         RowBox[{"Psi", "[", 
          RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], ")"}]}], 
     ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"a", "[", "t", "]"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", " ", 
         RowBox[{"Psi", "[", 
          RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], ")"}]}], 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"a", "[", "t", "]"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", " ", 
         RowBox[{"Psi", "[", 
          RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], ")"}]}]}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.661189573410247*^9, 3.6611895902121553`*^9}, 
   3.661190913120844*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "-", 
      RowBox[{"2", " ", 
       RowBox[{"Psi", "[", 
        RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], ",", "0", ",",
      "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"Psi", "[", 
          RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], ")"}]}], 
     ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"Psi", "[", 
          RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], ")"}]}], 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"Psi", "[", 
          RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], ")"}]}]}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.661189573410247*^9, 3.6611895902121553`*^9}, 
   3.661190913123402*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", "1"}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"Psi", "[", 
         RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], "0", "0", 
      "0"},
     {"0", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox[
         RowBox[{"a", "[", "t", "]"}], "2"]}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"Psi", "[", 
           RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], ")"}]}], 
      "0", "0"},
     {"0", "0", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox[
         RowBox[{"a", "[", "t", "]"}], "2"]}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"Psi", "[", 
           RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], ")"}]}], 
      "0"},
     {"0", "0", "0", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox[
         RowBox[{"a", "[", "t", "]"}], "2"]}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"Psi", "[", 
           RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], ")"}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.661189573410247*^9, 3.6611895902121553`*^9}, 
   3.661190913125464*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RGtensors", "[", 
  RowBox[{"g", ",", "coords"}], "]"}]], "Input",
 CellChangeTimes->{{3.6592135276621113`*^9, 3.6592135335942593`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"gdd = \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{
         RowBox[{"-", "1"}], "-", 
         RowBox[{"2", " ", 
          RowBox[{"Psi", "[", 
           RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], "0", "0", 
        "0"},
       {"0", 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox[
           RowBox[{"a", "[", "t", "]"}], "2"]}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"2", " ", 
            RowBox[{"Psi", "[", 
             RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], ")"}]}], 
        "0", "0"},
       {"0", "0", 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox[
           RowBox[{"a", "[", "t", "]"}], "2"]}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"2", " ", 
            RowBox[{"Psi", "[", 
             RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], ")"}]}], 
        "0"},
       {"0", "0", "0", 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox[
           RowBox[{"a", "[", "t", "]"}], "2"]}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"2", " ", 
            RowBox[{"Psi", "[", 
             RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], ")"}]}]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm["gdd = ", 
   MatrixForm[{{-1 - 
      2 $CellContext`Psi[$CellContext`t, $CellContext`x, $CellContext`y, \
$CellContext`z], 0, 0, 0}, {
     0, -$CellContext`a[$CellContext`t]^2 (-1 + 
       2 $CellContext`Psi[$CellContext`t, $CellContext`x, $CellContext`y, \
$CellContext`z]), 0, 0}, {
     0, 0, -$CellContext`a[$CellContext`t]^2 (-1 + 
       2 $CellContext`Psi[$CellContext`t, $CellContext`x, $CellContext`y, \
$CellContext`z]), 0}, {
     0, 0, 0, -$CellContext`a[$CellContext`t]^2 (-1 + 
       2 $CellContext`Psi[$CellContext`t, $CellContext`x, $CellContext`y, \
$CellContext`z])}}]],
  Editable->False]], "Print",
 CellChangeTimes->{3.661189593230777*^9, 3.6611909204219837`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"LineElement = \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"d", "[", "t", "]"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "-", 
        RowBox[{"2", " ", 
         RowBox[{"Psi", "[", 
          RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], ")"}]}], 
     "-", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"a", "[", "t", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"d", "[", "x", "]"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"Psi", "[", 
          RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], ")"}]}], 
     "-", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"a", "[", "t", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"d", "[", "y", "]"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"Psi", "[", 
          RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], ")"}]}], 
     "-", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"a", "[", "t", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"d", "[", "z", "]"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"Psi", "[", 
          RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], ")"}]}]}],
    Short[#, 32]& ]}],
  SequenceForm["LineElement = ", 
   Short[$CellContext`d[$CellContext`t]^2 (-1 - 
      2 $CellContext`Psi[$CellContext`t, $CellContext`x, $CellContext`y, \
$CellContext`z]) - $CellContext`a[$CellContext`t]^2 \
$CellContext`d[$CellContext`x]^2 (-1 + 
     2 $CellContext`Psi[$CellContext`t, $CellContext`x, $CellContext`y, \
$CellContext`z]) - $CellContext`a[$CellContext`t]^2 \
$CellContext`d[$CellContext`y]^2 (-1 + 
     2 $CellContext`Psi[$CellContext`t, $CellContext`x, $CellContext`y, \
$CellContext`z]) - $CellContext`a[$CellContext`t]^2 \
$CellContext`d[$CellContext`z]^2 (-1 + 
     2 $CellContext`Psi[$CellContext`t, $CellContext`x, $CellContext`y, \
$CellContext`z]), 32]],
  Editable->False]], "Print",
 CellChangeTimes->{3.661189593230777*^9, 3.661190920424614*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"gUU = \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"-", 
         FractionBox["1", 
          RowBox[{"1", "+", 
           RowBox[{"2", " ", 
            RowBox[{"Psi", "[", 
             RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}]]}], "0", 
        "0", "0"},
       {"0", 
        RowBox[{"-", 
         FractionBox["1", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"a", "[", "t", "]"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"2", " ", 
              RowBox[{"Psi", "[", 
               RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], 
            ")"}]}]]}], "0", "0"},
       {"0", "0", 
        RowBox[{"-", 
         FractionBox["1", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"a", "[", "t", "]"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"2", " ", 
              RowBox[{"Psi", "[", 
               RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], 
            ")"}]}]]}], "0"},
       {"0", "0", "0", 
        RowBox[{"-", 
         FractionBox["1", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"a", "[", "t", "]"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"2", " ", 
              RowBox[{"Psi", "[", 
               RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], 
            ")"}]}]]}]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm["gUU = ", 
   MatrixForm[{{(-1)/(1 + 
      2 $CellContext`Psi[$CellContext`t, $CellContext`x, $CellContext`y, \
$CellContext`z]), 0, 0, 0}, {
     0, -$CellContext`a[$CellContext`t]^(-2)/(-1 + 
      2 $CellContext`Psi[$CellContext`t, $CellContext`x, $CellContext`y, \
$CellContext`z]), 0, 0}, {
     0, 0, -$CellContext`a[$CellContext`t]^(-2)/(-1 + 
      2 $CellContext`Psi[$CellContext`t, $CellContext`x, $CellContext`y, \
$CellContext`z]), 0}, {
     0, 0, 0, -$CellContext`a[$CellContext`t]^(-2)/(-1 + 
      2 $CellContext`Psi[$CellContext`t, $CellContext`x, $CellContext`y, \
$CellContext`z])}}]],
  Editable->False]], "Print",
 CellChangeTimes->{3.661189593230777*^9, 3.661190920427414*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"gUU computed in \"\>", "\[InvisibleSpace]", 
   "0.0026159999999997297`", "\[InvisibleSpace]", "\<\" sec\"\>"}],
  SequenceForm["gUU computed in ", 0.0026159999999997297`, " sec"],
  Editable->False]], "Print",
 CellChangeTimes->{3.661189593230777*^9, 3.661190920429335*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Gamma computed in \"\>", "\[InvisibleSpace]", 
   "0.006724999999999426`", "\[InvisibleSpace]", "\<\" sec\"\>"}],
  SequenceForm["Gamma computed in ", 0.006724999999999426, " sec"],
  Editable->False]], "Print",
 CellChangeTimes->{3.661189593230777*^9, 3.661190920431088*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Riemann(dddd) computed in \"\>", "\[InvisibleSpace]", 
   "0.023564000000000362`", "\[InvisibleSpace]", "\<\" sec\"\>"}],
  SequenceForm["Riemann(dddd) computed in ", 0.023564000000000362`, " sec"],
  Editable->False]], "Print",
 CellChangeTimes->{3.661189593230777*^9, 3.66119092043292*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Riemann(Uddd) computed in \"\>", "\[InvisibleSpace]", 
   "0.04810499999999962`", "\[InvisibleSpace]", "\<\" sec\"\>"}],
  SequenceForm["Riemann(Uddd) computed in ", 0.04810499999999962, " sec"],
  Editable->False]], "Print",
 CellChangeTimes->{3.661189593230777*^9, 3.661190920475795*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Ricci computed in \"\>", "\[InvisibleSpace]", 
   "0.02334999999999887`", "\[InvisibleSpace]", "\<\" sec\"\>"}],
  SequenceForm["Ricci computed in ", 0.02334999999999887, " sec"],
  Editable->False]], "Print",
 CellChangeTimes->{3.661189593230777*^9, 3.66119092052531*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Weyl computed in \"\>", "\[InvisibleSpace]", 
   "0.05138400000000054`", "\[InvisibleSpace]", "\<\" sec\"\>"}],
  SequenceForm["Weyl computed in ", 0.05138400000000054, " sec"],
  Editable->False]], "Print",
 CellChangeTimes->{3.661189593230777*^9, 3.661190920577105*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Einstein computed in \"\>", "\[InvisibleSpace]", 
   "0.019054999999999822`", "\[InvisibleSpace]", "\<\" sec\"\>"}],
  SequenceForm["Einstein computed in ", 0.019054999999999822`, " sec"],
  Editable->False]], "Print",
 CellChangeTimes->{3.661189593230777*^9, 3.661190920580077*^9}],

Cell[BoxData["\<\"All tasks completed in 0.181945 seconds\"\>"], "Print",
 CellChangeTimes->{3.661189593230777*^9, 3.661190920582506*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"printrepl", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      SuperscriptBox["phi", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", " ",
      "dphi"}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox["phi", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", " ",
      "xphi"}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox["phi", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", " ",
      "yphi"}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox["phi", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", " ",
      "zphi"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      SuperscriptBox["phi", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"2", ",", "0", ",", "0", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", " ",
      "ddphi"}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox["phi", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "2", ",", "0", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", " ",
      "xxphi"}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox["phi", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "0", ",", "2", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", " ",
      "yyphi"}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox["phi", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "0", ",", "0", ",", "2"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", " ",
      "zzphi"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"a", "[", "t", "]"}], " ", "\[Rule]", " ", "a"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "'"}], "[", "t", "]"}], " ", "\[Rule]", " ", "da"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Psi", "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", " ",
      "Psi"}], ",", " ", 
    RowBox[{
     RowBox[{
      SuperscriptBox["Psi", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", " ",
      "dPsi"}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox["Psi", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", " ",
      "xPsi"}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox["Psi", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", " ",
      "yPsi"}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox["Psi", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", " ",
      "zPsi"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.659213914364317*^9, 3.65921392209678*^9}, {
  3.659214396071636*^9, 3.659214400462729*^9}, {3.6592144383026733`*^9, 
  3.659214534062351*^9}, {3.659214571991007*^9, 3.6592146891433773`*^9}, {
  3.659214787192404*^9, 3.65921479109603*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     SuperscriptBox["phi", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"1", ",", "0", ",", "0", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "dphi"}], 
   ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["phi", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "xphi"}], 
   ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["phi", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "0", ",", "1", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "yphi"}], 
   ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["phi", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "0", ",", "0", ",", "1"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "zphi"}], 
   ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["phi", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"2", ",", "0", ",", "0", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "ddphi"}],
    ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["phi", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "2", ",", "0", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "xxphi"}],
    ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["phi", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "0", ",", "2", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "yyphi"}],
    ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["phi", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "0", ",", "0", ",", "2"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "zzphi"}],
    ",", 
   RowBox[{
    RowBox[{"a", "[", "t", "]"}], "\[Rule]", "a"}], ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["a", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], "\[Rule]", "da"}], ",", 
   RowBox[{
    RowBox[{"Psi", "[", 
     RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "Psi"}], 
   ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["Psi", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"1", ",", "0", ",", "0", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "dPsi"}], 
   ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["Psi", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "xPsi"}], 
   ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["Psi", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "0", ",", "1", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "\[Rule]", "yPsi"}], 
   ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["Psi", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "0", ",", "0", ",", "1"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "\[Rule]", 
    "zPsi"}]}], "}"}]], "Output",
 CellChangeTimes->{3.661189599598557*^9, 3.661190923305894*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"oprepl", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"xxphi", " ", "\[Rule]", "  ", 
     RowBox[{"lphi", " ", "-", " ", "yyphi", " ", "-", " ", "zzphi"}]}], ",", 
    " ", 
    RowBox[{
     RowBox[{"xphi", " ", "xPsi"}], " ", "\[Rule]", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "yphi"}], " ", "yPsi"}], "-", 
      RowBox[{"zphi", " ", "zPsi"}], "  ", "+", " ", 
      RowBox[{"gphi", " ", "gPsi"}]}]}], ",", " ", 
    RowBox[{"da", " ", "\[Rule]", " ", 
     RowBox[{"H", " ", "a"}]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.659214793541716*^9, 3.659214931155787*^9}, {
   3.659215044272204*^9, 3.659215066023184*^9}, {3.659215187363412*^9, 
   3.659215204714739*^9}, {3.6592156626027393`*^9, 3.659215663906513*^9}, {
   3.6592157005773363`*^9, 3.6592157422419577`*^9}, {3.659215957680072*^9, 
   3.6592159577599077`*^9}, {3.6592164270709352`*^9, 
   3.6592164534208717`*^9}, {3.6592881588968487`*^9, 3.659288181195691*^9}, 
   3.659288894571817*^9, {3.660940168303521*^9, 3.660940175150783*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"xxphi", "\[Rule]", 
    RowBox[{"lphi", "-", "yyphi", "-", "zzphi"}]}], ",", 
   RowBox[{
    RowBox[{"xphi", " ", "xPsi"}], "\[Rule]", 
    RowBox[{
     RowBox[{"gphi", " ", "gPsi"}], "-", 
     RowBox[{"yphi", " ", "yPsi"}], "-", 
     RowBox[{"zphi", " ", "zPsi"}]}]}], ",", 
   RowBox[{"da", "\[Rule]", 
    RowBox[{"a", " ", "H"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.661189601078171*^9, 3.661190924546418*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Laplacian", "[", 
   RowBox[{"phi", "[", 
    RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "]"}], " ", "//", " ",
   "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{"eomtmp", " ", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"%", " ", "/.", " ", "printrepl"}], ")"}], ",", " ", 
    RowBox[{"Assumptions", " ", "\[Rule]", "  ", "oprepl"}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.659213984446457*^9, 3.6592140165301533`*^9}, {
  3.659214079454344*^9, 3.6592141197235193`*^9}, {3.6592143219106903`*^9, 
  3.659214381024578*^9}, {3.659214540282854*^9, 3.659214549824751*^9}, {
  3.659214698842856*^9, 3.6592147557365828`*^9}, {3.6592148287619553`*^9, 
  3.659214833049459*^9}, {3.659214941697033*^9, 3.659214950600512*^9}, {
  3.659215026730626*^9, 3.659215087767284*^9}, {3.659215333484338*^9, 
  3.6592153424571247`*^9}, {3.659215839196046*^9, 3.659215839323812*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"a", "[", "t", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"4", " ", 
        SuperscriptBox[
         RowBox[{"Psi", "[", 
          RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "2"]}]}], ")"}],
      "2"]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     SuperscriptBox["phi", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "0", ",", "0", ",", "2"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "+", 
    RowBox[{
     SuperscriptBox["phi", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "0", ",", "2", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "+", 
    RowBox[{
     SuperscriptBox["phi", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "2", ",", "0", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "-", 
    RowBox[{"3", " ", 
     RowBox[{"a", "[", "t", "]"}], " ", 
     RowBox[{
      SuperscriptBox["a", "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}], " ", 
     RowBox[{
      SuperscriptBox["phi", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"Psi", "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"2", " ", 
           RowBox[{"Psi", "[", 
            RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], ")"}], 
        " ", 
        RowBox[{
         SuperscriptBox["phi", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "0", ",", "0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["Psi", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "0", ",", "0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"2", " ", 
           RowBox[{"Psi", "[", 
            RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"2", " ", 
              RowBox[{"Psi", "[", 
               RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], 
            ")"}]}]}], ")"}], " ", 
        RowBox[{
         SuperscriptBox["phi", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "0", ",", "0", ",", "2"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], "+", 
       RowBox[{
        SuperscriptBox["phi", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "0", ",", "2", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"2", " ", 
           RowBox[{"Psi", "[", 
            RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], ")"}], 
        " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            SuperscriptBox["phi", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"0", ",", "0", ",", "1", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", 
           RowBox[{
            SuperscriptBox["Psi", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"0", ",", "0", ",", "1", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"Psi", "[", 
            RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", 
           RowBox[{
            SuperscriptBox["phi", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"0", ",", "0", ",", "2", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], ")"}]}], 
       "-", 
       RowBox[{"2", " ", 
        RowBox[{
         SuperscriptBox["phi", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["Psi", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], "-", 
       RowBox[{"4", " ", 
        RowBox[{"Psi", "[", 
         RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["phi", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["Psi", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], "+", 
       RowBox[{
        SuperscriptBox["phi", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "2", ",", "0", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"Psi", "[", 
         RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"2", " ", 
           RowBox[{"Psi", "[", 
            RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], ")"}], 
        " ", 
        RowBox[{
         SuperscriptBox["phi", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "2", ",", "0", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], "+", 
       RowBox[{"3", " ", 
        RowBox[{"a", "[", "t", "]"}], " ", 
        RowBox[{
         SuperscriptBox["a", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], " ", 
        RowBox[{
         SuperscriptBox["phi", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "0", ",", "0", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], "+", 
       RowBox[{"6", " ", 
        RowBox[{"a", "[", "t", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"2", " ", 
           RowBox[{"Psi", "[", 
            RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], ")"}], 
        " ", 
        RowBox[{"Psi", "[", 
         RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["a", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], " ", 
        RowBox[{
         SuperscriptBox["phi", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "0", ",", "0", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], ")"}]}], "-", 
    RowBox[{"4", " ", 
     SuperscriptBox[
      RowBox[{"a", "[", "t", "]"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"Psi", "[", 
        RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"Psi", "[", 
          RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "2"]}]}], ")"}],
      " ", 
     RowBox[{
      SuperscriptBox["phi", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", 
     RowBox[{
      SuperscriptBox["Psi", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], "-", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"a", "[", "t", "]"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", " ", 
         RowBox[{"Psi", "[", 
          RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], ")"}], "2"],
      " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"2", " ", 
        RowBox[{"Psi", "[", 
         RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], ")"}], " ", 
     RowBox[{
      SuperscriptBox["phi", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"2", ",", "0", ",", "0", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.6611896044984703`*^9, 3.661190925853932*^9}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{"3", " ", "a", " ", "da", " ", "dphi", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", " ", "Psi"}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"2", " ", "Psi"}]}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox["a", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"2", " ", "Psi"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"4", " ", "dphi", " ", "dPsi", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "Psi"}], ")"}]}], "+", 
       RowBox[{"ddphi", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["Psi", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"2", " ", "Psi"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "xxphi"}], "-", "yyphi", "-", "zzphi", "+", 
       RowBox[{"4", " ", "Psi", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"xphi", " ", "xPsi"}], "+", 
          RowBox[{"yphi", " ", "yPsi"}], "+", 
          RowBox[{"zphi", " ", "zPsi"}], "+", 
          RowBox[{"Psi", " ", 
           RowBox[{"(", 
            RowBox[{"xxphi", "+", "yyphi", "+", "zzphi"}], ")"}]}]}], 
         ")"}]}]}], ")"}]}]}], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"a", "-", 
      RowBox[{"4", " ", "a", " ", 
       SuperscriptBox["Psi", "2"]}]}], ")"}], "2"]]}]], "Output",
 CellChangeTimes->{3.6611896044984703`*^9, 3.66119092592938*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"res1", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Series", "[", 
      RowBox[{"eomtmp", ",", " ", 
       RowBox[{"{", 
        RowBox[{"Psi", ",", "0", ",", "1"}], "}"}]}], "]"}], " ", "/.", " ", 
     "oprepl"}], " ", "//", " ", "Simplify"}], " ", "//", " ", 
   "Normal"}]}], "\[IndentingNewLine]", 
 RowBox[{"SeriesCoefficient", "[", 
  RowBox[{"res1", ",", 
   RowBox[{"{", 
    RowBox[{"ddphi", ",", "0", ",", "1"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"SeriesCoefficient", "[", 
  RowBox[{"res1", ",", 
   RowBox[{"{", 
    RowBox[{"dphi", ",", "0", ",", "1"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"SeriesCoefficient", "[", 
  RowBox[{"res1", ",", 
   RowBox[{"{", 
    RowBox[{"dphi", ",", "0", ",", "2"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"SeriesCoefficient", "[", 
  RowBox[{"res1", ",", 
   RowBox[{"{", 
    RowBox[{"lphi", ",", "0", ",", "1"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"SeriesCoefficient", "[", 
  RowBox[{"res1", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"gphi", " ", "gPsi"}], ",", "0", ",", "1"}], "}"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.661194019183784*^9, 3.6611940449755163`*^9}, {
  3.661194102610032*^9, 3.661194104018034*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "ddphi"}], "+", 
  RowBox[{"4", " ", "dphi", " ", "dPsi"}], "-", 
  RowBox[{"3", " ", "dphi", " ", "H"}], "+", 
  FractionBox["lphi", 
   SuperscriptBox["a", "2"]], "+", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "gphi", " ", "gPsi"}], "+", 
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"ddphi", "-", 
         RowBox[{"2", " ", "dphi", " ", "dPsi"}], "+", 
         RowBox[{"3", " ", "dphi", " ", "H"}]}], ")"}]}], "+", "lphi"}], 
     ")"}], " ", "Psi"}], 
   SuperscriptBox["a", "2"]]}]], "Output",
 CellChangeTimes->{{3.6611940374958773`*^9, 3.661194045456935*^9}, 
   3.661194104631453*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "1"}], "+", 
  RowBox[{"2", " ", "Psi"}]}]], "Output",
 CellChangeTimes->{{3.6611940374958773`*^9, 3.661194045456935*^9}, 
   3.661194104633121*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"4", " ", "dPsi"}], "-", 
  RowBox[{"3", " ", "H"}], "-", 
  RowBox[{"4", " ", "dPsi", " ", "Psi"}], "+", 
  RowBox[{"6", " ", "H", " ", "Psi"}]}]], "Output",
 CellChangeTimes->{{3.6611940374958773`*^9, 3.661194045456935*^9}, 
   3.661194104634317*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.6611940374958773`*^9, 3.661194045456935*^9}, 
   3.661194104635434*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{"1", "+", 
   RowBox[{"2", " ", "Psi"}]}], 
  SuperscriptBox["a", "2"]]], "Output",
 CellChangeTimes->{{3.6611940374958773`*^9, 3.661194045456935*^9}, 
   3.6611941046366*^9}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"4", " ", "Psi"}], 
   SuperscriptBox["a", "2"]]}]], "Output",
 CellChangeTimes->{{3.6611940374958773`*^9, 3.661194045456935*^9}, 
   3.661194104699404*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"res", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Series", "[", 
      RowBox[{
       RowBox[{"eomtmp", " ", "/.", " ", 
        RowBox[{"{", 
         RowBox[{"dPsi", " ", "\[Rule]", " ", 
          RowBox[{
           RowBox[{
            FractionBox["1", "2"], " ", "dphi", " ", "delphi"}], " ", "-", 
           " ", 
           RowBox[{"H", " ", "Psi"}]}]}], "}"}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"Psi", ",", "0", ",", "1"}], "}"}]}], "]"}], " ", "/.", " ", 
     "oprepl"}], " ", "//", " ", "Simplify"}], " ", "//", " ", 
   "Normal"}]}]], "Input",
 CellChangeTimes->{{3.661189616502224*^9, 3.6611896312064238`*^9}, {
  3.6611899986808033`*^9, 3.661189998976501*^9}, {3.661190976478998*^9, 
  3.661190979806419*^9}, {3.661192753337017*^9, 3.6611927612144203`*^9}, {
  3.661192793831048*^9, 3.6611928255647182`*^9}, {3.661192927806011*^9, 
  3.661192928398602*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "ddphi"}], "+", 
  RowBox[{"2", " ", "delphi", " ", 
   SuperscriptBox["dphi", "2"]}], "-", 
  RowBox[{"3", " ", "dphi", " ", "H"}], "+", 
  FractionBox["lphi", 
   SuperscriptBox["a", "2"]], "+", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "gphi", " ", "gPsi"}], "+", 
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"ddphi", "+", 
         RowBox[{"dphi", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "delphi"}], " ", "dphi"}], "+", "H"}], ")"}]}]}], 
        ")"}]}], "+", "lphi"}], ")"}], " ", "Psi"}], 
   SuperscriptBox["a", "2"]]}]], "Output",
 CellChangeTimes->{
  3.661189631611887*^9, 3.661190000266953*^9, 3.661190927856359*^9, 
   3.661190980079472*^9, {3.661192756035866*^9, 3.6611927618013153`*^9}, {
   3.6611927966390247`*^9, 3.6611928264098387`*^9}, 3.661192929274001*^9, 
   3.661194319810878*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"coeffs", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"SeriesCoefficient", "[", 
       RowBox[{"eomtmp", ",", " ", 
        RowBox[{"{", 
         RowBox[{"Psi", ",", "0", ",", "#"}], "}"}]}], "]"}], "&"}], "/@", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}]}], " ", "/.", " ", "oprepl"}], " ", "//",
    " ", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.661189800574566*^9, 3.661189850351541*^9}, {
  3.661189885213591*^9, 3.661189899441682*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "ddphi"}], "+", 
    RowBox[{"4", " ", "dphi", " ", "dPsi"}], "-", 
    RowBox[{"3", " ", "dphi", " ", "H"}], "+", 
    FractionBox["lphi", 
     SuperscriptBox["a", "2"]]}], ",", 
   FractionBox[
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "gphi", " ", "gPsi"}], "+", 
       RowBox[{
        SuperscriptBox["a", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"ddphi", "-", 
          RowBox[{"2", " ", "dphi", " ", "dPsi"}], "+", 
          RowBox[{"3", " ", "dphi", " ", "H"}]}], ")"}]}], "+", "lphi"}], 
      ")"}]}], 
    SuperscriptBox["a", "2"]]}], "}"}]], "Output",
 CellChangeTimes->{{3.6611898203089657`*^9, 3.661189851063795*^9}, {
   3.6611898871517067`*^9, 3.661189899717394*^9}, 3.661190935156927*^9, 
   3.661191039904928*^9, 3.6611943209271603`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"-", 
   RowBox[{"SeriesCoefficient", "[", 
    RowBox[{"res", ",", 
     RowBox[{"{", 
      RowBox[{"ddphi", ",", "0", ",", "1"}], "}"}]}], "]"}]}], " ", "//", " ",
   "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"-", 
   RowBox[{"SeriesCoefficient", "[", 
    RowBox[{"res", ",", 
     RowBox[{"{", 
      RowBox[{"dphi", ",", "0", ",", "1"}], "}"}]}], "]"}]}], " ", "//", " ", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"-", 
   RowBox[{"SeriesCoefficient", "[", 
    RowBox[{"res", ",", 
     RowBox[{"{", 
      RowBox[{"dphi", ",", "0", ",", "2"}], "}"}]}], "]"}]}], " ", "//", " ", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"-", 
   RowBox[{"SeriesCoefficient", "[", 
    RowBox[{"res", ",", 
     RowBox[{"{", 
      RowBox[{"lphi", ",", "0", ",", "1"}], "}"}]}], "]"}]}], " ", "//", " ", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"-", 
   RowBox[{"SeriesCoefficient", "[", 
    RowBox[{"res", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"gphi", " ", "gPsi"}], ",", "0", ",", "1"}], "}"}]}], "]"}]}], 
  " ", "//", " ", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.6611938517696333`*^9, 3.66119394465974*^9}, {
  3.66119430072795*^9, 3.6611943128476267`*^9}}],

Cell[BoxData[
 RowBox[{"1", "-", 
  RowBox[{"2", " ", "Psi"}]}]], "Output",
 CellChangeTimes->{{3.6611938669828033`*^9, 3.661193945043116*^9}, {
  3.661194315092638*^9, 3.6611943217276917`*^9}}],

Cell[BoxData[
 RowBox[{"H", " ", 
  RowBox[{"(", 
   RowBox[{"3", "-", 
    RowBox[{"2", " ", "Psi"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.6611938669828033`*^9, 3.661193945043116*^9}, {
  3.661194315092638*^9, 3.661194321729114*^9}}],

Cell[BoxData[
 RowBox[{"2", " ", "delphi", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", "Psi"}], ")"}]}]], "Output",
 CellChangeTimes->{{3.6611938669828033`*^9, 3.661193945043116*^9}, {
  3.661194315092638*^9, 3.6611943217302437`*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"1", "+", 
    RowBox[{"2", " ", "Psi"}]}], 
   SuperscriptBox["a", "2"]]}]], "Output",
 CellChangeTimes->{{3.6611938669828033`*^9, 3.661193945043116*^9}, {
  3.661194315092638*^9, 3.6611943217314*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"4", " ", "Psi"}], 
  SuperscriptBox["a", "2"]]], "Output",
 CellChangeTimes->{{3.6611938669828033`*^9, 3.661193945043116*^9}, {
  3.661194315092638*^9, 3.6611943217654543`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ass", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Psi", ">", "0"}], ",", " ", 
    RowBox[{"phi", ">", "0"}], ",", " ", 
    RowBox[{"dphi", ">", "0"}], ",", " ", 
    RowBox[{"dPhi", ">", "0"}], ",", " ", 
    RowBox[{"ddphi", ">", "0"}], ",", " ", 
    RowBox[{"xphi", ">", "0"}], ",", 
    RowBox[{"yphi", ">", "0"}], ",", 
    RowBox[{"zphi", ">", "0"}], ",", 
    RowBox[{"xPhi", ">", "0"}], ",", 
    RowBox[{"yPhi", ">", "0"}], ",", 
    RowBox[{"zPhi", ">", "0"}], ",", " ", 
    RowBox[{"xxphi", ">", "0"}], ",", " ", 
    RowBox[{"yyphi", ">", "0"}], ",", 
    RowBox[{"zzphi", ">", "0"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.659215491825251*^9, 3.659215551683998*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Psi", ">", "0"}], ",", 
   RowBox[{"phi", ">", "0"}], ",", 
   RowBox[{"dphi", ">", "0"}], ",", 
   RowBox[{"dPhi", ">", "0"}], ",", 
   RowBox[{"ddphi", ">", "0"}], ",", 
   RowBox[{"xphi", ">", "0"}], ",", 
   RowBox[{"yphi", ">", "0"}], ",", 
   RowBox[{"zphi", ">", "0"}], ",", 
   RowBox[{"xPhi", ">", "0"}], ",", 
   RowBox[{"yPhi", ">", "0"}], ",", 
   RowBox[{"zPhi", ">", "0"}], ",", 
   RowBox[{"xxphi", ">", "0"}], ",", 
   RowBox[{"yyphi", ">", "0"}], ",", 
   RowBox[{"zzphi", ">", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{3.661192713744899*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eom", " ", "=", " ", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"FullSimplify", "[", 
      RowBox[{
       RowBox[{"Expand", "[", "eomtmp", "]"}], ",", " ", 
       RowBox[{"Assumptions", " ", "\[Rule]", " ", "ass"}]}], "]"}], " ", "/.",
      " ", "oprepl"}], ")"}], " ", "//", " ", "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.6592154175689383`*^9, 3.659215491116495*^9}, {
  3.659215537571265*^9, 3.659215670770204*^9}, {3.659215763518997*^9, 
  3.6592159014461403`*^9}, {3.65921638848302*^9, 3.6592164020028*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"2", " ", "Psi"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"4", " ", "gphi", " ", "gPsi", " ", "Psi"}], "+", 
       RowBox[{"lphi", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["Psi", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox["a", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"2", " ", "Psi"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "ddphi"}], "+", 
       RowBox[{"4", " ", 
        RowBox[{"(", 
         RowBox[{"ddphi", "+", 
          RowBox[{"3", " ", "dphi", " ", "H"}]}], ")"}], " ", 
        SuperscriptBox["Psi", "2"]}], "+", 
       RowBox[{"dphi", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "3"}], " ", "H"}], "+", 
          RowBox[{"4", " ", "dPsi", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "Psi"}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"a", "-", 
      RowBox[{"4", " ", "a", " ", 
       SuperscriptBox["Psi", "2"]}]}], ")"}], "2"]]}]], "Output",
 CellChangeTimes->{3.661192715446967*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Cancel", "@", 
  RowBox[{"Apart", "@", 
   RowBox[{"Expand", "@", "eom"}]}]}]], "Input",
 CellChangeTimes->{{3.659216404059492*^9, 3.659216406457962*^9}, {
  3.659288934708777*^9, 3.659288936667618*^9}, {3.659288967896413*^9, 
  3.659289009010388*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"gphi", " ", "gPsi"}], 
    RowBox[{
     SuperscriptBox["a", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", "Psi"}]}], ")"}], "2"]}]]}], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     RowBox[{"-", "3"}], " ", 
     SuperscriptBox["a", "2"], " ", "dphi", " ", "dPsi"}], "-", 
    RowBox[{"gphi", " ", "gPsi"}], "-", 
    RowBox[{"2", " ", "lphi"}]}], 
   RowBox[{"2", " ", 
    SuperscriptBox["a", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"2", " ", "Psi"}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{"dphi", " ", "dPsi"}], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"2", " ", "Psi"}]}], ")"}], "2"]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     RowBox[{"-", "2"}], " ", 
     SuperscriptBox["a", "2"], " ", "ddphi"}], "+", 
    RowBox[{"3", " ", 
     SuperscriptBox["a", "2"], " ", "dphi", " ", "dPsi"}], "+", 
    RowBox[{"gphi", " ", "gPsi"}], "-", 
    RowBox[{"6", " ", 
     SuperscriptBox["a", "2"], " ", "dphi", " ", "H"}]}], 
   RowBox[{"2", " ", 
    SuperscriptBox["a", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"2", " ", "Psi"}]}], ")"}]}]]}]], "Output",
 CellChangeTimes->{3.661192722796103*^9}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1440, 851},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
ShowSelection->True,
FrontEndVersion->"8.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (February 23, \
2011)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 132, 3, 67, "Section"],
Cell[714, 27, 117, 2, 27, "Input"],
Cell[834, 31, 388, 8, 49, "Input"],
Cell[1225, 41, 328, 9, 47, "Input"],
Cell[1556, 52, 427, 10, 46, "Input"],
Cell[1986, 64, 444, 12, 27, "Input"],
Cell[2433, 78, 668, 15, 27, "Input"],
Cell[3104, 95, 795, 21, 27, "Input"],
Cell[3902, 118, 309, 7, 27, "Input"],
Cell[4214, 127, 703, 16, 27, "Input"],
Cell[4920, 145, 645, 15, 27, "Input"],
Cell[5568, 162, 653, 19, 62, "Input"],
Cell[6224, 183, 896, 25, 27, "Input"],
Cell[7123, 210, 519, 15, 62, "Input"],
Cell[7645, 227, 309, 8, 46, "Input"],
Cell[7957, 237, 979, 25, 27, "Input"],
Cell[8939, 264, 372, 8, 27, "Input"],
Cell[9314, 274, 524, 12, 27, "Input"],
Cell[9841, 288, 974, 26, 27, "Input"],
Cell[10818, 316, 336, 8, 27, "Input"],
Cell[11157, 326, 357, 10, 27, "Input"],
Cell[11517, 338, 235, 5, 27, "Input"],
Cell[11755, 345, 1584, 41, 79, "Input"],
Cell[13342, 388, 526, 15, 51, "Input"],
Cell[13871, 405, 516, 16, 47, "Input"],
Cell[14390, 423, 1661, 45, 55, "Input"],
Cell[16054, 470, 1000, 27, 27, "Input"],
Cell[17057, 499, 231, 6, 27, "Input"],
Cell[17291, 507, 129, 2, 27, "Input"],
Cell[17423, 511, 331, 10, 27, "Input"],
Cell[17757, 523, 666, 13, 27, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[18460, 541, 427, 14, 42, "Section"],
Cell[18890, 557, 120, 2, 27, "Input"],
Cell[19013, 561, 1239, 31, 108, "Input"],
Cell[20255, 594, 861, 22, 27, "Input"],
Cell[21119, 618, 1070, 26, 27, "Input"],
Cell[22192, 646, 1604, 33, 53, "Input"],
Cell[23799, 681, 524, 14, 27, "Input"],
Cell[24326, 697, 93, 1, 26, "Text"],
Cell[24422, 700, 392, 10, 27, "Input"],
Cell[24817, 712, 100, 1, 26, "Text"],
Cell[24920, 715, 419, 12, 27, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[25376, 732, 177, 4, 37, "Section"],
Cell[25556, 738, 120, 2, 27, "Input"],
Cell[25679, 742, 206, 5, 33, "Input"],
Cell[25888, 749, 290, 7, 27, "Input"],
Cell[26181, 758, 1117, 22, 64, "Input"],
Cell[27301, 782, 861, 22, 27, "Input"],
Cell[28165, 806, 1070, 26, 27, "Input"],
Cell[29238, 834, 1130, 29, 53, "Input"],
Cell[30371, 865, 524, 14, 27, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[30932, 884, 229, 7, 37, "Section"],
Cell[31164, 893, 4235, 106, 207, "Input"],
Cell[35402, 1001, 682, 18, 58, "Input"],
Cell[36087, 1021, 686, 20, 62, "Input"],
Cell[36776, 1043, 596, 17, 63, "Input"],
Cell[37375, 1062, 745, 17, 33, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[38157, 1084, 243, 5, 37, "Section"],
Cell[38403, 1091, 1376, 35, 108, "Text"],
Cell[39782, 1128, 172, 3, 27, "Input"],
Cell[CellGroupData[{
Cell[39979, 1135, 96, 1, 34, "Subsection"],
Cell[40078, 1138, 621, 13, 61, "Input"],
Cell[40702, 1153, 584, 13, 43, "Input"],
Cell[41289, 1168, 467, 11, 27, "Input"],
Cell[41759, 1181, 306, 7, 27, "Input"],
Cell[42068, 1190, 470, 12, 43, "Input"],
Cell[42541, 1204, 348, 8, 43, "Input"],
Cell[42892, 1214, 422, 11, 43, "Input"],
Cell[43317, 1227, 911, 23, 43, "Input"],
Cell[44231, 1252, 322, 6, 27, "Input"],
Cell[44556, 1260, 465, 13, 27, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45058, 1278, 95, 1, 34, "Subsection"],
Cell[45156, 1281, 322, 8, 47, "Input"],
Cell[45481, 1291, 284, 7, 27, "Input"],
Cell[45768, 1300, 111, 3, 27, "Input"],
Cell[45882, 1305, 231, 6, 27, "Input"],
Cell[46116, 1313, 409, 7, 27, "Input"],
Cell[46528, 1322, 179, 5, 27, "Input"],
Cell[46710, 1329, 317, 7, 33, "Input"],
Cell[47030, 1338, 745, 17, 33, "Input"],
Cell[47778, 1357, 94, 1, 27, "Input"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[47921, 1364, 89, 1, 37, "Section"],
Cell[48013, 1367, 118, 2, 27, "Input"],
Cell[48134, 1371, 292, 8, 33, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[48463, 1384, 101, 1, 37, "Section"],
Cell[48567, 1387, 500, 14, 47, "Input"],
Cell[49070, 1403, 785, 21, 46, "Input"],
Cell[49858, 1426, 176, 4, 27, "Input"],
Cell[50037, 1432, 2361, 65, 285, "Input"],
Cell[52401, 1499, 94, 1, 27, "Input"],
Cell[52498, 1502, 1201, 34, 50, "Input"],
Cell[CellGroupData[{
Cell[53724, 1540, 111, 1, 34, "Subsection"],
Cell[53838, 1543, 818, 23, 58, "Input"],
Cell[54659, 1568, 772, 23, 58, "Input"],
Cell[55434, 1593, 1811, 44, 88, "Input"],
Cell[57248, 1639, 724, 12, 27, "Input"],
Cell[57975, 1653, 285, 8, 27, "Input"],
Cell[58263, 1663, 981, 26, 73, "Input"],
Cell[59247, 1691, 291, 7, 27, "Input"],
Cell[59541, 1700, 994, 27, 58, "Input"],
Cell[60538, 1729, 199, 4, 26, "Text"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[60786, 1739, 105, 1, 37, "Section"],
Cell[60894, 1742, 120, 2, 27, "Input"],
Cell[61017, 1746, 1841, 53, 105, "Input"],
Cell[62861, 1801, 928, 23, 58, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[63826, 1829, 109, 1, 37, "Section"],
Cell[63938, 1832, 1253, 32, 48, "Input"],
Cell[65194, 1866, 296, 7, 27, "Input"],
Cell[65493, 1875, 354, 9, 27, "Input"],
Cell[65850, 1886, 403, 10, 27, "Input"],
Cell[66256, 1898, 352, 9, 27, "Input"],
Cell[66611, 1909, 455, 12, 27, "Input"],
Cell[67069, 1923, 504, 12, 27, "Input"],
Cell[67576, 1937, 456, 12, 27, "Input"],
Cell[68035, 1951, 681, 19, 27, "Input"],
Cell[68719, 1972, 1349, 39, 33, "Input"],
Cell[70071, 2013, 94, 1, 27, "Input"],
Cell[70168, 2016, 201, 4, 27, "Input"],
Cell[70372, 2022, 973, 26, 27, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[71382, 2053, 114, 1, 37, "Section"],
Cell[71499, 2056, 138, 3, 27, "Input"],
Cell[71640, 2061, 232, 6, 30, "Input"],
Cell[71875, 2069, 713, 17, 33, "Input"],
Cell[72591, 2088, 873, 21, 33, "Input"],
Cell[73467, 2111, 502, 11, 27, "Input"],
Cell[73972, 2124, 324, 8, 27, "Input"],
Cell[74299, 2134, 220, 5, 27, "Input"],
Cell[74522, 2141, 495, 10, 43, "Input"],
Cell[75020, 2153, 263, 7, 33, "Input"],
Cell[75286, 2162, 295, 8, 49, "Input"],
Cell[75584, 2172, 422, 8, 27, "Input"],
Cell[76009, 2182, 587, 15, 33, "Input"],
Cell[76599, 2199, 376, 9, 27, "Input"],
Cell[76978, 2210, 410, 8, 27, "Input"],
Cell[77391, 2220, 488, 12, 27, "Input"],
Cell[77882, 2234, 481, 12, 27, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[78400, 2251, 117, 1, 37, "Section"],
Cell[78520, 2254, 136, 3, 27, "Input"],
Cell[78659, 2259, 512, 16, 27, "Input"],
Cell[79174, 2277, 1143, 35, 27, "Input"],
Cell[80320, 2314, 688, 19, 33, "Input"],
Cell[81011, 2335, 938, 25, 33, "Input"],
Cell[81952, 2362, 339, 9, 27, "Input"],
Cell[CellGroupData[{
Cell[82316, 2375, 127, 1, 34, "Subsection"],
Cell[82446, 2378, 457, 10, 30, "Input"],
Cell[82906, 2390, 405, 9, 27, "Input"],
Cell[83314, 2401, 669, 18, 33, "Input"],
Cell[83986, 2421, 281, 6, 46, "Input"],
Cell[84270, 2429, 320, 9, 27, "Input"],
Cell[84593, 2440, 401, 12, 33, "Input"],
Cell[84997, 2454, 661, 20, 33, "Input"],
Cell[85661, 2476, 807, 23, 33, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[86505, 2504, 128, 1, 34, "Subsection"],
Cell[86636, 2507, 548, 10, 27, "Input"],
Cell[87187, 2519, 481, 10, 27, "Input"],
Cell[CellGroupData[{
Cell[87693, 2533, 267, 5, 27, "Input"],
Cell[87963, 2540, 73, 1, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[88073, 2546, 283, 6, 27, "Input"],
Cell[88359, 2554, 70, 1, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[88466, 2560, 670, 14, 49, "Input"],
Cell[89139, 2576, 876, 24, 33, "Output"]
}, Open  ]],
Cell[90030, 2603, 766, 18, 46, "Input"],
Cell[CellGroupData[{
Cell[90821, 2625, 764, 20, 27, "Input"],
Cell[91588, 2647, 96, 1, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[91721, 2653, 168, 3, 27, "Input"],
Cell[91892, 2658, 78, 1, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[92007, 2664, 167, 4, 66, "Input"],
Cell[92177, 2670, 90, 1, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[92304, 2676, 693, 15, 66, "Input"],
Cell[93000, 2693, 269, 6, 27, "Output"],
Cell[93272, 2701, 70, 1, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[93379, 2707, 570, 14, 33, "Input"],
Cell[93952, 2723, 895, 25, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[94884, 2753, 601, 14, 27, "Input"],
Cell[95488, 2769, 1337, 37, 53, "Output"]
}, Open  ]],
Cell[96840, 2809, 870, 23, 27, "Input"],
Cell[CellGroupData[{
Cell[97735, 2836, 256, 5, 27, "Input"],
Cell[97994, 2843, 145, 2, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[98176, 2850, 383, 9, 27, "Input"],
Cell[98562, 2861, 73, 1, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[98672, 2867, 347, 10, 27, "Input"],
Cell[99022, 2879, 72, 1, 27, "Output"]
}, Open  ]],
Cell[99109, 2883, 355, 9, 27, "Input"],
Cell[99467, 2894, 309, 7, 27, "Input"],
Cell[CellGroupData[{
Cell[99801, 2905, 251, 5, 27, "Input"],
Cell[100055, 2912, 93, 1, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[100185, 2918, 1049, 27, 58, "Input"],
Cell[101237, 2947, 1504, 44, 53, "Output"],
Cell[102744, 2993, 374, 9, 33, "Output"],
Cell[103121, 3004, 426, 12, 33, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[103608, 3023, 188, 4, 67, "Section"],
Cell[103799, 3029, 138, 3, 27, "Input"],
Cell[103940, 3034, 128, 2, 27, "Input"],
Cell[CellGroupData[{
Cell[104093, 3040, 197, 4, 27, "Input"],
Cell[104293, 3046, 135, 3, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[104465, 3054, 3388, 94, 69, "Input"],
Cell[107856, 3150, 1278, 40, 33, "Output"],
Cell[109137, 3192, 1566, 51, 33, "Output"],
Cell[110706, 3245, 1889, 59, 97, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[112632, 3309, 160, 3, 27, "Input"],
Cell[CellGroupData[{
Cell[112817, 3316, 2675, 74, 78, "Print"],
Cell[115495, 3392, 2317, 65, 23, "Print"],
Cell[117815, 3459, 2870, 79, 116, "Print"],
Cell[120688, 3540, 323, 6, 20, "Print"],
Cell[121014, 3548, 324, 6, 20, "Print"],
Cell[121341, 3556, 340, 6, 20, "Print"],
Cell[121684, 3564, 338, 6, 20, "Print"],
Cell[122025, 3572, 321, 6, 20, "Print"],
Cell[122349, 3580, 320, 6, 20, "Print"],
Cell[122672, 3588, 331, 6, 20, "Print"],
Cell[123006, 3596, 137, 1, 20, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[123192, 3603, 4544, 137, 87, "Input"],
Cell[127739, 3742, 3980, 133, 71, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[131756, 3880, 1053, 22, 27, "Input"],
Cell[132812, 3904, 475, 13, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[133324, 3922, 957, 19, 43, "Input"],
Cell[134284, 3943, 10196, 296, 154, "Output"],
Cell[144483, 4241, 1669, 51, 58, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[146189, 4297, 1295, 38, 103, "Input"],
Cell[147487, 4337, 754, 22, 52, "Output"],
Cell[148244, 4361, 187, 5, 27, "Output"],
Cell[148434, 4368, 286, 7, 27, "Output"],
Cell[148723, 4377, 122, 2, 27, "Output"],
Cell[148848, 4381, 213, 6, 47, "Output"],
Cell[149064, 4389, 211, 6, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[149312, 4400, 936, 23, 46, "Input"],
Cell[150251, 4425, 1022, 29, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[151310, 4459, 521, 14, 27, "Input"],
Cell[151834, 4475, 901, 25, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[152772, 4505, 1285, 38, 88, "Input"],
Cell[154060, 4545, 194, 4, 27, "Output"],
Cell[154257, 4551, 241, 6, 27, "Output"],
Cell[154501, 4559, 253, 6, 27, "Output"],
Cell[154757, 4567, 257, 7, 47, "Output"],
Cell[155017, 4576, 216, 5, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[155270, 4586, 723, 18, 27, "Input"],
Cell[155996, 4606, 615, 17, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[156648, 4628, 561, 12, 27, "Input"],
Cell[157212, 4642, 1369, 44, 58, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[158618, 4691, 276, 6, 27, "Input"],
Cell[158897, 4699, 1379, 46, 53, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
