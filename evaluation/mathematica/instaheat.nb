(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    451647,      12890]
NotebookOptionsPosition[    420987,      12037]
NotebookOutlinePosition[    421445,      12055]
CellTagsIndexPosition[    421402,      12052]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["mk_fourier_spectral_operators revisited", "Section",
 CellChangeTimes->{{3.655590744365844*^9, 3.655590772491901*^9}}],

Cell[BoxData[
 RowBox[{"Quit", "[", "]"}]], "Input",
 CellChangeTimes->{{3.655153761350109*^9, 3.65515376261451*^9}}],

Cell[BoxData[
 RowBox[{"origPoints", " ", "=", " ", 
  RowBox[{
   RowBox[{"-", "\[Pi]"}], "+", 
   FractionBox[
    RowBox[{"2", " ", "\[Pi]", " ", "i"}], "Np"]}]}]], "Input",
 CellChangeTimes->{{3.655150793279812*^9, 3.655150831239789*^9}, {
  3.655151342142723*^9, 3.655151343158386*^9}, {3.6551513859324837`*^9, 
  3.655151386100369*^9}, {3.655153718216855*^9, 3.655153720832675*^9}}],

Cell[BoxData[
 RowBox[{"scaledPoints", " ", "=", " ", 
  RowBox[{
   RowBox[{"origPoints", " ", "*", " ", 
    FractionBox[
     RowBox[{"(", 
      RowBox[{"b", "-", "a"}], ")"}], 
     RowBox[{"2", " ", "\[Pi]"}]]}], " ", "//", " ", "Simplify"}]}]], "Input",\

 CellChangeTimes->{{3.655150834467767*^9, 3.655150877661848*^9}}],

Cell[BoxData[
 RowBox[{"shiftandscaledPoints", " ", "=", " ", 
  RowBox[{
   RowBox[{"scaledPoints", " ", "+", " ", 
    FractionBox[
     RowBox[{"(", 
      RowBox[{"b", "-", "a"}], ")"}], "2"], "+", " ", "a"}], " ", "//", " ", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.655150906522875*^9, 3.655150929202509*^9}, {
  3.655151199181274*^9, 3.655151247611217*^9}, {3.655151513774433*^9, 
  3.655151514374119*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Simplify", "@", "origPoints"}], " ", "==", " ", 
  RowBox[{"Simplify", "@", 
   RowBox[{"(", 
    RowBox[{"shiftandscaledPoints", " ", "/.", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", "\[Rule]", " ", 
        RowBox[{"-", "\[Pi]"}]}], ",", " ", 
       RowBox[{"b", "\[Rule]", " ", "\[Pi]"}]}], "}"}]}], ")"}]}]}]], "Input",\

 CellChangeTimes->{{3.655150973200231*^9, 3.655151065676188*^9}}],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"shiftandscaledPoints", " ", "/.", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", "\[Rule]", " ", 
        RowBox[{"-", "\[Pi]"}]}], ",", " ", 
       RowBox[{"b", "\[Rule]", " ", "\[Pi]"}], ",", " ", 
       RowBox[{"Np", "\[Rule]", " ", "51"}]}], "}"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "0", ",", "50"}], "}"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6551509378460503`*^9, 3.655150967377304*^9}, {
  3.655151089707018*^9, 3.6551511004832*^9}, {3.655151310888871*^9, 
  3.655151321111948*^9}, {3.655153730007979*^9, 3.655153731584453*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"x", "[", 
    RowBox[{"asub_", ",", "bsub_", ",", "Nsub_"}], "]"}], " ", ":=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"N", "@", "shiftandscaledPoints"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", 
         RowBox[{"Nsub", "-", "1"}]}], "}"}]}], "]"}], " ", "//.", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", "\[Rule]", " ", "asub"}], ",", " ", 
       RowBox[{"b", "\[Rule]", " ", "bsub"}], ",", " ", 
       RowBox[{"Np", "\[Rule]", " ", "Nsub"}]}], "}"}]}], ")"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.655153852104765*^9, 3.6551538865208282`*^9}, {
  3.6551545981978273`*^9, 3.655154646506571*^9}, {3.655156822438856*^9, 
  3.655156830774581*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"asub", "=", 
   RowBox[{"-", "\[Pi]"}]}], ";", " ", 
  RowBox[{"bsub", "=", "\[Pi]"}], ";", " ", 
  RowBox[{"Nsub", " ", "=", " ", "51"}], ";"}]], "Input",
 CellChangeTimes->{{3.655154667869948*^9, 3.6551546834085712`*^9}, {
  3.655156788272337*^9, 3.6551567903920517`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"N", "@", 
      RowBox[{"Min", "@", "#"}]}], ",", 
     RowBox[{"N", "@", 
      RowBox[{"Max", "@", "#"}]}], ",", 
     RowBox[{"Length", "@", "#"}]}], "}"}], "&"}], "@", " ", 
  RowBox[{"x", "[", 
   RowBox[{"asub", ",", "bsub", ",", "Nsub"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.655151143711863*^9, 3.6551511681763487`*^9}, {
   3.655151268571808*^9, 3.655151276394033*^9}, 3.65515373432936*^9, {
   3.655153780535063*^9, 3.6551537830226927`*^9}, 3.655153850572686*^9, {
   3.655153890808606*^9, 3.65515389167177*^9}, {3.655154664625476*^9, 
   3.655154688921275*^9}, {3.6551568371267223`*^9, 3.655156838518098*^9}}],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"shiftandscaledPoints", " ", "/.", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", "\[Rule]", " ", "2"}], ",", " ", 
       RowBox[{"b", "\[Rule]", " ", "10"}], ",", " ", 
       RowBox[{"Np", "\[Rule]", " ", "Nsub"}]}], "}"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "0", ",", 
      RowBox[{"Nsub", "-", "1"}]}], "}"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.655151123857177*^9, 3.6551511288893023`*^9}, 
   3.655153736496399*^9, {3.655153841650893*^9, 3.65515384524258*^9}, {
   3.65515390507996*^9, 3.65515390953561*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"d1", " ", "=", " ", 
   FractionBox[
    RowBox[{"\[Pi]", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"-", "1"}], ")"}], 
      RowBox[{"i", "+", "j"}]]}], 
    RowBox[{
     RowBox[{"Sin", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"i", "-", "j"}], ")"}], " ", 
       FractionBox["\[Pi]", "Np"]}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{"b", "-", "a"}], ")"}]}]]}], ";"}]], "Input",
 CellChangeTimes->{{3.6551532693442097`*^9, 3.6551533235169764`*^9}, 
   3.6551537394969482`*^9, {3.655154411022931*^9, 3.655154416862465*^9}, {
   3.655154486475398*^9, 3.655154486811421*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"d1mat", "[", 
    RowBox[{"asub_", ",", "bsub_", ",", "Nsub_"}], "]"}], ":=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"i", "\[Equal]", "j"}], ",", "0.0", ",", 
         RowBox[{"N", "@", "d1"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", 
         RowBox[{"Np", "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "0", ",", 
         RowBox[{"Np", "-", "1"}]}], "}"}]}], "]"}], " ", "//.", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Np", "\[Rule]", " ", "Nsub"}], ",", " ", 
       RowBox[{"a", "\[Rule]", " ", "asub"}], ",", " ", 
       RowBox[{"b", "\[Rule]", " ", "bsub"}]}], "}"}]}], ")"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6551541974309607`*^9, 3.655154254327396*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"d1orig", " ", "=", " ", 
   FractionBox[
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"-", "1"}], ")"}], 
     RowBox[{"i", "+", "j"}]], 
    RowBox[{"2", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"i", "-", "j"}], ")"}], " ", 
       FractionBox["\[Pi]", "Np"]}], "]"}]}]]}], ";"}]], "Input",
 CellChangeTimes->{{3.6551534945160437`*^9, 3.655153568440838*^9}, 
   3.6551537515517817`*^9, {3.655154421278438*^9, 3.655154422206341*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Simplify", "[", 
   RowBox[{"d1orig", " ", 
    FractionBox[
     RowBox[{"2", " ", "\[Pi]"}], 
     RowBox[{"b", "-", "a"}]]}], "]"}], " ", "\[Equal]", " ", 
  RowBox[{"Simplify", "[", "d1", "]"}]}]], "Input",
 CellChangeTimes->{{3.6551554034666*^9, 3.655155432691915*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"d1matorig", "[", "Nsub_", "]"}], " ", ":=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"i", "\[Equal]", "j"}], ",", "0.0", ",", 
         RowBox[{"N", "@", "d1orig"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", 
         RowBox[{"Np", "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "0", ",", 
         RowBox[{"Np", "-", "1"}]}], "}"}]}], "]"}], " ", "//.", " ", 
     RowBox[{"{", 
      RowBox[{"Np", "\[Rule]", " ", "Nsub"}], "}"}]}], ")"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.655153579785368*^9, 3.6551535870392323`*^9}, {
  3.655153752999508*^9, 3.6551537560949783`*^9}, {3.6551538035489264`*^9, 
  3.655153827883072*^9}, {3.655153975308917*^9, 3.655153975588518*^9}, {
  3.655154264870474*^9, 3.655154280813568*^9}, {3.65515434047404*^9, 
  3.655154346482342*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"d1matorig", "[", "Nsub", "]"}], " ", "\[Equal]", " ", 
  RowBox[{"d1mat", "[", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], ",", "\[Pi]", ",", "Nsub"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6551542878096447`*^9, 3.655154315258739*^9}, {
  3.655154355521289*^9, 3.6551543572807713`*^9}, {3.6551547179512157`*^9, 
  3.655154721518672*^9}}],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"#", ",", 
      RowBox[{"Sin", "[", "#", "]"}]}], "}"}], "&"}], "/@", 
   RowBox[{"x", "[", 
    RowBox[{"asub", ",", "bsub", ",", "Nsub"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.655153829770914*^9, 3.655153831066245*^9}, {
  3.655153992922329*^9, 3.6551540280495033`*^9}, {3.655154732646964*^9, 
  3.655154734830585*^9}, {3.65515507990329*^9, 3.6551550862371187`*^9}, {
  3.655156884596385*^9, 3.655156885947163*^9}}],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"ListPlot", "[", 
    RowBox[{"Thread", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"asub", ",", "bsub", ",", "Nsub"}], "]"}], ",", 
       RowBox[{
        RowBox[{"d1mat", "[", 
         RowBox[{"asub", ",", "bsub", ",", "Nsub"}], "]"}], ".", 
        RowBox[{"Sin", "[", 
         RowBox[{"x", "[", 
          RowBox[{"asub", ",", "bsub", ",", "Nsub"}], "]"}], "]"}]}]}], "}"}],
      "]"}], "]"}], ",", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"Cos", "[", "x", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}]}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.655154104305175*^9, 3.655154116724783*^9}, {
  3.65515455175161*^9, 3.655154557390983*^9}, {3.655154748456993*^9, 
  3.655154760501253*^9}, {3.655155094237002*^9, 3.655155233334446*^9}, {
  3.655156892395446*^9, 3.6551569000036707`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"d1mat", "[", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], ",", "\[Pi]", ",", "5"}], "]"}], " ", "//", " ", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.6551545416875143`*^9, 3.655154546687203*^9}, {
  3.6551548964275627`*^9, 3.655154908333261*^9}, {3.6551549478434153`*^9, 
  3.655154949915141*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"d1mat", "[", 
    RowBox[{
     RowBox[{"-", "\[Pi]"}], ",", "\[Pi]", ",", "5"}], "]"}], ".", 
   RowBox[{"d1mat", "[", 
    RowBox[{
     RowBox[{"-", "\[Pi]"}], ",", "\[Pi]", ",", "5"}], "]"}]}], " ", "//", 
  " ", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.655231010707868*^9, 3.6552310108999567`*^9}}],

Cell[BoxData[
 RowBox[{"x", "[", 
  RowBox[{
   RowBox[{"-", "\[Pi]"}], ",", "\[Pi]", ",", "5"}], "]"}]], "Input",
 CellChangeTimes->{{3.6551549233143587`*^9, 3.6551549265323467`*^9}, {
  3.655156907745607*^9, 3.6551569168651867`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"d2orig", " ", "=", " ", 
   FractionBox[
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", "Mp"}], ")"}], "2"], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"j", "-", "i"}], ")"}], " ", "\[Pi]", " ", 
          FractionBox[
           RowBox[{"(", 
            RowBox[{"Np", "-", "2"}], ")"}], "Np"]}], "]"}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"j", "-", "i"}], ")"}], " ", 
           FractionBox["\[Pi]", "Np"]}], "]"}], "3"], " "}]], "+", 
      RowBox[{
       SuperscriptBox["Mp", "2"], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"j", "-", "i"}], ")"}], " ", "\[Pi]", " ", 
         FractionBox[
          RowBox[{"(", 
           RowBox[{"Np", "+", "2"}], ")"}], "Np"]}], "]"}]}]}], ")"}], 
    RowBox[{"4", " ", "Np"}]]}], ";"}]], "Input",
 CellChangeTimes->{{3.6551553748492317`*^9, 3.6551553824615307`*^9}, {
  3.655155467825651*^9, 3.655155544982834*^9}, {3.655155711888338*^9, 
  3.655155720877603*^9}, {3.655155765045697*^9, 3.655155784600442*^9}, {
  3.6551558322746277`*^9, 3.655155867183258*^9}, {3.655155929723876*^9, 
  3.6551560338077803`*^9}, {3.655156407596376*^9, 3.655156432541626*^9}, {
  3.65515653459939*^9, 3.655156546605783*^9}, {3.655156635569347*^9, 
  3.655156636625766*^9}, {3.6551576018498783`*^9, 3.6551576357204037`*^9}}],

Cell[BoxData[
 RowBox[{"d2", " ", "=", " ", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{"-", "1"}], 
     SuperscriptBox["Np", "2"]], 
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox[
       RowBox[{"2", " ", "\[Pi]"}], 
       RowBox[{"b", "-", "a"}]], ")"}], "2"], " ", "*", " ", "d2orig"}], " ", 
   "//", " ", "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.6551560509924*^9, 3.655156089403677*^9}, {
  3.6551567610738*^9, 3.6551567688257017`*^9}, {3.655157644670623*^9, 
  3.6551576521900787`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "Mp"}], " ", 
     FractionBox[
      RowBox[{"(", 
       RowBox[{"1", "+", "Mp"}], ")"}], "3"]}], " ", "/.", " ", 
    RowBox[{"{", 
     RowBox[{"Mp", "\[Rule]", 
      FractionBox[
       RowBox[{"(", 
        RowBox[{"Np", "-", "1"}], ")"}], "2"]}], "}"}]}], ")"}], " ", "//", 
  " ", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.655156214344034*^9, 3.655156283249818*^9}, {
  3.65515650788913*^9, 3.6551565279730988`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"d2mat", "[", 
    RowBox[{"asub_", ",", "bsub_", ",", "Nsub_"}], "]"}], ":=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"i", "\[Equal]", "j"}], ",", " ", 
         RowBox[{
          FractionBox[
           RowBox[{"-", "1"}], 
           SuperscriptBox["Np", "2"]], 
          FractionBox[
           RowBox[{"(", 
            RowBox[{"1", "-", 
             SuperscriptBox["Np", "2"]}], ")"}], "12"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"2", " ", 
             FractionBox["\[Pi]", 
              RowBox[{"b", "-", "a"}]]}], ")"}], "2"]}], ",", 
         RowBox[{"N", "@", "d2"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", 
         RowBox[{"Np", "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "0", ",", 
         RowBox[{"Np", "-", "1"}]}], "}"}]}], "]"}], " ", "//.", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Mp", "\[Rule]", " ", 
        FractionBox[
         RowBox[{"(", 
          RowBox[{"Nsub", "-", "1"}], ")"}], "2"]}], ",", 
       RowBox[{"Np", "\[Rule]", " ", "Nsub"}], ",", " ", 
       RowBox[{"a", "\[Rule]", " ", "asub"}], ",", " ", 
       RowBox[{"b", "\[Rule]", " ", "bsub"}]}], "}"}]}], ")"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.655156103139421*^9, 3.655156109531315*^9}, {
  3.6551563151372833`*^9, 3.655156343919249*^9}, {3.655156467826412*^9, 
  3.655156487759646*^9}, {3.6551566472093267`*^9, 3.655156690647347*^9}, {
  3.6551576679672194`*^9, 3.655157685837167*^9}}],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"ListPlot", "[", 
    RowBox[{"Thread", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"asub", ",", "bsub", ",", "Nsub"}], "]"}], ",", 
       RowBox[{
        RowBox[{"d2mat", "[", 
         RowBox[{"asub", ",", "bsub", ",", "Nsub"}], "]"}], ".", 
        RowBox[{"Sin", "[", 
         RowBox[{"x", "[", 
          RowBox[{"asub", ",", "bsub", ",", "Nsub"}], "]"}], "]"}]}]}], "}"}],
      "]"}], "]"}], ",", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Sin", "[", "x", "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}]}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.655156128129233*^9, 3.655156132528862*^9}, {
  3.6551569565042048`*^9, 3.65515696523018*^9}, {3.655157113481565*^9, 
  3.655157128327496*^9}, {3.6551574939589653`*^9, 3.6551575765301533`*^9}, {
  3.655157749490309*^9, 3.655157770400722*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"d2mat", "[", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], ",", "\[Pi]", ",", "5"}], "]"}], " ", "//", " ", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.655230984539833*^9, 3.65523098476413*^9}}],

Cell[BoxData[
 RowBox[{"Nsub", " ", "=", " ", "11"}]], "Input",
 CellChangeTimes->{{3.655157827989543*^9, 3.655157834155653*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}]}], "}"}], "\[ConjugateTranspose]"}], 
  "  ", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.6551580006965437`*^9, 3.6551580732324467`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"d1mat", "[", 
    RowBox[{"asub", ",", "bsub", ",", "Nsub"}], "]"}], " ", "+", " ", 
   RowBox[{
    RowBox[{"d1mat", "[", 
     RowBox[{"asub", ",", "bsub", ",", "Nsub"}], "]"}], 
    "\[ConjugateTranspose]"}]}], " ", "//", " ", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.6551569749764423`*^9, 3.655156981382307*^9}, {
  3.655157133118905*^9, 3.655157156749825*^9}, {3.655157734113798*^9, 
  3.655157735265071*^9}, {3.655157794135144*^9, 3.6551578192451363`*^9}, {
  3.6551578543639383`*^9, 3.655157862674376*^9}, {3.6551579606404133`*^9, 
  3.655157995261882*^9}, {3.655158078624186*^9, 3.6551580957593317`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "solving wave equation with ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[Phi]", "2"], TraditionalForm]]],
 " and ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[Phi]", "4"], TraditionalForm]]],
 " potential"
}], "Section",
 CellChangeTimes->{{3.655575111199752*^9, 3.655575114645688*^9}, {
  3.655590787668131*^9, 3.655590842472245*^9}}],

Cell[BoxData[
 RowBox[{"Quit", "[", "]"}]], "Input",
 CellChangeTimes->{{3.655576157110862*^9, 3.6555761597959414`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"m", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", " ", "=", " ", "100"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Vprime", " ", "=", " ", 
   RowBox[{
    RowBox[{
     SuperscriptBox["m", "2"], " ", 
     RowBox[{"\[Phi]", "[", 
      RowBox[{"x", ",", "t"}], "]"}]}], " ", "+", " ", 
    RowBox[{
     FractionBox["g", "6"], " ", 
     SuperscriptBox[
      RowBox[{"\[Phi]", "[", 
       RowBox[{"x", ",", "t"}], "]"}], "3"]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Phi]init", " ", "=", " ", 
   RowBox[{"Sin", "[", "x", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d\[Phi]init", " ", "=", " ", 
   RowBox[{"-", 
    RowBox[{"Cos", "[", "x", "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.655576703488723*^9, 3.655576710833851*^9}, {
  3.655576883083097*^9, 3.655576883227063*^9}, {3.655577149159746*^9, 
  3.655577149423852*^9}, {3.655577373533228*^9, 3.655577373684922*^9}, {
  3.6555774374752417`*^9, 3.655577437585413*^9}, {3.65558085456282*^9, 
  3.655580949179134*^9}, {3.655580979913741*^9, 3.6555810061439466`*^9}, {
  3.655581201594098*^9, 3.655581207863261*^9}, {3.6555828020702553`*^9, 
  3.655582804732607*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"eqn", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"x", ",", "t"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "2"}], "}"}]}], "]"}], " ", "-", " ", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"x", ",", "t"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "2"}], "}"}]}], "]"}], " ", "+", " ", "Vprime"}], 
    " ", "\[Equal]", " ", "0"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.655575846843227*^9, 3.655575849034733*^9}, {
  3.65557656569197*^9, 3.6555766002163067`*^9}, {3.655576716442801*^9, 
  3.65557671814624*^9}, {3.6555768804782457`*^9, 3.655576891243807*^9}, {
  3.655576991349042*^9, 3.655577007378632*^9}, {3.6555809102516336`*^9, 
  3.655580912971179*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ic", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Phi]", "[", 
       RowBox[{
        RowBox[{"-", "\[Pi]"}], ",", "t"}], "]"}], "\[Equal]", " ", 
      RowBox[{"\[Phi]", "[", 
       RowBox[{"\[Pi]", ",", "t"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"\[Phi]", "[", 
       RowBox[{"x", ",", "0"}], "]"}], "\[Equal]", "\[Phi]init"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Derivative", "[", 
         RowBox[{"0", ",", "1"}], "]"}], "[", "\[Phi]", "]"}], "[", 
       RowBox[{"x", ",", "0"}], "]"}], "\[Equal]", "d\[Phi]init"}]}], "}"}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.655575850673994*^9, 3.655575866747387*^9}, {
  3.655575907913494*^9, 3.655575930672083*^9}, {3.6555763295763893`*^9, 
  3.655576331503717*^9}, {3.6555763759376717`*^9, 3.655576378037133*^9}, {
  3.6555764327087717`*^9, 3.655576452656415*^9}, {3.655576667597452*^9, 
  3.655576686588431*^9}, {3.655576737201189*^9, 3.65557673926538*^9}, {
  3.6555809301655283`*^9, 3.65558094624299*^9}}],

Cell[BoxData[
 RowBox[{"sol", " ", "=", " ", 
  RowBox[{
   RowBox[{"NDSolve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"eqn", ",", "ic"}], "}"}], ",", "\[Phi]", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"MaxStepFraction", "\[Rule]", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "2"}]]}], ",", " ", 
     RowBox[{"MaxStepSize", "\[Rule]", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "2"}]]}], ",", " ", 
     RowBox[{"Method", "\[Rule]", " ", 
      RowBox[{"{", "\"\<ExplicitRungeKutta\>\"", "}"}]}]}], "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "1"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.655575452228568*^9, 3.655575611224907*^9}, {
  3.655575801889556*^9, 3.655575864577633*^9}, {3.655575934047493*^9, 
  3.6555759355597153`*^9}, {3.655575985577696*^9, 3.655575986263809*^9}, {
  3.655576386647546*^9, 3.6555764196074877`*^9}, {3.6555764893278027`*^9, 
  3.655576504902896*^9}, {3.655576624111209*^9, 3.6555766245750227`*^9}, {
  3.655576690843895*^9, 3.655576691395462*^9}, {3.655577352246397*^9, 
  3.65557737107928*^9}, {3.6555834248502398`*^9, 3.655583462613618*^9}, {
  3.655583499436181*^9, 3.655583500467737*^9}, {3.655583563924025*^9, 
  3.655583611264083*^9}, {3.6555836953002853`*^9, 3.655583707702157*^9}, {
  3.6555837469900723`*^9, 3.6555837934372387`*^9}, {3.6555838323532143`*^9, 
  3.655583893835231*^9}, {3.65558392615555*^9, 3.655583927987*^9}}],

Cell[BoxData[
 RowBox[{"Plot3D", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"\[Phi]", "/.", "sol"}], ")"}], "[", 
    RowBox[{"x", ",", "t"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "\[Pi]"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.655576462212126*^9, 3.6555765338030863`*^9}, {
  3.655576628414688*^9, 3.6555766285027733`*^9}, {3.655576694515492*^9, 
  3.655576694819356*^9}}],

Cell["not working", "Text",
 CellChangeTimes->{{3.655590858439865*^9, 3.655590859471366*^9}}],

Cell[BoxData[
 RowBox[{"exact", " ", "=", " ", 
  RowBox[{"DSolve", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"FullSimplify", "[", "eqn", "]"}], ",", 
      RowBox[{"FullSimplify", "[", "ic", "]"}]}], "}"}], ",", "\[Phi]", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "t"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.655577384661108*^9, 3.655577413217811*^9}}],

Cell["generally working:", "Text",
 CellChangeTimes->{{3.655590861551161*^9, 3.655590863646982*^9}}],

Cell[BoxData[
 RowBox[{"DSolve", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"y", "[", "x", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "2"}], "}"}]}], "]"}], " ", "-", " ", "5"}], " ", 
     "\[Equal]", " ", "0"}], "}"}], ",", "y", ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.655576199099813*^9, 3.655576289688387*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["further nonlinear potentials...", "Section",
 CellChangeTimes->{{3.6555882075010843`*^9, 3.6555882174267807`*^9}, {
  3.655590900862691*^9, 3.655590901149006*^9}}],

Cell[BoxData[
 RowBox[{"Quit", "[", "]"}]], "Input",
 CellChangeTimes->{{3.655589819877903*^9, 3.6555898210950613`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"func", " ", "=", " ", 
   RowBox[{"Tanh", "[", 
    SuperscriptBox["x", "4"], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.655588377883973*^9, 3.6555883840535994`*^9}}],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{"func", ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6555882186333027`*^9, 3.655588277024762*^9}, {
  3.6555883671593227`*^9, 3.655588389045083*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Vprime", " ", "=", " ", 
   RowBox[{"Tanh", "[", 
    SuperscriptBox[
     RowBox[{"\[Phi]", "[", 
      RowBox[{"x", ",", "t"}], "]"}], "4"], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Phi]init", " ", "=", " ", 
   RowBox[{"Sin", "[", "x", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d\[Phi]init", " ", "=", " ", "0"}], ";"}]}], "Input",
 CellChangeTimes->{{3.655576703488723*^9, 3.655576710833851*^9}, {
  3.655576883083097*^9, 3.655576883227063*^9}, {3.655577149159746*^9, 
  3.655577149423852*^9}, {3.655577373533228*^9, 3.655577373684922*^9}, {
  3.6555774374752417`*^9, 3.655577437585413*^9}, {3.65558085456282*^9, 
  3.655580949179134*^9}, {3.655580979913741*^9, 3.6555810061439466`*^9}, {
  3.655581201594098*^9, 3.655581207863261*^9}, {3.6555828020702553`*^9, 
  3.655582804732607*^9}, {3.6555885789334497`*^9, 3.6555885939883204`*^9}, {
  3.65558863691512*^9, 3.655588644545599*^9}, {3.655589868473386*^9, 
  3.6555898709124928`*^9}, {3.655590315738106*^9, 3.655590324440093*^9}, {
  3.6555903847396297`*^9, 3.655590385490342*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"eqn", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"x", ",", "t"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "2"}], "}"}]}], "]"}], " ", "-", " ", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"x", ",", "t"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "2"}], "}"}]}], "]"}], " ", "+", " ", "Vprime"}], 
    " ", "\[Equal]", " ", "0"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.655575846843227*^9, 3.655575849034733*^9}, {
  3.65557656569197*^9, 3.6555766002163067`*^9}, {3.655576716442801*^9, 
  3.65557671814624*^9}, {3.6555768804782457`*^9, 3.655576891243807*^9}, {
  3.655576991349042*^9, 3.655577007378632*^9}, {3.6555809102516336`*^9, 
  3.655580912971179*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ic", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Phi]", "[", 
       RowBox[{
        RowBox[{"-", "\[Pi]"}], ",", "t"}], "]"}], "\[Equal]", " ", 
      RowBox[{"\[Phi]", "[", 
       RowBox[{"\[Pi]", ",", "t"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"\[Phi]", "[", 
       RowBox[{"x", ",", "0"}], "]"}], "\[Equal]", "\[Phi]init"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Derivative", "[", 
         RowBox[{"0", ",", "1"}], "]"}], "[", "\[Phi]", "]"}], "[", 
       RowBox[{"x", ",", "0"}], "]"}], "\[Equal]", "d\[Phi]init"}]}], "}"}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.655575850673994*^9, 3.655575866747387*^9}, {
  3.655575907913494*^9, 3.655575930672083*^9}, {3.6555763295763893`*^9, 
  3.655576331503717*^9}, {3.6555763759376717`*^9, 3.655576378037133*^9}, {
  3.6555764327087717`*^9, 3.655576452656415*^9}, {3.655576667597452*^9, 
  3.655576686588431*^9}, {3.655576737201189*^9, 3.65557673926538*^9}, {
  3.6555809301655283`*^9, 3.65558094624299*^9}}],

Cell[BoxData[
 RowBox[{"sol", " ", "=", " ", 
  RowBox[{
   RowBox[{"NDSolve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"eqn", ",", "ic"}], "}"}], ",", "\[Phi]", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"MaxStepFraction", "\[Rule]", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "3"}]]}], ",", " ", 
     RowBox[{"MaxStepSize", "\[Rule]", " ", 
      SuperscriptBox["10", 
       RowBox[{"-", "3"}]]}], ",", " ", 
     RowBox[{"Method", "\[Rule]", " ", "Automatic"}]}], "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "1"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQnRfQ/rnE5rVjgVE6eymQtiu3kQfRP6qF1EG0QOtB
fRBt8PIjmK6pMTID0QqFHmB6046QDBDdVVCcA6JjarVKQXTbE5lyEM3Wz9wG
oqelCYFpA8boPhC9YHkOmK55xP4QRJd1Jj0G0Vqm0jcqgPShRZfvgGijr7kP
QfSW731geu7E2pcgOq444z2I/jD75U8QLVRR9htEr1kXz1AJpO/81WUD0R2+
3Nwg2mzXLiEQ7fLriBiIbpz6H0zHvzmeUw2kwxSegWnOv52WNUDa/O8qMF2X
1GsPoiUW3QDTALGnkYs=
  "]],

Cell[BoxData[
 RowBox[{"Plot3D", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"\[Phi]", "/.", "sol"}], ")"}], "[", 
    RowBox[{"x", ",", "t"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "\[Pi]"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.655576462212126*^9, 3.6555765338030863`*^9}, {
  3.655576628414688*^9, 3.6555766285027733`*^9}, {3.655576694515492*^9, 
  3.655576694819356*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "evaluate C vs ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " results"
}], "Section",
 CellChangeTimes->{{3.6555894195941668`*^9, 3.655589425905847*^9}, {
  3.6555909075661507`*^9, 3.655590908156703*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"compareCtoMath", "[", 
    RowBox[{"filenum_", ",", " ", "Nxloc_", ",", " ", "mathres_"}], "]"}], 
   " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SetDirectory", "[", 
       RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dt", " ", "=", 
       RowBox[{"0.1", " ", "*", " ", 
        SuperscriptBox["2", 
         RowBox[{"-", "filenum"}]]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"xvec", " ", "=", " ", 
       RowBox[{"N", "@", 
        RowBox[{"Most", "@", 
         RowBox[{"Range", "[", 
          RowBox[{
           RowBox[{"-", "\[Pi]"}], ",", "\[Pi]", ",", 
           RowBox[{"2", " ", 
            RowBox[{"\[Pi]", " ", "/", " ", 
             RowBox[{"(", "Nxloc", ")"}]}]}]}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vec", " ", "=", " ", 
       RowBox[{"Flatten", "@", 
        RowBox[{"Import", "[", 
         RowBox[{
          RowBox[{"\"\<vector_00\>\"", "<>", 
           RowBox[{"ToString", "[", "filenum", "]"}], "<>", "\"\<.txt\>\""}], 
          ",", "\"\<csv\>\""}], "]"}]}]}], ";", 
      RowBox[{"Nt", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "@", "vec"}], " ", "/", " ", "Nxloc"}], " ", "/", 
        " ", "2"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tvec", " ", "=", " ", 
       RowBox[{"Range", "[", 
        RowBox[{"0", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Nt", "-", "1"}], ")"}], " ", "dt"}], ",", " ", "dt"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"A", " ", "=", " ", 
       RowBox[{"Partition", "[", 
        RowBox[{"vec", ",", 
         RowBox[{"2", " ", "Nxloc"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"phi", "[", "filenum", "]"}], " ", "=", " ", 
       RowBox[{"A", "[", 
        RowBox[{"[", 
         RowBox[{";;", ",", 
          RowBox[{"1", ";;", "Nxloc"}]}], "]"}], "]"}]}], ";", 
      RowBox[{
       RowBox[{"phimath", "[", "filenum", "]"}], " ", "=", " ", 
       RowBox[{
        RowBox[{"Partition", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"\[Phi]", "/.", "sol"}], ")"}], "[", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}], " ", "&"}], "/@", " ", 
           RowBox[{"Tuples", "[", 
            RowBox[{"{", 
             RowBox[{"xvec", ",", "tvec"}], "}"}], "]"}]}], ",", "Nt"}], 
         "]"}], "\[ConjugateTranspose]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"diff", "[", "filenum", "]"}], "=", 
       RowBox[{"ListPlot3D", "[", 
        RowBox[{
         RowBox[{"phi", "[", "filenum", "]"}], " ", "-", " ", 
         RowBox[{"phimath", "[", "filenum", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"errors", "[", "filenum", "]"}], " ", "=", " ", 
       RowBox[{"Norm", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"phi", "[", "filenum", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}], "-", 
          RowBox[{
           RowBox[{"phimath", "[", "filenum", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}]}], ",", "2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{
        RowBox[{"errors", "[", "filenum", "]"}], ",", "Module"}], "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.655588919527837*^9, 3.655589210733796*^9}, 
   3.655589243557563*^9, {3.6555893295961514`*^9, 3.655589340273295*^9}, {
   3.655589464611271*^9, 3.655589479578299*^9}, {3.6555896263721657`*^9, 
   3.6555896829858093`*^9}, {3.655589794866194*^9, 3.655589795586275*^9}, {
   3.655589904244278*^9, 3.655589904587906*^9}, {3.655589938129221*^9, 
   3.655589950095606*^9}, 3.65558998267797*^9, {3.655590054031611*^9, 
   3.655590094514122*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Nx", " ", "=", " ", "51"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"files", " ", "=", " ", "7"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"errs", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"compareCtoMath", "[", 
      RowBox[{"#", ",", " ", "Nx", ",", " ", 
       RowBox[{"(", 
        RowBox[{"\[Phi]", " ", "/.", " ", "sol"}], ")"}]}], "]"}], " ", "&"}],
     " ", "/@", " ", 
    RowBox[{"Range", "[", 
     RowBox[{"0", ",", 
      RowBox[{"files", "-", "1"}]}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.655589345975498*^9, 3.655589530917797*^9}, {
  3.655589589898863*^9, 3.655589593482731*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dts", " ", "=", " ", 
   RowBox[{"0.1", "*", 
    SuperscriptBox["2", 
     RowBox[{"-", 
      RowBox[{"Range", "[", 
       RowBox[{"0", ",", 
        RowBox[{"files", "-", "1"}]}], "]"}]}]]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plotvalues", "=", 
   RowBox[{"Thread", "[", 
    RowBox[{"{", 
     RowBox[{"dts", ",", "errs"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListLogLogPlot", "[", 
  RowBox[{"plotvalues", ",", 
   RowBox[{"PlotRange", "\[Rule]", " ", "All"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6555906149413633`*^9, 3.655590618221045*^9}, {
  3.655590656067631*^9, 3.655590663308737*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"gooduntil", " ", "=", " ", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fitvals", " ", "=", 
   RowBox[{"Reverse", "@", 
    RowBox[{"plotvalues", "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", "gooduntil"}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fit", " ", "=", " ", 
   RowBox[{"FindFit", "[", 
    RowBox[{"fitvals", ",", " ", 
     RowBox[{"a", " ", 
      SuperscriptBox["x", "4"]}], ",", "a", ",", "x"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.6555906772904453`*^9, 3.655590706690441*^9}}],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"a", " ", 
        SuperscriptBox["x", "4"]}], " ", "/.", " ", "fit"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "0", ",", "0.1"}], "}"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", " ", "All"}]}], "]"}], ",", 
    RowBox[{"ListPlot", "[", "fitvals", "]"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.655584122123846*^9, 3.655584144964012*^9}, {
  3.6555841942080717`*^9, 3.655584262702096*^9}, {3.655584306355706*^9, 
  3.655584324139279*^9}, {3.655584433655712*^9, 3.6555844468062487`*^9}, {
  3.655584501405294*^9, 3.6555846179746027`*^9}, {3.655584695058155*^9, 
  3.6555847087125063`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["read data for comparison (development, now packaged)", "Section",
 CellChangeTimes->{{3.655581600107958*^9, 3.655581602026174*^9}, {
  3.655582772821844*^9, 3.655582774300695*^9}, {3.655590873398472*^9, 
  3.655590879686368*^9}}],

Cell[TextData[{
 "that was for:\n",
 Cell[BoxData[{
  RowBox[{
   RowBox[{"m", "=", "5"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"g", " ", "=", " ", "100"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Vprime", " ", "=", " ", 
    RowBox[{
     RowBox[{
      SuperscriptBox["m", "2"], " ", 
      RowBox[{"\[Phi]", "[", 
       RowBox[{"x", ",", "t"}], "]"}]}], " ", "+", " ", 
     RowBox[{
      FractionBox["g", "6"], " ", 
      SuperscriptBox[
       RowBox[{"\[Phi]", "[", 
        RowBox[{"x", ",", "t"}], "]"}], "3"]}]}]}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"\[Phi]init", " ", "=", " ", 
    RowBox[{"Sin", "[", "x", "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"d\[Phi]init", " ", "=", " ", 
    RowBox[{"-", 
     RowBox[{"Cos", "[", "x", "]"}]}]}], ";"}]}],
  CellChangeTimes->{{3.655576703488723*^9, 3.655576710833851*^9}, {
   3.655576883083097*^9, 3.655576883227063*^9}, {3.655577149159746*^9, 
   3.655577149423852*^9}, {3.655577373533228*^9, 3.655577373684922*^9}, {
   3.6555774374752417`*^9, 3.655577437585413*^9}, {3.65558085456282*^9, 
   3.655580949179134*^9}, {3.655580979913741*^9, 3.6555810061439466`*^9}, {
   3.655581201594098*^9, 3.655581207863261*^9}, {3.6555828020702553`*^9, 
   3.655582804732607*^9}}]
}], "Text",
 CellChangeTimes->{{3.655588501731317*^9, 3.655588536310463*^9}}],

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.655581552788537*^9, 3.6555815596944027`*^9}}],

Cell[CellGroupData[{

Cell["compute", "Subsection",
 CellChangeTimes->{{3.6555839522959223`*^9, 3.65558395284798*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"filenum", " ", "=", " ", "6"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Nx", " ", "=", " ", "51"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"dt", " ", "=", 
  RowBox[{"0.1", " ", "*", " ", 
   SuperscriptBox["2", 
    RowBox[{"-", "filenum"}]]}]}]}], "Input",
 CellChangeTimes->{{3.65558164928697*^9, 3.655581651185041*^9}, {
  3.6555818667305403`*^9, 3.65558187196279*^9}, {3.6555825586946898`*^9, 
  3.6555825806713343`*^9}, {3.655582952194742*^9, 3.655583009334552*^9}, {
  3.655583058468197*^9, 3.655583113345252*^9}, {3.655583935778722*^9, 
  3.6555839871755466`*^9}}],

Cell[BoxData[{
 RowBox[{"xvec", " ", "=", " ", 
  RowBox[{"N", "@", 
   RowBox[{"Most", "@", 
    RowBox[{"Range", "[", 
     RowBox[{
      RowBox[{"-", "\[Pi]"}], ",", "\[Pi]", ",", 
      RowBox[{"2", " ", 
       RowBox[{"\[Pi]", " ", "/", " ", 
        RowBox[{"(", "Nx", ")"}]}]}]}], "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"Length", "@", "xvec"}]}], "Input",
 CellChangeTimes->{{3.65558163511928*^9, 3.6555816803425694`*^9}, {
  3.65558175899343*^9, 3.655581857464614*^9}, {3.655582598271306*^9, 
  3.65558259849452*^9}, {3.6555828383316708`*^9, 3.6555828406431217`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"vec", " ", "=", " ", 
   RowBox[{"Flatten", "@", 
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{"\"\<vector_00\>\"", "<>", 
       RowBox[{"ToString", "[", "filenum", "]"}], "<>", "\"\<.txt\>\""}], 
      ",", "\"\<csv\>\""}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.655581524207985*^9, 3.655581539925984*^9}, {
  3.6555815718760366`*^9, 3.6555815794042387`*^9}, {3.655582604653244*^9, 
  3.655582615613431*^9}}],

Cell[BoxData[
 RowBox[{"Nt", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "@", "vec"}], " ", "/", " ", "Nx"}], " ", "/", " ", 
   "2"}]}]], "Input",
 CellChangeTimes->{{3.655581613866681*^9, 3.6555816148407707`*^9}, {
   3.655581903139007*^9, 3.6555819180239983`*^9}, 3.655582623619564*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tvec", " ", "=", " ", 
   RowBox[{"Range", "[", 
    RowBox[{"0", ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Nt", "-", "1"}], ")"}], " ", "dt"}], ",", " ", "dt"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "@", "tvec"}]}], "Input",
 CellChangeTimes->{{3.655581929712533*^9, 3.655581981795143*^9}, {
  3.655582627811273*^9, 3.6555826309228563`*^9}, {3.6555828450511627`*^9, 
  3.655582853578472*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"A", " ", "=", " ", 
   RowBox[{"Partition", "[", 
    RowBox[{"vec", ",", 
     RowBox[{"2", " ", "Nx"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", "A", "]"}]}], "Input",
 CellChangeTimes->{{3.655582121574016*^9, 3.655582213998741*^9}, {
  3.655582639540071*^9, 3.65558263982006*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"phi", " ", "=", " ", 
   RowBox[{"A", "[", 
    RowBox[{"[", 
     RowBox[{";;", ",", 
      RowBox[{"1", ";;", "Nx"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", "phi", "]"}]}], "Input",
 CellChangeTimes->{{3.655582227767475*^9, 3.655582253222035*^9}, {
  3.655582310748623*^9, 3.655582332939929*^9}, {3.6555826452103*^9, 
  3.655582647793869*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"phimath", " ", "=", " ", 
   RowBox[{
    RowBox[{"Partition", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Phi]", "/.", "sol"}], ")"}], "[", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "]"}], " ", "&"}], "/@", " ", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"xvec", ",", "tvec"}], "}"}], "]"}]}], ",", "Nt"}], "]"}], 
    "\[ConjugateTranspose]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", "phimath", "]"}]}], "Input",
 CellChangeTimes->{{3.6555823923207703`*^9, 3.655582451612816*^9}, {
  3.6555824845952597`*^9, 3.655582530905471*^9}, {3.655582654138753*^9, 
  3.655582665657631*^9}, {3.655582861483913*^9, 3.655582862714487*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"ListPlot3D", "[", 
   RowBox[{"phi", " ", "-", " ", "phimath"}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.6555824534276047`*^9, 3.6555824643290854`*^9}, {
   3.655582525120594*^9, 3.655582542479354*^9}, 3.655582669057219*^9, {
   3.655583069643276*^9, 3.655583075370717*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"errors", "[", "filenum", "]"}], " ", "=", " ", 
  RowBox[{"Norm", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"phi", "[", 
      RowBox[{"[", 
       RowBox[{"-", "1"}], "]"}], "]"}], "-", 
     RowBox[{"phimath", "[", 
      RowBox[{"[", 
       RowBox[{"-", "1"}], "]"}], "]"}]}], ",", "2"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.655582890575121*^9, 3.655582944826137*^9}, {
  3.655583018381768*^9, 3.6555830376128397`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["compare", "Subsection",
 CellChangeTimes->{{3.655583946864855*^9, 3.655583947384153*^9}}],

Cell[BoxData[{
 RowBox[{"dts", " ", "=", " ", 
  RowBox[{"0.1", "*", 
   SuperscriptBox["2", 
    RowBox[{"-", 
     RowBox[{"Range", "[", 
      RowBox[{"0", ",", "6"}], "]"}]}]]}]}], "\[IndentingNewLine]", 
 RowBox[{"Length", "@", "dts"}]}], "Input",
 CellChangeTimes->{{3.6555831708401403`*^9, 3.6555832169393463`*^9}}],

Cell[BoxData[
 RowBox[{"errs", " ", "=", " ", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"errors", "[", "i", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "0", ",", "6"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6555832402143087`*^9, 3.6555832511612864`*^9}}],

Cell[BoxData[
 RowBox[{"Thread", "[", 
  RowBox[{"{", 
   RowBox[{"dts", ",", "errs"}], "}"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"plotvalues", "=", 
   RowBox[{"Thread", "[", 
    RowBox[{"{", 
     RowBox[{"dts", ",", "errs"}], "}"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.655584078658087*^9, 3.65558408334231*^9}}],

Cell[BoxData[
 RowBox[{"ListLogLogPlot", "[", 
  RowBox[{"plotvalues", ",", 
   RowBox[{"PlotRange", "\[Rule]", " ", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.655583123735519*^9, 3.655583151022378*^9}, {
  3.655583221819365*^9, 3.655583254497882*^9}, {3.6555832904406853`*^9, 
  3.655583394256915*^9}, {3.655584003395084*^9, 3.6555840067938623`*^9}, {
  3.6555840775993547`*^9, 3.655584086740675*^9}}],

Cell[BoxData[
 RowBox[{"fitvals", " ", "=", 
  RowBox[{"Reverse", "@", 
   RowBox[{"plotvalues", "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "3"}], "]"}], "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{"fit", " ", "=", " ", 
  RowBox[{"FindFit", "[", 
   RowBox[{"fitvals", ",", " ", 
    RowBox[{"a", " ", 
     SuperscriptBox["x", "4"]}], ",", "a", ",", "x"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.655584390237035*^9, 3.655584490748826*^9}, {
  3.655584688881825*^9, 3.655584689688484*^9}}],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"a", " ", 
        SuperscriptBox["x", "4"]}], " ", "/.", " ", "fit"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "0", ",", "0.1"}], "}"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", " ", "All"}]}], "]"}], ",", 
    RowBox[{"ListPlot", "[", "fitvals", "]"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.655584122123846*^9, 3.655584144964012*^9}, {
  3.6555841942080717`*^9, 3.655584262702096*^9}, {3.655584306355706*^9, 
  3.655584324139279*^9}, {3.655584433655712*^9, 3.6555844468062487`*^9}, {
  3.655584501405294*^9, 3.6555846179746027`*^9}, {3.655584695058155*^9, 
  3.6555847087125063`*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.655583412983626*^9, 3.6555834135935087`*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["filter windows", "Section",
 CellChangeTimes->{{3.65567217515525*^9, 3.655672177532392*^9}, {
  3.68914474843091*^9, 3.689144748973303*^9}}],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"1", "-", 
    RowBox[{"Tanh", "[", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"1", "-", 
        SuperscriptBox["x", "6"]}]], "-", "1"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", " ", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6557479648176613`*^9, 3.6557481167385883`*^9}, {
  3.655748181960585*^9, 3.655748233534898*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Tanh", "[", 
       RowBox[{"1", "-", 
        SuperscriptBox[
         RowBox[{"(", 
          FractionBox["1", "x"], ")"}], "#"]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", 
       RowBox[{"3", "\[Pi]"}]}], "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", " ", "All"}]}], "]"}], " ", "&"}], "/@", 
  " ", 
  RowBox[{"Range", "[", 
   RowBox[{"2", ",", "10", ",", "2"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.65566877600126*^9, 3.655668813008852*^9}, {
  3.6556720327432632`*^9, 3.655672085613254*^9}, {3.655672183396626*^9, 
  3.65567221019565*^9}, {3.6557478456393213`*^9, 3.655747847928521*^9}, {
  3.65574788791123*^9, 3.655747950350522*^9}}],

Cell[BoxData[
 RowBox[{"N", "@", 
  RowBox[{"Tanh", "[", 
   RowBox[{"2", " ", "\[Pi]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.655747856919943*^9, 3.6557478847023478`*^9}}],

Cell[BoxData[{
 RowBox[{"Nx", " ", "=", " ", "501"}], "\[IndentingNewLine]", 
 RowBox[{"nc", " ", "=", " ", 
  RowBox[{
   RowBox[{"Floor", "[", 
    FractionBox["Nx", "2"], "]"}], "+", "1"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lowbnd", "=", " ", 
   RowBox[{"-", "\[Pi]"}]}], ";", " ", 
  RowBox[{"upbnd", " ", "=", " ", "\[Pi]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"coFraction", " ", "=", " ", "0.1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"nmax", " ", "=", " ", 
  RowBox[{"Ceiling", "[", 
   RowBox[{"nc", " ", "*", " ", 
    RowBox[{"(", 
     RowBox[{"1", " ", "-", " ", "coFraction"}], ")"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"coIndices", " ", "=", " ", 
  RowBox[{"Range", "[", 
   RowBox[{"0", ",", " ", 
    RowBox[{"nmax", "-", "1"}], ",", " ", "1"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Length", "@", "coIndices"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"w", " ", "=", " ", 
   RowBox[{"1", "-", 
    RowBox[{"Tanh", "[", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"1", "-", 
        SuperscriptBox["x", "8"]}]], "-", "1"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"coPoints", " ", "=", " ", 
   RowBox[{
    RowBox[{
     FractionBox["#", "nmax"], " ", "&"}], "/@", " ", "coIndices"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"wpart", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"N", "@", 
      RowBox[{"(", 
       RowBox[{"w", " ", "/.", " ", 
        RowBox[{"{", 
         RowBox[{"x", "\[Rule]", " ", "#"}], "}"}]}], ")"}]}], " ", "&"}], "/@",
     "coPoints"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"wtot", " ", "=", " ", 
   RowBox[{"wpart", "~", "Join", "~", 
    RowBox[{"Table", "[", 
     RowBox[{"0", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"nc", "-", "nmax"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "@", "wtot"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", "wtot", "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.655747440661509*^9, 3.655747539627924*^9}, {
  3.655747605857692*^9, 3.6557477499023457`*^9}, {3.655747783599494*^9, 
  3.6557477913677*^9}, {3.6557478227543488`*^9, 3.655747823306357*^9}, {
  3.655748150666367*^9, 3.655748172281501*^9}, {3.6557482558790817`*^9, 
  3.655748608436201*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6557475124878674`*^9, 3.655747513135872*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{
         FractionBox["1", 
          RowBox[{
           SuperscriptBox["x", "#"], "-", "1"}]], "+", "1"}], "]"}], ",", 
       RowBox[{"1", "-", 
        RowBox[{"Tanh", "[", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"1", "-", 
            SuperscriptBox["x", "#"]}]], "-", "1"}], "]"}]}], ",", " ", 
       FractionBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{
            SuperscriptBox["x", "#"], " ", "\[Pi]"}], "]"}], "+", "1"}], 
         ")"}], "2"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", " ", "All"}]}], "]"}], "&"}], "/@", " ", 
  
  RowBox[{"Range", "[", 
   RowBox[{"2", ",", "8", ",", "2"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.655672095707308*^9, 3.655672159228774*^9}, {
  3.6556722159723673`*^9, 3.655672253602542*^9}, {3.655758714337641*^9, 
  3.655758807892972*^9}, {3.6557588427619333`*^9, 3.655758890388562*^9}, {
  3.655759035280382*^9, 3.6557590858626003`*^9}}],

Cell[CellGroupData[{

Cell["planck taper window", "Subsection",
 CellChangeTimes->{{3.6556723362643414`*^9, 3.6556723387275887`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"windowl", "[", 
    RowBox[{"n_", ",", "a_", ",", "Nx_"}], "]"}], ":=", " ", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"Exp", "[", 
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{"Nx", "-", "1"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", "n"], "+", 
         FractionBox["1", 
          RowBox[{"n", " ", "-", " ", 
           RowBox[{"a", 
            RowBox[{"(", 
             RowBox[{"Nx", "-", "1"}], ")"}]}]}]]}], ")"}]}], "]"}], "+", 
     "1"}]]}], ";"}]], "Input",
 CellChangeTimes->{{3.655670339928615*^9, 3.655670394963986*^9}, {
   3.655670443501973*^9, 3.655670448396937*^9}, {3.6556704882681227`*^9, 
   3.655670491931326*^9}, 3.65567063008241*^9, {3.6556707075544977`*^9, 
   3.655670707986185*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"windowr", "[", 
    RowBox[{"n_", ",", "a_", ",", "Nx_"}], "]"}], ":=", " ", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"Exp", "[", 
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{"Nx", "-", "1"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", 
          RowBox[{"Nx", "-", "1", "-", "n"}]], "+", 
         FractionBox["1", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", " ", "-", " ", "a"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"Nx", "-", "1"}], ")"}]}], " ", "-", " ", "n"}]]}], 
        ")"}]}], "]"}], "+", "1"}]]}], ";"}]], "Input",
 CellChangeTimes->{{3.655670632315949*^9, 3.6556707106182537`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"window", "[", 
    RowBox[{"n_", ",", "a_", ",", "Nx_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Piecewise", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"windowl", "[", 
          RowBox[{"n", ",", " ", "a", ",", " ", "Nx"}], "]"}], ",", " ", 
         RowBox[{"0", " ", "<", " ", "n", " ", "<", " ", 
          RowBox[{"a", " ", 
           RowBox[{"(", 
            RowBox[{"Nx", "-", "1"}], ")"}]}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"windowr", "[", 
          RowBox[{"n", ",", "a", ",", "Nx"}], "]"}], ",", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", " ", "-", " ", "a"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"Nx", "-", "1"}], ")"}]}], " ", "<", " ", "n", " ", "<", 
          " ", 
          RowBox[{"(", 
           RowBox[{"Nx", "-", "1"}], ")"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"0", ",", " ", 
         RowBox[{
          RowBox[{"n", "==", "0"}], " ", "||", "  ", 
          RowBox[{"n", " ", "==", " ", 
           RowBox[{"Nx", "-", "1"}]}]}]}], "}"}]}], "\[IndentingNewLine]", 
      "}"}], ",", "1"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.65567070042552*^9, 3.6556709437761917`*^9}, {
   3.655671076541554*^9, 3.655671123692505*^9}, {3.6556711661016083`*^9, 
   3.6556711950312243`*^9}, {3.6556712315755053`*^9, 3.655671239111113*^9}, {
   3.655671292919773*^9, 3.6556714168959846`*^9}, {3.6556714806914997`*^9, 
   3.6556715167226763`*^9}, 3.655671609833127*^9, {3.6557472073517942`*^9, 
   3.655747209927526*^9}, {3.655747284038015*^9, 3.655747291229854*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Nxval", "=", "101"}], ";", " ", 
  RowBox[{"aval", "=", "0.6"}], ";"}]], "Input",
 CellChangeTimes->{{3.6556695076727867`*^9, 3.65566971874549*^9}, {
  3.6556697526843643`*^9, 3.655669783321762*^9}, {3.655669823121037*^9, 
  3.655669823665029*^9}, {3.655669887759918*^9, 3.6556699386303*^9}, {
  3.6556699860466833`*^9, 3.655670051181448*^9}, {3.65567008364431*^9, 
  3.6556701244016323`*^9}, {3.6556703220652227`*^9, 3.655670332720265*^9}, {
  3.655670401827641*^9, 3.655670402107211*^9}, {3.6556704584847937`*^9, 
  3.655670474907835*^9}, {3.655671012359703*^9, 3.655671048259953*^9}, {
  3.655747213046093*^9, 3.655747273500115*^9}, {3.6557473077796087`*^9, 
  3.6557473304027977`*^9}}],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"window", "[", 
     RowBox[{"#", ",", "aval", ",", "Nxval"}], "]"}], "&"}], "/@", " ", 
   RowBox[{"Range", "[", 
    RowBox[{"0", ",", 
     RowBox[{"Nxval", "-", "1"}], ",", "1"}], "]"}]}], "]"}]], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Nxval", "=", "101"}], ";", " ", 
  RowBox[{"aval", "=", " ", "0.9"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cutoffpoints", " ", "=", " ", 
   RowBox[{"Range", "[", 
    RowBox[{
     RowBox[{"Floor", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "aval"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"Nxval", "-", "1"}], ")"}]}], "+", "1"}], "]"}], ",", " ", 
     RowBox[{"Nxval", "-", "1"}], ",", " ", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "@", "cutoffpoints"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"windowr", "[", 
     RowBox[{"#", ",", "aval", ",", "Nxval"}], "]"}], " ", "&"}], "/@", " ", 
   "cutoffpoints"}], "]"}]}], "Input",
 CellChangeTimes->{{3.655746964811496*^9, 3.6557471855339413`*^9}, {
  3.6557473577011023`*^9, 3.655747358267585*^9}, {3.655747391259076*^9, 
  3.655747391634488*^9}}],

Cell[BoxData[
 RowBox[{"Nmax", " ", "=", " ", 
  RowBox[{"Floor", "[", 
   RowBox[{"aval", " ", 
    RowBox[{"(", 
     RowBox[{"Nxval", "-", "1"}], ")"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.655671026100792*^9, 3.655671026414804*^9}, {
  3.655672291933659*^9, 3.655672296633713*^9}}],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{
    FractionBox["1", 
     RowBox[{
      RowBox[{"Exp", "[", 
       RowBox[{"a", " ", "L", " ", 
        RowBox[{"(", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"L", "-", "x"}]], "+", 
          FractionBox["1", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "a"}], ")"}], " ", "L"}], " ", "-", "x"}]]}], 
         ")"}]}], "]"}], "+", "1"}]], "/.", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"a", "\[Rule]", " ", "0.5"}], ",", " ", 
      RowBox[{"L", "\[Rule]", " ", "\[Pi]"}]}], "}"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", " ", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.655669343012413*^9, 3.655669411801002*^9}, {
  3.655670564367304*^9, 3.65567057974466*^9}, {3.655671651837233*^9, 
  3.655671656884831*^9}, {3.655671703930113*^9, 3.655671994000031*^9}}],

Cell["TODO: how to do this with the fftw3 fourier coefficients", "Text",
 CellChangeTimes->{{3.6556725512556353`*^9, 3.655672565885275*^9}, {
  3.6556904832163467`*^9, 3.655690501383005*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["energy considerations", "Section",
 CellChangeTimes->{{3.655764464502252*^9, 3.65576446694173*^9}}],

Cell[BoxData[
 RowBox[{"Quit", "[", "]"}]], "Input",
 CellChangeTimes->{{3.655764631276184*^9, 3.6557646321490793`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"potential", "[", "f_", "]"}], ":=", "0"}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     FractionBox["1", "2"], " ", 
     SuperscriptBox["mass", "2"], " ", 
     SuperscriptBox["f", "2"]}], ";"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"energy", "[", 
    RowBox[{"f_", ",", " ", "V_"}], "]"}], ":=", " ", 
   RowBox[{
    RowBox[{
     FractionBox["1", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Derivative", "[", 
          RowBox[{"1", ",", "0"}], "]"}], "[", "f", "]"}], "[", 
        RowBox[{"t", ",", "x"}], "]"}], ")"}], "2"]}], " ", "+", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Derivative", "[", 
          RowBox[{"0", ",", "1"}], "]"}], "[", "f", "]"}], "[", 
        RowBox[{"t", ",", "x"}], "]"}], ")"}], "2"]}], "+", " ", 
    RowBox[{"V", "[", 
     RowBox[{"f", "[", 
      RowBox[{"t", ",", "x"}], "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"phi", "[", 
    RowBox[{"t_", ",", "x_"}], "]"}], ":=", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"x", "-", "t"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Plot3D", "[", 
  RowBox[{
   RowBox[{"phi", "[", 
    RowBox[{"t", ",", "x"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "\[Pi]"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6557646059231377`*^9, 3.655764621455084*^9}, {
  3.6557646546456127`*^9, 3.6557646823246098`*^9}, {3.655764808699465*^9, 
  3.655764883913089*^9}, {3.655765032878912*^9, 3.6557650602949553`*^9}, {
  3.655766096280905*^9, 3.655766117589837*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"energy", "[", 
   RowBox[{"phi", ",", "potential"}], "]"}], " ", "//", " ", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{"etot", " ", "=", " ", 
  RowBox[{"Integrate", "[", 
   RowBox[{"%", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"etot", " ", "/.", " ", 
    RowBox[{"{", 
     RowBox[{"mass", " ", "\[Rule]", " ", "1"}], "}"}]}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "\[Pi]"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.655764639226564*^9, 3.6557646530038633`*^9}, {
  3.65576478264515*^9, 3.655764787437419*^9}, {3.655764860382167*^9, 
  3.655764862125753*^9}, {3.65576489375073*^9, 3.6557648954786673`*^9}, {
  3.655764962067686*^9, 3.6557650003150177`*^9}, {3.6557651161081343`*^9, 
  3.655765150044228*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["tests for differentiation", "Section",
 CellChangeTimes->{{3.65636054188503*^9, 3.656360547171227*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"Sin", "[", "x", "]"}], " ", 
    RowBox[{"Sin", "[", "y", "]"}], " ", 
    RowBox[{"Sin", "[", "z", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], 
       SuperscriptBox["x", "2"]}], " ", "-", " ", 
      RowBox[{"4", " ", 
       SuperscriptBox["y", "2"]}], " ", "-", " ", 
      RowBox[{"1.5", " ", 
       SuperscriptBox["z", "2"]}]}], "]"}], " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"2", " ", "x"}], "]"}], " ", 
    RowBox[{"Cos", "[", "y", "]"}], " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"4", " ", "z"}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.656360590952383*^9, 3.656360621509795*^9}, {
  3.656364809803401*^9, 3.656364811050968*^9}, {3.658686850981612*^9, 
  3.6586868939819317`*^9}, {3.658687181155744*^9, 3.658687197961093*^9}, {
  3.658689615397028*^9, 3.658689627741432*^9}, {3.6586897273028803`*^9, 
  3.658689734117703*^9}, {3.6586898310590363`*^9, 3.6586898311147346`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"x", ",", "y", ",", "z"}], "]"}], " ", "//", " ", 
   "FullSimplify"}], " ", "//", " ", "CForm"}]], "Input",
 CellChangeTimes->{{3.6586880217192574`*^9, 3.658688029035473*^9}, {
  3.6586882952219048`*^9, 3.658688295781736*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", "x"}], "]"}], " ", "//", 
   " ", "FullSimplify"}], " ", "//", " ", "CForm"}]], "Input",
 CellChangeTimes->{{3.658686932066678*^9, 3.6586870041048613`*^9}, {
  3.6586882807122517`*^9, 3.658688281886812*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", "y"}], "]"}], " ", "//", 
   " ", "FullSimplify"}], " ", "//", " ", "CForm"}]], "Input",
 CellChangeTimes->{{3.658686980604033*^9, 3.658686980916299*^9}, {
  3.6586881865643044`*^9, 3.658688190035398*^9}, {3.6586882866780043`*^9, 
  3.658688287430367*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", "z"}], "]"}], " ", "//", 
   " ", "FullSimplify"}], " ", "//", " ", "CForm"}]], "Input",
 CellChangeTimes->{{3.658688192955077*^9, 3.6586881935708323`*^9}, {
  3.658688290726048*^9, 3.658688291461948*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "2"}], "}"}]}], "]"}], " ", "//", " ", 
   "FullSimplify"}], " ", "//", " ", "CForm"}]], "Input",
 CellChangeTimes->{{3.658686932066678*^9, 3.6586870041048613`*^9}, {
  3.6586882807122517`*^9, 3.658688281886812*^9}, {3.65868839030774*^9, 
  3.658688399483282*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", "2"}], "}"}]}], "]"}], " ", "//", " ", 
   "FullSimplify"}], " ", "//", " ", "CForm"}]], "Input",
 CellChangeTimes->{{3.658686980604033*^9, 3.658686980916299*^9}, {
  3.6586881865643044`*^9, 3.658688190035398*^9}, {3.6586882866780043`*^9, 
  3.658688287430367*^9}, {3.658688404747316*^9, 3.6586884066600857`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"z", ",", "2"}], "}"}]}], "]"}], " ", "//", " ", 
   "FullSimplify"}], " ", "//", " ", "CForm"}]], "Input",
 CellChangeTimes->{{3.658688192955077*^9, 3.6586881935708323`*^9}, {
  3.658688290726048*^9, 3.658688291461948*^9}, {3.6586884098833437`*^9, 
  3.658688410907889*^9}}],

Cell[BoxData[
 RowBox[{"grad", " ", "=", " ", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", "x"}], "]"}], ",", " ", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", "y"}], "]"}], ",", " ", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", "z"}], "]"}]}], "}"}], 
   " ", "//", " ", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.656366347869278*^9, 3.656366448550291*^9}, {
  3.658686925560841*^9, 3.658686928177321*^9}}],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "4"}], " ", 
        SuperscriptBox["x", "2"]}], "]"}], " ", 
      RowBox[{"Cos", "[", "x", "]"}]}], ",", " ", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "4"}], " ", 
           SuperscriptBox["y", "2"]}], "]"}], " ", 
         RowBox[{"Cos", "[", "y", "]"}]}], ",", "y"}], "]"}], " ", "/.", " ", 
      
      RowBox[{"y", "\[Rule]", " ", "x"}]}], ",", " ", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "4"}], " ", 
           SuperscriptBox["y", "2"]}], "]"}], " ", 
         RowBox[{"Cos", "[", "y", "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"y", ",", "2"}], "}"}]}], "]"}], " ", "/.", " ", 
      RowBox[{"y", "\[Rule]", " ", "x"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.658689363141218*^9, 3.658689405600234*^9}, {
  3.658689449745226*^9, 3.658689602798375*^9}, {3.658689656469162*^9, 
  3.6586896609728003`*^9}, {3.658689865744318*^9, 3.658689888359207*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6586897750565367`*^9, 3.658689777555394*^9}}],

Cell[BoxData[
 RowBox[{"gradsq", " ", "=", " ", 
  RowBox[{
   RowBox[{"grad", ".", "grad"}], " ", "//", " ", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.656366450300317*^9, 3.656366456893032*^9}}],

Cell[BoxData[
 RowBox[{"lap", " ", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "2"}], "}"}]}], "]"}], " ", "+", " ", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", "2"}], "}"}]}], "]"}], " ", "+", " ", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"z", ",", "2"}], "}"}]}], "]"}]}], " ", "//", " ", 
    "Simplify"}], " ", "//", " ", "CForm"}]}]], "Input",
 CellChangeTimes->{{3.656364624240137*^9, 3.6563647227350893`*^9}, {
  3.656364789069483*^9, 3.656364792453143*^9}, {3.656366388391911*^9, 
  3.6563664204961023`*^9}, {3.6586872068166943`*^9, 3.658687208681076*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["higgs metastability potential", "Section",
 CellChangeTimes->{{3.658678708474242*^9, 3.658678713120556*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Quit", "[", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.6586787304590178`*^9, 3.658678732529181*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"l", "=", 
   SuperscriptBox["10", 
    RowBox[{"-", "7"}]]}], ";"}]], "Input",
 CellChangeTimes->{{3.6586978746780777`*^9, 3.658697886201949*^9}, {
  3.6587019813170843`*^9, 3.658701981398814*^9}}],

Cell[BoxData[
 RowBox[{"repl", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"a", " ", "\[Rule]", "  ", 
     RowBox[{
      SuperscriptBox["10", 
       RowBox[{"-", "2"}]], "/", "l"}]}], ",", " ", 
    RowBox[{"b", " ", "\[Rule]", "  ", 
     RowBox[{"1", "/", "l"}]}], ",", " ", 
    RowBox[{"\[CapitalLambda]", " ", "\[Rule]", " ", 
     RowBox[{
      SuperscriptBox["10", 
       RowBox[{"-", "10"}]], "/", "l"}]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.658676150906073*^9, 3.6586761577835283`*^9}, {
  3.658676366714904*^9, 3.658676378370571*^9}, {3.658676424609541*^9, 
  3.6586764576242228`*^9}, {3.658677130514017*^9, 3.658677135450574*^9}, {
  3.65869786452682*^9, 3.65869787131874*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"pot", "[", "h_", "]"}], " ", ":=", " ", 
   RowBox[{"\[CapitalLambda]", " ", "+", " ", 
    RowBox[{"a", " ", 
     RowBox[{"(", 
      RowBox[{"1", " ", "-", " ", 
       RowBox[{
        SuperscriptBox["10", 
         RowBox[{"-", "1"}]], " ", 
        RowBox[{"Log10", "[", 
         RowBox[{
          SuperscriptBox["10", "19"], " ", 
          RowBox[{"Abs", "[", "h", "]"}]}], "]"}]}]}], ")"}], " ", 
     SuperscriptBox["h", "4"]}], " ", "+", " ", 
    RowBox[{"b", " ", 
     SuperscriptBox["h", "6"]}]}]}], " ", ";"}]], "Input",
 CellChangeTimes->{{3.658676159938664*^9, 3.658676283842246*^9}, 
   3.658676343114794*^9, {3.658676385051181*^9, 3.658676387021325*^9}, {
   3.658677073603652*^9, 3.6586770806510763`*^9}, {3.658677147394457*^9, 
   3.658677150234144*^9}, {3.658677419996299*^9, 3.6586774209566927`*^9}}],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"pot", "[", "h", "]"}], " ", "/.", " ", "repl"}], ",", 
   RowBox[{"{", 
    RowBox[{"h", ",", 
     RowBox[{"-", "0.085"}], ",", "0.085"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.658676555638276*^9, 3.658676625953596*^9}, {
  3.658676660981907*^9, 3.6586767284201727`*^9}, {3.658677291217704*^9, 
  3.658677355026973*^9}, {3.65867742453238*^9, 3.6586774255302763`*^9}, {
  3.658682007118511*^9, 3.6586820540027103`*^9}}],

Cell[BoxData[
 RowBox[{"NMinimize", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"pot", "[", "h", "]"}], " ", "/.", " ", "repl"}], ",", "h"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.658676844376781*^9, 3.6586768520351067`*^9}, {
  3.65867736894036*^9, 3.6586773757144327`*^9}, {3.65867743489174*^9, 
  3.658677435448063*^9}}],

Cell[BoxData[
 RowBox[{"Limit", "[", 
  RowBox[{
   RowBox[{"pot", "[", "h", "]"}], ",", " ", 
   RowBox[{"h", "\[Rule]", " ", "0"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6586823422558327`*^9, 3.658682349704027*^9}}],

Cell[BoxData[{
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"pot", "[", "h", "]"}], ",", "h"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Limit", "[", 
  RowBox[{"%", ",", " ", 
   RowBox[{"h", "\[Rule]", " ", "0"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.658677393958007*^9, 3.65867740799751*^9}, {
  3.658677456436062*^9, 3.658677457019738*^9}, {3.6586774873263903`*^9, 
  3.65867752591813*^9}, {3.658677637035894*^9, 3.658677638763074*^9}, {
  3.6586822326697683`*^9, 3.6586822661331053`*^9}}],

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"Log10", "[", 
    RowBox[{
     RowBox[{"Abs", "[", "h", "]"}], " ", 
     SuperscriptBox["10", "19"]}], "]"}], ",", "h"}], "]"}]], "Input",
 CellChangeTimes->{{3.658677815699524*^9, 3.658677837827643*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Log10", "[", "x", "]"}], " ", "\[Equal]", " ", 
   FractionBox[
    RowBox[{"Log", "[", "x", "]"}], 
    RowBox[{"Log", "[", "10", "]"}]]}], " ", "//", " ", "Simplify"}]], "Input",\

 CellChangeTimes->{{3.658677962931679*^9, 3.658678024546041*^9}}],

Cell[BoxData[
 RowBox[{"replphi", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"phi0", " ", "\[Rule]", " ", "0.04"}], ",", " ", 
    RowBox[{"\[Lambda]", " ", "\[Rule]", " ", "20"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.6586956422035*^9, 3.658695674744548*^9}, {
  3.658695875899352*^9, 3.658695878595769*^9}, {3.658696366281871*^9, 
  3.658696393623845*^9}, {3.658702073616803*^9, 3.658702073767063*^9}}],

Cell[BoxData[
 RowBox[{"phi", " ", "=", " ", 
  RowBox[{"phi0", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Cos", "[", "x", "]"}], " ", "+", " ", "1"}], ")"}], 
   RowBox[{
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", "\[Lambda]"}], " ", 
      SuperscriptBox["x", "2"]}], "]"}], " ", "/", " ", "2"}], 
   "k"}]}]], "Input",
 CellChangeTimes->{{3.658695622542513*^9, 3.6586956401457148`*^9}, {
   3.658695679432623*^9, 3.6586956900960712`*^9}, {3.658695854636318*^9, 
   3.658695871916758*^9}, {3.658702099623028*^9, 3.658702100510827*^9}, 
   3.6587030657376757`*^9}],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"phi", "  ", "/.", " ", "replphi"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", " ", 
   RowBox[{"PlotRange", " ", "\[Rule]", " ", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.658695692571021*^9, 3.6586957884530067`*^9}, 
   3.658695865267981*^9}],

Cell[BoxData[
 RowBox[{"phitrunc", " ", "=", " ", 
  RowBox[{"FourierSeries", "[", 
   RowBox[{
    RowBox[{"phi", " ", "/.", " ", "replphi"}], ",", " ", "x", ",", " ", 
    "30"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6586958280751*^9, 3.658695845899353*^9}, {
  3.658695885114416*^9, 3.658695893183707*^9}, {3.658695937651341*^9, 
  3.658695940411051*^9}, {3.658696051720496*^9, 3.6586960534242887`*^9}}],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Re", "[", "phitrunc", "]"}], ",", " ", 
     RowBox[{"phi", " ", "/.", " ", "replphi"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", " ", 
   RowBox[{"PlotRange", " ", "\[Rule]", " ", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.658695907069496*^9, 3.6586959628498507`*^9}, {
  3.658696000673581*^9, 3.658696014273355*^9}}],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"Abs", "[", 
    RowBox[{
     RowBox[{"Re", "[", "phitrunc", "]"}], " ", "-", " ", 
     RowBox[{"(", " ", 
      RowBox[{"phi", " ", "/.", " ", "replphi"}], ")"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", " ", 
   RowBox[{"PlotRange", " ", "\[Rule]", " ", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.658696035521145*^9, 3.658696043816153*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["solve poisson equation tests", "Section",
 CellChangeTimes->{{3.6591988773222933`*^9, 3.6591988844403687`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Quit", "[", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.661118598921228*^9, 3.661118600193193*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"lap", "[", "f_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"f", ",", " ", 
      RowBox[{"{", 
       RowBox[{"x", ",", "2"}], "}"}]}], "]"}], " ", "+", " ", 
    RowBox[{"D", "[", 
     RowBox[{"f", ",", " ", 
      RowBox[{"{", 
       RowBox[{"y", ",", "2"}], "}"}]}], "]"}], " ", "+", " ", 
    RowBox[{"D", "[", 
     RowBox[{"f", ",", " ", 
      RowBox[{"{", 
       RowBox[{"z", ",", "2"}], "}"}]}], "]"}]}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"gradsq", "[", "f_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"f", ",", " ", 
        RowBox[{"{", 
         RowBox[{"x", ",", "1"}], "}"}]}], "]"}], ",", " ", 
      RowBox[{"D", "[", 
       RowBox[{"f", ",", " ", 
        RowBox[{"{", 
         RowBox[{"y", ",", "1"}], "}"}]}], "]"}], ",", " ", 
      RowBox[{"D", "[", 
       RowBox[{"f", ",", " ", 
        RowBox[{"{", 
         RowBox[{"z", ",", "1"}], "}"}]}], "]"}]}], "}"}], ".", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"f", ",", " ", 
        RowBox[{"{", 
         RowBox[{"x", ",", "1"}], "}"}]}], "]"}], ",", " ", 
      RowBox[{"D", "[", 
       RowBox[{"f", ",", " ", 
        RowBox[{"{", 
         RowBox[{"y", ",", "1"}], "}"}]}], "]"}], ",", " ", 
      RowBox[{"D", "[", 
       RowBox[{"f", ",", " ", 
        RowBox[{"{", 
         RowBox[{"z", ",", "1"}], "}"}]}], "]"}]}], "}"}]}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.6611184039272833`*^9, 3.6611184180425797`*^9}, {
  3.661118453517564*^9, 3.66111847313911*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"getmean", "[", "f_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"NIntegrate", "[", 
     RowBox[{"f", ",", " ", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"y", ",", 
        RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"z", ",", 
        RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}]}], "]"}], " ", "/", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"2", " ", "\[Pi]"}], ")"}], "3"]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.661118353426215*^9, 3.661118353634137*^9}, {
  3.6633541367356052`*^9, 3.663354156270856*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"solvepoisson", "[", "f_", "]"}], " ", ":=", " ", 
   RowBox[{"InverseFourierTransform", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"FourierTransform", "[", 
        RowBox[{"f", ",", " ", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"kx", ",", "ky", ",", "kz"}], "}"}]}], "]"}]}], " ", "/", 
      " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["kx", "2"], " ", "+", " ", 
        SuperscriptBox["ky", "2"], " ", "+", " ", 
        SuperscriptBox["kz", "2"]}], ")"}]}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"kx", ",", "ky", ",", "kz"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.661118179881118*^9, 3.6611182714674892`*^9}, {
  3.6611192870125523`*^9, 3.661119287164083*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"potential", "[", "f_", "]"}], " ", ":=", " ", "lambdaval"}], ";", 
  " ", 
  RowBox[{
   RowBox[{"potentialprime", "[", "f_", "]"}], " ", ":=", " ", "0"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6611185247416687`*^9, 3.661118535407083*^9}, {
  3.661121807229641*^9, 3.661121815029346*^9}}],

Cell[CellGroupData[{

Cell["first attempt (WARNING: wrong equation)", "Subsection",
 CellChangeTimes->{{3.661117429782316*^9, 3.661117442354233*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rho", " ", ":=", " ", 
   RowBox[{
    RowBox[{"Sin", "[", "x", "]"}], " ", 
    RowBox[{"Sin", "[", "y", "]"}], "  ", 
    RowBox[{"Sin", "[", "z", "]"}], " ", 
    SuperscriptBox["x", "2"]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.659199491812096*^9, 3.659199525643435*^9}, {
  3.659201128659953*^9, 3.659201129691625*^9}, {3.659201757092486*^9, 
  3.659201764516315*^9}, {3.659201803899922*^9, 3.659201806040609*^9}}],

Cell[BoxData[
 RowBox[{"ft", " ", "=", " ", 
  RowBox[{"FourierTransform", "[", 
   RowBox[{"rho", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"kx", ",", "ky", ",", "kz"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6592009493121634`*^9, 3.659200977996911*^9}, {
   3.6592010514943113`*^9, 3.659201052614066*^9}, 3.65920115577127*^9}],

Cell[BoxData[
 RowBox[{"sol", " ", "=", " ", 
  RowBox[{"InverseFourierTransform", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"-", "ft"}], " ", "/", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["kx", "2"], " ", "+", " ", 
        SuperscriptBox["ky", "2"], " ", "+", " ", 
        SuperscriptBox["kz", "2"]}], ")"}]}], " ", "/", " ", "2"}], ",", " ", 
    
    RowBox[{"{", 
     RowBox[{"kx", ",", "ky", ",", "kz"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.659200991417697*^9, 3.6592010559740973`*^9}, {
  3.659201111388873*^9, 3.659201112404662*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"lap", "[", "sol", "]"}], " ", "\[Equal]", " ", 
   FractionBox["rho", "2"]}], " ", "//", " ", "Simplify"}]], "Input",
 CellChangeTimes->{{3.659201078509356*^9, 3.6592010860251627`*^9}, {
  3.659201161938549*^9, 3.659201169681944*^9}}],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Sin", "[", "x", "]"}], " ", 
    RowBox[{"x", "^", "2"}]}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.659205745669917*^9, 3.659205765551742*^9}}],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", "10"}], " ", 
      SuperscriptBox["x", "2"]}], "]"}], " ", 
    RowBox[{"Cos", "[", "x", "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6592059048941917`*^9, 3.659205918092626*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"N", "@", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "10"}], " ", 
           SuperscriptBox["y", "2"]}], "]"}], " ", 
         RowBox[{"Cos", "[", "y", "]"}]}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"y", ",", "#"}], "}"}]}], "]"}], "&"}], "/@", 
     RowBox[{"Range", "[", 
      RowBox[{"0", ",", "15"}], "]"}]}], ")"}]}], " ", "/.", " ", 
  RowBox[{"y", "\[Rule]", " ", 
   RowBox[{"-", "\[Pi]"}]}]}]], "Input",
 CellChangeTimes->{{3.659205958436131*^9, 3.6592060222148237`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "10"}], " ", 
           SuperscriptBox["y", "2"]}], "]"}], " ", 
         RowBox[{"Cos", "[", "y", "]"}]}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"y", ",", "#"}], "}"}]}], "]"}], " ", "/.", " ", 
      RowBox[{"y", "\[Rule]", " ", "x"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}]}], "]"}], "&"}], "/@", 
  RowBox[{"{", 
   RowBox[{"0", ",", "1", ",", "2", ",", "3", ",", "4"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.659205779775818*^9, 3.6592058271310873`*^9}, {
  3.659205857752942*^9, 3.659205877768262*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
new (hopefully) correct poisson equation (WARNING: still wrong equations!)\
\>", "Subsection",
 CellChangeTimes->{{3.661117447281817*^9, 3.661117456841508*^9}, {
  3.663353995791897*^9, 3.663354008510188*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"meanval", " ", "=", " ", "0.5"}], ";", " ", 
  RowBox[{"amplitude", "=", "0.1"}], ";", " ", 
  RowBox[{"lambdaval", " ", "=", " ", "0.2"}], ";", " ", 
  RowBox[{"a", " ", "=", " ", "1"}], ";"}]], "Input",
 CellChangeTimes->{{3.66111786060599*^9, 3.661117890131344*^9}, {
  3.6611183618173637`*^9, 3.661118361985569*^9}, {3.661118540182921*^9, 
  3.66111854620674*^9}, {3.661118663647174*^9, 3.661118666052952*^9}, {
  3.661120578952927*^9, 3.6611205791124697`*^9}, {3.661187527136989*^9, 
  3.66118752740724*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"phi", " ", "=", " ", 
   RowBox[{"meanval", " ", "+", " ", 
    RowBox[{"amplitude", " ", 
     RowBox[{"Cos", "[", "x", "]"}], " ", 
     RowBox[{"Cos", "[", "y", "]"}], " ", 
     RowBox[{"Cos", "[", "z", "]"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.661117854542988*^9, 3.661117855758225*^9}, {
  3.661117896314724*^9, 3.66111792955473*^9}, {3.6611183662894697`*^9, 
  3.66111836648941*^9}, {3.661120773765421*^9, 3.661120780204867*^9}}],

Cell[BoxData[
 RowBox[{"phiavg", " ", "=", " ", 
  RowBox[{"getmean", "[", "phi", "]"}]}]], "Input",
 CellChangeTimes->{{3.6611179484809837`*^9, 3.661118007765349*^9}, {
  3.66111810958882*^9, 3.6611181133638153`*^9}, {3.661118371152939*^9, 
  3.661118371376709*^9}}],

Cell[BoxData[
 RowBox[{"dphiinit", " ", "=", " ", 
  RowBox[{"D", "[", 
   RowBox[{"phi", ",", "t"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.66111863629392*^9, 3.661118647156226*^9}, {
  3.661121577331017*^9, 3.661121634366547*^9}, {3.661121896594157*^9, 
  3.661121900666191*^9}}],

Cell[BoxData[
 RowBox[{"rho", " ", "=", " ", 
  RowBox[{
   RowBox[{
    FractionBox[
     SuperscriptBox["dphiinit", "2"], "2"], " ", "+", " ", 
    FractionBox[
     RowBox[{"gradsq", "[", "phi", "]"}], "2"], "+", " ", 
    RowBox[{"potential", "[", "phi", "]"}]}], " ", "//", " ", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.6611180244221287`*^9, 3.6611180276408577`*^9}, {
  3.661118122805884*^9, 3.661118143270019*^9}, {3.661118383784891*^9, 
  3.661118389632369*^9}, {3.661118504968216*^9, 3.66111852148015*^9}, {
  3.661118563014887*^9, 3.661118568998028*^9}, {3.661118644895751*^9, 
  3.661118645198226*^9}, {3.661121903443006*^9, 3.661121904282711*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"valnum", " ", "=", " ", "32"}], ";", " ", 
  RowBox[{"vals", " ", "=", " ", 
   RowBox[{"N", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "\[Pi]"}], " ", "+", " ", 
       FractionBox[
        RowBox[{"2", "\[Pi]", " ", "i", " "}], "valnum"]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "0", ",", 
        RowBox[{"valnum", "-", "1"}]}], "}"}]}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.661119849304035*^9, 3.661119979553144*^9}, {
  3.661120036134975*^9, 3.661120039398033*^9}, {3.661120085973114*^9, 
  3.6611201250429487`*^9}, {3.661120533940102*^9, 3.661120534780281*^9}, {
  3.6611227168936987`*^9, 3.661122717173088*^9}, {3.66112312267507*^9, 
  3.661123123081437*^9}}],

Cell[BoxData[
 RowBox[{"Length", "@", 
  RowBox[{"Flatten", "@", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"N", "@", 
      RowBox[{"(", 
       RowBox[{"rho", " ", "/.", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "\[Rule]", " ", "xv"}], ",", " ", 
          RowBox[{"y", "\[Rule]", " ", "yv"}], ",", " ", 
          RowBox[{"z", "\[Rule]", " ", "zv"}]}], "}"}]}], ")"}]}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"xv", ",", "vals"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"yv", ",", "vals"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"zv", ",", "vals"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6611228191368093`*^9, 3.661122827088469*^9}, {
  3.6611228941872*^9, 3.661122896201623*^9}}],

Cell[BoxData[
 RowBox[{"rhoavg", " ", "=", " ", 
  RowBox[{"getmean", "[", "rho", "]"}]}]], "Input",
 CellChangeTimes->{{3.661118582736814*^9, 3.6611185962290297`*^9}}],

Cell[BoxData[
 RowBox[{"hub", " ", "=", " ", 
  SqrtBox[
   FractionBox["rhoavg", "3"]]}]], "Input",
 CellChangeTimes->{{3.66111866942756*^9, 3.6611186956615763`*^9}}],

Cell[BoxData[{
 RowBox[{"dphi", " ", "=", " ", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{"lap", "[", "phi", "]"}], 
     SuperscriptBox["a", "2"]], " ", "-", " ", 
    RowBox[{"3", " ", "hub", " ", "dphiinit"}], " ", "-", " ", 
    RowBox[{"potentialprime", "[", "phi", "]"}]}], " ", "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"dphi", " ", "=", " ", "dphiinit"}]}], "Input",
 CellChangeTimes->{
  3.6611216442706537`*^9, {3.6611217373703413`*^9, 3.661121740176528*^9}, {
   3.661121789463975*^9, 3.661121798630067*^9}, {3.661121833253372*^9, 
   3.661121851108987*^9}, {3.661121910202621*^9, 3.661121911027185*^9}, {
   3.661122659326313*^9, 3.661122664213954*^9}}],

Cell[BoxData[
 RowBox[{"rhs", " ", "=", " ", 
  RowBox[{
   RowBox[{"0.5", " ", "*", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"3", " ", "hub", " ", 
       SuperscriptBox["a", "2"], " ", "dphi", " ", 
       RowBox[{"(", 
        RowBox[{"phi", " ", "-", " ", "phiavg"}], ")"}]}], " ", "-", " ", 
      "rho", " ", "+", " ", "rhoavg"}], ")"}]}], " ", "//", " ", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.661117535963876*^9, 3.6611175873022947`*^9}, {
  3.661118707240749*^9, 3.661118710144456*^9}, {3.6611229494809523`*^9, 
  3.661122949999699*^9}}],

Cell[BoxData[
 RowBox[{"sol", " ", "=", " ", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"Re", "[", 
     RowBox[{"solvepoisson", "[", "rhs", "]"}], "]"}], ",", 
    RowBox[{"Assumptions", "\[Rule]", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x", "\[Element]", "Reals"}], ",", " ", 
       RowBox[{"y", "\[Element]", "Reals"}], ",", " ", 
       RowBox[{"z", "\[Element]", "Reals"}]}], "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.661118718204278*^9, 3.661118759120831*^9}, {
  3.661118814002905*^9, 3.661118817818591*^9}, {3.661118866112235*^9, 
  3.661118909196939*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"solcomp", " ", "=", " ", 
   RowBox[{"Flatten", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"N", "@", 
       RowBox[{"(", 
        RowBox[{"sol", " ", "/.", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x", "\[Rule]", " ", "xv"}], ",", " ", 
           RowBox[{"y", "\[Rule]", " ", "yv"}], ",", " ", 
           RowBox[{"z", "\[Rule]", " ", "zv"}]}], "}"}]}], ")"}]}], ",", " ", 
      
      RowBox[{"{", 
       RowBox[{"xv", ",", "vals"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"yv", ",", "vals"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"zv", ",", "vals"}], "}"}]}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.661119982594017*^9, 3.661120070455111*^9}, {
  3.6611201166205072`*^9, 3.6611201493596973`*^9}, {3.661120673991028*^9, 
  3.661120677438554*^9}}],

Cell[BoxData[
 RowBox[{"filename", " ", "=", " ", 
  RowBox[{"SystemDialogInput", "[", 
   RowBox[{"\"\<FileOpen\>\"", ",", 
    RowBox[{"NotebookDirectory", "[", "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.661120244221681*^9, 3.661120281621773*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Import", "[", 
    RowBox[{"filename", ",", " ", 
     RowBox[{"{", 
      RowBox[{"\"\<Datasets\>\"", ",", "\"\</a\>\""}], "}"}]}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}], " ", "\[Equal]", " ", "a"}]], "Input",
 CellChangeTimes->{{3.661120812952992*^9, 3.661120813504758*^9}, {
  3.661121078051072*^9, 3.6611211029461184`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Import", "[", 
    RowBox[{"filename", ",", " ", 
     RowBox[{"{", 
      RowBox[{"\"\<Datasets\>\"", ",", "\"\</rho\>\""}], "}"}]}], "]"}], "[", 
   
   RowBox[{"[", "1", "]"}], "]"}], " ", "\[Equal]", " ", "rhoavg"}]], "Input",\

 CellChangeTimes->{{3.6611210515052547`*^9, 3.661121075259079*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"solnumraw", " ", "=", " ", 
   RowBox[{"Import", "[", 
    RowBox[{"filename", ",", " ", 
     RowBox[{"{", 
      RowBox[{"\"\<Datasets\>\"", ",", "\"\</psi\>\""}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6611202928610287`*^9, 3.661120305221711*^9}, {
  3.661120345109941*^9, 3.661120410638591*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"solnum", " ", "=", " ", 
   RowBox[{"solnumraw", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.661120412648725*^9, 3.661120423686034*^9}, {
  3.6611207048782053`*^9, 3.66112070497305*^9}, {3.661120825184596*^9, 
  3.661120825288353*^9}}],

Cell[BoxData[
 RowBox[{"Max", "[", 
  RowBox[{"Abs", "[", 
   RowBox[{"solnum", "  ", "-", " ", "solcomp"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.661120430379613*^9, 3.6611204579093943`*^9}, {
  3.6611206354998426`*^9, 3.661120641267309*^9}}],

Cell[BoxData[{
 RowBox[{"err", " ", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"Re", "[", 
     RowBox[{
      RowBox[{"lap", "[", "sol", "]"}], " ", "-", " ", "rhs"}], "]"}], ",", 
    RowBox[{"Assumptions", "\[Rule]", "  ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x", "\[Element]", "Reals"}], ",", " ", 
       RowBox[{"y", "\[Element]", "Reals"}], ",", " ", 
       RowBox[{"z", "\[Element]", "Reals"}]}], "}"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Maximize", "[", 
  RowBox[{
   RowBox[{"Re", "[", "err", "]"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Minimize", "[", 
  RowBox[{
   RowBox[{"Re", "[", "err", "]"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.661118754267967*^9, 3.6611187958197308`*^9}, {
  3.661119332613393*^9, 3.66111944664178*^9}, {3.661119569372998*^9, 
  3.661119569885344*^9}, {3.661121963623767*^9, 3.661121974934758*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["test integration x direction", "Subsection",
 CellChangeTimes->{{3.663354518136367*^9, 3.6633545199362297`*^9}, {
  3.66335666786594*^9, 3.6633566694658127`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"valnum", " ", "=", " ", "64"}], ";", " ", 
  RowBox[{"vals", " ", "=", " ", 
   RowBox[{"N", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "\[Pi]"}], " ", "+", " ", 
       FractionBox[
        RowBox[{"2", "\[Pi]", " ", "i", " "}], "valnum"]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "0", ",", 
        RowBox[{"valnum", "-", "1"}]}], "}"}]}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.663355345525226*^9, 3.6633554617731657`*^9, {3.663355545578925*^9, 
   3.66335558518534*^9}, 3.66335574713589*^9, 3.663357128958943*^9, 
   3.663357176534371*^9}],

Cell[BoxData[
 RowBox[{"foo", "=", "  ", 
  RowBox[{"4", " ", "+", " ", 
   RowBox[{
    RowBox[{"Cos", "[", 
     RowBox[{"21", " ", "x"}], "]"}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"8", " ", "y"}], "]"}], " "}]}]}]], "Input",
 CellChangeTimes->{{3.663354524437663*^9, 3.6633545700719213`*^9}, {
  3.663357494458226*^9, 3.6633574971136217`*^9}, {3.663357647656008*^9, 
  3.6633576486640873`*^9}, {3.663357893117635*^9, 3.6633579118591423`*^9}, {
  3.66335923415874*^9, 3.66335923423691*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"foonum", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"N", "@", 
      RowBox[{"(", 
       RowBox[{"foo", "/.", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "\[Rule]", " ", "xv"}], ",", " ", 
          RowBox[{"y", "\[Rule]", " ", "yv"}]}], "}"}]}], ")"}]}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"xv", ",", "vals"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"yv", ",", "vals"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", " ", "//", " ", "MatrixForm"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6633546957754297`*^9, 3.66335472626481*^9}, {
   3.66335534824478*^9, 3.6633553567018843`*^9}, 3.663355466483037*^9, {
   3.663355522386373*^9, 3.663355570265732*^9}, 3.663355637448818*^9, 
   3.663355753327269*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ListPlot3D", "[", "foonum", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.663357191004765*^9, 3.6633572008449383`*^9}, 
   3.6633572660123243`*^9, {3.663357618040399*^9, 3.663357662255786*^9}, 
   3.6633582989598513`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"foores", " ", "=", " ", 
   RowBox[{
    RowBox[{"Sin", "[", "x", "]"}], " ", 
    RowBox[{"Sin", "[", "y", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"foores", " ", "=", " ", 
  RowBox[{
   RowBox[{"InverseFourierTransform", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"FourierTransform", "[", 
       RowBox[{
        RowBox[{"foo", " ", "-", " ", 
         RowBox[{"Mean", "@", 
          RowBox[{"Flatten", "@", "foonum"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"kx", ",", "ky"}], "}"}]}], "]"}], " ", "/", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", " ", "\[ImaginaryI]"}], " ", "kx"}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"kx", ",", "ky"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "y"}], "}"}]}], "]"}], " ", "//", " ", 
   "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.663355809563189*^9, 3.663355826430173*^9}, {
  3.663357511721573*^9, 3.6633576113052397`*^9}, {3.6633580209329643`*^9, 
  3.6633580353082314`*^9}, {3.66335807115584*^9, 3.66335807395548*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"foores", ",", "x"}], "]"}], " ", "\[Equal]", " ", 
   RowBox[{"foo", " ", "-", " ", 
    RowBox[{"Mean", "@", 
     RowBox[{"Flatten", "@", "foonum"}]}]}]}], " ", "//", " ", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.6633575576257133`*^9, 3.663357607968273*^9}, {
  3.663358102004015*^9, 3.663358112698003*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fooresnum", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"N", "@", 
      RowBox[{"(", 
       RowBox[{"foores", "/.", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "\[Rule]", " ", "xv"}], ",", " ", 
          RowBox[{"y", "\[Rule]", " ", "yv"}]}], "}"}]}], ")"}]}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"xv", ",", "vals"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"yv", ",", "vals"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6633558391502457`*^9, 3.6633558493498917`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"integmat", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"i", "-", "1"}], ")"}], " ", ">", " ", 
        FractionBox["valnum", "2"]}], ",", "   ", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"i", "-", "1"}], ")"}], " ", "-", " ", "valnum"}], ")"}]}],
        ",", "  ", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", 
        RowBox[{"(", 
         RowBox[{"i", "-", "1"}], ")"}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "valnum"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "valnum"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"integmat", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"i", "-", "1"}], ")"}], " ", ">", " ", 
        FractionBox["valnum", "2"]}], ",", "   ", 
       RowBox[{
        RowBox[{"-", " ", "\[ImaginaryI]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"i", "-", "1"}], ")"}], " ", "-", " ", "valnum"}], ")"}]}],
        ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}]}], " ", "\[Equal]", " ", 
          "valnum"}], ",", "0", ",", "   ", 
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", 
          RowBox[{"(", 
           RowBox[{"i", "-", "1"}], ")"}]}]}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "valnum"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "valnum"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"integmat", " ", "//", " ", "MatrixForm"}], ";"}]}], "Input",
 CellChangeTimes->{{3.663354775390255*^9, 3.6633548336672707`*^9}, {
   3.6633549669873037`*^9, 3.663354981121709*^9}, {3.663355023882793*^9, 
   3.6633550959686127`*^9}, {3.663355155592476*^9, 3.663355158335636*^9}, {
   3.6633552542462683`*^9, 3.663355256661121*^9}, {3.663355359597188*^9, 
   3.663355392764636*^9}, 3.663355468803501*^9, 3.6633555097709723`*^9, 
   3.663355756799534*^9, {3.6633560521668367`*^9, 3.6633560543798637`*^9}, {
   3.663356604430923*^9, 3.6633566059174757`*^9}, {3.66335702361794*^9, 
   3.663357141240189*^9}, 3.663357184230544*^9, {3.663357229340914*^9, 
   3.663357230968751*^9}, {3.663357673825392*^9, 3.6633576780254307`*^9}, {
   3.66335778498393*^9, 3.6633577885760803`*^9}, {3.663357821255514*^9, 
   3.6633578479600286`*^9}, {3.663358584161275*^9, 3.663358609758986*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ffoonum", " ", "=", " ", 
   RowBox[{"Fourier", "[", "foonum", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", " ", "//", " ", "MatrixForm"}], ";"}]}], "Input",
 CellChangeTimes->{{3.663355098806981*^9, 3.663355135090488*^9}, {
   3.663355668087984*^9, 3.6633556720165787`*^9}, 3.663355758407053*^9, {
   3.6633577339025784`*^9, 3.663357759382393*^9}, {3.663358140476387*^9, 
   3.663358142721781*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ffooint", " ", "=", " ", 
   RowBox[{
    RowBox[{"ffoonum", " ", "/", " ", "integmat"}], " ", "/.", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ComplexInfinity", " ", "\[Rule]", " ", "0"}], ",", " ", 
      RowBox[{"Indeterminate", " ", "\[Rule]", " ", "0"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", " ", "//", " ", "MatrixForm"}], ";"}]}], "Input",
 CellChangeTimes->{{3.663355190662004*^9, 3.663355192638129*^9}, {
   3.66335524424579*^9, 3.663355319565188*^9}, {3.6633556079927073`*^9, 
   3.6633556138805943`*^9}, 3.6633557601430197`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fooint", " ", "=", " ", 
   RowBox[{"InverseFourier", "[", "ffooint", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", " ", "//", " ", "MatrixForm"}], ";"}]}], "Input",
 CellChangeTimes->{{3.663355703174672*^9, 3.663355717591082*^9}, {
  3.663355762870844*^9, 3.663355768230474*^9}}],

Cell[BoxData[
 RowBox[{"Max", "[", 
  RowBox[{"Im", "@", "fooint"}], "]"}]], "Input",
 CellChangeTimes->{{3.6633569392489147`*^9, 3.663356942888076*^9}}],

Cell[BoxData[
 RowBox[{"Max", "[", 
  RowBox[{"Abs", "[", 
   RowBox[{
    RowBox[{"Re", "@", "fooint"}], " ", "-", " ", "fooresnum"}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6633557929265757`*^9, 3.6633558024139137`*^9}, {
  3.663355852550798*^9, 3.663355862493526*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ListPlot3D", "[", 
   RowBox[{
    RowBox[{"Re", "@", "fooint"}], " ", "-", " ", 
    RowBox[{"Re", "@", "fooresnum"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.663357212436796*^9, 3.663357215060828*^9}, 
   3.663357264220602*^9, {3.663357629320018*^9, 3.663357664170911*^9}, {
   3.663357863445404*^9, 3.663357883220663*^9}, {3.663358129194294*^9, 
   3.663358130017994*^9}, 3.663358293866548*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["test integration poisson", "Subsection",
 CellChangeTimes->{{3.663354518136367*^9, 3.6633545199362297`*^9}, {
  3.66335666786594*^9, 3.6633566822892923`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"valnum", " ", "=", " ", "64"}], ";", " ", 
  RowBox[{"vals", " ", "=", " ", 
   RowBox[{"N", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "\[Pi]"}], " ", "+", " ", 
       FractionBox[
        RowBox[{"2", "\[Pi]", " ", "i", " "}], "valnum"]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "0", ",", 
        RowBox[{"valnum", "-", "1"}]}], "}"}]}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.663355345525226*^9, 3.6633554617731657`*^9, {3.663355545578925*^9, 
   3.66335558518534*^9}, 3.66335574713589*^9}],

Cell[BoxData[
 RowBox[{"foo", "=", " ", 
  RowBox[{"4", " ", "+", 
   RowBox[{
    RowBox[{"Cos", "[", 
     RowBox[{"5", " ", "x"}], "]"}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"3", " ", "y"}], "]"}], " "}]}]}]], "Input",
 CellChangeTimes->{{3.663354524437663*^9, 3.6633545700719213`*^9}, {
  3.6633574392441196`*^9, 3.6633574424653273`*^9}, {3.663358183249399*^9, 
  3.663358183673328*^9}, {3.66335924781314*^9, 3.663359250276596*^9}}],

Cell[BoxData[
 RowBox[{"foores", " ", "=", " ", 
  RowBox[{
   RowBox[{"InverseFourierTransform", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"FourierTransform", "[", 
        RowBox[{"foo", ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"kx", ",", "ky"}], "}"}]}], "]"}]}], "/", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["kx", "2"], " ", "+", " ", 
        SuperscriptBox["ky", "2"]}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"kx", ",", "ky"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "y"}], "}"}]}], "]"}], " ", "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.663355809563189*^9, 3.663355826430173*^9}, {
  3.6633567254035482`*^9, 3.663356765675515*^9}, {3.663358266929448*^9, 
  3.663358269801312*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"foonum", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"N", "@", 
      RowBox[{"(", 
       RowBox[{"foo", "/.", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "\[Rule]", " ", "xv"}], ",", " ", 
          RowBox[{"y", "\[Rule]", " ", "yv"}]}], "}"}]}], ")"}]}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"xv", ",", "vals"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"yv", ",", "vals"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", " ", "//", " ", "MatrixForm"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6633546957754297`*^9, 3.66335472626481*^9}, {
   3.66335534824478*^9, 3.6633553567018843`*^9}, 3.663355466483037*^9, {
   3.663355522386373*^9, 3.663355570265732*^9}, 3.663355637448818*^9, 
   3.663355753327269*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ListPlot3D", "[", "foonum", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.6633568692556543`*^9, 3.663356880080937*^9}, 
   3.663356948791864*^9, 3.663357459106188*^9, 3.663358285903907*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fooresnum", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"N", "@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"foores", "-", " ", 
          RowBox[{"2", " ", 
           SuperscriptBox["y", "2"]}]}], ")"}], "/.", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "\[Rule]", " ", "xv"}], ",", " ", 
          RowBox[{"y", "\[Rule]", " ", "yv"}]}], "}"}]}], ")"}]}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"xv", ",", "vals"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"yv", ",", "vals"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6633558391502457`*^9, 3.6633558493498917`*^9}, {
  3.663358239321596*^9, 3.6633582571611757`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"integmat", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"i", "-", "1"}], ")"}], " ", ">", " ", 
         FractionBox["valnum", "2"]}], ",", "  ", 
        RowBox[{"-", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"i", "-", "1"}], ")"}], " ", "-", " ", "valnum"}], ")"}],
           "2"]}], ",", " ", 
        RowBox[{"-", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"i", "-", "1"}], ")"}], "2"]}]}], "]"}], "+", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"j", "-", "1"}], ")"}], " ", ">", " ", 
         FractionBox["valnum", "2"]}], ",", "  ", 
        RowBox[{"-", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"j", "-", "1"}], ")"}], " ", "-", " ", "valnum"}], ")"}],
           "2"]}], ",", " ", 
        RowBox[{"-", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"j", "-", "1"}], ")"}], "2"]}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "valnum"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "valnum"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"integmat", " ", "//", " ", "MatrixForm"}], ";"}]}], "Input",
 CellChangeTimes->{{3.663354775390255*^9, 3.6633548336672707`*^9}, {
   3.6633549669873037`*^9, 3.663354981121709*^9}, {3.663355023882793*^9, 
   3.6633550959686127`*^9}, {3.663355155592476*^9, 3.663355158335636*^9}, {
   3.6633552542462683`*^9, 3.663355256661121*^9}, {3.663355359597188*^9, 
   3.663355392764636*^9}, 3.663355468803501*^9, 3.6633555097709723`*^9, 
   3.663355756799534*^9, {3.6633560521668367`*^9, 3.6633560543798637`*^9}, {
   3.663356604430923*^9, 3.6633566059174757`*^9}, {3.6633567955634937`*^9, 
   3.663356842427685*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ffoonum", " ", "=", " ", 
   RowBox[{"Fourier", "[", "foonum", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", " ", "//", " ", "MatrixForm"}], ";"}]}], "Input",
 CellChangeTimes->{{3.663355098806981*^9, 3.663355135090488*^9}, {
   3.663355668087984*^9, 3.6633556720165787`*^9}, 3.663355758407053*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ffooint", " ", "=", " ", 
   RowBox[{
    RowBox[{"ffoonum", " ", "/", " ", "integmat"}], " ", "/.", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ComplexInfinity", " ", "\[Rule]", " ", "0"}], ",", " ", 
      RowBox[{"Indeterminate", " ", "\[Rule]", " ", "0"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", " ", "//", " ", "MatrixForm"}], ";"}]}], "Input",
 CellChangeTimes->{{3.663355190662004*^9, 3.663355192638129*^9}, {
   3.66335524424579*^9, 3.663355319565188*^9}, {3.6633556079927073`*^9, 
   3.6633556138805943`*^9}, 3.6633557601430197`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fooint", " ", "=", " ", 
   RowBox[{"InverseFourier", "[", "ffooint", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", " ", "//", " ", "MatrixForm"}], ";"}]}], "Input",
 CellChangeTimes->{{3.663355703174672*^9, 3.663355717591082*^9}, {
  3.663355762870844*^9, 3.663355768230474*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ListPlot3D", "[", 
   RowBox[{"Re", "@", "fooint"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.6633568692556543`*^9, 3.663356918960663*^9}, 
   3.663356950904305*^9, 3.663357460122164*^9, 3.663358288584075*^9}],

Cell[BoxData[
 RowBox[{"Max", "[", 
  RowBox[{"Im", "@", "fooint"}], "]"}]], "Input",
 CellChangeTimes->{{3.6633569258485518`*^9, 3.663356933512102*^9}}],

Cell[BoxData[
 RowBox[{"Max", "[", 
  RowBox[{"Abs", "[", 
   RowBox[{
    RowBox[{"Re", "@", "fooint"}], " ", "-", " ", 
    RowBox[{"(", "fooresnum", ")"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6633557929265757`*^9, 3.6633558024139137`*^9}, {
  3.663355852550798*^9, 3.663355862493526*^9}, {3.66335822736099*^9, 
  3.663358229007897*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["new equations discussed with karsten and will", "Subsection",
 CellChangeTimes->{{3.66335402358307*^9, 3.6633540315016727`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"meanval", " ", "=", " ", "6.319569842"}], ";", " ", 
  RowBox[{"amplitude", "=", 
   RowBox[{
    SuperscriptBox["10", 
     RowBox[{"-", "4"}]], " ", "meanval"}]}], ";", " ", 
  RowBox[{"mass", " ", "=", " ", "0.11026"}], ";", " ", 
  RowBox[{"a", " ", "=", " ", "1"}], ";"}]], "Input",
 CellChangeTimes->{{3.66111786060599*^9, 3.661117890131344*^9}, {
  3.6611183618173637`*^9, 3.661118361985569*^9}, {3.661118540182921*^9, 
  3.66111854620674*^9}, {3.661118663647174*^9, 3.661118666052952*^9}, {
  3.661120578952927*^9, 3.6611205791124697`*^9}, {3.661187527136989*^9, 
  3.66118752740724*^9}, {3.6633540819043207`*^9, 3.663354101734823*^9}, {
  3.663354310067616*^9, 3.663354325642685*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"lap", "[", "f_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"f", ",", " ", 
      RowBox[{"{", 
       RowBox[{"x", ",", "2"}], "}"}]}], "]"}], " ", "+", " ", 
    RowBox[{"D", "[", 
     RowBox[{"f", ",", " ", 
      RowBox[{"{", 
       RowBox[{"y", ",", "2"}], "}"}]}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.663354166790639*^9, 3.663354168558214*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"gradsq", "[", "f_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"f", ",", " ", 
        RowBox[{"{", 
         RowBox[{"x", ",", "1"}], "}"}]}], "]"}], ",", " ", 
      RowBox[{"D", "[", 
       RowBox[{"f", ",", " ", 
        RowBox[{"{", 
         RowBox[{"y", ",", "1"}], "}"}]}], "]"}]}], "}"}], ".", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"f", ",", " ", 
        RowBox[{"{", 
         RowBox[{"x", ",", "1"}], "}"}]}], "]"}], ",", " ", 
      RowBox[{"D", "[", 
       RowBox[{"f", ",", " ", 
        RowBox[{"{", 
         RowBox[{"y", ",", "1"}], "}"}]}], "]"}]}], "}"}]}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.6611184039272833`*^9, 3.6611184180425797`*^9}, {
  3.661118453517564*^9, 3.66111847313911*^9}, {3.6633541743351173`*^9, 
  3.663354201367297*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"getmean", "[", "f_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"NIntegrate", "[", 
     RowBox[{"f", ",", " ", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"y", ",", 
        RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}]}], "]"}], " ", "/", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"2", " ", "\[Pi]"}], ")"}], "2"]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.661118353426215*^9, 3.661118353634137*^9}, {
  3.6633541367356052`*^9, 3.663354156270856*^9}, {3.6633542061754313`*^9, 
  3.6633542086147118`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"solvepoisson", "[", "f_", "]"}], " ", ":=", " ", 
   RowBox[{"InverseFourierTransform", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"FourierTransform", "[", 
        RowBox[{"f", ",", " ", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"kx", ",", "ky", ",", "kz"}], "}"}]}], "]"}]}], " ", "/", 
      " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["kx", "2"], " ", "+", " ", 
        SuperscriptBox["ky", "2"], " ", "+", " ", 
        SuperscriptBox["kz", "2"]}], ")"}]}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"kx", ",", "ky", ",", "kz"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.661118179881118*^9, 3.6611182714674892`*^9}, {
  3.6611192870125523`*^9, 3.661119287164083*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"potential", "[", "f_", "]"}], " ", ":=", " ", 
   RowBox[{
    SuperscriptBox["mass", "2"], " ", 
    FractionBox[
     SuperscriptBox["f", "2"], "2"]}]}], ";", " ", 
  RowBox[{
   RowBox[{"potentialprime", "[", "f_", "]"}], " ", ":=", " ", 
   RowBox[{
    SuperscriptBox["mass", "2"], " ", "f"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6611185247416687`*^9, 3.661118535407083*^9}, {
  3.661121807229641*^9, 3.661121815029346*^9}, {3.663354302612496*^9, 
  3.663354303659238*^9}, {3.663354345872944*^9, 3.663354365250901*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"phi", " ", "=", " ", 
   RowBox[{"meanval", " ", "+", " ", 
    RowBox[{"amplitude", " ", 
     RowBox[{"Cos", "[", "x", "]"}], " ", 
     RowBox[{"Cos", "[", "y", "]"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.661117854542988*^9, 3.661117855758225*^9}, {
  3.661117896314724*^9, 3.66111792955473*^9}, {3.6611183662894697`*^9, 
  3.66111836648941*^9}, {3.661120773765421*^9, 3.661120780204867*^9}, {
  3.663354114847205*^9, 3.6633541157108583`*^9}}],

Cell[BoxData[
 RowBox[{"phiavg", " ", "=", " ", "meanval"}]], "Input",
 CellChangeTimes->{{3.6611179484809837`*^9, 3.661118007765349*^9}, {
  3.66111810958882*^9, 3.6611181133638153`*^9}, {3.661118371152939*^9, 
  3.661118371376709*^9}, {3.6633542285341663`*^9, 3.6633542310458183`*^9}}],

Cell[BoxData[
 RowBox[{"dphiinit", " ", "=", " ", 
  RowBox[{"-", "0.089318193"}]}]], "Input",
 CellChangeTimes->{{3.66111863629392*^9, 3.661118647156226*^9}, {
  3.661121577331017*^9, 3.661121634366547*^9}, {3.661121896594157*^9, 
  3.661121900666191*^9}, {3.663354257683654*^9, 3.6633542896508207`*^9}}],

Cell[BoxData[
 RowBox[{"rho", " ", "=", " ", 
  RowBox[{
   RowBox[{
    FractionBox[
     SuperscriptBox["dphiinit", "2"], "2"], " ", "+", " ", 
    FractionBox[
     RowBox[{"gradsq", "[", "phi", "]"}], "2"], "+", " ", 
    RowBox[{"potential", "[", "phi", "]"}]}], " ", "//", " ", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.6611180244221287`*^9, 3.6611180276408577`*^9}, {
  3.661118122805884*^9, 3.661118143270019*^9}, {3.661118383784891*^9, 
  3.661118389632369*^9}, {3.661118504968216*^9, 3.66111852148015*^9}, {
  3.661118563014887*^9, 3.661118568998028*^9}, {3.661118644895751*^9, 
  3.661118645198226*^9}, {3.661121903443006*^9, 3.661121904282711*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"valnum", " ", "=", " ", "64"}], ";", " ", 
  RowBox[{"vals", " ", "=", " ", 
   RowBox[{"N", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "\[Pi]"}], " ", "+", " ", 
       FractionBox[
        RowBox[{"2", "\[Pi]", " ", "i", " "}], "valnum"]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "0", ",", 
        RowBox[{"valnum", "-", "1"}]}], "}"}]}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.661119849304035*^9, 3.661119979553144*^9}, {
  3.661120036134975*^9, 3.661120039398033*^9}, {3.661120085973114*^9, 
  3.6611201250429487`*^9}, {3.661120533940102*^9, 3.661120534780281*^9}, {
  3.6611227168936987`*^9, 3.661122717173088*^9}, {3.66112312267507*^9, 
  3.661123123081437*^9}, {3.663354383360466*^9, 3.663354383645053*^9}}],

Cell[BoxData[
 RowBox[{"Length", "@", 
  RowBox[{"Flatten", "@", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"N", "@", 
      RowBox[{"(", 
       RowBox[{"rho", " ", "/.", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "\[Rule]", " ", "xv"}], ",", " ", 
          RowBox[{"y", "\[Rule]", " ", "yv"}]}], "}"}]}], ")"}]}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"xv", ",", "vals"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"yv", ",", "vals"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6611228191368093`*^9, 3.661122827088469*^9}, {
  3.6611228941872*^9, 3.661122896201623*^9}, {3.6633543915763483`*^9, 
  3.6633543949362*^9}}],

Cell[BoxData[
 RowBox[{"rhoavg", " ", "=", " ", 
  RowBox[{"getmean", "[", "rho", "]"}]}]], "Input",
 CellChangeTimes->{{3.661118582736814*^9, 3.6611185962290297`*^9}}],

Cell[BoxData[
 RowBox[{"hub", " ", "=", " ", 
  SqrtBox[
   FractionBox["rhoavg", "3"]]}]], "Input",
 CellChangeTimes->{{3.66111866942756*^9, 3.6611186956615763`*^9}}],

Cell[BoxData[{
 RowBox[{"dphi", " ", "=", " ", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{"lap", "[", "phi", "]"}], 
     SuperscriptBox["a", "2"]], " ", "-", " ", 
    RowBox[{"3", " ", "hub", " ", "dphiinit"}], " ", "-", " ", 
    RowBox[{"potentialprime", "[", "phi", "]"}]}], " ", "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"dphi", " ", "=", " ", "dphiinit"}]}], "Input",
 CellChangeTimes->{
  3.6611216442706537`*^9, {3.6611217373703413`*^9, 3.661121740176528*^9}, {
   3.661121789463975*^9, 3.661121798630067*^9}, {3.661121833253372*^9, 
   3.661121851108987*^9}, {3.661121910202621*^9, 3.661121911027185*^9}, {
   3.661122659326313*^9, 3.661122664213954*^9}, 3.663354435496546*^9, 
   3.663354473507778*^9}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.661117535963876*^9, 3.6611175873022947`*^9}, {
  3.661118707240749*^9, 3.661118710144456*^9}, {3.6611229494809523`*^9, 
  3.661122949999699*^9}, {3.66335449860914*^9, 3.66335451280182*^9}}],

Cell[BoxData[
 RowBox[{"sol", " ", "=", " ", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"Re", "[", 
     RowBox[{"solvepoisson", "[", "rhs", "]"}], "]"}], ",", 
    RowBox[{"Assumptions", "\[Rule]", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x", "\[Element]", "Reals"}], ",", " ", 
       RowBox[{"y", "\[Element]", "Reals"}], ",", " ", 
       RowBox[{"z", "\[Element]", "Reals"}]}], "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.661118718204278*^9, 3.661118759120831*^9}, {
  3.661118814002905*^9, 3.661118817818591*^9}, {3.661118866112235*^9, 
  3.661118909196939*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"solcomp", " ", "=", " ", 
   RowBox[{"Flatten", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"N", "@", 
       RowBox[{"(", 
        RowBox[{"sol", " ", "/.", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x", "\[Rule]", " ", "xv"}], ",", " ", 
           RowBox[{"y", "\[Rule]", " ", "yv"}], ",", " ", 
           RowBox[{"z", "\[Rule]", " ", "zv"}]}], "}"}]}], ")"}]}], ",", " ", 
      
      RowBox[{"{", 
       RowBox[{"xv", ",", "vals"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"yv", ",", "vals"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"zv", ",", "vals"}], "}"}]}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.661119982594017*^9, 3.661120070455111*^9}, {
  3.6611201166205072`*^9, 3.6611201493596973`*^9}, {3.661120673991028*^9, 
  3.661120677438554*^9}}],

Cell[BoxData[
 RowBox[{"filename", " ", "=", " ", 
  RowBox[{"SystemDialogInput", "[", 
   RowBox[{"\"\<FileOpen\>\"", ",", 
    RowBox[{"NotebookDirectory", "[", "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.661120244221681*^9, 3.661120281621773*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Import", "[", 
    RowBox[{"filename", ",", " ", 
     RowBox[{"{", 
      RowBox[{"\"\<Datasets\>\"", ",", "\"\</a\>\""}], "}"}]}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}], " ", "\[Equal]", " ", "a"}]], "Input",
 CellChangeTimes->{{3.661120812952992*^9, 3.661120813504758*^9}, {
  3.661121078051072*^9, 3.6611211029461184`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Import", "[", 
    RowBox[{"filename", ",", " ", 
     RowBox[{"{", 
      RowBox[{"\"\<Datasets\>\"", ",", "\"\</rho\>\""}], "}"}]}], "]"}], "[", 
   
   RowBox[{"[", "1", "]"}], "]"}], " ", "\[Equal]", " ", "rhoavg"}]], "Input",\

 CellChangeTimes->{{3.6611210515052547`*^9, 3.661121075259079*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"solnumraw", " ", "=", " ", 
   RowBox[{"Import", "[", 
    RowBox[{"filename", ",", " ", 
     RowBox[{"{", 
      RowBox[{"\"\<Datasets\>\"", ",", "\"\</psi\>\""}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6611202928610287`*^9, 3.661120305221711*^9}, {
  3.661120345109941*^9, 3.661120410638591*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"solnum", " ", "=", " ", 
   RowBox[{"solnumraw", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.661120412648725*^9, 3.661120423686034*^9}, {
  3.6611207048782053`*^9, 3.66112070497305*^9}, {3.661120825184596*^9, 
  3.661120825288353*^9}}],

Cell[BoxData[
 RowBox[{"Max", "[", 
  RowBox[{"Abs", "[", 
   RowBox[{"solnum", "  ", "-", " ", "solcomp"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.661120430379613*^9, 3.6611204579093943`*^9}, {
  3.6611206354998426`*^9, 3.661120641267309*^9}}],

Cell[BoxData[{
 RowBox[{"err", " ", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"Re", "[", 
     RowBox[{
      RowBox[{"lap", "[", "sol", "]"}], " ", "-", " ", "rhs"}], "]"}], ",", 
    RowBox[{"Assumptions", "\[Rule]", "  ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x", "\[Element]", "Reals"}], ",", " ", 
       RowBox[{"y", "\[Element]", "Reals"}], ",", " ", 
       RowBox[{"z", "\[Element]", "Reals"}]}], "}"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Maximize", "[", 
  RowBox[{
   RowBox[{"Re", "[", "err", "]"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Minimize", "[", 
  RowBox[{
   RowBox[{"Re", "[", "err", "]"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.661118754267967*^9, 3.6611187958197308`*^9}, {
  3.661119332613393*^9, 3.66111944664178*^9}, {3.661119569372998*^9, 
  3.661119569885344*^9}, {3.661121963623767*^9, 3.661121974934758*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["equations of motion without scalar perturbation", "Section",
 CellChangeTimes->{{3.6618080468608637`*^9, 3.661808052612301*^9}}],

Cell[CellGroupData[{

Cell["initialize RGTC", "Subsection",
 CellChangeTimes->{{3.661807404617031*^9, 3.6618074097363577`*^9}, {
  3.662756215001363*^9, 3.662756220273423*^9}}],

Cell[BoxData[
 RowBox[{"<<", " ", "EDCRGTCcode.m"}]], "Input",
 CellChangeTimes->{{3.659213467062601*^9, 3.659213488856326*^9}, 
   3.6618080982767773`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["some helpful functions, mostly for readability", "Subsection",
 CellChangeTimes->{{3.6627562238969173`*^9, 3.662756235976243*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"nice", "[", "f_", "]"}], " ", ":=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{"tolin", "@", 
     RowBox[{"(", 
      RowBox[{"f", " ", "/.", " ", "printrepl"}], ")"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.66163014438806*^9, 3.6616301457240133`*^9}}],

Cell[BoxData[
 RowBox[{"printrepl", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      SuperscriptBox["phi", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", " ",
      "dphi"}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox["phi", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", " ",
      "xphi"}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox["phi", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", " ",
      "yphi"}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox["phi", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", " ",
      "zphi"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      SuperscriptBox["phi", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"2", ",", "0", ",", "0", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", " ",
      "ddphi"}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox["phi", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "2", ",", "0", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", " ",
      "xxphi"}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox["phi", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "0", ",", "2", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", " ",
      "yyphi"}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox["phi", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "0", ",", "0", ",", "2"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", " ",
      "zzphi"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"a", "[", "t", "]"}], " ", "\[Rule]", " ", "a"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "'"}], "[", "t", "]"}], " ", "\[Rule]", " ", "da"}]}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.659213914364317*^9, 3.65921392209678*^9}, {
  3.659214396071636*^9, 3.659214400462729*^9}, {3.6592144383026733`*^9, 
  3.659214534062351*^9}, {3.659214571991007*^9, 3.6592146891433773`*^9}, {
  3.659214787192404*^9, 3.65921479109603*^9}, {3.661808089942553*^9, 
  3.661808090855414*^9}}],

Cell[BoxData[
 RowBox[{"oprepl", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"xxphi", " ", "\[Rule]", "  ", 
     RowBox[{"lphi", " ", "-", " ", "yyphi", " ", "-", " ", "zzphi"}]}], ",", 
    " ", 
    RowBox[{"da", " ", "\[Rule]", " ", 
     RowBox[{"H", " ", "a"}]}], ",", " ", 
    RowBox[{
     SuperscriptBox["xphi", "2"], " ", "\[Rule]", " ", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["yphi", "2"]}], " ", "-", " ", 
      SuperscriptBox["zphi", "2"], " ", "+", " ", 
      SuperscriptBox["gphi", "2"]}]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.659214793541716*^9, 3.659214931155787*^9}, {
   3.659215044272204*^9, 3.659215066023184*^9}, {3.659215187363412*^9, 
   3.659215204714739*^9}, {3.6592156626027393`*^9, 3.659215663906513*^9}, {
   3.6592157005773363`*^9, 3.6592157422419577`*^9}, {3.659215957680072*^9, 
   3.6592159577599077`*^9}, {3.6592164270709352`*^9, 
   3.6592164534208717`*^9}, {3.6592881588968487`*^9, 3.659288181195691*^9}, 
   3.659288894571817*^9, {3.660940168303521*^9, 3.660940175150783*^9}, {
   3.6616292678887367`*^9, 3.661629314263686*^9}, 3.661808130474688*^9}],

Cell[BoxData[
 RowBox[{"grepl", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{"Gnew", " ", "\[Rule]", " ", 
    FractionBox["1", 
     RowBox[{"8", " ", "\[Pi]"}]]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.661631228336399*^9, 3.661631249894232*^9}}],

Cell[BoxData[
 RowBox[{"coords", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.659213500185669*^9, 3.659213510640218*^9}, {
  3.661805265682004*^9, 3.661805267194525*^9}}],

Cell[BoxData[{
 RowBox[{"g", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      SuperscriptBox[
       RowBox[{"a", "[", "t", "]"}], "2"], ",", "0", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", 
      SuperscriptBox[
       RowBox[{"a", "[", "t", "]"}], "2"], ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0", ",", 
      SuperscriptBox[
       RowBox[{"a", "[", "t", "]"}], "2"]}], "}"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"g", " ", "//", " ", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.6592132263670177`*^9, 3.659213327349605*^9}, {
   3.659213515554082*^9, 3.6592135156902237`*^9}, {3.659213549427917*^9, 
   3.659213562219933*^9}, 3.659214205885046*^9, {3.659287997316237*^9, 
   3.659288011285386*^9}, {3.659288783616477*^9, 3.65928879398288*^9}, {
   3.659288859455915*^9, 3.659288860144106*^9}, {3.660939909094689*^9, 
   3.660939913567176*^9}, {3.661189582767799*^9, 3.6611895896059523`*^9}, {
   3.661190896548168*^9, 3.661190912622839*^9}, {3.661808147436657*^9, 
   3.661808156098823*^9}, {3.6618082752755337`*^9, 3.661808275562008*^9}}],

Cell[BoxData[
 RowBox[{"RGtensors", "[", 
  RowBox[{"g", ",", "coords"}], "]"}]], "Input",
 CellChangeTimes->{{3.6592135276621113`*^9, 3.6592135335942593`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["compute eom", "Subsection",
 CellChangeTimes->{{3.661800417974061*^9, 3.661800419924685*^9}, {
  3.6618062412926826`*^9, 3.661806242819202*^9}, {3.661808306621282*^9, 
  3.6618083067490187`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Laplacian", "[", 
   RowBox[{"phi", "[", 
    RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "]"}], " ", "//", " ",
   "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{"eomtmp", " ", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"%", " ", "/.", " ", "printrepl"}], ")"}], ",", " ", 
    RowBox[{"Assumptions", " ", "\[Rule]", "  ", "oprepl"}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.659213984446457*^9, 3.6592140165301533`*^9}, {
  3.659214079454344*^9, 3.6592141197235193`*^9}, {3.6592143219106903`*^9, 
  3.659214381024578*^9}, {3.659214540282854*^9, 3.659214549824751*^9}, {
  3.659214698842856*^9, 3.6592147557365828`*^9}, {3.6592148287619553`*^9, 
  3.659214833049459*^9}, {3.659214941697033*^9, 3.659214950600512*^9}, {
  3.659215026730626*^9, 3.659215087767284*^9}, {3.659215333484338*^9, 
  3.6592153424571247`*^9}, {3.659215839196046*^9, 3.659215839323812*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"eomtmp", " ", "\[Equal]", " ", 
    RowBox[{"covDiv", "[", 
     RowBox[{
      RowBox[{"gUU", ".", 
       RowBox[{"covD", "[", 
        RowBox[{"phi", "[", 
         RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "]"}]}], ",", 
      "1"}], "]"}]}], " ", "/.", " ", "printrepl"}], " ", "//", " ", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.662752471482067*^9, 3.662752545887148*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"eomtmp", " ", "/.", " ", "oprepl"}], ")"}], " ", "//", " ", 
   "FullSimplify"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"eomrepl", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"%", " ", "\[Equal]", " ", "Vprime"}], ",", " ", "ddphi"}], 
     "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], " ", "//", " ", 
   "FullSimplify"}]}]}], "Input",
 CellChangeTimes->{{3.661799750264654*^9, 3.661799842294924*^9}, {
  3.6618054872423964`*^9, 3.6618054894012136`*^9}, {3.661805921255815*^9, 
  3.661805921607616*^9}, {3.6618059582450657`*^9, 3.661805963295781*^9}, {
  3.66180831710308*^9, 3.661808320670527*^9}}],

Cell[BoxData[
 RowBox[{"rhs", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{"ddphi", " ", "/.", " ", "eomrepl"}], ",", 
      RowBox[{"{", 
       RowBox[{"Psi", ",", "0", ",", "1"}], "}"}]}], "]"}], " ", "//", " ", 
    "FullSimplify"}], " ", "//", " ", "Normal"}]}]], "Input",
 CellChangeTimes->{{3.661799814588168*^9, 3.661799870749342*^9}, {
   3.661799938425756*^9, 3.6617999504171133`*^9}, {3.6618000456916313`*^9, 
   3.661800061786771*^9}, {3.6618002911838837`*^9, 3.6618002920055523`*^9}, 
   3.6618059324785013`*^9, {3.661805967340741*^9, 3.661805993707757*^9}, 
   3.661806039136339*^9, {3.661808323838702*^9, 3.6618083278781147`*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["equations of motion with scalar perturbation", "Section",
 CellChangeTimes->{{3.659213014104723*^9, 3.659213021975371*^9}, {
  3.659213222484356*^9, 3.6592132237242527`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Quit", "[", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.659214211589732*^9, 3.6592142130562477`*^9}}],

Cell[CellGroupData[{

Cell["initialization RGTC", "Subsection",
 CellChangeTimes->{{3.661807404617031*^9, 3.6618074097363577`*^9}, {
  3.662842661503759*^9, 3.662842663238081*^9}}],

Cell[BoxData[
 RowBox[{"<<", " ", "EDCRGTCcode.m"}]], "Input",
 CellChangeTimes->{{3.659213467062601*^9, 3.659213488856326*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["compute background values first", "Subsection",
 CellChangeTimes->{{3.6628424457636223`*^9, 3.6628424496979513`*^9}, {
  3.66294743582574*^9, 3.662947436551566*^9}}],

Cell[BoxData[
 RowBox[{"bgcoords", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.662842451879236*^9, 3.6628424620990047`*^9}}],

Cell[BoxData[
 RowBox[{"bgg", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      SuperscriptBox[
       RowBox[{"a", "[", "t", "]"}], "2"], ",", "0", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", 
      SuperscriptBox[
       RowBox[{"a", "[", "t", "]"}], "2"], ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0", ",", 
      SuperscriptBox[
       RowBox[{"a", "[", "t", "]"}], "2"]}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.662842464462376*^9, 3.662842489362385*^9}}],

Cell[BoxData[
 RowBox[{"RGtensors", "[", 
  RowBox[{"bgg", ",", "bgcoords"}], "]"}]], "Input",
 CellChangeTimes->{{3.662842491866322*^9, 3.66284249960067*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"bgRdd", " ", "=", " ", "Rdd"}], ";", " ", 
  RowBox[{"bgEUd", " ", "=", " ", "EUd"}], ";", " ", 
  RowBox[{"bgR", " ", "=", " ", "R"}], ";"}]], "Input",
 CellChangeTimes->{{3.662842504250105*^9, 3.662842526303337*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Clear", "@@", 
    RowBox[{"DeleteCases", "[", 
     RowBox[{
      RowBox[{"Names", "@", "\"\<`*\>\""}], ",", 
      RowBox[{
      "\"\<bgRdd\>\"", " ", "|", " ", "\"\<bgEUd\>\"", " ", "|", " ", 
       "\"\<bgR\>\""}]}], "]"}]}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.6628425324205847`*^9, 3.662842533782303*^9}, {
  3.662842611843705*^9, 3.6628426335299597`*^9}, {3.6628510213230467`*^9, 
  3.6628510232345448`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["some useful functions, mostly for readability", "Subsection",
 CellChangeTimes->{{3.662756289879479*^9, 3.662756295756824*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"expansionOrder", " ", "=", " ", "1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tolin", "[", "f_", "]"}], " ", ":=", " ", 
   RowBox[{"Simplify", "@", 
    RowBox[{"Normal", "@", 
     RowBox[{"Series", "[", 
      RowBox[{"f", ",", " ", 
       RowBox[{"{", 
        RowBox[{"Psi", ",", "0", ",", "expansionOrder"}], "}"}]}], 
      "]"}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.66162916071454*^9, 3.6616291837383413`*^9}, {
  3.66162936215162*^9, 3.661629364199099*^9}, {3.662851102293614*^9, 
  3.662851114045546*^9}, {3.662851155506918*^9, 3.662851155682184*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"fullnice", "[", "f_", "]"}], " ", ":=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"tolin", "@", 
      RowBox[{"(", 
       RowBox[{"f", " ", "/.", " ", "printrepl"}], ")"}]}], " ", "/.", " ", 
     "oprepl"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.661629964073977*^9, 3.661630013875849*^9}, {
  3.6616301386362743`*^9, 3.661630138964213*^9}, {3.6628510924941177`*^9, 
  3.662851099510166*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"myLaplacian", "[", "f_", "]"}], " ", ":=", " ", 
  RowBox[{"covDiv", "[", 
   RowBox[{
    RowBox[{"gUU", ".", 
     RowBox[{"covD", "[", "f", "]"}]}], ",", "1"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6627467455883303`*^9, 3.6627467570703917`*^9}, {
   3.662746805605633*^9, 3.662746864739229*^9}, {3.662746964393807*^9, 
   3.662746989965805*^9}, {3.662747246028304*^9, 3.662747300769566*^9}, {
   3.66274733324783*^9, 3.662747333335977*^9}, {3.662747421925318*^9, 
   3.662747422716901*^9}, {3.66274757457069*^9, 3.6627475793928328`*^9}, {
   3.662747710770337*^9, 3.662747749623884*^9}, {3.662747791122501*^9, 
   3.662747831490425*^9}, 3.6627483239106293`*^9, {3.662752419339052*^9, 
   3.662752439224073*^9}, {3.662752563798275*^9, 3.662752564430092*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"getCoefficients", "[", "f_", "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{"\"\<full expression: \>\"", ",", " ", 
        RowBox[{"Collect", "[", 
         RowBox[{"f", ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"dphi", ",", " ", 
             SuperscriptBox["dphi", "2"], ",", " ", "lphi", ",", " ", 
             RowBox[{"gphi", " ", "gPsi"}], ",", " ", "Vprime"}], "}"}], " ", 
           "/.", " ", "mathrepl"}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "\"\<coefficients of\>\"", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<\!\(\*OverscriptBox[\(\[Phi]\), \(.\)]\): \>\"", ",", " ", 
        RowBox[{"Simplify", "@", 
         RowBox[{"SeriesCoefficient", "[", 
          RowBox[{"f", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"dphi", " ", "/.", " ", "mathrepl"}], ",", "0", ",", 
             "1"}], "}"}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<\!\(\*SuperscriptBox[OverscriptBox[\(\[Phi]\), \(.\)], \(2\)]\): \
\>\"", ",", " ", 
        RowBox[{"Simplify", "@", 
         RowBox[{"SeriesCoefficient", "[", 
          RowBox[{"f", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"dphi", " ", "/.", " ", "mathrepl"}], ",", "0", ",", 
             "2"}], "}"}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<\!\(\*SuperscriptBox[\(\[Del]\), \(2\)]\)\[Phi]: \>\"", ",", " ", 
        
        RowBox[{"Simplify", "@", 
         RowBox[{"SeriesCoefficient", "[", 
          RowBox[{"f", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lphi", " ", "/.", " ", "mathrepl"}], ",", "0", ",", 
             "1"}], "}"}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<(\[Del]\[Phi]) (\[Del]\[Psi]): \>\"", ",", " ", 
        RowBox[{"Simplify", "@", 
         RowBox[{"SeriesCoefficient", "[", 
          RowBox[{"f", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"gphi", " ", "gPsi"}], " ", "/.", " ", "mathrepl"}], 
             ",", "0", ",", "1"}], "}"}]}], "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<V': \>\"", ",", " ", 
        RowBox[{"Simplify", "@", 
         RowBox[{"SeriesCoefficient", "[", 
          RowBox[{"f", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Vprime", " ", "/.", " ", "mathrepl"}], ",", "0", ",", 
             "1"}], "}"}]}], "]"}]}]}], "]"}], ";"}]}], "\[IndentingNewLine]",
     " ", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6627531980176563`*^9, 3.6627534772565737`*^9}, {
  3.662753507837038*^9, 3.662753534819117*^9}, {3.662753566267014*^9, 
  3.6627536642889643`*^9}, {3.662753818601787*^9, 3.6627538942127123`*^9}, {
  3.662753925566646*^9, 3.662753982929335*^9}, {3.662754040792706*^9, 
  3.662754120859701*^9}, {3.6627563008893223`*^9, 3.662756326272108*^9}, {
  3.6627573165178223`*^9, 3.6627573340623713`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["replacement rules for readability", "Subsection",
 CellChangeTimes->{{3.662756330170906*^9, 3.662756337794312*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"printrepl", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox["phi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "dphi"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["phi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "xphi"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["phi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "1", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "yphi"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["phi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "zphi"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       SuperscriptBox["phi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"2", ",", "0", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "ddphi"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["phi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "2", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "xxphi"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["phi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "2", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "yyphi"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["phi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "0", ",", "2"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "zzphi"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "[", "t", "]"}], " ", "\[Rule]", " ", "a"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"a", "'"}], "[", "t", "]"}], " ", "\[Rule]", " ", "da"}], ",", 
     
     RowBox[{
      RowBox[{
       RowBox[{"a", "''"}], "[", "t", "]"}], " ", "\[Rule]", " ", "dda"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"V", "[", 
       RowBox[{"phi", "[", 
        RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "]"}], " ", 
      "\[Rule]", " ", "V"}], ",", " ", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"V", "[", 
         RowBox[{"phi", "[", 
          RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "]"}], ",", 
        RowBox[{"phi", "[", 
         RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], "]"}], " ", 
      "\[Rule]", " ", "Vprime"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Psi", "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "Psi"}], ",", " ", 
     RowBox[{
      RowBox[{
       SuperscriptBox["Psi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "dPsi"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["Psi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "xPsi"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["Psi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "1", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "yPsi"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["Psi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "zPsi"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       SuperscriptBox["Psi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"2", ",", "0", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "ddPsi"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["Psi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "2", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "xxPsi"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["Psi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "2", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "yyPsi"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["Psi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "0", ",", "2"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "zzPsi"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       SuperscriptBox["Psi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "1", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "xdPsi"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["Psi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0", ",", "1", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "ydPsi"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["Psi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0", ",", "0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "zdPsi"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.659213914364317*^9, 3.65921392209678*^9}, {
   3.659214396071636*^9, 3.659214400462729*^9}, {3.6592144383026733`*^9, 
   3.659214534062351*^9}, {3.659214571991007*^9, 3.6592146891433773`*^9}, {
   3.659214787192404*^9, 3.65921479109603*^9}, {3.662742990338163*^9, 
   3.662743083577395*^9}, 3.662756343169889*^9, {3.6628290815125513`*^9, 
   3.6628291014635468`*^9}, {3.6628292399271717`*^9, 3.662829244141405*^9}, {
   3.662851658665413*^9, 3.66285168577603*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mathrepl", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"phi", " ", "\[Rule]", " ", "\[Phi]"}], ",", " ", 
     RowBox[{"dphi", " ", "\[Rule]", " ", 
      OverscriptBox["\[Phi]", "."]}], ",", 
     RowBox[{"xphi", " ", "\[Rule]", " ", 
      RowBox[{
       SubscriptBox["\[PartialD]", "x"], "\[Phi]"}]}], ",", 
     RowBox[{"yphi", " ", "\[Rule]", " ", 
      RowBox[{
       SubscriptBox["\[PartialD]", "y"], "\[Phi]"}]}], ",", 
     RowBox[{"zphi", " ", "\[Rule]", " ", 
      RowBox[{
       SubscriptBox["\[PartialD]", "z"], "\[Phi]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ddphi", " ", "\[Rule]", " ", "dd\[Phi]"}], ",", 
     RowBox[{"xxphi", " ", "\[Rule]", " ", 
      RowBox[{
       SubscriptBox["\[PartialD]", "x"], 
       RowBox[{
        SubscriptBox["\[PartialD]", "x"], "\[Phi]"}]}]}], ",", 
     RowBox[{"yyphi", " ", "\[Rule]", " ", 
      RowBox[{
       SubscriptBox["\[PartialD]", "y"], 
       RowBox[{
        SubscriptBox["\[PartialD]", "y"], "\[Phi]"}]}]}], ",", 
     RowBox[{"zzphi", " ", "\[Rule]", " ", 
      RowBox[{
       SubscriptBox["\[PartialD]", "z"], 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "\[Phi]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"delphi", " ", "\[Rule]", " ", "\[Delta]\[Phi]"}], ",", 
     RowBox[{"deldphi", " ", "\[Rule]", " ", 
      OverscriptBox["\[Delta]\[Phi]", "."]}], ",", " ", "\[IndentingNewLine]", 
     RowBox[{"da", " ", "\[Rule]", " ", 
      OverscriptBox["a", "."]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Vprime", " ", "\[Rule]", " ", 
      RowBox[{"V", "'"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"rhobar", " ", "\[Rule]", " ", 
      OverscriptBox["\[Rho]", "_"]}], ",", " ", "\[IndentingNewLine]", 
     RowBox[{"Psi", " ", "\[Rule]", " ", "\[Psi]"}], ",", " ", 
     RowBox[{"dPsi", " ", "\[Rule]", " ", 
      OverscriptBox["\[Psi]", "."]}], ",", 
     RowBox[{"xPsi", " ", "\[Rule]", " ", 
      RowBox[{
       SubscriptBox["\[PartialD]", "x"], "\[Psi]"}]}], ",", 
     RowBox[{"yPsi", " ", "\[Rule]", " ", 
      RowBox[{
       SubscriptBox["\[PartialD]", "y"], "\[Psi]"}]}], ",", 
     RowBox[{"zPsi", " ", "\[Rule]", " ", 
      RowBox[{
       SubscriptBox["\[PartialD]", "z"], "\[Psi]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"xdPsi", " ", "\[Rule]", " ", 
      RowBox[{
       SubscriptBox["\[PartialD]", "x"], 
       OverscriptBox["\[Psi]", "."]}]}], ",", " ", 
     RowBox[{"ydPsi", " ", "\[Rule]", " ", 
      RowBox[{
       SubscriptBox["\[PartialD]", "y"], 
       OverscriptBox["\[Psi]", "."]}]}], ",", " ", 
     RowBox[{"zdPsi", " ", "\[Rule]", " ", 
      RowBox[{
       SubscriptBox["\[PartialD]", "z"], 
       OverscriptBox["\[Psi]", "."]}]}], ",", " ", "\[IndentingNewLine]", 
     RowBox[{"lPsi", " ", "\[Rule]", " ", "\[CapitalDelta]\[Psi]"}], ",", " ", 
     RowBox[{"lphi", " ", "\[Rule]", "  ", "\[CapitalDelta]\[Phi]"}], ",", 
     " ", 
     RowBox[{
      RowBox[{"gphi", " ", "gPsi"}], " ", "\[Rule]", " ", 
      RowBox[{
       RowBox[{"\[Del]", "\[Phi]"}], " ", 
       RowBox[{"\[Del]", "\[Psi]"}]}]}], ",", " ", 
     RowBox[{
      SuperscriptBox["gphi", "2"], " ", "\[Rule]", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"\[Del]", "\[Phi]"}], ")"}], "2"]}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.662756419525899*^9, 3.662756424861803*^9}, {
  3.6627565720917788`*^9, 3.662756574747417*^9}, {3.662756718087454*^9, 
  3.662756719343575*^9}, {3.6627567592129307`*^9, 3.662756770248612*^9}, {
  3.662756860547024*^9, 3.662757007991002*^9}, {3.6627572563379297`*^9, 
  3.6627572729687433`*^9}, {3.662758017622628*^9, 3.662758035953719*^9}, {
  3.662758121195751*^9, 3.66275812803933*^9}, {3.662759911580743*^9, 
  3.662759938436405*^9}, {3.6628457970483627`*^9, 3.6628458003668747`*^9}, {
  3.662851699715782*^9, 3.662851753928875*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"oprepl", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"xxphi", " ", "\[Rule]", "  ", 
      RowBox[{"lphi", " ", "-", " ", "yyphi", " ", "-", " ", "zzphi"}]}], ",", 
     RowBox[{"xxPsi", " ", "\[Rule]", "  ", 
      RowBox[{"lPsi", " ", "-", " ", "yyPsi", " ", "-", " ", "zzPsi"}]}], ",",
      " ", 
     RowBox[{
      RowBox[{"xphi", " ", "xPsi"}], " ", "\[Rule]", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "yphi"}], " ", "yPsi"}], "-", 
       RowBox[{"zphi", " ", "zPsi"}], "  ", "+", " ", 
       RowBox[{"gphi", " ", "gPsi"}]}]}], ",", " ", 
     RowBox[{"da", " ", "\[Rule]", " ", 
      RowBox[{"H", " ", "a"}]}], ",", " ", 
     RowBox[{
      SuperscriptBox["xphi", "2"], " ", "\[Rule]", " ", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["yphi", "2"]}], " ", "-", " ", 
       SuperscriptBox["zphi", "2"], " ", "+", " ", 
       SuperscriptBox["gphi", "2"]}]}], ",", " ", 
     RowBox[{
      SuperscriptBox["xPsi", "2"], " ", "\[Rule]", " ", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["yPsi", "2"]}], " ", "-", " ", 
       SuperscriptBox["zPsi", "2"], " ", "+", " ", 
       SuperscriptBox["gPsi", "2"]}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.659214793541716*^9, 3.659214931155787*^9}, {
   3.659215044272204*^9, 3.659215066023184*^9}, {3.659215187363412*^9, 
   3.659215204714739*^9}, {3.6592156626027393`*^9, 3.659215663906513*^9}, {
   3.6592157005773363`*^9, 3.6592157422419577`*^9}, {3.659215957680072*^9, 
   3.6592159577599077`*^9}, {3.6592164270709352`*^9, 
   3.6592164534208717`*^9}, {3.6592881588968487`*^9, 3.659288181195691*^9}, 
   3.659288894571817*^9, {3.660940168303521*^9, 3.660940175150783*^9}, {
   3.6616292678887367`*^9, 3.661629314263686*^9}, 3.662756820532968*^9, {
   3.6628291250594177`*^9, 3.66282913391964*^9}, {3.6628291719415627`*^9, 
   3.66282918294094*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"opreplalt", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["\[PartialD]", "x"], 
       RowBox[{
        SubscriptBox["\[PartialD]", "x"], "\[Phi]"}]}], " ", "\[Rule]", "  ", 
      
      RowBox[{"\[CapitalDelta]\[Phi]", " ", "-", " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "y"], 
        RowBox[{
         SubscriptBox["\[PartialD]", "y"], "\[Phi]"}]}], " ", "-", " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "\[Phi]"}]}]}]}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        SubscriptBox["\[PartialD]", "x"], "\[Phi]"}], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "x"], "\[Psi]"}]}], "\[Rule]", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          SubscriptBox["\[PartialD]", "y"], "\[Phi]"}]}], " ", 
        RowBox[{
         SubscriptBox["\[PartialD]", "y"], "\[Psi]"}]}], "-", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "\[Phi]"}], " ", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "\[Psi]"}]}], "  ", "+", " ", 
       RowBox[{
        RowBox[{"\[Del]", "\[Phi]"}], " ", 
        RowBox[{"\[Del]", "\[Psi]"}]}]}]}], ",", " ", 
     RowBox[{
      OverscriptBox["a", "."], " ", "\[Rule]", " ", 
      RowBox[{"H", " ", "a"}]}], ",", " ", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["\[PartialD]", "x"], "\[Phi]"}], ")"}], "2"], " ", 
      "\[Rule]", " ", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["\[PartialD]", "y"], "\[Phi]"}], ")"}], "2"]}], " ", 
       "-", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], "\[Phi]"}], ")"}], "2"], " ", "+",
        " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"\[Del]", "\[Phi]"}], ")"}], "2"]}]}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.662756784735046*^9, 3.662756816037425*^9}, {
  3.662757014516102*^9, 3.662757014756444*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"quadPsirepl", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SuperscriptBox["dPsi", "2"], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      SuperscriptBox["ddPsi", "2"], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      SuperscriptBox["gPsi", "2"], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      SuperscriptBox["lPsi", "2"], "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"dPsi", " ", "Psi"}], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"ddPsi", " ", "Psi"}], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"lPsi", " ", "Psi"}], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"dPsi", " ", "ddPsi"}], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"lPsi", " ", "dPsi"}], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"lPsi", " ", "ddPsi"}], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"gPsi", " ", "Psi"}], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"gPsi", " ", "dPsi"}], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"Psi", " ", "xPsi"}], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"dPsi", " ", "xPsi"}], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"lPsi", " ", "xPsi"}], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"gPsi", " ", "xPsi"}], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"xdPsi", " ", "Psi"}], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"xdPsi", " ", "dPsi"}], " ", "\[Rule]", " ", "0"}], ",", 
     RowBox[{
      RowBox[{"Psi", " ", "yPsi"}], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"dPsi", " ", "yPsi"}], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"lPsi", " ", "yPsi"}], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"gPsi", " ", "yPsi"}], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"ydPsi", " ", "Psi"}], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"ydPsi", " ", "dPsi"}], " ", "\[Rule]", " ", "0"}], ",", 
     RowBox[{
      RowBox[{"Psi", " ", "zPsi"}], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"dPsi", " ", "zPsi"}], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"lPsi", " ", "zPsi"}], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"gPsi", " ", "zPsi"}], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"zdPsi", " ", "Psi"}], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"zdPsi", " ", "dPsi"}], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      SuperscriptBox["dPsi", "2"], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      SuperscriptBox["xPsi", "2"], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      SuperscriptBox["yPsi", "2"], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      SuperscriptBox["zPsi", "2"], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      SuperscriptBox["gPsi", "2"], "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      SuperscriptBox["dPsi", "2"], "\[Rule]", " ", "0"}]}], "}"}]}], 
  ";"}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "replacement rules for ",
 Cell[BoxData[
  FormBox[
   OverscriptBox["\[Psi]", "."], TraditionalForm]]],
 ", from Riotto --> WARNING"
}], "Subsection",
 CellChangeTimes->{{3.662756828648758*^9, 3.662756838900947*^9}, {
  3.6628510458396893`*^9, 3.6628510557267113`*^9}}],

Cell["TODO: check this, equation (162) in riotto", "Text",
 CellChangeTimes->{{3.661796968197307*^9, 3.6617970017465353`*^9}, {
  3.6618060515757437`*^9, 3.6618060552616777`*^9}, {3.6618073573887873`*^9, 
  3.661807358459631*^9}, {3.662740626010725*^9, 3.662740646181551*^9}, {
  3.662746727648795*^9, 3.662746728182457*^9}}],

Cell[BoxData[
 RowBox[{"einsteinPert00", " ", "=", " ", 
  RowBox[{
   RowBox[{"dPsi", " ", "+", " ", 
    RowBox[{"H", " ", "Psi"}]}], " ", "\[Equal]", " ", 
   RowBox[{
   "4", " ", "\[Pi]", " ", "Gnew", " ", "dphi", " ", "delphi"}]}]}]], "Input",\

 CellChangeTimes->{{3.6627403836259747`*^9, 3.6627404278896933`*^9}, {
  3.662740616529592*^9, 3.6627406177333403`*^9}, {3.662845676111105*^9, 
  3.662845682405367*^9}, {3.6628510417456408`*^9, 3.662851042049551*^9}}],

Cell[BoxData[
 RowBox[{"dPsirepl", " ", "=", " ", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{"einsteinPert00", ",", " ", "dPsi"}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.662740434278263*^9, 3.662740461515856*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["replacement rule for numerics: 8 \[Pi] G = 1 (G = Gnew)", "Subsection",
 CellChangeTimes->{{3.662757031304235*^9, 3.662757046623557*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"grepl", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"Gnew", " ", "\[Rule]", " ", 
     FractionBox["1", 
      RowBox[{"8", " ", "\[Pi]"}]]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.661631228336399*^9, 3.661631249894232*^9}, 
   3.66275704904959*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["setup coordinates and metric and call RGtensors", "Subsection",
 CellChangeTimes->{{3.662757052526977*^9, 3.6627570592386913`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"coords", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.659213500185669*^9, 3.659213510640218*^9}, {
   3.661805265682004*^9, 3.661805267194525*^9}, 3.662757062864636*^9}],

Cell[BoxData[{
 RowBox[{"g", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "1"}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"Psi", "[", 
         RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], ",", "0", 
      ",", "0", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", " ", "-", " ", 
         RowBox[{"2", " ", 
          RowBox[{"Psi", "[", 
           RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], ")"}]}], 
      ",", "0", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", " ", "-", " ", 
         RowBox[{"2", " ", 
          RowBox[{"Psi", "[", 
           RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], ")"}]}], 
      ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0", ",", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", " ", "-", " ", 
         RowBox[{"2", " ", 
          RowBox[{"Psi", "[", 
           RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], ")"}]}]}], 
     "}"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"g", " ", "//", " ", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.6592132263670177`*^9, 3.659213327349605*^9}, {
   3.659213515554082*^9, 3.6592135156902237`*^9}, {3.659213549427917*^9, 
   3.659213562219933*^9}, 3.659214205885046*^9, {3.659287997316237*^9, 
   3.659288011285386*^9}, {3.659288783616477*^9, 3.65928879398288*^9}, {
   3.659288859455915*^9, 3.659288860144106*^9}, {3.660939909094689*^9, 
   3.660939913567176*^9}, {3.661189582767799*^9, 3.6611895896059523`*^9}, {
   3.661190896548168*^9, 3.661190912622839*^9}, {3.661808185832955*^9, 
   3.661808202158963*^9}}],

Cell["\<\
do everything as series expansion in \[Psi] around 0 up to second order\
\>", "Text",
 CellChangeTimes->{{3.6627570689903603`*^9, 3.662757084421204*^9}}],

Cell[BoxData[
 RowBox[{"gPert", " ", "=", " ", 
  RowBox[{"Series", "[", 
   RowBox[{"g", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Psi", "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], ",", "0", ",", 
      RowBox[{"expansionOrder", " ", "+", " ", "2"}]}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.662748339342737*^9, 3.6627484142342777`*^9}, {
  3.6627484860361*^9, 3.662748486123426*^9}, {3.662832575145792*^9, 
  3.662832575201239*^9}, {3.662851131644011*^9, 3.6628511358149767`*^9}, {
  3.662947458243491*^9, 3.66294745929049*^9}}],

Cell[BoxData[
 RowBox[{"RGtensors", "[", 
  RowBox[{"g", ",", "coords"}], "]"}]], "Input",
 CellChangeTimes->{{3.6592135276621113`*^9, 3.6592135335942593`*^9}, {
  3.662748384872767*^9, 3.662748385312427*^9}, {3.6628402725171432`*^9, 
  3.662840273132886*^9}, {3.662947462915447*^9, 3.662947463321968*^9}, {
  3.662947634896944*^9, 3.66294763561549*^9}}],

Cell[BoxData[
 RowBox[{"sqg", " ", "=", " ", 
  RowBox[{
   RowBox[{"Sqrt", "[", 
    RowBox[{"-", 
     RowBox[{"Det", "[", "gdd", "]"}]}], "]"}], " ", "//", " ", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.662747142155484*^9, 3.6627471994151154`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["compute the laplacian", "Subsection",
 CellChangeTimes->{{3.661800417974061*^9, 3.661800419924685*^9}, {
  3.6618062412926826`*^9, 3.661806242819202*^9}, {3.662753693604282*^9, 
  3.662753695444273*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"eomtmp", " ", "=", " ", 
   RowBox[{
    RowBox[{"Laplacian", "[", 
     RowBox[{"phi", "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "]"}], " ", "//", 
    " ", "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(", 
   RowBox[{"fullnice", "@", "eomtmp"}], ")"}], " ", "//.", " ", 
  "mathrepl"}]}], "Input",
 CellChangeTimes->{{3.659213984446457*^9, 3.6592140165301533`*^9}, {
  3.659214079454344*^9, 3.6592141197235193`*^9}, {3.6592143219106903`*^9, 
  3.659214381024578*^9}, {3.659214540282854*^9, 3.659214549824751*^9}, {
  3.659214698842856*^9, 3.6592147557365828`*^9}, {3.6592148287619553`*^9, 
  3.659214833049459*^9}, {3.659214941697033*^9, 3.659214950600512*^9}, {
  3.659215026730626*^9, 3.659215087767284*^9}, {3.659215333484338*^9, 
  3.6592153424571247`*^9}, {3.659215839196046*^9, 3.659215839323812*^9}, {
  3.6627529818061953`*^9, 3.6627530024671173`*^9}, {3.6627537009023523`*^9, 
  3.662753712029435*^9}, {3.662757095562229*^9, 3.662757097045944*^9}, {
  3.662757127854631*^9, 3.662757161973591*^9}, {3.6629475980091047`*^9, 
  3.6629476025978413`*^9}}],

Cell["\<\
compare Laplacian function from RGTC with partly selfmade to make sure it \
does the correct thing\
\>", "Text",
 CellChangeTimes->{{3.662753728554631*^9, 3.662753745529592*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"eomtmp", " ", "\[Equal]", "  ", 
   RowBox[{"myLaplacian", "[", 
    RowBox[{"phi", "[", 
     RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "]"}]}], " ", "//", 
  " ", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.6627468972051487`*^9, 3.66274693029706*^9}, {
  3.662747455782144*^9, 3.6627474692399073`*^9}, {3.662747553426756*^9, 
  3.662747562249851*^9}, {3.662747625610468*^9, 3.662747640305155*^9}, {
  3.6627478670235567`*^9, 3.662747875302865*^9}, {3.662753011891333*^9, 
  3.662753023866515*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["compute the equation of motion", "Subsection",
 CellChangeTimes->{{3.661799601362871*^9, 3.661799611338211*^9}, {
   3.661800432332168*^9, 3.661800433411944*^9}, {3.661806172799053*^9, 
   3.661806175758717*^9}, {3.662753751161702*^9, 3.662753786583177*^9}, 
   3.66275419377452*^9, 3.662754270074642*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Normal", "@", "eomtmp"}], " ", "\[Equal]", " ", "Vprime"}], 
      ",", " ", 
      RowBox[{
       SuperscriptBox["phi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"2", ",", "0", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], " ", "//", " ", "FullSimplify"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"eomrepl1", " ", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", " ", 
     RowBox[{"%", " ", "/.", " ", "printrepl"}], ")"}], " ", "/.", " ", 
    "oprepl"}], " ", "//", " ", "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"getCoefficients", "[", 
  RowBox[{
   RowBox[{"Expand", "@", 
    RowBox[{"fullnice", "@", 
     RowBox[{"(", 
      RowBox[{"ddphi", " ", "/.", " ", "eomrepl1"}], ")"}]}]}], " ", "//.", 
   " ", "mathrepl"}], "]"}]}], "Input",
 CellChangeTimes->{{3.662907305085657*^9, 3.66290735881378*^9}, {
  3.6629073929862633`*^9, 3.662907416659627*^9}, {3.6629074530937147`*^9, 
  3.6629075006914988`*^9}, {3.662907551861684*^9, 3.662907577100823*^9}, {
  3.66291448747311*^9, 3.66291452905793*^9}, {3.6629145840417967`*^9, 
  3.662914584321857*^9}, {3.662947574377285*^9, 3.662947576832046*^9}, {
  3.662947620491605*^9, 3.662947622057424*^9}}],

Cell["with dpsirepl", "Text",
 CellChangeTimes->{{3.6629076332070217`*^9, 3.662907634950461*^9}}],

Cell[BoxData[
 RowBox[{"rhs1", " ", "=", " ", 
  RowBox[{
   RowBox[{"fullnice", "@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"ddphi", " ", "/.", " ", "eomrepl1"}], ")"}], " ", "/.", " ", 
      "dPsirepl"}], ")"}]}], " ", "//.", " ", "mathrepl"}]}]], "Input",
 CellChangeTimes->{{3.661805779279746*^9, 3.661805895089813*^9}, {
  3.6618060255465527`*^9, 3.66180603024221*^9}, {3.6618063696925592`*^9, 
  3.661806384898467*^9}, {3.662749036657835*^9, 3.662749040961327*^9}, {
  3.66275724372755*^9, 3.6627572456079197`*^9}, {3.6629077927028637`*^9, 
  3.6629078041430283`*^9}}],

Cell[BoxData[
 RowBox[{"getCoefficients", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"Expand", "@", "rhs1"}], ")"}], " ", "//.", " ", "mathrepl"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.662753798501981*^9, 3.6627538022158546`*^9}, {
  3.6628418152312517`*^9, 3.662841825094441*^9}, {3.662841860741919*^9, 
  3.6628418695640593`*^9}, {3.662841997253201*^9, 3.6628419992528152`*^9}, {
  3.662842041052329*^9, 3.662842051913952*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
recompute the equation of motion, expand metric from beginning (maxOrder>=2 \
works, but not maxOrder=1 ??)\
\>", "Subsection",
 CellChangeTimes->{{3.661800407502512*^9, 3.661800411086266*^9}, {
  3.6618061113957357`*^9, 3.6618061156180143`*^9}, {3.662754260172935*^9, 
  3.6627542676189213`*^9}, {3.662757467873118*^9, 3.66275748736618*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"maxOrder", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"gUUlin", " ", "=", " ", 
  RowBox[{
   RowBox[{"Series", "[", 
    RowBox[{"gUU", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Psi", "[", 
        RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], ",", "0", ",", 
       "maxOrder"}], "}"}]}], "]"}], " ", "//", "Normal"}]}]}], "Input",
 CellChangeTimes->{{3.6616227595602694`*^9, 3.6616227766796503`*^9}, {
  3.6616228394594307`*^9, 3.661622872341851*^9}, {3.6616229402543592`*^9, 
  3.661622941989851*^9}, {3.661633359477593*^9, 3.661633360715611*^9}, {
  3.6627487537647057`*^9, 3.66274876936369*^9}, {3.6627490955324087`*^9, 
  3.662749106243683*^9}, {3.6627526508309917`*^9, 3.6627526512145567`*^9}, {
  3.6627527314079103`*^9, 3.6627527315578547`*^9}, {3.662757490479576*^9, 
  3.662757499935678*^9}}],

Cell[BoxData[
 RowBox[{"tolin", "@", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"gUUlin", ".", "gdd"}], " ", "/.", " ", "printrepl"}], 
   ")"}]}]], "Input",
 CellChangeTimes->{{3.66180649705748*^9, 3.661806518924033*^9}, {
  3.6627526578222*^9, 3.6627526582059526`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"eomtmp2", " ", "=", " ", 
   RowBox[{
    RowBox[{"covDiv", "[", 
     RowBox[{
      RowBox[{"gUUlin", ".", 
       RowBox[{"covD", "[", 
        RowBox[{"phi", "[", 
         RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "]"}]}], ",", 
      "1"}], "]"}], " ", "//", " ", "FullSimplify"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.659213984446457*^9, 3.6592140165301533`*^9}, {
   3.659214079454344*^9, 3.6592141197235193`*^9}, {3.6592143219106903`*^9, 
   3.659214381024578*^9}, {3.659214540282854*^9, 3.659214549824751*^9}, {
   3.659214698842856*^9, 3.6592147557365828`*^9}, {3.6592148287619553`*^9, 
   3.659214833049459*^9}, {3.659214941697033*^9, 3.659214950600512*^9}, {
   3.659215026730626*^9, 3.659215087767284*^9}, {3.659215333484338*^9, 
   3.6592153424571247`*^9}, {3.659215839196046*^9, 3.659215839323812*^9}, 
   3.66180643675191*^9, {3.661806575379574*^9, 3.6618065908254766`*^9}, {
   3.6627526359280148`*^9, 3.662752635999852*^9}, {3.6627526695134783`*^9, 
   3.66275269412805*^9}, {3.662757511503405*^9, 3.6627575222303333`*^9}}],

Cell[BoxData[
 RowBox[{"eomrepl2", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"fullnice", "@", 
        RowBox[{"(", "eomtmp2", ")"}]}], " ", "\[Equal]", " ", "Vprime"}], 
      ",", " ", "ddphi"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], " ", "//", " ", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.6618062171509247`*^9, 3.661806217238752*^9}, 
   3.661806298130126*^9, 3.661806441423592*^9, 3.661806588130539*^9, {
   3.661806722315258*^9, 3.6618067287679377`*^9}, {3.662748644771586*^9, 
   3.662748652689533*^9}, {3.6627575333254843`*^9, 3.66275755662044*^9}}],

Cell[BoxData[
 RowBox[{"rhs2", " ", "=", " ", 
  RowBox[{
   RowBox[{"fullnice", "@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"ddphi", " ", "/.", " ", "eomrepl2"}], ")"}], " ", "/.", " ", 
      "dPsirepl"}], ")"}]}], " ", "//.", " ", "mathrepl"}]}]], "Input",
 CellChangeTimes->{{3.661806263035693*^9, 3.6618062657875223`*^9}, {
  3.6627491171166487`*^9, 3.662749123922477*^9}, {3.6627573955971527`*^9, 
  3.6627573979002113`*^9}, {3.662757585464381*^9, 3.662757585584182*^9}, {
  3.662757622422583*^9, 3.6627576569333878`*^9}}],

Cell[BoxData[
 RowBox[{"getCoefficients", "[", "rhs2", "]"}]], "Input",
 CellChangeTimes->{{3.66275759169621*^9, 3.662757624653698*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["compare eom from different methods", "Subsection",
 CellChangeTimes->{{3.661806085548218*^9, 3.661806086571659*^9}, {
  3.662757668783618*^9, 3.6627576723114443`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rhs1", " ", "\[Equal]", " ", "rhs2"}], " ", "//", " ", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.661806087947262*^9, 3.6618060924289713`*^9}, {
  3.6627450775021753`*^9, 3.6627450783581038`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["compute the stress energy", "Subsection",
 CellChangeTimes->{{3.6616300238827763`*^9, 3.661630030713537*^9}, {
  3.662743125985857*^9, 3.662743126863284*^9}, {3.662837305976869*^9, 
  3.662837307808751*^9}}],

Cell[TextData[{
 "this is ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["\[PartialD]", "\[Mu]"], "\[Phi]"}], " ", 
    RowBox[{
     SubscriptBox["\[PartialD]", "\[Nu]"], "\[Phi]"}]}], TraditionalForm]]]
}], "Text",
 CellChangeTimes->{{3.662757683047183*^9, 3.662757695565131*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"phidd", " ", "=", " ", 
   RowBox[{"Outer", "[", 
    RowBox[{"Times", ",", 
     RowBox[{"covD", "[", 
      RowBox[{"phi", "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "]"}], ",", 
     RowBox[{"covD", "[", 
      RowBox[{"phi", "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "]"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.661629699067011*^9, 3.661629707010198*^9}, {
  3.6616298103080263`*^9, 3.661629810723523*^9}, {3.662743172610839*^9, 
  3.662743201569762*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"phidd", " ", "\[Equal]", 
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{"covD", "[", 
       RowBox[{"phi", "[", 
        RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "]"}], "}"}], 
     "]"}], ".", 
    RowBox[{"{", 
     RowBox[{"covD", "[", 
      RowBox[{"phi", "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "]"}], "}"}]}]}], 
  " ", "//", " ", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.66276275989142*^9, 3.662762763449821*^9}, {
   3.6627628555273952`*^9, 3.6627629684545097`*^9}, 3.6627631040581503`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Tdd", " ", "=", 
   RowBox[{"phidd", " ", "-", " ", 
    RowBox[{"gdd", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"Contract", "[", 
         RowBox[{
          RowBox[{"Raise", "[", 
           RowBox[{"phidd", ",", "1"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], " ", "+", " ", 
       RowBox[{"V", "[", 
        RowBox[{"phi", "[", 
         RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "]"}]}], 
      ")"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.661629406378508*^9, 3.6616294504412746`*^9}, {
  3.661629502205143*^9, 3.66162952562075*^9}, {3.661629660880801*^9, 
  3.661629661358799*^9}, {3.661629712744615*^9, 3.661629723112254*^9}, {
  3.661629759962866*^9, 3.661629860547565*^9}, {3.6616300471229963`*^9, 
  3.6616300647456093`*^9}, {3.661793855965024*^9, 3.6617938564141283`*^9}, {
  3.6627432076734123`*^9, 3.662743212715396*^9}, {3.6627433509549637`*^9, 
  3.6627433761618147`*^9}, {3.662743451145049*^9, 3.662743452280691*^9}, {
  3.662744414986623*^9, 3.662744421665662*^9}, {3.662757707216219*^9, 
  3.66275773592704*^9}, {3.662757775807651*^9, 3.662757776743191*^9}, {
  3.662837515695465*^9, 3.662837515960487*^9}}],

Cell["short check:", "Text",
 CellChangeTimes->{{3.6627613753015537`*^9, 3.662761376909227*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"phidd", " ", "-", " ", 
    RowBox[{"gdd", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{
         RowBox[{"covD", "[", 
          RowBox[{"phi", "[", 
           RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "]"}], ".", 
         "gUU", ".", 
         RowBox[{"covD", "[", 
          RowBox[{"phi", "[", 
           RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "]"}]}]}], " ",
        "+", " ", 
       RowBox[{"V", "[", 
        RowBox[{"phi", "[", 
         RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "]"}]}], 
      ")"}]}]}], " ", "\[Equal]", " ", "Tdd"}], " ", "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.662761271247225*^9, 3.6627613996440573`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"TUd", " ", "=", " ", 
   RowBox[{"Raise", "[", 
    RowBox[{"Tdd", ",", " ", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TUU", " ", "=", " ", 
   RowBox[{"Raise", "[", 
    RowBox[{"TUd", ",", " ", "2"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.661629935147769*^9, 3.661629953459831*^9}, {
  3.66163025235312*^9, 3.661630285600066*^9}, {3.662743416038641*^9, 
  3.662743493541897*^9}, {3.662837526694429*^9, 3.66283752690217*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"fullnice", "@", 
     RowBox[{"(", 
      RowBox[{"TUd", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], ")"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"dphi", ",", "gphi", ",", "V"}], "}"}]}], "]"}], " ", "//.", " ",
   "mathrepl"}]], "Input",
 CellChangeTimes->{{3.661630269263316*^9, 3.6616302763522797`*^9}, {
  3.661630372384804*^9, 3.661630384458547*^9}, {3.662743467719653*^9, 
  3.6627434716551332`*^9}, {3.662757917310246*^9, 3.662757918717752*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Tdd", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "/.", " ", "printrepl"}], 
    ")"}], " ", "/.", " ", "oprepl"}], " ", "//", " ", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fullnice", "@", 
    RowBox[{"Tdd", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1"}], "]"}], "]"}]}], " ", "/.", " ", "mathrepl"}], 
  " ", "//", " ", "Expand"}]}], "Input",
 CellChangeTimes->{{3.662837532083848*^9, 3.662837566383834*^9}, {
  3.6628394206604652`*^9, 3.6628394220604477`*^9}, {3.662840365455936*^9, 
  3.662840367567483*^9}}],

Cell["check rho", "Text",
 CellChangeTimes->{{3.66284094416696*^9, 3.662840945515975*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"fullnice", "@", 
     RowBox[{"(", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"TUU", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], 
        RowBox[{"gUU", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]]}], ")"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"dphi", ",", " ", "gphi", ",", " ", "V"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rhorepl", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"V", " ", "\[Rule]", " ", 
     RowBox[{"rho", " ", "-", " ", "%", " ", "+", "V"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{" ", 
  RowBox[{"%", "/.", " ", "mathrepl"}]}]}], "Input",
 CellChangeTimes->{{3.6628409502072687`*^9, 3.662841025323824*^9}, {
  3.662994297265051*^9, 3.6629943751639433`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Tdd", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "i"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2", ",", "4"}], "}"}]}], "]"}], " ", "/.", " ", 
     "printrepl"}], ")"}], " ", "/.", " ", "oprepl"}], " ", "//", " ", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fullnice", "@", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"Tdd", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "i"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "2", ",", "4"}], "}"}]}], "]"}]}], " ", "/.", " ", 
  "mathrepl"}]}], "Input",
 CellChangeTimes->{{3.662839379847125*^9, 3.662839397695595*^9}, {
  3.6628394503473673`*^9, 3.662839495800701*^9}, {3.662851225597476*^9, 
  3.6628512268464518`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["einstein tensor", "Subsection",
 CellChangeTimes->{{3.6628356350870857`*^9, 3.66283563790274*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Edd", " ", "=", " ", 
   RowBox[{
    RowBox[{"Lower", "[", 
     RowBox[{"EUd", ",", "1"}], "]"}], " ", "//", " ", "Simplify"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.662837597124399*^9, 3.662837610930882*^9}}],

Cell[CellGroupData[{

Cell["00 component", "Subsubsection",
 CellChangeTimes->{{3.662948253152104*^9, 3.6629482548077602`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Edd", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "/.", " ", "printrepl"}],
       ")"}], " ", "/.", " ", "oprepl"}], " ", "//", " ", "Simplify"}], " ", "//",
    " ", "Expand"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fullnice", "@", "%"}], " ", "//", " ", "Expand"}]}], "Input",
 CellChangeTimes->{{3.662947764880331*^9, 3.6629478026341553`*^9}, {
  3.662947842643272*^9, 3.6629478447392817`*^9}, {3.662947880852138*^9, 
  3.6629479113871317`*^9}, {3.66294795822089*^9, 3.662947985652824*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fullnice", "@", 
   RowBox[{"(", 
    RowBox[{"Edd", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1"}], "]"}], "]"}], ")"}]}], " ", "//", " ", 
  "Expand"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", " ", "/.", " ", "quadPsirepl"}], " ", "/.", " ", 
  "mathrepl"}]}], "Input",
 CellChangeTimes->{{3.6628356405491543`*^9, 3.662835763345641*^9}, {
  3.662837435541972*^9, 3.6628374655536337`*^9}, {3.6628376151461067`*^9, 
  3.662837618201888*^9}, {3.662837863830597*^9, 3.662837864963272*^9}, {
  3.66283952047889*^9, 3.6628395265016747`*^9}, {3.662840177009997*^9, 
  3.662840179402123*^9}, {3.662948225025044*^9, 3.662948226673142*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fullnice", "@", 
   RowBox[{"(", 
    RowBox[{"EUd", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1"}], "]"}], "]"}], ")"}]}], " ", "//", " ", 
  "Expand"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", " ", "/.", " ", "quadPsirepl"}], " ", "/.", " ", 
  "mathrepl"}]}], "Input",
 CellChangeTimes->{{3.662948066439505*^9, 3.662948066999762*^9}, {
  3.6629482158680277`*^9, 3.662948217080635*^9}}],

Cell["check", "Text",
 CellChangeTimes->{{3.662845541683869*^9, 3.662845542027623*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SeriesCoefficient", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Edd", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "/.", " ", "printrepl"}],
       ")"}], " ", "/.", " ", "oprepl"}], ",", 
    RowBox[{"{", 
     RowBox[{"Psi", ",", "0", ",", "0"}], "}"}]}], "]"}], " ", "/.", " ", 
  "quadPsirepl"}]], "Input",
 CellChangeTimes->{{3.662845451848196*^9, 3.662845485294786*^9}, {
  3.6628455253190193`*^9, 3.662845536696322*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["0i component", "Subsubsection",
 CellChangeTimes->{{3.6629482687757893`*^9, 3.6629482703441057`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"fullnice", "@", 
    RowBox[{"(", 
     RowBox[{"Edd", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "2"}], "]"}], "]"}], ")"}]}], " ", "//", " ", 
   "Expand"}], " ", "//", " ", "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Expand", "@", "%"}], " ", "/.", " ", "quadPsirepl"}]}], "Input",
 CellChangeTimes->{{3.662948279458457*^9, 3.6629483353640537`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"fullnice", "@", 
    RowBox[{"(", 
     RowBox[{"EUd", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "2"}], "]"}], "]"}], ")"}]}], " ", "//", " ", 
   "Expand"}], " ", "//", " ", "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Expand", "@", "%"}], " ", "/.", " ", "quadPsirepl"}]}], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["ii component", "Subsubsection",
 CellChangeTimes->{{3.662948376556822*^9, 3.662948381627219*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"fullnice", "@", 
    RowBox[{"(", 
     RowBox[{"EUd", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "2"}], "]"}], "]"}], ")"}]}], " ", "//", " ", 
   "Expand"}], " ", "//", " ", "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Expand", "@", "%"}], " ", "/.", " ", "quadPsirepl"}]}], "Input",
 CellChangeTimes->{{3.662948387989661*^9, 3.662948414229577*^9}}],

Cell["\<\
check with another independent package and manual computation\
\>", "Text",
 CellChangeTimes->{{3.662840551037323*^9, 3.662840551355151*^9}, {
  3.6628408799052963`*^9, 3.6628408918407593`*^9}}],

Cell[BoxData[{
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Import", "[", "\"\<EinsteinTensor.m\>\"", "]"}]}], "Input",
 CellChangeTimes->{{3.6628407586136427`*^9, 3.662840762289159*^9}, {
  3.662840797839612*^9, 3.662840825199603*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Edd", " ", "\[Equal]", " ", 
   RowBox[{"EinsteinTensor", "[", 
    RowBox[{"g", ",", "coords"}], "]"}]}], " ", "//", " ", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.662840831220831*^9, 3.662840873675518*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Eddalt", " ", "=", " ", 
   RowBox[{
    RowBox[{"Rdd", " ", "-", " ", 
     RowBox[{
      FractionBox["1", "2"], " ", "gdd", " ", "R"}]}], " ", "//", " ", 
    "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Eddalt", " ", "\[Equal]", " ", "Edd"}], " ", "//", 
  "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.6628405538529663`*^9, 3.662840580595978*^9}, {
  3.662851286508224*^9, 3.662851286899494*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["full einstein equations", "Subsection",
 CellChangeTimes->{{3.662837572097866*^9, 3.662837577201663*^9}, {
  3.6628411554514637`*^9, 3.6628411559379377`*^9}, {3.6629124392494087`*^9, 
  3.6629124401748962`*^9}, {3.66291644639305*^9, 3.662916447158888*^9}}],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{"einstein", " ", "=", " ", 
    RowBox[{"Edd", " ", "-", " ", 
     RowBox[{"8", " ", "\[Pi]", " ", "Gnew", " ", "Tdd"}]}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.6628375808219213`*^9, 3.662837595601864*^9}, {
  3.662837625616219*^9, 3.662837671438341*^9}, {3.662838693749514*^9, 
  3.66283870127652*^9}, {3.6628387395717773`*^9, 3.662838772504634*^9}, {
  3.6628399951008043`*^9, 3.662840021947027*^9}, {3.6628401845707483`*^9, 
  3.6628402055528316`*^9}, {3.662851306195644*^9, 3.662851310659032*^9}, {
  3.662851346507698*^9, 3.662851349043154*^9}, {3.662912449080551*^9, 
  3.662912453488081*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rhobarrepl", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     SuperscriptBox["H", "2"], " ", "\[Rule]", " ", 
     RowBox[{
      FractionBox["8", "3"], " ", "\[Pi]", " ", "Gnew", " ", "rhobar"}]}], 
    "}"}]}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell["00 component", "Subsubsection",
 CellChangeTimes->{{3.662838660975135*^9, 3.6628386623493633`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Expand", "@", 
        RowBox[{"fullnice", "@", 
         RowBox[{"EUd", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], ")"}], "/.", " ", 
      "quadPsirepl"}], ")"}], " ", "\[Equal]", " ", 
    RowBox[{"8", " ", "\[Pi]", " ", "Gnew", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Expand", "@", 
         RowBox[{"fullnice", "@", 
          RowBox[{"TUd", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], ")"}], " ", "/.", " ", 
       "quadPsirepl"}], ")"}]}]}], "//", " ", "Simplify"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Collect", "[", 
     RowBox[{
      RowBox[{"lPsi", " ", "/.", " ", 
       RowBox[{
        RowBox[{"Solve", "[", 
         RowBox[{"%", ",", "lPsi"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"gphi", ",", " ", "dphi", ",", " ", "V"}], "}"}]}], "]"}], " ",
     "/.", " ", "rhorepl"}], " ", "/.", " ", "rhobarrepl"}], " ", "//", " ", 
  "Simplify"}]}], "Input",
 CellChangeTimes->{{3.66299088721568*^9, 3.662991009068778*^9}, {
   3.662991136808778*^9, 3.6629911694142838`*^9}, {3.662991251926654*^9, 
   3.6629912794188557`*^9}, {3.662991482027676*^9, 3.6629915648214617`*^9}, {
   3.662991720031201*^9, 3.6629917337639027`*^9}, {3.662991870932041*^9, 
   3.662991874054694*^9}, {3.6629929766257267`*^9, 3.66299298596935*^9}, {
   3.662994059849107*^9, 3.662994068727518*^9}, {3.662994186590514*^9, 
   3.662994241971259*^9}, {3.662994398498859*^9, 3.6629944032438297`*^9}, {
   3.662994438457247*^9, 3.662994441142514*^9}, {3.662994486931011*^9, 
   3.662994488939106*^9}, 3.662995292491696*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"lPsirepl", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{"fullnice", "@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"einstein", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "\[Equal]", " ", 
           "0"}], ")"}]}], ",", " ", "lPsi"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], " ", "/.", " ", "quadPsirepl"}], " ", "//",
     " ", "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Expand", "@", 
       RowBox[{"(", 
        RowBox[{"fullnice", "@", 
         RowBox[{"(", 
          RowBox[{"lPsi", " ", "/.", "lPsirepl"}], ")"}]}], ")"}]}], "/.", 
      " ", "quadPsirepl"}], ")"}], " ", "//", " ", "Simplify"}], " ", "//", 
   " ", "Expand"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Expand", "@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"SeriesCoefficient", "[", 
        RowBox[{"%", ",", 
         RowBox[{"{", 
          RowBox[{"Psi", ",", "0", ",", "#"}], "}"}]}], "]"}], " ", "/", " ", 
       
       RowBox[{"(", 
        RowBox[{"4", " ", "\[Pi]", " ", "Gnew"}], ")"}]}], " ", "/.", " ", 
      "mathrepl"}], ")"}]}], " ", "&"}], "/@", " ", 
  RowBox[{"{", 
   RowBox[{"0", ",", "1"}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.662837673460247*^9, 3.662837708179986*^9}, {
   3.662837739778674*^9, 3.662837750066557*^9}, 3.6628380539623547`*^9, {
   3.66283812806911*^9, 3.6628381291889973`*^9}, {3.6628387497864017`*^9, 
   3.6628387791363773`*^9}, {3.66284571611526*^9, 3.6628457234090853`*^9}, {
   3.662851355002821*^9, 3.66285141866778*^9}, {3.662910269485697*^9, 
   3.662910296889105*^9}, {3.66299528572581*^9, 3.662995287715557*^9}}],

Cell["check", "Text",
 CellChangeTimes->{{3.662852344081736*^9, 3.6628523444161386`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Simplify", "[", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"einstein", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "\[Equal]", " ", 
            "0"}], ")"}], " ", "/.", " ", "printrepl"}], ")"}], "]"}], " ", "/.",
        " ", "oprepl"}], ",", 
      RowBox[{"{", "lPsi", "}"}]}], " ", "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], " ", "//", " ", "FullSimplify"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Expand", "@", 
     RowBox[{"fullnice", "@", 
      RowBox[{"(", 
       RowBox[{"lPsi", " ", "/.", " ", "%"}], ")"}]}]}], " ", "/.", " ", 
    "quadPsirepl"}], " ", "//", " ", "FullSimplify"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Expand", "@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"SeriesCoefficient", "[", 
        RowBox[{"%", ",", 
         RowBox[{"{", 
          RowBox[{"Psi", ",", "0", ",", "#"}], "}"}]}], "]"}], " ", "/", " ", 
       
       RowBox[{"(", 
        RowBox[{"4", " ", "\[Pi]", " ", "Gnew"}], ")"}]}], " ", "/.", " ", 
      "mathrepl"}], ")"}]}], " ", "&"}], "/@", " ", 
  RowBox[{"{", 
   RowBox[{"0", ",", "1"}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.662852100828414*^9, 3.662852278726028*^9}, {
   3.66285234877962*^9, 3.662852414319208*^9}, 3.6628525432021847`*^9, 
   3.6629102539775057`*^9}],

Cell["check 2", "Text",
 CellChangeTimes->{{3.6629102374933*^9, 3.662910238125016*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"fullnice", "@", 
        RowBox[{"Edd", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], " ", "\[Equal]", " ", 
       RowBox[{"8", " ", "\[Pi]", " ", "Gnew", " ", 
        RowBox[{"fullnice", "@", 
         RowBox[{"Tdd", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}]}], ",", " ", "lPsi"}], 
     "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], " ", "//", " ", "FullSimplify"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Expand", "@", 
     RowBox[{"fullnice", "@", 
      RowBox[{"(", 
       RowBox[{"lPsi", " ", "/.", " ", "%"}], ")"}]}]}], " ", "/.", " ", 
    "quadPsirepl"}], " ", "//", " ", "FullSimplify"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Expand", "@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"SeriesCoefficient", "[", 
        RowBox[{"%", ",", 
         RowBox[{"{", 
          RowBox[{"Psi", ",", "0", ",", "#"}], "}"}]}], "]"}], " ", "/", " ", 
       
       RowBox[{"(", 
        RowBox[{"4", " ", "\[Pi]", " ", "Gnew"}], ")"}]}], " ", "/.", " ", 
      "mathrepl"}], ")"}]}], " ", "&"}], "/@", " ", 
  RowBox[{"{", 
   RowBox[{"0", ",", "1"}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.662910077188126*^9, 3.662910178181398*^9}, {
   3.6629102088039923`*^9, 3.66291020957997*^9}, 3.662910255183424*^9}],

Cell["check 3", "Text",
 CellChangeTimes->{{3.66291164647956*^9, 3.662911647805963*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"fullnice", "@", 
        RowBox[{"EUd", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], " ", "\[Equal]", " ", 
       RowBox[{"8", " ", "\[Pi]", " ", "Gnew", " ", 
        RowBox[{"fullnice", "@", 
         RowBox[{"TUd", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}]}], ",", " ", "lPsi"}], 
     "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], " ", "//", " ", "FullSimplify"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Expand", "@", 
     RowBox[{"fullnice", "@", 
      RowBox[{"(", 
       RowBox[{"lPsi", " ", "/.", " ", "%"}], ")"}]}]}], " ", "/.", " ", 
    "quadPsirepl"}], " ", "//", " ", "FullSimplify"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Expand", "@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"SeriesCoefficient", "[", 
        RowBox[{"%", ",", 
         RowBox[{"{", 
          RowBox[{"Psi", ",", "0", ",", "#"}], "}"}]}], "]"}], " ", "/", " ", 
       
       RowBox[{"(", 
        RowBox[{"4", " ", "\[Pi]", " ", "Gnew"}], ")"}]}], " ", "/.", " ", 
      "mathrepl"}], ")"}]}], " ", "&"}], "/@", " ", 
  RowBox[{"{", 
   RowBox[{"0", ",", "1"}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.662911658857451*^9, 3.6629116619771357`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SeriesCoefficient", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"fullnice", "@", 
        RowBox[{"(", 
         RowBox[{"lPsi", " ", "/.", " ", "lPsirepl"}], ")"}]}], " ", "/.", 
       " ", 
       RowBox[{"{", 
        RowBox[{
         SuperscriptBox["H", "2"], " ", "\[Rule]", " ", 
         RowBox[{
          FractionBox["8", "3"], " ", "\[Pi]", " ", "Gnew", " ", 
          RowBox[{"(", 
           RowBox[{
            FractionBox[
             SuperscriptBox["gphi", "2"], 
             RowBox[{"2", " ", 
              SuperscriptBox["a", "2"]}]], " ", "+", " ", 
            FractionBox[
             SuperscriptBox["dphi", "2"], "2"], " ", "+", " ", "V"}], 
           ")"}]}]}], "}"}]}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"Psi", ",", " ", "0", ",", " ", "#"}], "}"}]}], "]"}], " ", 
    "&"}], " ", "/@", " ", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}]}], " ", "//", " ", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"%", "/.", "dPsirepl"}], "  ", "/.", " ", "grepl"}], "//", " ", 
  "Simplify"}]}], "Input",
 CellChangeTimes->{{3.662924367906905*^9, 3.6629244653818808`*^9}, {
  3.662924501887603*^9, 3.662924586895419*^9}}],

Cell[BoxData[
 RowBox[{"dPsi", "/.", " ", "dPsirepl"}]], "Input",
 CellChangeTimes->{{3.662926112727703*^9, 3.662926115446953*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["0i components", "Subsubsection",
 CellChangeTimes->{{3.662844683432989*^9, 3.662844685192794*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Tdd", "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", "/.", " ", 
  "printrepl"}]], "Input",
 CellChangeTimes->{{3.662912850843449*^9, 3.662912886983438*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Expand", "@", 
   RowBox[{"fullnice", "@", 
    RowBox[{"Edd", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], " ", "/.", " ", 
  "quadPsirepl"}]], "Input",
 CellChangeTimes->{{3.662912967045958*^9, 3.662913016186171*^9}}],

Cell[BoxData[
 RowBox[{"Expand", "[", 
  RowBox[{"fullnice", "@", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"einstein", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", "\[Equal]", " ", "0"}], 
    ")"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.662844852100308*^9, 3.662844950765876*^9}, {
  3.662845303191169*^9, 3.662845306943549*^9}, {3.662851481590166*^9, 
  3.662851504164876*^9}, {3.662851786619926*^9, 3.6628518039181423`*^9}, {
  3.662912318308612*^9, 3.662912318532426*^9}}],

Cell["check", "Text",
 CellChangeTimes->{{3.6629119051650953`*^9, 3.662911905452614*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Simplify", "[", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"einstein", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", "\[Equal]", " ", "0"}], 
      ")"}], " ", "/.", " ", "printrepl"}], ")"}], "]"}], " ", "/.", " ", 
  "oprepl"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Expand", "@", 
    RowBox[{"fullnice", "@", "%"}]}], " ", "/.", " ", "quadPsirepl"}], " ", "//",
   " ", "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.662911908649398*^9, 3.662911991185131*^9}, {
  3.66291216611639*^9, 3.6629121924349403`*^9}, {3.662912337043416*^9, 
  3.662912340050956*^9}, {3.662912545900371*^9, 3.6629125688257236`*^9}}],

Cell["check2", "Text",
 CellChangeTimes->{{3.6629122200793858`*^9, 3.662912220847054*^9}}],

Cell[BoxData[{
 RowBox[{"(", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"fullnice", "@", 
      RowBox[{"Edd", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}]}], " ", "\[Equal]", " ", 
     RowBox[{"8", " ", "\[Pi]", " ", "Gnew", " ", 
      RowBox[{"Tdd", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], ")"}], " ", "/.", " ", 
   "printrepl"}], ")"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Expand", "@", 
    RowBox[{"fullnice", "@", "%"}]}], " ", "/.", " ", "quadPsirepl"}], " ", "//",
   " ", "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.662912230112905*^9, 3.6629123030302973`*^9}, {
  3.662912514675992*^9, 3.66291251602041*^9}}],

Cell[BoxData[{
 RowBox[{"EU1d2", " ", "=", " ", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Expand", "@", 
      RowBox[{"fullnice", "@", 
       RowBox[{"EUd", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], "/.", " ", 
     "quadPsirepl"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{
     "gphi", ",", " ", "V", ",", " ", "dphi", ",", " ", "lPsi", ",", " ", 
      "dPsi"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Ed1d2", " ", "=", " ", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Expand", "@", 
      RowBox[{"fullnice", "@", 
       RowBox[{"Edd", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], "/.", " ", 
     "quadPsirepl"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{
     "gphi", ",", " ", "V", ",", " ", "dphi", ",", " ", "lPsi", ",", " ", 
      "dPsi"}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.662992997381489*^9, 3.662993027706861*^9}, {
  3.662993063178913*^9, 3.662993184806238*^9}, {3.662993261678239*^9, 
  3.662993277694687*^9}, {3.66299482748073*^9, 3.662994827592031*^9}, {
  3.662994858168776*^9, 3.6629948588323383`*^9}, {3.662995031222283*^9, 
  3.662995035815126*^9}}],

Cell[BoxData[{
 RowBox[{"TU1d2", " ", "=", " ", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"fullnice", "@", 
      RowBox[{"TUd", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "/.", " ", "quadPsirepl"}], 
    ",", " ", 
    RowBox[{"{", 
     RowBox[{"gphi", ",", " ", "V", ",", " ", "dphi"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Td1d2", " ", "=", " ", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"fullnice", "@", 
      RowBox[{"Tdd", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "/.", " ", "quadPsirepl"}], 
    ",", " ", 
    RowBox[{"{", 
     RowBox[{"gphi", ",", " ", "V", ",", " ", "dphi"}], "}"}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.6629931866790323`*^9, 3.662993196742524*^9}, {
  3.662993243294998*^9, 3.662993253189905*^9}, {3.662994835000374*^9, 
  3.662994861432088*^9}, {3.662995042550597*^9, 3.662995048069971*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"EU1d2", " ", "\[Equal]", " ", 
     RowBox[{"8", " ", "\[Pi]", " ", "Gnew", " ", "TU1d2"}]}], " ", "/.", " ",
     "rhorepl"}], " ", "/.", " ", "rhobarrepl"}], " ", "//", " ", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Ed1d2", " ", "\[Equal]", " ", 
     RowBox[{"8", " ", "\[Pi]", " ", "Gnew", " ", "Td1d2"}]}], " ", "/.", " ",
     "rhorepl"}], " ", "/.", " ", "rhobarrepl"}], " ", "//", " ", 
  "Simplify"}]}], "Input",
 CellChangeTimes->{{3.662993281739539*^9, 3.662993313811242*^9}, {
  3.662994865463339*^9, 3.662994866015559*^9}, {3.662995012030341*^9, 
  3.662995012853847*^9}, {3.662995057221806*^9, 3.662995065245919*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["11 component", "Subsubsection",
 CellChangeTimes->{{3.662838666461183*^9, 3.662838669148559*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Expand", "[", 
    RowBox[{"fullnice", "@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"einstein", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "i"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", "4"}], "}"}]}], "]"}], " ", "\[Equal]", 
       " ", "0"}], ")"}]}], "]"}], " ", "/.", " ", "quadPsirepl"}], " ", "//",
   " ", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.66283868115659*^9, 3.662838689052863*^9}, {
  3.662838793206758*^9, 3.662838816661948*^9}, {3.662838879531052*^9, 
  3.662838891890024*^9}, {3.662838930591992*^9, 3.6628389763061533`*^9}, {
  3.662851908794909*^9, 3.662852031901939*^9}}],

Cell["check", "Text",
 CellChangeTimes->{{3.662914657644808*^9, 3.662914657995442*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"Tdd", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "i"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "2", ",", "4"}], "}"}]}], "]"}], " ", "/.", 
      "printrepl"}], ")"}], " ", "/.", " ", "oprepl"}], " ", "//", " ", 
   "Simplify"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Tspacesum", " ", "=", " ", 
  RowBox[{
   RowBox[{"Expand", "@", 
    RowBox[{"fullnice", "@", "%"}]}], " ", "/.", " ", 
   "quadPsirepl"}]}]}], "Input",
 CellChangeTimes->{{3.662915547685666*^9, 3.662915573005748*^9}, 
   3.6629156750331173`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"Edd", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "i"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "2", ",", "4"}], "}"}]}], "]"}], " ", "/.", 
      "printrepl"}], ")"}], " ", "/.", " ", "oprepl"}], " ", "//", " ", 
   "Simplify"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Gspacesum", " ", "=", " ", 
  RowBox[{
   RowBox[{"Expand", "@", 
    RowBox[{"fullnice", "@", "%"}]}], " ", "/.", " ", 
   "quadPsirepl"}]}]}], "Input",
 CellChangeTimes->{{3.662915487793066*^9, 3.662915531984672*^9}, {
   3.662915575213893*^9, 3.6629155772297707`*^9}, 3.662915667440955*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Gspacesum", " ", "\[Equal]", " ", 
   RowBox[{"8", " ", "\[Pi]", " ", "Gnew", " ", "Tspacesum"}]}], " ", "//", 
  " ", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.66291558004014*^9, 3.662915593204425*^9}}],

Cell["check 2", "Text",
 CellChangeTimes->{{3.662915610521109*^9, 3.662915613408506*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"einstein", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "i"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "2", ",", "4"}], "}"}]}], "]"}], " ", "\[Equal]",
         " ", "0"}], ")"}], " ", "/.", " ", "printrepl"}], ")"}], "]"}], " ", 
   "/.", " ", "oprepl"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Expand", "@", 
    RowBox[{"fullnice", "@", "%"}]}], " ", "/.", " ", "quadPsirepl"}], " ", "//",
   " ", "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.662915200537732*^9, 3.662915218899558*^9}, 
   3.662915666242989*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
compute the perturbed stress energy by subtracting background\
\>", "Subsection",
 CellChangeTimes->{{3.662837336319007*^9, 3.662837348358368*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"rhoeq", " ", "=", " ", 
   RowBox[{"rho", " ", "\[Equal]", "  ", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"TUU", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], 
      RowBox[{"gUU", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}]]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"fullnice", "@", 
     RowBox[{"(", 
      RowBox[{"rho", " ", "/.", " ", 
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{"fullnice", "@", "rhoeq"}], ",", "rho"}], "]"}]}], ")"}]}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"dphi", ",", " ", 
      SuperscriptBox["gphi", "2"], ",", "V"}], "}"}]}], "]"}], " ", "//.", 
  "mathrepl"}]}], "Input",
 CellChangeTimes->{{3.662743545909696*^9, 3.6627436160062323`*^9}, {
  3.6627579379828987`*^9, 3.662757988087451*^9}, {3.662762138828431*^9, 
  3.662762139356111*^9}, {3.662762171262698*^9, 3.662762252633892*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    RowBox[{"gUU", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1"}], "]"}], "]"}]}], " ", 
   RowBox[{"gdd", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}]}], " ", "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.6627449839595947`*^9, 3.662745002802326*^9}, {
  3.662745172948123*^9, 3.662745190875626*^9}, {3.662748813600501*^9, 
  3.66274881400038*^9}}],

Cell[BoxData[
 RowBox[{"TU0d0bar", " ", "=", " ", 
  RowBox[{
   RowBox[{"fullnice", "@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", " ", 
       RowBox[{"gdd", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], " ", 
      RowBox[{"gUU", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "rhobar"}], ")"}]}], "//",
    " ", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.6627622817199993`*^9, 3.66276239435714*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"delTU0d0", " ", "=", " ", 
   RowBox[{
    RowBox[{"TUd", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "-", " ", "TU0d0bar"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fullnice", "@", "delTU0d0"}], " ", "/.", " ", 
  "mathrepl"}]}], "Input",
 CellChangeTimes->{{3.66163080643683*^9, 3.661630814199485*^9}, {
   3.661811146371718*^9, 3.661811147954337*^9}, {3.6618111836258717`*^9, 
   3.6618112192550907`*^9}, {3.662744261299913*^9, 3.662744262539584*^9}, {
   3.6627452319873247`*^9, 3.6627452337712603`*^9}, {3.662745299577922*^9, 
   3.662745331968676*^9}, {3.662745973109149*^9, 3.66274597316857*^9}, {
   3.662746065148644*^9, 3.662746072931921*^9}, {3.662758065494596*^9, 
   3.662758069846237*^9}, {3.6627621130404587`*^9, 3.6627621226241207`*^9}, {
   3.6627622685522013`*^9, 3.6627622771672792`*^9}, {3.662762404892385*^9, 
   3.6627624116278267`*^9}, 3.662850772568591*^9}],

Cell[BoxData[
 RowBox[{"Td0d0bar", " ", "=", " ", 
  RowBox[{
   RowBox[{"fullnice", "@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"gdd", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], " ", "rhobar"}], ")"}]}], 
   " ", "//", " ", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.662850680220354*^9, 3.6628507100178823`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"delTd0d0", " ", "=", " ", 
   RowBox[{
    RowBox[{"Tdd", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "-", " ", "Td0d0bar"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fullnice", "@", "delTd0d0"}], " ", "/.", " ", 
  "mathrepl"}]}], "Input",
 CellChangeTimes->{{3.662850570808607*^9, 3.6628505750261183`*^9}, {
  3.6628506549649057`*^9, 3.662850668308735*^9}, {3.662850718456582*^9, 
  3.66285075952274*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["perturbed einstein tensor", "Subsection",
 CellChangeTimes->{{3.662828783861096*^9, 3.662828794123268*^9}, {
  3.662835609040531*^9, 3.662835611736215*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"g0dd", " ", "=", " ", 
   RowBox[{
    RowBox[{"gdd", " ", "/.", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Psi", "[", 
        RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
       " ", "0"}], "}"}]}], " ", "//", " ", "Simplify"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6628286001220083`*^9, 3.662828632123192*^9}, 
   3.662850908592029*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"g0UU", " ", "=", " ", 
   RowBox[{
    RowBox[{"1", "/", "g0dd"}], " ", "/.", " ", 
    RowBox[{"ComplexInfinity", "\[Rule]", " ", "0"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6628286387276907`*^9, 3.662828683115971*^9}, 
   3.662850910719558*^9}],

Cell[BoxData[
 RowBox[{"g0dd", ".", "g0UU"}]], "Input",
 CellChangeTimes->{{3.6628509005775337`*^9, 3.6628509032154408`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"delgdd", " ", "=", " ", 
   RowBox[{
    RowBox[{"gdd", " ", "-", " ", "g0dd"}], " ", "//", " ", "Simplify"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6628286889232273`*^9, 3.6628287085207653`*^9}, 
   3.662850914655305*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"delgUU", " ", "=", " ", 
   RowBox[{
    RowBox[{"gUU", " ", "-", " ", "g0UU"}], " ", "//", " ", "Simplify"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.662828730069447*^9, 3.6628287519124317`*^9}, 
   3.6628509163590527`*^9}],

Cell["check", "Text",
 CellChangeTimes->{{3.6629167238787117`*^9, 3.6629167265519037`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"delgUU", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "\[Equal]", " ", 
   RowBox[{
    RowBox[{"-", " ", 
     SuperscriptBox[
      RowBox[{"gUU", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], "2"]}], " ", 
    RowBox[{"delgdd", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], " ", "//", " ", 
  "fullnice"}]], "Input",
 CellChangeTimes->{{3.6629167284407263`*^9, 3.6629167824358673`*^9}, {
  3.662916991735115*^9, 3.662916994318287*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"hdd", " ", "=", " ", "delgdd"}], ";"}]], "Input",
 CellChangeTimes->{{3.662832098969548*^9, 3.6628321047584467`*^9}, 
   3.6628509403416767`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"delRd0d0", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      FractionBox["1", 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"a", "[", "t", "]"}], "2"]}]], " ", 
      RowBox[{"Laplacian", "[", 
       RowBox[{"hdd", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}]}], " ", "+", " ", 
     RowBox[{
      FractionBox["3", "2"], " ", 
      FractionBox[
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"a", "[", "t", "]"}], ",", "t"}], "]"}], 
       RowBox[{"a", "[", "t", "]"}]], " ", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"hdd", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "t"}], "]"}]}], " ", 
     "+", " ", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"a", "[", "t", "]"}], "2"]}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"hdd", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "i"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "2"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "2", ",", "4"}], "}"}]}], "]"}], " ", "-", " ", 
        RowBox[{"2", " ", 
         FractionBox[
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"a", "[", "t", "]"}], ",", "t"}], "]"}], 
          RowBox[{"a", "[", "t", "]"}]], " ", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"hdd", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "i"}], "]"}], "]"}], ",", "t"}], "]"}], ",", 
           
           RowBox[{"{", 
            RowBox[{"i", ",", "2", ",", "4"}], "}"}]}], "]"}]}], " ", "+", 
        " ", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            SuperscriptBox[
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"a", "[", "t", "]"}], ",", "t"}], "]"}], "2"], 
            SuperscriptBox[
             RowBox[{"a", "[", "t", "]"}], "2"]], "-", 
           FractionBox[
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"a", "[", "t", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"t", ",", "2"}], "}"}]}], "]"}], 
            RowBox[{"a", "[", "t", "]"}]]}], ")"}], " ", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"hdd", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "i"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "2", ",", "4"}], "}"}]}], "]"}]}]}], ")"}]}]}], 
    " ", "//", " ", "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"delRd0d0", " ", "/.", " ", "printrepl"}], ")"}], " ", "/.", " ", 
   "oprepl"}], " ", "//", " ", "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.662832205930285*^9, 3.662832455255748*^9}, {
   3.662832714255979*^9, 3.662832852260991*^9}, {3.662832945800969*^9, 
   3.662832970370872*^9}, 3.662833956905594*^9, {3.662842887751902*^9, 
   3.662842921717724*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"delRd1d1", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "2"]}], " ", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"hdd", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "2"}], "}"}]}], "]"}]}], " ", "-", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"a", "[", "t", "]"}], ",", "t"}], "]"}], "2"]}], " ", "+",
         " ", 
        RowBox[{
         RowBox[{"a", "[", "t", "]"}], " ", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"a", "[", "t", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "2"}], "}"}]}], "]"}]}]}], ")"}], " ", 
      RowBox[{"hdd", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}]}], " ", "-", " ", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"a", "[", "t", "]"}], " ", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"a", "[", "t", "]"}], ",", "t"}], "]"}], " ", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"hdd", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "t"}], "]"}]}], " ", 
     "+", " ", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"a", "[", "t", "]"}], "2"]}]], " ", 
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"Laplacian", "[", 
         RowBox[{"hdd", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}], "]"}], " ", "-", " ", 
        RowBox[{"2", " ", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"hdd", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", "x"}], "]"}], 
             ",", 
             RowBox[{"coords", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "2", ",", "4"}], "}"}]}], "]"}]}], " ", "+", 
        " ", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"hdd", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "i"}], "]"}], "]"}], ",", "x"}], "]"}], ",",
             "x"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "2", ",", "4"}], "}"}]}], "]"}]}], ")"}]}], " ", 
     "-", " ", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"hdd", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "2"}], "}"}]}], "]"}]}], " ", "+", " ", 
     RowBox[{
      FractionBox[
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"a", "[", "t", "]"}], ",", "t"}], "]"}], 
       RowBox[{"2", " ", 
        RowBox[{"a", "[", "t", "]"}]}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"hdd", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", "t"}], "]"}], " ", 
        "-", " ", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"hdd", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "i"}], "]"}], "]"}], ",", "t"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "2", ",", "4"}], "}"}]}], "]"}]}], ")"}]}], " ", 
     "+", " ", 
     RowBox[{
      FractionBox[
       SuperscriptBox[
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"a", "[", "t", "]"}], ",", "t"}], "]"}], "2"], 
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", " ", "2"}], " ", 
         RowBox[{"hdd", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}]}], " ", "+", " ", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"hdd", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "i"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "2", ",", "4"}], "}"}]}], "]"}]}], ")"}]}]}], 
    " ", "//", " ", "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"delRd1d1", " ", "/.", " ", "printrepl"}], ")"}], " ", "/.", " ", 
   "oprepl"}], " ", "//", " ", "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.662832990711499*^9, 3.662833328973629*^9}, {
  3.662833360022496*^9, 3.662833558985722*^9}, {3.662833618597446*^9, 
  3.662833620285187*^9}, {3.662833663993142*^9, 3.662833671024334*^9}, {
  3.6628337092053843`*^9, 3.6628337296962*^9}, {3.662833937576158*^9, 
  3.662833943459455*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"delRd2d2", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "2"]}], " ", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"hdd", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"y", ",", "2"}], "}"}]}], "]"}]}], " ", "-", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"a", "[", "t", "]"}], ",", "t"}], "]"}], "2"]}], " ", "+",
         " ", 
        RowBox[{
         RowBox[{"a", "[", "t", "]"}], " ", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"a", "[", "t", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "2"}], "}"}]}], "]"}]}]}], ")"}], " ", 
      RowBox[{"hdd", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}]}], " ", "-", " ", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"a", "[", "t", "]"}], " ", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"a", "[", "t", "]"}], ",", "t"}], "]"}], " ", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"hdd", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "t"}], "]"}]}], " ", 
     "+", " ", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"a", "[", "t", "]"}], "2"]}]], " ", 
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"Laplacian", "[", 
         RowBox[{"hdd", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "3"}], "]"}], "]"}], "]"}], " ", "-", " ", 
        RowBox[{"2", " ", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"hdd", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "3"}], "]"}], "]"}], ",", "y"}], "]"}], 
             ",", 
             RowBox[{"coords", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "2", ",", "4"}], "}"}]}], "]"}]}], " ", "+", 
        " ", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"hdd", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "i"}], "]"}], "]"}], ",", "y"}], "]"}], ",",
             "y"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "2", ",", "4"}], "}"}]}], "]"}]}], ")"}]}], " ", 
     "-", " ", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"hdd", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "3"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "2"}], "}"}]}], "]"}]}], " ", "+", " ", 
     RowBox[{
      FractionBox[
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"a", "[", "t", "]"}], ",", "t"}], "]"}], 
       RowBox[{"2", " ", 
        RowBox[{"a", "[", "t", "]"}]}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"hdd", "[", 
           RowBox[{"[", 
            RowBox[{"3", ",", "3"}], "]"}], "]"}], ",", "t"}], "]"}], " ", 
        "-", " ", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"hdd", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "i"}], "]"}], "]"}], ",", "t"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "2", ",", "4"}], "}"}]}], "]"}]}], ")"}]}], " ", 
     "+", " ", 
     RowBox[{
      FractionBox[
       SuperscriptBox[
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"a", "[", "t", "]"}], ",", "t"}], "]"}], "2"], 
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", " ", "2"}], " ", 
         RowBox[{"hdd", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "3"}], "]"}], "]"}]}], " ", "+", " ", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"hdd", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "i"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "2", ",", "4"}], "}"}]}], "]"}]}], ")"}]}]}], 
    " ", "//", " ", "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"delRd2d2", " ", "/.", " ", "printrepl"}], ")"}], " ", "/.", " ", 
   "oprepl"}], " ", "//", " ", "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.662833779573344*^9, 3.6628338708930607`*^9}, {
  3.6628339350962954`*^9, 3.662833947079002*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"delRd3d3", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "2"]}], " ", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"hdd", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"z", ",", "2"}], "}"}]}], "]"}]}], " ", "-", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"a", "[", "t", "]"}], ",", "t"}], "]"}], "2"]}], " ", "+",
         " ", 
        RowBox[{
         RowBox[{"a", "[", "t", "]"}], " ", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"a", "[", "t", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "2"}], "}"}]}], "]"}]}]}], ")"}], " ", 
      RowBox[{"hdd", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}]}], " ", "-", " ", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"a", "[", "t", "]"}], " ", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"a", "[", "t", "]"}], ",", "t"}], "]"}], " ", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"hdd", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "t"}], "]"}]}], " ", 
     "+", " ", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"a", "[", "t", "]"}], "2"]}]], " ", 
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"Laplacian", "[", 
         RowBox[{"hdd", "[", 
          RowBox[{"[", 
           RowBox[{"4", ",", "4"}], "]"}], "]"}], "]"}], " ", "-", " ", 
        RowBox[{"2", " ", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"hdd", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "4"}], "]"}], "]"}], ",", "z"}], "]"}], 
             ",", 
             RowBox[{"coords", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "2", ",", "4"}], "}"}]}], "]"}]}], " ", "+", 
        " ", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"hdd", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "i"}], "]"}], "]"}], ",", "z"}], "]"}], ",",
             "z"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "2", ",", "4"}], "}"}]}], "]"}]}], ")"}]}], " ", 
     "-", " ", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"hdd", "[", 
         RowBox[{"[", 
          RowBox[{"4", ",", "4"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "2"}], "}"}]}], "]"}]}], " ", "+", " ", 
     RowBox[{
      FractionBox[
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"a", "[", "t", "]"}], ",", "t"}], "]"}], 
       RowBox[{"2", " ", 
        RowBox[{"a", "[", "t", "]"}]}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"hdd", "[", 
           RowBox[{"[", 
            RowBox[{"4", ",", "4"}], "]"}], "]"}], ",", "t"}], "]"}], " ", 
        "-", " ", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"hdd", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "i"}], "]"}], "]"}], ",", "t"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "2", ",", "4"}], "}"}]}], "]"}]}], ")"}]}], " ", 
     "+", " ", 
     RowBox[{
      FractionBox[
       SuperscriptBox[
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"a", "[", "t", "]"}], ",", "t"}], "]"}], "2"], 
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", " ", "2"}], " ", 
         RowBox[{"hdd", "[", 
          RowBox[{"[", 
           RowBox[{"4", ",", "4"}], "]"}], "]"}]}], " ", "+", " ", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"hdd", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "i"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "2", ",", "4"}], "}"}]}], "]"}]}], ")"}]}]}], 
    " ", "//", " ", "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"delRd3d3", " ", "/.", " ", "printrepl"}], ")"}], " ", "/.", " ", 
   "oprepl"}], " ", "//", " ", "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.662833885839982*^9, 3.6628339498548317`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"delRd1d1", " ", "\[Equal]", " ", "delRd2d2"}], " ", "//", " ", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"delRd1d1", " ", "\[Equal]", " ", "delRd3d3"}], " ", "//", " ", 
  "Simplify"}]}], "Input",
 CellChangeTimes->{{3.662833960794265*^9, 3.662833986683981*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"delRdd", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"delRd0d0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "delRd1d1", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "delRd2d2", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "delRd3d3"}], "}"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6628339960016737`*^9, 3.6628340337309103`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"delR", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Contract", "[", 
      RowBox[{
       RowBox[{"Outer", "[", 
        RowBox[{"Times", ",", "delgUU", ",", "Rdd"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "4"}], "}"}]}], "]"}], " ", "+", " ", 
     RowBox[{"Contract", "[", 
      RowBox[{
       RowBox[{"Raise", "[", 
        RowBox[{"delRdd", ",", "1"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], " ", "//", " ", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"delR", " ", "/.", " ", "printrepl"}], ")"}], " ", "/.", " ", 
   "oprepl"}], " ", "//", " ", "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.6628340475241623`*^9, 3.662834108462454*^9}, {
  3.662834208128641*^9, 3.662834233343232*^9}}],

Cell["check", "Text",
 CellChangeTimes->{{3.6628430821588373`*^9, 3.662843082462438*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Contract", "[", 
    RowBox[{
     RowBox[{"Raise", "[", 
      RowBox[{"delRdd", ",", "1"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], "]"}], " ", "\[Equal]", " ", 
   RowBox[{"Tr", "[", 
    RowBox[{"gUU", ".", "delRdd"}], "]"}]}], " ", "//", " ", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.6628430846012917`*^9, 3.6628431161676807`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"delGd0d0", " ", "=", " ", 
   RowBox[{
    RowBox[{"delRd0d0", " ", "-", " ", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"delgdd", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "R"}], " ", "-", " ", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"gdd", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "delR"}]}], " ", "//", 
    " ", "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Expand", "@", 
   RowBox[{"fullnice", "@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"fullnice", "@", "delGd0d0"}], " ", "/.", " ", "quadPsirepl"}], 
     ")"}]}]}], " ", "/.", " ", "quadPsirepl"}]}], "Input",
 CellChangeTimes->{{3.662834245861018*^9, 3.662834264449923*^9}, {
  3.662834382818123*^9, 3.6628344409335127`*^9}, {3.662834571862228*^9, 
  3.6628346682144747`*^9}, {3.6628413770428057`*^9, 3.662841421444656*^9}, {
  3.662843336618699*^9, 3.662843336906989*^9}}],

Cell["check", "Text",
 CellChangeTimes->{{3.662852637153297*^9, 3.662852637529009*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"delGd0d0semi", " ", "=", " ", 
   RowBox[{
    RowBox[{"delRd0d0", " ", "-", " ", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"delgdd", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "bgR"}], " ", "-", " ", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"g0dd", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "delR"}]}], " ", "//", 
    " ", "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Expand", "@", 
   RowBox[{"fullnice", "@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"fullnice", "@", "delGd0d0semi"}], " ", "/.", " ", 
      "quadPsirepl"}], ")"}]}]}], " ", "/.", " ", "quadPsirepl"}]}], "Input",
 CellChangeTimes->{{3.6628433473947363`*^9, 3.6628433711436357`*^9}, {
  3.662843425439674*^9, 3.6628434357401667`*^9}}],

Cell[BoxData[
 RowBox[{"delGd0d0red", " ", "=", " ", 
  RowBox[{
   RowBox[{"6", " ", "dPsi", " ", "H"}], " ", "+", " ", 
   RowBox[{"24", " ", 
    SuperscriptBox["H", "2"], " ", "Psi"}], " ", "-", " ", 
   RowBox[{"2", " ", 
    FractionBox["lPsi", 
     SuperscriptBox["a", "4"]]}]}]}]], "Input",
 CellChangeTimes->{{3.66284372278026*^9, 3.662843777602454*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["solve perturbed einstein equations", "Subsection",
 CellChangeTimes->{{3.6629176597521057`*^9, 3.662917665894277*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"fullnice", "@", 
       RowBox[{"(", 
        RowBox[{"delGd0d0", " ", "-", " ", 
         RowBox[{"8", " ", "\[Pi]", " ", "Gnew", " ", "delTd0d0"}]}], ")"}]}],
       " ", "\[Equal]", " ", "0"}], ",", "lPsi"}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}], " ", "//", " ", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Expand", "@", 
     RowBox[{"fullnice", "@", 
      RowBox[{"(", 
       RowBox[{"lPsi", " ", "/.", " ", "%"}], ")"}]}]}], " ", "/.", " ", 
    "quadPsirepl"}], " ", "//", " ", "FullSimplify"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Expand", "@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"SeriesCoefficient", "[", 
        RowBox[{"%", ",", 
         RowBox[{"{", 
          RowBox[{"Psi", ",", "0", ",", "#"}], "}"}]}], "]"}], " ", "/", " ", 
       
       RowBox[{"(", 
        RowBox[{"4", " ", "\[Pi]", " ", "Gnew"}], ")"}]}], " ", "/.", " ", 
      "mathrepl"}], ")"}]}], " ", "&"}], "/@", " ", 
  RowBox[{"{", 
   RowBox[{"0", ",", "1"}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.6628526701987047`*^9, 3.6628527796236343`*^9}, {
  3.662852818190736*^9, 3.6628528184630527`*^9}}],

Cell["check", "Text",
 CellChangeTimes->{{3.6629171050346813`*^9, 3.66291710537691*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"fullnice", "@", 
        RowBox[{"(", "delGd0d0", ")"}]}], " ", "\[Equal]", " ", 
       RowBox[{"fullnice", "@", 
        RowBox[{"(", " ", 
         RowBox[{"8", " ", "\[Pi]", " ", "Gnew", " ", "delTd0d0"}], ")"}]}]}],
       ",", "lPsi"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], " ", "//", " ", "FullSimplify"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Expand", "@", 
     RowBox[{"fullnice", "@", 
      RowBox[{"(", 
       RowBox[{"lPsi", " ", "/.", " ", "%"}], ")"}]}]}], " ", "/.", " ", 
    "quadPsirepl"}], " ", "//", " ", "FullSimplify"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Expand", "@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"SeriesCoefficient", "[", 
        RowBox[{"%", ",", 
         RowBox[{"{", 
          RowBox[{"Psi", ",", "0", ",", "#"}], "}"}]}], "]"}], " ", "/", " ", 
       
       RowBox[{"(", 
        RowBox[{"4", " ", "\[Pi]", " ", "Gnew"}], ")"}]}], " ", "/.", " ", 
      "mathrepl"}], ")"}]}], " ", "&"}], "/@", " ", 
  RowBox[{"{", 
   RowBox[{"0", ",", "1"}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.662917121991952*^9, 3.662917133503914*^9}, 
   3.662917767619985*^9}],

Cell["check 2", "Text",
 CellChangeTimes->{{3.662917684638468*^9, 3.662917685077036*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"delGd0d0", " ", "\[Equal]", " ", 
           RowBox[{"8", " ", "\[Pi]", " ", "Gnew", " ", "delTd0d0"}]}], ")"}],
          " ", "/.", " ", "printrepl"}], ")"}], " ", "/.", " ", "oprepl"}], 
      ",", "lPsi"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], " ", "//", " ", "FullSimplify"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Expand", "@", 
     RowBox[{"fullnice", "@", 
      RowBox[{"(", 
       RowBox[{"lPsi", " ", "/.", " ", "%"}], ")"}]}]}], " ", "/.", " ", 
    "quadPsirepl"}], " ", "//", " ", "FullSimplify"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Expand", "@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"SeriesCoefficient", "[", 
        RowBox[{"%", ",", 
         RowBox[{"{", 
          RowBox[{"Psi", ",", "0", ",", "#"}], "}"}]}], "]"}], " ", "/", " ", 
       
       RowBox[{"(", 
        RowBox[{"4", " ", "\[Pi]", " ", "Gnew"}], ")"}]}], " ", "/.", " ", 
      "mathrepl"}], ")"}]}], " ", "&"}], "/@", " ", 
  RowBox[{"{", 
   RowBox[{"0", ",", "1"}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.6629177027969313`*^9, 3.662917766596187*^9}}],

Cell["with cherrypicked terms of einstein tensor", "Text",
 CellChangeTimes->{{3.662917792672729*^9, 3.6629177981029997`*^9}}],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{
    RowBox[{"Collect", "[", 
     RowBox[{
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{"Simplify", "[", 
         RowBox[{"delGd0d0red", " ", "\[Equal]", " ", 
          RowBox[{"8", " ", "\[Pi]", " ", "Gnew", " ", 
           RowBox[{"(", 
            RowBox[{"fullnice", "@", "delTd0d0"}], ")"}]}]}], "]"}], ",", " ",
         "lPsi"}], "]"}], ",", " ", 
      RowBox[{"{", "Psi", "}"}]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Expand", "@", 
    RowBox[{"(", 
     RowBox[{"fullnice", "@", 
      RowBox[{"(", 
       RowBox[{"lPsi", " ", "/.", "%"}], ")"}]}], ")"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Expand", "@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"SeriesCoefficient", "[", 
          RowBox[{"%", ",", 
           RowBox[{"{", 
            RowBox[{"Psi", ",", "0", ",", "#"}], "}"}]}], "]"}], " ", "/", 
         " ", 
         RowBox[{"(", 
          RowBox[{"4", " ", "\[Pi]", " ", "Gnew"}], ")"}]}], " ", "/.", " ", 
        "mathrepl"}], ")"}]}], " ", "&"}], "/@", " ", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.662850470647148*^9, 3.662850481984383*^9}, {
  3.662850519990283*^9, 3.662850521725955*^9}, {3.6628507966153173`*^9, 
  3.6628508243490763`*^9}, {3.6629157391927347`*^9, 3.662915752262141*^9}, {
  3.66291585931971*^9, 3.662915900884267*^9}, {3.662915932645899*^9, 
  3.662915993027171*^9}, {3.662916026869155*^9, 3.6629160414522*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
einstein equation for 00 component of perturbations with Einstein tensor from \
Riotto --> WARNING\
\>", "Subsection",
 CellChangeTimes->{{3.6616307652302732`*^9, 3.6616307764121513`*^9}, {
  3.6628373682544003`*^9, 3.662837385212431*^9}}],

Cell[BoxData[
 RowBox[{"delGU0d0pre", " ", "=", " ", 
  RowBox[{
   RowBox[{"6", " ", 
    SuperscriptBox["a", "2"], " ", "H", " ", 
    RowBox[{"(", 
     RowBox[{"dPsi", " ", "+", " ", 
      RowBox[{"H", " ", "Psi"}]}], ")"}]}], " ", "-", " ", 
   RowBox[{"2", " ", "lPsi"}]}]}]], "Input",
 CellChangeTimes->{{3.662745423231152*^9, 3.662745490399662*^9}}],

Cell[BoxData[
 RowBox[{"delGU0d0", " ", "=", " ", 
  RowBox[{
   RowBox[{"delGU0d0pre", " ", "/.", " ", "dPsirepl"}], " ", "//", " ", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.66163082172047*^9, 3.6616308516153708`*^9}, {
  3.661630893662703*^9, 3.6616309015429707`*^9}, {3.661631014821237*^9, 
  3.661631020292776*^9}, {3.661631115091764*^9, 3.661631121426675*^9}, {
  3.662744265979701*^9, 3.662744267307514*^9}, {3.662745483812049*^9, 
  3.662745509208728*^9}}],

Cell[BoxData[{
 RowBox[{"poisseq", " ", "=", " ", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"Simplify", "[", 
       RowBox[{"delGU0d0", " ", "\[Equal]", " ", 
        RowBox[{"8", " ", "\[Pi]", " ", "Gnew", " ", 
         RowBox[{"(", 
          RowBox[{"fullnice", "@", "delTU0d0"}], ")"}]}]}], "]"}], ",", " ", 
      "lPsi"}], "]"}], ",", " ", 
    RowBox[{"{", "Psi", "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"poisseqnum", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"poisseq", " ", "/.", " ", "grepl"}], " ", "//.", " ", 
    "mathrepl"}], " ", "//", " ", "FullSimplify"}]}]}], "Input",
 CellChangeTimes->{{3.661811486541999*^9, 3.661811487516386*^9}, {
  3.662744276053907*^9, 3.662744280213585*^9}, {3.662745537647946*^9, 
  3.662745592471999*^9}, {3.662758145820099*^9, 3.6627581479316807`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SeriesCoefficient", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"lPsi", " ", "/.", "poisseq"}], ")"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"Psi", ",", "0", ",", "0"}], "}"}]}], "]"}], " ", "/", " ", 
    RowBox[{"(", 
     RowBox[{"4", " ", "\[Pi]", " ", "Gnew"}], ")"}]}], " ", "/.", " ", 
   "mathrepl"}], " ", "//", " ", "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SeriesCoefficient", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"lPsi", " ", "/.", "poisseq"}], ")"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"Psi", ",", "0", ",", "1"}], "}"}]}], "]"}], " ", "/", " ", 
    RowBox[{"(", 
     RowBox[{"4", " ", "\[Pi]", " ", "Gnew"}], ")"}]}], " ", "/.", " ", 
   "mathrepl"}], " ", "//", " ", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.661631344657805*^9, 3.6616314117905807`*^9}, {
  3.661632383122077*^9, 3.661632385172401*^9}, {3.662745605374497*^9, 
  3.662745607622202*^9}, {3.662745712087785*^9, 3.662745713854576*^9}, {
  3.6627457497068787`*^9, 3.662745759194162*^9}, {3.662748877727683*^9, 
  3.662748885468869*^9}, {3.662758177874404*^9, 3.6627582071443367`*^9}, {
  3.6627618075414343`*^9, 3.662761818245296*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
einstein equations with the perturbed stress energy from Riotto --> WARNING\
\>", "Subsection",
 CellChangeTimes->{{3.66275977198975*^9, 3.662759784075783*^9}, {
  3.66283739177223*^9, 3.662837396987858*^9}}],

Cell[BoxData[
 RowBox[{"delTU0d0rio", " ", "=", " ", 
  RowBox[{
   SuperscriptBox["a", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Psi", " ", 
      SuperscriptBox["dphi", "2"]}], " ", "-", " ", 
     RowBox[{"dphi", " ", "deldphi"}], " ", "-", " ", 
     RowBox[{"Vprime", " ", "delphi"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.662759786388011*^9, 3.662759795372281*^9}, {
  3.662759879708849*^9, 3.6627599048099546`*^9}}],

Cell[BoxData[
 RowBox[{"poisseq2", " ", "=", " ", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"Simplify", "[", 
        RowBox[{"delGU0d0", " ", "\[Equal]", " ", 
         RowBox[{"8", " ", "\[Pi]", " ", "Gnew", " ", 
          RowBox[{"(", "delTU0d0rio", ")"}]}]}], "]"}], ",", " ", "lPsi"}], 
      "]"}], ",", " ", 
     RowBox[{"{", "Psi", "}"}]}], "]"}], " ", "//", " ", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.662759972230689*^9, 3.662759991295415*^9}, {
  3.6627600902056627`*^9, 3.662760120611054*^9}, {3.662760186413355*^9, 
  3.6627602100051823`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SeriesCoefficient", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"lPsi", " ", "/.", "poisseq2"}], ")"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"Psi", ",", "0", ",", "0"}], "}"}]}], "]"}], " ", "/", " ", 
    RowBox[{"(", 
     RowBox[{"4", " ", "\[Pi]", " ", "Gnew"}], ")"}]}], " ", "/.", " ", 
   "mathrepl"}], " ", "//", " ", "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SeriesCoefficient", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"lPsi", " ", "/.", "poisseq2"}], ")"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"Psi", ",", "0", ",", "1"}], "}"}]}], "]"}], " ", "/", " ", 
    RowBox[{"(", 
     RowBox[{"4", " ", "\[Pi]", " ", "Gnew"}], ")"}]}], " ", "/.", " ", 
   "mathrepl"}], " ", "//", " ", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.662761780668063*^9, 3.662761781331772*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"lPsi", " ", "/.", " ", "poisseq"}], ")"}], " ", "/", " ", 
   RowBox[{"(", 
    RowBox[{"4", " ", "\[Pi]", " ", "Gnew"}], ")"}]}], " ", "//", " ", 
  "Expand"}]], "Input",
 CellChangeTimes->{{3.6627602015177507`*^9, 3.662760224131855*^9}, {
  3.662760258078446*^9, 3.662760266422142*^9}, {3.662763338655388*^9, 
  3.662763365606051*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"lPsi", " ", "/.", " ", "poisseq2"}], ")"}], " ", "/", " ", 
   RowBox[{"(", 
    RowBox[{"4", " ", "\[Pi]", " ", "Gnew"}], ")"}]}], " ", "//", " ", 
  "Expand"}]], "Input",
 CellChangeTimes->{{3.662760227301721*^9, 3.6627602339714127`*^9}, {
  3.662760270773934*^9, 3.662760273402809*^9}, {3.662763312618493*^9, 
  3.6627633285281277`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["full perturbation of stress energy --> INCOMPLETE, WRONG?", "Subsection",
 CellChangeTimes->{{3.662822063312989*^9, 3.662822065205432*^9}, {
  3.662822101826337*^9, 3.662822103640915*^9}, {3.662837405051355*^9, 
  3.662837411451036*^9}}],

Cell[BoxData[
 RowBox[{"delTd0d0", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"2", "deldphi", " ", "dphi"}], " ", "+", " ", 
    RowBox[{"2", " ", "Psi", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], " ", "+", " ", 
          RowBox[{"2", " ", "Psi"}]}], ")"}], " ", 
        SuperscriptBox["dphi", "2"]}], " ", "+", " ", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"2", " ", 
          SuperscriptBox["a", "2"]}]], " ", 
        RowBox[{"(", 
         RowBox[{"1", " ", "+", " ", 
          RowBox[{"2", " ", "Psi"}]}], ")"}], " ", 
        SuperscriptBox["gphi", "2"]}], " ", "+", " ", "V"}], ")"}]}], " ", 
    "+", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", " ", "+", " ", 
       RowBox[{"2", " ", "Psi"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Psi", " ", 
        SuperscriptBox["dphi", "2"]}], " ", "+", " ", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"2", " ", 
          SuperscriptBox["a", "2"]}]], " ", "2", " ", "Psi", " ", 
        SuperscriptBox["gphi", "2"]}], " ", "+", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], " ", "+", " ", 
          RowBox[{"2", " ", "Psi"}]}], ")"}], " ", "deldphi", " ", "dphi"}], 
       " ", "+", " ", 
       RowBox[{
        FractionBox["1", 
         SuperscriptBox["a", "2"]], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"2", " ", "Psi"}]}], ")"}], " ", "gphi", " ", "gdelphi"}], 
       " ", "+", " ", 
       RowBox[{"Vprime", " ", "delphi"}]}], ")"}]}]}], " ", "//", " ", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.662822109082316*^9, 3.662822259680626*^9}, {
  3.662822389397994*^9, 3.66282239315028*^9}}],

Cell[BoxData[
 RowBox[{"Series", "[", 
  RowBox[{"delTd0d0", ",", 
   RowBox[{"{", 
    RowBox[{"Psi", ",", "0", ",", "3"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6628224583401957`*^9, 3.662822465945422*^9}}],

Cell[BoxData[
 RowBox[{"delGd0d0", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "6"}], " ", "H", " ", 
    SuperscriptBox["a", "2"], " ", "dPsi"}], " ", "+", " ", 
   RowBox[{"2", " ", "lPsi"}]}]}]], "Input",
 CellChangeTimes->{{3.662822276303261*^9, 3.662822290915846*^9}}],

Cell[BoxData[
 RowBox[{"poisseq3", " ", "=", " ", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"fullnice", "@", 
       RowBox[{"Simplify", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"delGd0d0", " ", "/.", " ", "dPsirepl"}], ")"}], " ", 
         "\[Equal]", " ", 
         RowBox[{"8", " ", "\[Pi]", " ", "Gnew", " ", "delTd0d0"}]}], "]"}]}],
       ",", " ", "lPsi"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"Psi", ",", 
      SuperscriptBox["Psi", "2"], ",", 
      SuperscriptBox["Psi", "3"]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.662822337651938*^9, 3.662822386908084*^9}, {
  3.662822485395455*^9, 3.66282255209101*^9}, {3.662822594962028*^9, 
  3.662822600945496*^9}, {3.662822681757328*^9, 3.662822708435459*^9}, {
  3.6628251464788313`*^9, 3.6628251479183693`*^9}, {3.662825225075016*^9, 
  3.6628252358979807`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"lPsi", " ", "/.", " ", "poisseq3"}], ")"}], " ", "/", " ", 
   RowBox[{"(", 
    RowBox[{"4", " ", "\[Pi]", " ", "Gnew"}], ")"}]}], " ", "//", " ", 
  "Expand"}]], "Input",
 CellChangeTimes->{{3.662822555098357*^9, 3.66282255521021*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["stress energy with scalar and tensor perturbations", "Section",
 CellChangeTimes->{{3.6737260754410753`*^9, 3.67372608087983*^9}}],

Cell[BoxData[
 RowBox[{"Quit", "[", "]"}]], "Input",
 CellChangeTimes->{{3.6737262381035557`*^9, 3.673726239084793*^9}}],

Cell[CellGroupData[{

Cell["initialization RGTC", "Subsection",
 CellChangeTimes->{{3.661807404617031*^9, 3.6618074097363577`*^9}, {
  3.662842661503759*^9, 3.662842663238081*^9}}],

Cell[BoxData[
 RowBox[{"<<", " ", "EDCRGTCcode.m"}]], "Input",
 CellChangeTimes->{{3.659213467062601*^9, 3.659213488856326*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["some useful functions, mostly for readability", "Subsection",
 CellChangeTimes->{{3.662756289879479*^9, 3.662756295756824*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"expansionOrder", " ", "=", " ", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tolin", "[", "f_", "]"}], " ", ":=", " ", 
   RowBox[{"Simplify", "@", 
    RowBox[{"Normal", "@", 
     RowBox[{"Series", "[", 
      RowBox[{"f", ",", 
       RowBox[{"{", 
        RowBox[{"Psi", ",", "0", ",", 
         RowBox[{"expansionOrder", " ", "+", " ", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"h11", "[", 
          RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], ",", "0", ",", 
         RowBox[{"expansionOrder", " ", "+", " ", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"h12", "[", 
          RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], ",", "0", ",", 
         RowBox[{"expansionOrder", " ", "+", " ", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"h13", "[", 
          RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], ",", "0", ",", 
         RowBox[{"expansionOrder", " ", "+", " ", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"h22", "[", 
          RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], ",", "0", ",", 
         RowBox[{"expansionOrder", " ", "+", " ", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"h23", "[", 
          RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], ",", "0", ",", 
         RowBox[{"expansionOrder", " ", "+", " ", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"h33", "[", 
          RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], ",", "0", ",", 
         RowBox[{"expansionOrder", " ", "+", " ", "1"}]}], "}"}]}], 
      "]"}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.66162916071454*^9, 3.6616291837383413`*^9}, {
   3.66162936215162*^9, 3.661629364199099*^9}, {3.662851102293614*^9, 
   3.662851114045546*^9}, {3.662851155506918*^9, 3.662851155682184*^9}, {
   3.673727473913856*^9, 3.673727484259542*^9}, {3.673727852999621*^9, 
   3.673727853686883*^9}, 3.673727893790565*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"fullnice", "[", "f_", "]"}], " ", ":=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"tolin", "@", 
      RowBox[{"(", 
       RowBox[{"f", " ", "/.", " ", "printrepl"}], ")"}]}], " ", "/.", " ", 
     "oprepl"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.661629964073977*^9, 3.661630013875849*^9}, {
  3.6616301386362743`*^9, 3.661630138964213*^9}, {3.6628510924941177`*^9, 
  3.662851099510166*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["replacement rules for readability", "Subsection",
 CellChangeTimes->{{3.662756330170906*^9, 3.662756337794312*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"printrepl", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox["phi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "dphi"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["phi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "xphi"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["phi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "1", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "yphi"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["phi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "zphi"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       SuperscriptBox["phi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"2", ",", "0", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "ddphi"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["phi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "2", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "xxphi"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["phi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "2", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "yyphi"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["phi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "0", ",", "2"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "zzphi"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "[", "t", "]"}], " ", "\[Rule]", " ", "a"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"a", "'"}], "[", "t", "]"}], " ", "\[Rule]", " ", "da"}], ",", 
     
     RowBox[{
      RowBox[{
       RowBox[{"a", "''"}], "[", "t", "]"}], " ", "\[Rule]", " ", "dda"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"V", "[", 
       RowBox[{"phi", "[", 
        RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "]"}], " ", 
      "\[Rule]", " ", "V"}], ",", " ", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"V", "[", 
         RowBox[{"phi", "[", 
          RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "]"}], ",", 
        RowBox[{"phi", "[", 
         RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], "]"}], " ", 
      "\[Rule]", " ", "Vprime"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Psi", "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "Psi"}], ",", " ", 
     RowBox[{
      RowBox[{
       SuperscriptBox["Psi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "dPsi"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["Psi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "xPsi"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["Psi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "1", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "yPsi"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["Psi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "zPsi"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       SuperscriptBox["Psi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"2", ",", "0", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "ddPsi"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["Psi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "2", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "xxPsi"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["Psi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "2", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "yyPsi"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["Psi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "0", ",", "2"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "zzPsi"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       SuperscriptBox["Psi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "1", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "xdPsi"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["Psi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0", ",", "1", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "ydPsi"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["Psi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0", ",", "0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "zdPsi"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.659213914364317*^9, 3.65921392209678*^9}, {
   3.659214396071636*^9, 3.659214400462729*^9}, {3.6592144383026733`*^9, 
   3.659214534062351*^9}, {3.659214571991007*^9, 3.6592146891433773`*^9}, {
   3.659214787192404*^9, 3.65921479109603*^9}, {3.662742990338163*^9, 
   3.662743083577395*^9}, 3.662756343169889*^9, {3.6628290815125513`*^9, 
   3.6628291014635468`*^9}, {3.6628292399271717`*^9, 3.662829244141405*^9}, {
   3.662851658665413*^9, 3.66285168577603*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mathrepl", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"phi", " ", "\[Rule]", " ", "\[Phi]"}], ",", " ", 
     RowBox[{"dphi", " ", "\[Rule]", " ", 
      OverscriptBox["\[Phi]", "."]}], ",", 
     RowBox[{"xphi", " ", "\[Rule]", " ", 
      RowBox[{
       SubscriptBox["\[PartialD]", "x"], "\[Phi]"}]}], ",", 
     RowBox[{"yphi", " ", "\[Rule]", " ", 
      RowBox[{
       SubscriptBox["\[PartialD]", "y"], "\[Phi]"}]}], ",", 
     RowBox[{"zphi", " ", "\[Rule]", " ", 
      RowBox[{
       SubscriptBox["\[PartialD]", "z"], "\[Phi]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ddphi", " ", "\[Rule]", " ", "dd\[Phi]"}], ",", 
     RowBox[{"xxphi", " ", "\[Rule]", " ", 
      RowBox[{
       SubscriptBox["\[PartialD]", "x"], 
       RowBox[{
        SubscriptBox["\[PartialD]", "x"], "\[Phi]"}]}]}], ",", 
     RowBox[{"yyphi", " ", "\[Rule]", " ", 
      RowBox[{
       SubscriptBox["\[PartialD]", "y"], 
       RowBox[{
        SubscriptBox["\[PartialD]", "y"], "\[Phi]"}]}]}], ",", 
     RowBox[{"zzphi", " ", "\[Rule]", " ", 
      RowBox[{
       SubscriptBox["\[PartialD]", "z"], 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], "\[Phi]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"delphi", " ", "\[Rule]", " ", "\[Delta]\[Phi]"}], ",", 
     RowBox[{"deldphi", " ", "\[Rule]", " ", 
      OverscriptBox["\[Delta]\[Phi]", "."]}], ",", " ", "\[IndentingNewLine]", 
     RowBox[{"da", " ", "\[Rule]", " ", 
      OverscriptBox["a", "."]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Vprime", " ", "\[Rule]", " ", 
      RowBox[{"V", "'"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"rhobar", " ", "\[Rule]", " ", 
      OverscriptBox["\[Rho]", "_"]}], ",", " ", "\[IndentingNewLine]", 
     RowBox[{"Psi", " ", "\[Rule]", " ", "\[Psi]"}], ",", " ", 
     RowBox[{"dPsi", " ", "\[Rule]", " ", 
      OverscriptBox["\[Psi]", "."]}], ",", 
     RowBox[{"xPsi", " ", "\[Rule]", " ", 
      RowBox[{
       SubscriptBox["\[PartialD]", "x"], "\[Psi]"}]}], ",", 
     RowBox[{"yPsi", " ", "\[Rule]", " ", 
      RowBox[{
       SubscriptBox["\[PartialD]", "y"], "\[Psi]"}]}], ",", 
     RowBox[{"zPsi", " ", "\[Rule]", " ", 
      RowBox[{
       SubscriptBox["\[PartialD]", "z"], "\[Psi]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"xdPsi", " ", "\[Rule]", " ", 
      RowBox[{
       SubscriptBox["\[PartialD]", "x"], 
       OverscriptBox["\[Psi]", "."]}]}], ",", " ", 
     RowBox[{"ydPsi", " ", "\[Rule]", " ", 
      RowBox[{
       SubscriptBox["\[PartialD]", "y"], 
       OverscriptBox["\[Psi]", "."]}]}], ",", " ", 
     RowBox[{"zdPsi", " ", "\[Rule]", " ", 
      RowBox[{
       SubscriptBox["\[PartialD]", "z"], 
       OverscriptBox["\[Psi]", "."]}]}], ",", " ", "\[IndentingNewLine]", 
     RowBox[{"lPsi", " ", "\[Rule]", " ", "\[CapitalDelta]\[Psi]"}], ",", " ", 
     RowBox[{"lphi", " ", "\[Rule]", "  ", "\[CapitalDelta]\[Phi]"}], ",", 
     " ", 
     RowBox[{
      RowBox[{"gphi", " ", "gPsi"}], " ", "\[Rule]", " ", 
      RowBox[{
       RowBox[{"\[Del]", "\[Phi]"}], " ", 
       RowBox[{"\[Del]", "\[Psi]"}]}]}], ",", " ", 
     RowBox[{
      SuperscriptBox["gphi", "2"], " ", "\[Rule]", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"\[Del]", "\[Phi]"}], ")"}], "2"]}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.662756419525899*^9, 3.662756424861803*^9}, {
  3.6627565720917788`*^9, 3.662756574747417*^9}, {3.662756718087454*^9, 
  3.662756719343575*^9}, {3.6627567592129307`*^9, 3.662756770248612*^9}, {
  3.662756860547024*^9, 3.662757007991002*^9}, {3.6627572563379297`*^9, 
  3.6627572729687433`*^9}, {3.662758017622628*^9, 3.662758035953719*^9}, {
  3.662758121195751*^9, 3.66275812803933*^9}, {3.662759911580743*^9, 
  3.662759938436405*^9}, {3.6628457970483627`*^9, 3.6628458003668747`*^9}, {
  3.662851699715782*^9, 3.662851753928875*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"oprepl", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"xxphi", " ", "\[Rule]", "  ", 
      RowBox[{"lphi", " ", "-", " ", "yyphi", " ", "-", " ", "zzphi"}]}], ",", 
     RowBox[{"xxPsi", " ", "\[Rule]", "  ", 
      RowBox[{"lPsi", " ", "-", " ", "yyPsi", " ", "-", " ", "zzPsi"}]}], ",",
      " ", 
     RowBox[{
      RowBox[{"xphi", " ", "xPsi"}], " ", "\[Rule]", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "yphi"}], " ", "yPsi"}], "-", 
       RowBox[{"zphi", " ", "zPsi"}], "  ", "+", " ", 
       RowBox[{"gphi", " ", "gPsi"}]}]}], ",", " ", 
     RowBox[{"da", " ", "\[Rule]", " ", 
      RowBox[{"H", " ", "a"}]}], ",", " ", 
     RowBox[{
      SuperscriptBox["xphi", "2"], " ", "\[Rule]", " ", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["yphi", "2"]}], " ", "-", " ", 
       SuperscriptBox["zphi", "2"], " ", "+", " ", 
       SuperscriptBox["gphi", "2"]}]}], ",", " ", 
     RowBox[{
      SuperscriptBox["xPsi", "2"], " ", "\[Rule]", " ", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["yPsi", "2"]}], " ", "-", " ", 
       SuperscriptBox["zPsi", "2"], " ", "+", " ", 
       SuperscriptBox["gPsi", "2"]}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.659214793541716*^9, 3.659214931155787*^9}, {
   3.659215044272204*^9, 3.659215066023184*^9}, {3.659215187363412*^9, 
   3.659215204714739*^9}, {3.6592156626027393`*^9, 3.659215663906513*^9}, {
   3.6592157005773363`*^9, 3.6592157422419577`*^9}, {3.659215957680072*^9, 
   3.6592159577599077`*^9}, {3.6592164270709352`*^9, 
   3.6592164534208717`*^9}, {3.6592881588968487`*^9, 3.659288181195691*^9}, 
   3.659288894571817*^9, {3.660940168303521*^9, 3.660940175150783*^9}, {
   3.6616292678887367`*^9, 3.661629314263686*^9}, 3.662756820532968*^9, {
   3.6628291250594177`*^9, 3.66282913391964*^9}, {3.6628291719415627`*^9, 
   3.66282918294094*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"opreplalt", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["\[PartialD]", "x"], 
       RowBox[{
        SubscriptBox["\[PartialD]", "x"], "\[Phi]"}]}], " ", "\[Rule]", "  ", 
      
      RowBox[{"\[CapitalDelta]\[Phi]", " ", "-", " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "y"], 
        RowBox[{
         SubscriptBox["\[PartialD]", "y"], "\[Phi]"}]}], " ", "-", " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "z"], 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "\[Phi]"}]}]}]}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        SubscriptBox["\[PartialD]", "x"], "\[Phi]"}], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", "x"], "\[Psi]"}]}], "\[Rule]", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          SubscriptBox["\[PartialD]", "y"], "\[Phi]"}]}], " ", 
        RowBox[{
         SubscriptBox["\[PartialD]", "y"], "\[Psi]"}]}], "-", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "\[Phi]"}], " ", 
        RowBox[{
         SubscriptBox["\[PartialD]", "z"], "\[Psi]"}]}], "  ", "+", " ", 
       RowBox[{
        RowBox[{"\[Del]", "\[Phi]"}], " ", 
        RowBox[{"\[Del]", "\[Psi]"}]}]}]}], ",", " ", 
     RowBox[{
      OverscriptBox["a", "."], " ", "\[Rule]", " ", 
      RowBox[{"H", " ", "a"}]}], ",", " ", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["\[PartialD]", "x"], "\[Phi]"}], ")"}], "2"], " ", 
      "\[Rule]", " ", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["\[PartialD]", "y"], "\[Phi]"}], ")"}], "2"]}], " ", 
       "-", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["\[PartialD]", "z"], "\[Phi]"}], ")"}], "2"], " ", "+",
        " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"\[Del]", "\[Phi]"}], ")"}], "2"]}]}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.662756784735046*^9, 3.662756816037425*^9}, {
  3.662757014516102*^9, 3.662757014756444*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"quadPsirepl", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SuperscriptBox["dPsi", "2"], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      SuperscriptBox["ddPsi", "2"], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      SuperscriptBox["gPsi", "2"], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      SuperscriptBox["lPsi", "2"], "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"dPsi", " ", "Psi"}], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"ddPsi", " ", "Psi"}], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"lPsi", " ", "Psi"}], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"dPsi", " ", "ddPsi"}], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"lPsi", " ", "dPsi"}], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"lPsi", " ", "ddPsi"}], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"gPsi", " ", "Psi"}], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"gPsi", " ", "dPsi"}], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"Psi", " ", "xPsi"}], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"dPsi", " ", "xPsi"}], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"lPsi", " ", "xPsi"}], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"gPsi", " ", "xPsi"}], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"xdPsi", " ", "Psi"}], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"xdPsi", " ", "dPsi"}], " ", "\[Rule]", " ", "0"}], ",", 
     RowBox[{
      RowBox[{"Psi", " ", "yPsi"}], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"dPsi", " ", "yPsi"}], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"lPsi", " ", "yPsi"}], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"gPsi", " ", "yPsi"}], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"ydPsi", " ", "Psi"}], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"ydPsi", " ", "dPsi"}], " ", "\[Rule]", " ", "0"}], ",", 
     RowBox[{
      RowBox[{"Psi", " ", "zPsi"}], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"dPsi", " ", "zPsi"}], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"lPsi", " ", "zPsi"}], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"gPsi", " ", "zPsi"}], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"zdPsi", " ", "Psi"}], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"zdPsi", " ", "dPsi"}], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      SuperscriptBox["dPsi", "2"], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      SuperscriptBox["xPsi", "2"], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      SuperscriptBox["yPsi", "2"], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      SuperscriptBox["zPsi", "2"], " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      SuperscriptBox["gPsi", "2"], "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      SuperscriptBox["dPsi", "2"], "\[Rule]", " ", "0"}]}], "}"}]}], 
  ";"}]], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["replacement rule for numerics: 8 \[Pi] G = 1 (G = Gnew)", "Subsection",
 CellChangeTimes->{{3.662757031304235*^9, 3.662757046623557*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"grepl", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"Gnew", " ", "\[Rule]", " ", 
     FractionBox["1", 
      RowBox[{"8", " ", "\[Pi]"}]]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.661631228336399*^9, 3.661631249894232*^9}, 
   3.66275704904959*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["setup coordinates and metric and call RGtensors", "Subsection",
 CellChangeTimes->{{3.662757052526977*^9, 3.6627570592386913`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"coords", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.659213500185669*^9, 3.659213510640218*^9}, {
   3.661805265682004*^9, 3.661805267194525*^9}, 3.662757062864636*^9}],

Cell[BoxData[{
 RowBox[{"g", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "1"}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"Psi", "[", 
         RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], ",", "0", 
      ",", "0", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", " ", "-", " ", 
         RowBox[{"2", " ", 
          RowBox[{"Psi", "[", 
           RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], " ", "+", 
         " ", 
         RowBox[{"h11", "[", 
          RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], ")"}]}], ",", 
      
      RowBox[{
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], " ", 
       RowBox[{"h12", "[", 
        RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], ",", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], " ", 
       RowBox[{"h13", "[", 
        RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], " ", 
       RowBox[{"h12", "[", 
        RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], ",", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", " ", "-", " ", 
         RowBox[{"2", " ", 
          RowBox[{"Psi", "[", 
           RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], " ", "+", 
         " ", 
         RowBox[{"h22", "[", 
          RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], ")"}]}], ",", 
      
      RowBox[{
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], " ", 
       RowBox[{"h23", "[", 
        RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], " ", 
       RowBox[{"h13", "[", 
        RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], ",", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], " ", 
       RowBox[{"h23", "[", 
        RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], ",", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", " ", "-", " ", 
         RowBox[{"2", " ", 
          RowBox[{"Psi", "[", 
           RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], " ", "+", 
         " ", 
         RowBox[{"h33", "[", 
          RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], ")"}]}]}], 
     "}"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"g", " ", "//", " ", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.6592132263670177`*^9, 3.659213327349605*^9}, {
   3.659213515554082*^9, 3.6592135156902237`*^9}, {3.659213549427917*^9, 
   3.659213562219933*^9}, 3.659214205885046*^9, {3.659287997316237*^9, 
   3.659288011285386*^9}, {3.659288783616477*^9, 3.65928879398288*^9}, {
   3.659288859455915*^9, 3.659288860144106*^9}, {3.660939909094689*^9, 
   3.660939913567176*^9}, {3.661189582767799*^9, 3.6611895896059523`*^9}, {
   3.661190896548168*^9, 3.661190912622839*^9}, {3.661808185832955*^9, 
   3.661808202158963*^9}, {3.673726301725963*^9, 3.673726369774438*^9}, {
   3.673726423715701*^9, 3.67372646447546*^9}, {3.673726500136306*^9, 
   3.6737265012950153`*^9}}],

Cell["\<\
do everything as series expansion in \[Psi] around 0 up to second order\
\>", "Text",
 CellChangeTimes->{{3.6627570689903603`*^9, 3.662757084421204*^9}}],

Cell[BoxData[
 RowBox[{"gPert", " ", "=", " ", 
  RowBox[{"Series", "[", 
   RowBox[{"g", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Psi", "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], ",", "0", ",", 
      RowBox[{"expansionOrder", " ", "+", " ", "1"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"h11", "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], ",", "0", ",", 
      RowBox[{"expansionOrder", " ", "+", " ", "1"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"h12", "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], ",", "0", ",", 
      RowBox[{"expansionOrder", " ", "+", " ", "1"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"h13", "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], ",", "0", ",", 
      RowBox[{"expansionOrder", " ", "+", " ", "1"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"h22", "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], ",", "0", ",", 
      RowBox[{"expansionOrder", " ", "+", " ", "1"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"h23", "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], ",", "0", ",", 
      RowBox[{"expansionOrder", " ", "+", " ", "1"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"h33", "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], ",", "0", ",", 
      RowBox[{"expansionOrder", " ", "+", " ", "1"}]}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.662748339342737*^9, 3.6627484142342777`*^9}, {
  3.6627484860361*^9, 3.662748486123426*^9}, {3.662832575145792*^9, 
  3.662832575201239*^9}, {3.662851131644011*^9, 3.6628511358149767`*^9}, {
  3.662947458243491*^9, 3.66294745929049*^9}, {3.6737265131952972`*^9, 
  3.673726590485407*^9}}],

Cell[BoxData[
 RowBox[{"RGtensors", "[", 
  RowBox[{"g", ",", "coords"}], "]"}]], "Input",
 CellChangeTimes->{{3.6592135276621113`*^9, 3.6592135335942593`*^9}, {
  3.662748384872767*^9, 3.662748385312427*^9}, {3.6628402725171432`*^9, 
  3.662840273132886*^9}, {3.662947462915447*^9, 3.662947463321968*^9}, {
  3.662947634896944*^9, 3.66294763561549*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"fullnice", "[", "gUU", "]"}], " ", "/.", " ", "printrepl"}], "//",
   " ", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.6737274019609547`*^9, 3.673727442516406*^9}, {
  3.6737274954242373`*^9, 3.673727499007008*^9}}],

Cell[BoxData[
 RowBox[{"sqg", " ", "=", " ", 
  RowBox[{
   RowBox[{"Sqrt", "[", 
    RowBox[{"-", 
     RowBox[{"Det", "[", "gdd", "]"}]}], "]"}], " ", "//", " ", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.662747142155484*^9, 3.6627471994151154`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["compute the stress energy", "Subsection",
 CellChangeTimes->{{3.6616300238827763`*^9, 3.661630030713537*^9}, {
  3.662743125985857*^9, 3.662743126863284*^9}, {3.662837305976869*^9, 
  3.662837307808751*^9}}],

Cell[TextData[{
 "this is ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["\[PartialD]", "\[Mu]"], "\[Phi]"}], " ", 
    RowBox[{
     SubscriptBox["\[PartialD]", "\[Nu]"], "\[Phi]"}]}], TraditionalForm]]]
}], "Text",
 CellChangeTimes->{{3.662757683047183*^9, 3.662757695565131*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"phidd", " ", "=", " ", 
   RowBox[{"Outer", "[", 
    RowBox[{"Times", ",", 
     RowBox[{"covD", "[", 
      RowBox[{"phi", "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "]"}], ",", 
     RowBox[{"covD", "[", 
      RowBox[{"phi", "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "]"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.661629699067011*^9, 3.661629707010198*^9}, {
  3.6616298103080263`*^9, 3.661629810723523*^9}, {3.662743172610839*^9, 
  3.662743201569762*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"phidd", " ", "\[Equal]", 
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{"covD", "[", 
       RowBox[{"phi", "[", 
        RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "]"}], "}"}], 
     "]"}], ".", 
    RowBox[{"{", 
     RowBox[{"covD", "[", 
      RowBox[{"phi", "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "]"}], "}"}]}]}], 
  " ", "//", " ", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.66276275989142*^9, 3.662762763449821*^9}, {
   3.6627628555273952`*^9, 3.6627629684545097`*^9}, 3.6627631040581503`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Tdd", " ", "=", 
   RowBox[{"phidd", " ", "-", " ", 
    RowBox[{"gdd", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"Contract", "[", 
         RowBox[{
          RowBox[{"Raise", "[", 
           RowBox[{"phidd", ",", "1"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], " ", "+", " ", 
       RowBox[{"V", "[", 
        RowBox[{"phi", "[", 
         RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "]"}]}], 
      ")"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.661629406378508*^9, 3.6616294504412746`*^9}, {
  3.661629502205143*^9, 3.66162952562075*^9}, {3.661629660880801*^9, 
  3.661629661358799*^9}, {3.661629712744615*^9, 3.661629723112254*^9}, {
  3.661629759962866*^9, 3.661629860547565*^9}, {3.6616300471229963`*^9, 
  3.6616300647456093`*^9}, {3.661793855965024*^9, 3.6617938564141283`*^9}, {
  3.6627432076734123`*^9, 3.662743212715396*^9}, {3.6627433509549637`*^9, 
  3.6627433761618147`*^9}, {3.662743451145049*^9, 3.662743452280691*^9}, {
  3.662744414986623*^9, 3.662744421665662*^9}, {3.662757707216219*^9, 
  3.66275773592704*^9}, {3.662757775807651*^9, 3.662757776743191*^9}, {
  3.662837515695465*^9, 3.662837515960487*^9}}],

Cell["short check:", "Text",
 CellChangeTimes->{{3.6627613753015537`*^9, 3.662761376909227*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"phidd", " ", "-", " ", 
    RowBox[{"gdd", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{
         RowBox[{"covD", "[", 
          RowBox[{"phi", "[", 
           RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "]"}], ".", 
         "gUU", ".", 
         RowBox[{"covD", "[", 
          RowBox[{"phi", "[", 
           RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "]"}]}]}], " ",
        "+", " ", 
       RowBox[{"V", "[", 
        RowBox[{"phi", "[", 
         RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "]"}]}], 
      ")"}]}]}], " ", "\[Equal]", " ", "Tdd"}], " ", "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.662761271247225*^9, 3.6627613996440573`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"TUd", " ", "=", " ", 
   RowBox[{"Raise", "[", 
    RowBox[{"Tdd", ",", " ", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TUU", " ", "=", " ", 
   RowBox[{"Raise", "[", 
    RowBox[{"TUd", ",", " ", "2"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.661629935147769*^9, 3.661629953459831*^9}, {
  3.66163025235312*^9, 3.661630285600066*^9}, {3.662743416038641*^9, 
  3.662743493541897*^9}, {3.662837526694429*^9, 3.66283752690217*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"fullnice", "@", 
     RowBox[{"(", 
      RowBox[{"TUd", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], ")"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"dphi", ",", "gphi", ",", "V"}], "}"}]}], "]"}], " ", "//.", " ",
   "mathrepl"}]], "Input",
 CellChangeTimes->{{3.661630269263316*^9, 3.6616302763522797`*^9}, {
  3.661630372384804*^9, 3.661630384458547*^9}, {3.662743467719653*^9, 
  3.6627434716551332`*^9}, {3.662757917310246*^9, 3.662757918717752*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Tdd", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "/.", " ", "printrepl"}], 
    ")"}], " ", "/.", " ", "oprepl"}], " ", "//", " ", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fullnice", "@", 
    RowBox[{"Tdd", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1"}], "]"}], "]"}]}], " ", "/.", " ", "mathrepl"}], 
  " ", "//", " ", "Expand"}]}], "Input",
 CellChangeTimes->{{3.662837532083848*^9, 3.662837566383834*^9}, {
  3.6628394206604652`*^9, 3.6628394220604477`*^9}, {3.662840365455936*^9, 
  3.662840367567483*^9}}],

Cell["check rho", "Text",
 CellChangeTimes->{{3.66284094416696*^9, 3.662840945515975*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"fullnice", "@", 
     RowBox[{"(", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"TUU", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], 
        RowBox[{"gUU", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]]}], ")"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"dphi", ",", " ", "gphi", ",", " ", "V"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rhorepl", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"V", " ", "\[Rule]", " ", 
     RowBox[{"rho", " ", "-", " ", "%", " ", "+", "V"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{" ", 
  RowBox[{"%", "/.", " ", "mathrepl"}]}]}], "Input",
 CellChangeTimes->{{3.6628409502072687`*^9, 3.662841025323824*^9}, {
  3.662994297265051*^9, 3.6629943751639433`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Tdd", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "i"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2", ",", "4"}], "}"}]}], "]"}], " ", "/.", " ", 
     "printrepl"}], ")"}], " ", "/.", " ", "oprepl"}], " ", "//", " ", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fullnice", "@", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"Tdd", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "i"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "2", ",", "4"}], "}"}]}], "]"}]}], " ", "/.", " ", 
  "mathrepl"}]}], "Input",
 CellChangeTimes->{{3.662839379847125*^9, 3.662839397695595*^9}, {
  3.6628394503473673`*^9, 3.662839495800701*^9}, {3.662851225597476*^9, 
  3.6628512268464518`*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["localized initial conditions", "Section",
 CellChangeTimes->{{3.665328792649888*^9, 3.66532879658422*^9}}],

Cell[BoxData[
 RowBox[{"normal", " ", "=", " ", 
  RowBox[{
   FractionBox["1", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{"2", " ", "\[Pi]"}], "]"}], " ", "\[Sigma]"}]], " ", 
   RowBox[{"Exp", "[", 
    RowBox[{"-", 
     FractionBox[
      SuperscriptBox["x", "2"], 
      RowBox[{"2", " ", 
       SuperscriptBox["\[Sigma]", "2"]}]]}], "]"}], " "}]}]], "Input",
 CellChangeTimes->{{3.665328905707588*^9, 3.6653289390453997`*^9}}],

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{
      FractionBox["1", "\[Pi]"], " ", "normal", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"n", " ", "x"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}]}], "]"}], ",", 
   RowBox[{"Assumptions", "\[Rule]", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"n", ">", "0"}], ",", " ", 
      RowBox[{"\[Sigma]", ">", "0"}], ",", " ", 
      RowBox[{
       SuperscriptBox["\[Sigma]", "2"], " ", ">", "0"}]}], "}"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.665328801060236*^9, 3.665328904838339*^9}, {
  3.6653289431249*^9, 3.665329033077024*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"coeff", " ", "=", " ", 
   FractionBox[
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "2"]}], " ", 
      SuperscriptBox["n", "2"], " ", 
      SuperscriptBox["\[Sigma]", "2"]}]], 
    RowBox[{"2", " ", "\[Pi]"}]]}], ";"}]], "Input",
 CellChangeTimes->{{3.665329038340281*^9, 3.66532908725776*^9}, {
  3.665329203573213*^9, 3.665329218434964*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"coeff", " ", "/.", 
       RowBox[{"{", 
        RowBox[{"\[Sigma]", "\[Rule]", " ", "0.10"}], "}"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"n", " ", "x"}], "]"}], " ", "+", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], 
        RowBox[{"n", "+", "1"}]]}], ")"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"n", ",", "1", ",", "32"}], "}"}]}], "]"}], " ", "/.", " ", 
  RowBox[{"{", 
   RowBox[{"x", "\[Rule]", " ", "\[Pi]"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.6653302945635557`*^9, 3.66533031314554*^9}}],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"coeff", " ", "/.", 
          RowBox[{"{", 
           RowBox[{"\[Sigma]", "\[Rule]", " ", "k"}], "}"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"n", " ", "x"}], "]"}], " ", "+", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{"n", "+", "1"}]]}], ")"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", "32"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", " ", 
     RowBox[{"PlotRange", "\[Rule]", " ", "All"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"k", ",", "0.2", ",", "0.7"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.665329221859212*^9, 3.66532922217869*^9}, {
  3.665329259266654*^9, 3.665329414886382*^9}, {3.665329444964127*^9, 
  3.6653294738633966`*^9}, {3.665330266877266*^9, 3.665330274334687*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"coeff", " ", "=", " ", 
   FractionBox[
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "2"]}], " ", 
      SuperscriptBox["n", "2"], " ", 
      SuperscriptBox["\[Sigma]", "2"]}]], 
    RowBox[{"2", " ", "\[Pi]"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Plot3D", "[", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"coeff", " ", "/.", 
          RowBox[{"{", 
           RowBox[{"\[Sigma]", "\[Rule]", " ", "k"}], "}"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"n", " ", "y"}], "]"}], " ", "+", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"n", " ", "x"}], "]"}], " ", "+", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{"n", "+", "1"}]]}], ")"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", "32"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", " ", 
     RowBox[{"PlotRange", "\[Rule]", " ", "All"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"k", ",", "0.2", ",", "0.7"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.665329889236867*^9, 3.66532999214682*^9}}],

Cell[BoxData[
 RowBox[{"coeff", " ", "=", " ", 
  FractionBox[
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "2"]}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["n1", "2"], " ", "+", " ", 
       SuperscriptBox["n2", "2"]}], ")"}], " ", 
     SuperscriptBox["\[Sigma]", "2"]}]], 
   RowBox[{"2", " ", "\[Pi]"}]]}]], "Input",
 CellChangeTimes->{{3.665331945462769*^9, 3.665331973209244*^9}}],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Plot3D", "[", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"coeff", " ", "/.", 
          RowBox[{"{", 
           RowBox[{"\[Sigma]", "\[Rule]", " ", "k"}], "}"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"n1", " ", "x"}], "]"}], " ", "+", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{"n1", "+", "1"}]]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"n2", " ", "y"}], "]"}], " ", "+", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{"n2", "+", "1"}]]}], ")"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"n1", ",", "1", ",", "16"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"n2", ",", "1", ",", "16"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", " ", 
     RowBox[{"PlotRange", "\[Rule]", " ", "All"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"k", ",", "0.2", ",", "0.7"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.665331986755072*^9, 3.665332029954372*^9}, {
  3.665332090235751*^9, 3.665332092521577*^9}}],

Cell[BoxData[
 RowBox[{"coeff", " ", "=", " ", 
  FractionBox[
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "2"]}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["n1", "2"], " ", "+", " ", 
       SuperscriptBox["n2", "2"], " ", "+", " ", 
       SuperscriptBox["n3", "2"]}], ")"}], " ", 
     SuperscriptBox["\[Sigma]", "2"]}]], 
   RowBox[{"2", " ", "\[Pi]"}]]}]], "Input",
 CellChangeTimes->{{3.665333280863803*^9, 3.665333283943686*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"coeff", " ", "/.", 
       RowBox[{"{", 
        RowBox[{"\[Sigma]", "\[Rule]", " ", "0.5"}], "}"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"n1", " ", "x"}], "]"}], " ", "+", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], 
        RowBox[{"n1", "+", "1"}]]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"n2", " ", "y"}], "]"}], " ", "+", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], 
        RowBox[{"n2", "+", "1"}]]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"n3", " ", "z"}], "]"}], " ", "+", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], 
        RowBox[{"n3", "+", "1"}]]}], ")"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"n1", ",", "1", ",", "16"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"n2", ",", "1", ",", "16"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"n3", ",", "1", ",", "16"}], "}"}]}], "]"}], " ", "/.", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"x", " ", "\[Rule]", " ", "0.0"}], ",", " ", 
    RowBox[{"y", " ", "\[Rule]", " ", "0.0"}], ",", " ", 
    RowBox[{"z", " ", "\[Rule]", " ", "0.0"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.665333303279467*^9, 3.665333343256669*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["stability of mathieus equation", "Section",
 CellChangeTimes->{{3.671899540070209*^9, 3.671899544804367*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"p", "[", 
   RowBox[{"a_", ",", "q_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"MathieuC", "[", 
     RowBox[{"a", ",", "q", ",", "0"}], "]"}]}], " ", 
   RowBox[{"MathieuSPrime", "[", 
    RowBox[{"a", ",", "q", ",", "0"}], "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{"ContourPlot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"p", "[", 
     RowBox[{"a", ",", "q"}], "]"}], " ", 
    RowBox[{"p", "[", 
     RowBox[{
      RowBox[{"-", "a"}], ",", 
      RowBox[{"-", "q"}]}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"q", ",", "0.05", ",", "0.95"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", "0.00", ",", "0.25"}], "}"}], ",", 
   RowBox[{"MaxRecursion", "\[Rule]", "3"}], ",", 
   RowBox[{"RegionFunction", "\[Rule]", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "f"}], "}"}], ",", 
      RowBox[{"f", ">", "0"}]}], "]"}]}], ",", 
   RowBox[{"ColorFunction", "\[Rule]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"ColorData", "[", "\"\<DarkRainbow\>\"", "]"}], "[", 
       RowBox[{"1", "-", "#"}], "]"}], "&"}], ")"}]}], ",", 
   RowBox[{"AspectRatio", "\[Rule]", 
    RowBox[{"1", "/", "GoldenRatio"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6718995457983932`*^9, 3.6718995934412937`*^9}, {
  3.671901645009227*^9, 3.671901652921011*^9}}],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"Flatten", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"MathieuCharacteristicA", "[", 
         RowBox[{"r", ",", "q"}], "]"}], ",", " ", 
        RowBox[{"MathieuCharacteristicB", "[", 
         RowBox[{
          RowBox[{"r", "+", "1"}], ",", "q"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", "0", ",", "3"}], "}"}]}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"q", ",", "0", ",", "10"}], "}"}], ",", 
   RowBox[{"Evaluated", "\[Rule]", " ", "True"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"All", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "15"}], "}"}]}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.67190020365452*^9, 3.6719002556183577`*^9}, {
   3.671900288918049*^9, 3.671900312119351*^9}, {3.671900348498806*^9, 
   3.671900365561453*^9}, {3.671900401974368*^9, 3.671900424925385*^9}, 
   3.6719016166518373`*^9}],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<PlotLegends`\>\"", "]"}]], "Input"],

Cell["without A=2q line", "Text",
 CellChangeTimes->{{3.673285343135903*^9, 3.673285348551689*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ymax", " ", "=", " ", "10"}], ";", " ", 
  RowBox[{"ymin", " ", "=", " ", 
   RowBox[{"-", "1"}]}], ";", " ", 
  RowBox[{"xmax", " ", "=", " ", "8"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{"Flatten", "@", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"MathieuCharacteristicA", "[", 
            RowBox[{"r", ",", "q"}], "]"}], ",", " ", 
           RowBox[{"MathieuCharacteristicB", "[", 
            RowBox[{
             RowBox[{"r", "+", "1"}], ",", "q"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"r", ",", "0", ",", "3"}], "}"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"q", ",", "0", ",", "xmax"}], "}"}], ",", 
      RowBox[{"PlotStyle", " ", "\[Rule]", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Black", ",", "Thick"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Black", ",", "Thick"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"Evaluated", "\[Rule]", " ", "True"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"All", ",", 
         RowBox[{"{", 
          RowBox[{"ymin", ",", "ymax"}], "}"}]}], "}"}]}], ",", " ", 
      RowBox[{"Filling", " ", "\[Rule]", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"2", " ", "n"}], "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"2", " ", "n"}], "+", "1"}], "}"}], ",", 
             RowBox[{"Directive", "[", 
              RowBox[{
               RowBox[{"ColorData", "[", "\"\<DarkRainbow\>\"", "]"}], "[", 
               "0", "]"}], "]"}]}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ",", 
      RowBox[{"Frame", "\[Rule]", " ", "True"}]}], "]"}], ",", " ", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"ContourPlot", "[", 
     RowBox[{
      RowBox[{"Im", "@", 
       RowBox[{"MathieuCharacteristicExponent", "[", 
        RowBox[{"r", ",", "q"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"q", ",", "0", ",", "xmax"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", "ymin", ",", "ymax"}], "}"}], ",", " ", 
      RowBox[{"MaxRecursion", "\[Rule]", "3"}], ",", 
      RowBox[{"RegionFunction", "\[Rule]", 
       RowBox[{"Function", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "f"}], "}"}], ",", 
         RowBox[{"f", ">", "0.1"}]}], "]"}]}], ",", 
      RowBox[{"ColorFunction", "\[Rule]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"ColorData", "[", "\"\<DarkRainbow\>\"", "]"}], "[", "#", 
          "]"}], "&"}], ")"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{"Flatten", "@", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"MathieuCharacteristicA", "[", 
            RowBox[{"r", ",", "q"}], "]"}], ",", " ", 
           RowBox[{"MathieuCharacteristicB", "[", 
            RowBox[{
             RowBox[{"r", "+", "1"}], ",", "q"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"r", ",", "0", ",", "3"}], "}"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"q", ",", "0", ",", "xmax"}], "}"}], ",", 
      RowBox[{"PlotStyle", " ", "\[Rule]", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Black", ",", "Thick"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Black", ",", "Thick"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"Evaluated", "\[Rule]", " ", "True"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"All", ",", 
         RowBox[{"{", 
          RowBox[{"ymin", ",", "ymax"}], "}"}]}], "}"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "}"}], "]"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJwdzlsog3EYBvCPC+fDXIxIIYdWMmc5lvOhHGq0YpraPimZQ+QQTbighCv5
tua0JOVm2Wik1kSyJlMSy2lCy6cl025Qvud/8fbrred5e+NkPaJ2b4qi4riB
ghuhgJGwJdd/6ylwR5NUDKOKtcTBDbYcKn+iK6A68qkaHt4La0gvuK0OJpjz
pHBoUisnOYNOAfNjgvth9/TCFAx3umfgzMHiPMxW+zKw8ndYBS0fJ3p4xksz
kD9OrO+wQy35hZlP+T4qTnbbQQwv2QqBJqOJSN3W86HLLo+GOe+OeFioy0iA
/KvAXKicCMqDsoLTCw2nNpK2waDxL9Ey57PHQzywumloiPFuh52MUAGLXlZ7
YZc/OwCPG2RL0O7F24RNr+db8KHavAsnfCOMUOQ3e0R6YQ/HcHc03ULudtht
UJ8ofoR77k0HvBOJ36A0tdQJY+l9F1RmPRP96JbmFU66yiiBAXMj8kIpt9fV
0HAtuagPCi6HiaGNZaOwsVYxBr8/W22QYsYu4T+3owv+
  "]],

Cell["with A=2q line", "Text",
 CellChangeTimes->{{3.673285351615452*^9, 3.673285354255445*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ymax", " ", "=", " ", "10"}], ";", " ", 
  RowBox[{"ymin", " ", "=", " ", 
   RowBox[{"-", "1"}]}], ";", " ", 
  RowBox[{"xmax", " ", "=", " ", "8"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{"Flatten", "@", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"MathieuCharacteristicA", "[", 
            RowBox[{"r", ",", "q"}], "]"}], ",", " ", 
           RowBox[{"MathieuCharacteristicB", "[", 
            RowBox[{
             RowBox[{"r", "+", "1"}], ",", "q"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"r", ",", "0", ",", "3"}], "}"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"q", ",", "0", ",", "xmax"}], "}"}], ",", 
      RowBox[{"PlotStyle", " ", "\[Rule]", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Black", ",", "Thick"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Black", ",", "Thick"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"Evaluated", "\[Rule]", " ", "True"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"All", ",", 
         RowBox[{"{", 
          RowBox[{"ymin", ",", "ymax"}], "}"}]}], "}"}]}], ",", " ", 
      RowBox[{"Filling", " ", "\[Rule]", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"2", " ", "n"}], "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"2", " ", "n"}], "+", "1"}], "}"}], ",", 
             RowBox[{"Directive", "[", 
              RowBox[{
               RowBox[{"ColorData", "[", "\"\<DarkRainbow\>\"", "]"}], "[", 
               "0", "]"}], "]"}]}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ",", 
      RowBox[{"Frame", "\[Rule]", " ", "True"}]}], "]"}], ",", " ", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"ContourPlot", "[", 
     RowBox[{
      RowBox[{"Im", "@", 
       RowBox[{"MathieuCharacteristicExponent", "[", 
        RowBox[{"r", ",", "q"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"q", ",", "0", ",", "xmax"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", "ymin", ",", "ymax"}], "}"}], ",", " ", 
      RowBox[{"MaxRecursion", "\[Rule]", "3"}], ",", 
      RowBox[{"RegionFunction", "\[Rule]", 
       RowBox[{"Function", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "f"}], "}"}], ",", 
         RowBox[{"f", ">", "0.1"}]}], "]"}]}], ",", 
      RowBox[{"ColorFunction", "\[Rule]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"ColorData", "[", "\"\<DarkRainbow\>\"", "]"}], "[", "#", 
          "]"}], "&"}], ")"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{"Flatten", "@", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"MathieuCharacteristicA", "[", 
            RowBox[{"r", ",", "q"}], "]"}], ",", " ", 
           RowBox[{"MathieuCharacteristicB", "[", 
            RowBox[{
             RowBox[{"r", "+", "1"}], ",", "q"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"r", ",", "0", ",", "3"}], "}"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"q", ",", "0", ",", "xmax"}], "}"}], ",", 
      RowBox[{"PlotStyle", " ", "\[Rule]", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Black", ",", "Thick"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Black", ",", "Thick"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"Evaluated", "\[Rule]", " ", "True"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"All", ",", 
         RowBox[{"{", 
          RowBox[{"ymin", ",", "ymax"}], "}"}]}], "}"}]}]}], "]"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{"2", " ", "q"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"q", ",", "0", ",", "xmax"}], "}"}], ",", " ", 
      RowBox[{"PlotStyle", "\[Rule]", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Darker", "[", "Red", "]"}], ",", 
         RowBox[{"Thickness", "[", "0.005", "]"}]}], "}"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "}"}], "]"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJwdzk0ow3EcBvDZwSab5mCaJmTkYt5lQ23yMgfUkmI1Nf+1kqEIpaZxoBQn
2ZaXLK2Vy7JNs5SmLVkTB4nlZVtobdrBahdT/s/v8O1zeZ6nb4VmRqllMhiM
UvpgzZO4xqRKyh//jmrh6V61DJbIrMSF42Q3NPwKe6BFEFHAi1dxP+lxxweg
yCdRw8VV6wTJuRx6KC3jzsHp9e01yI+nN+CGd2cLtlhYJtibXTLD4HfACW94
9S7yRyCUgDqLKgubItJcM23yJErky+0F8NJzSWQ8DxbBVHhCCFsT0UrY4WgU
waKH/DZoMHIkUNN+fbdHaxVQ95Cz8qPcp41lMkRvKE1BVxlTCydNYj3s/Dic
hVN5yXnoH9LswnAOzwaHP2/t8E3hc0Mjq9gDlezNK9IrfPND93JDkOzqwvfQ
WTXyDs/Stih8UY58QXVdVxyWU+cpaGiOEdnU2OgBLdXnUcF/U1Dv8g==
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<mathieu_stability.eps\>\"", ",", 
    RowBox[{"Out", "[", "5", "]"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.6719130252929068`*^9, 3.671913046451877*^9}, {
  3.673286407158597*^9, 3.6732864102053947`*^9}}],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"Flatten", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Tooltip", "[", 
         RowBox[{
          RowBox[{"MathieuCharacteristicA", "[", 
           RowBox[{"r", ",", "q"}], "]"}], ",", 
          RowBox[{"Subscript", "[", 
           RowBox[{"ce", ",", "r"}], "]"}]}], "]"}], ",", 
        RowBox[{"Tooltip", "[", 
         RowBox[{
          RowBox[{"MathieuCharacteristicB", "[", 
           RowBox[{
            RowBox[{"r", "+", "1"}], ",", "q"}], "]"}], ",", 
          RowBox[{"Subscript", "[", 
           RowBox[{"se", ",", 
            RowBox[{"r", "+", "1"}]}], "]"}]}], "]"}], ",", 
        RowBox[{"Tooltip", "[", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"MathieuCharacteristicA", "[", 
            RowBox[{"r", ",", "q"}], "]"}]}], ",", 
          RowBox[{"-", 
           RowBox[{"Subscript", "[", 
            RowBox[{"ce", ",", "r"}], "]"}]}]}], "]"}], ",", 
        RowBox[{"Tooltip", "[", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"MathieuCharacteristicB", "[", 
            RowBox[{
             RowBox[{"r", "+", "1"}], ",", "q"}], "]"}]}], ",", 
          RowBox[{"-", 
           RowBox[{"Subscript", "[", 
            RowBox[{"se", ",", 
             RowBox[{"r", "+", "1"}]}], "]"}]}]}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", "0", ",", "4"}], "}"}]}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"q", ",", "0", ",", "8"}], "}"}], ",", 
   RowBox[{"Evaluated", "\[Rule]", "True"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"All", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "15"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"PlotStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Directive", "[", 
       RowBox[{"Thick", ",", "Blue"}], "]"}], ",", 
      RowBox[{"Directive", "[", 
       RowBox[{"Thick", ",", "Red"}], "]"}], ",", 
      RowBox[{"Directive", "[", 
       RowBox[{"Thick", ",", "Dashed", ",", "Blue"}], "]"}], ",", 
      RowBox[{"Directive", "[", 
       RowBox[{"Thick", ",", "Dashed", ",", "Red"}], "]"}]}], "}"}]}], ",", 
   RowBox[{"Filling", "\[Rule]", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"2", " ", "n"}], "+", "1"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"2", " ", "n"}], "+", "2"}], "}"}], ",", 
          RowBox[{"Directive", "[", 
           RowBox[{
            RowBox[{"Opacity", "[", 
             RowBox[{"1", "/", "2"}], "]"}], ",", "Purple"}], "]"}]}], 
         "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "0", ",", "3"}], "}"}]}], "]"}]}]}], "]"}]], "Input",\

 CellChangeTimes->{{3.6719000631903067`*^9, 3.6719000631912813`*^9}, {
  3.671900099157598*^9, 3.6719001427390842`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "check equations of motion for ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["h", "ij"], TraditionalForm]]]
}], "Section",
 CellChangeTimes->{{3.673642099575944*^9, 3.673642116267818*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Quit", "[", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.673729964227099*^9, 3.6737299661569967`*^9}}],

Cell["from weinberg", "Text",
 CellChangeTimes->{{3.6737298831749077`*^9, 3.67372988463752*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"eq", " ", "=", " ", 
   RowBox[{
    SubscriptBox["\[Delta]T", "ij"], " ", "==", " ", 
    RowBox[{
     RowBox[{"pb", " ", 
      SubscriptBox["h", "ij"]}], " ", "+", " ", 
     RowBox[{
      SuperscriptBox["a", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[Delta]", "ij"], " ", "\[Delta]p"}], " ", "+", 
        SubscriptBox["\[Pi]", "ij"]}], ")"}]}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.673729887632972*^9, 3.673729960541891*^9}, {
  3.673730237527564*^9, 3.673730285173916*^9}}],

Cell[BoxData[
 RowBox[{"\[Delta]p", " ", "=", " ", 
  FractionBox[
   SubscriptBox["\[Delta]T", "kk"], "3"]}]], "Input",
 CellChangeTimes->{{3.673730044068775*^9, 3.673730072301744*^9}, {
  3.673730259974769*^9, 3.673730291173697*^9}, {3.673730579847355*^9, 
  3.673730613678032*^9}, {3.6737306550276937`*^9, 3.673730657106254*^9}}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["h", "ij"], " ", "=", " ", 
  RowBox[{
   SuperscriptBox["a", "2"], " ", 
   SubscriptBox["D", "ij"], " "}]}]], "Input",
 CellChangeTimes->{{3.673730078198964*^9, 3.673730082002585*^9}, {
  3.673730294285962*^9, 3.673730301315979*^9}}],

Cell[BoxData[
 RowBox[{"source", " ", "=", " ", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["\[Pi]", "ij"], " ", "/.", " ", 
       RowBox[{"Solve", "[", 
        RowBox[{"eq", ",", " ", 
         RowBox[{"{", 
          SubscriptBox["\[Pi]", "ij"], "}"}]}], "]"}]}], ")"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], ")"}], " ", "//", "Expand"}]}]], "Input",\

 CellChangeTimes->{{3.67372997916147*^9, 3.6737300335394087`*^9}, {
  3.6737301077233973`*^9, 3.6737301203864822`*^9}, {3.67373015749087*^9, 
  3.673730164282427*^9}, {3.673730198492407*^9, 3.673730225371078*^9}, {
  3.673730304605569*^9, 3.673730316365391*^9}, {3.673730387115774*^9, 
  3.673730388762295*^9}, {3.6737304564476633`*^9, 3.673730457767428*^9}}],

Cell["link to 0712.2991 eq (29)", "Text",
 CellChangeTimes->{{3.673730531644279*^9, 3.673730541772087*^9}}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["\[Delta]S", "ij"], " ", "=", " ", 
  RowBox[{
   RowBox[{
    SuperscriptBox["a", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"source", " ", "+", " ", 
      RowBox[{"pb", " ", 
       SubscriptBox["D", "ij"]}]}], ")"}]}], "  ", "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.6737304596925983`*^9, 3.673730565082913*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "get correct ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["h", "ij"], TraditionalForm]]],
 "s for different ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["k", "i"], TraditionalForm]]],
 "s"
}], "Section",
 CellChangeTimes->{{3.673730706910246*^9, 3.6737307343560743`*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.673456213606627*^9, 3.6734562203539248`*^9}}],

Cell[BoxData[
 RowBox[{"Quit", "[", "]"}]], "Input",
 CellChangeTimes->{{3.674335120851561*^9, 3.674335122824844*^9}}],

Cell["\<\
for readability of output (never use in assignments, only for print)\
\>", "Text",
 CellChangeTimes->{{3.670794561075774*^9, 3.6707945903314323`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"replPrint", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"h", "[", 
       RowBox[{"1", ",", "1"}], "]"}], " ", "\[Rule]", " ", "h11"}], ",", " ", 
     RowBox[{
      RowBox[{"h", "[", 
       RowBox[{"1", ",", "2"}], "]"}], " ", "\[Rule]", " ", "h12"}], ",", " ", 
     RowBox[{
      RowBox[{"h", "[", 
       RowBox[{"1", ",", "3"}], "]"}], " ", "\[Rule]", " ", "h13"}], ",", 
     RowBox[{
      RowBox[{"h", "[", 
       RowBox[{"2", ",", "2"}], "]"}], " ", "\[Rule]", " ", "h22"}], ",", 
     RowBox[{
      RowBox[{"h", "[", 
       RowBox[{"2", ",", "3"}], "]"}], " ", "\[Rule]", " ", "h23"}]}], 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.674334434624934*^9, 3.674334466725486*^9}, {
  3.67433451743042*^9, 3.6743345710187187`*^9}, {3.6743346310794992`*^9, 
  3.674334688901495*^9}, {3.674334990265452*^9, 3.67433501220879*^9}, {
  3.674335528015731*^9, 3.6743355476527033`*^9}}],

Cell["\<\
NOTE: since all of the equations are linear in the hij, everything below also \
holds if we put a dot on each hij (the derivatives)\
\>", "Text",
 CellChangeTimes->{{3.670794633766403*^9, 3.670794654210236*^9}}],

Cell["\<\
elimination rules due to symmetry and tracelessness (trivial):\
\>", "Text",
 CellChangeTimes->{{3.670794530932982*^9, 3.670794547092312*^9}, 
   3.670794661118067*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"replElim", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"h", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", "\[Rule]", " ", 
      RowBox[{"h", "[", 
       RowBox[{"1", ",", "2"}], "]"}]}], ",", " ", 
     RowBox[{
      RowBox[{"h", "[", 
       RowBox[{"3", ",", "1"}], "]"}], " ", "\[Rule]", " ", 
      RowBox[{"h", "[", 
       RowBox[{"1", ",", "3"}], "]"}]}], ",", " ", 
     RowBox[{
      RowBox[{"h", "[", 
       RowBox[{"3", ",", "2"}], "]"}], " ", "\[Rule]", " ", 
      RowBox[{"h", "[", 
       RowBox[{"2", ",", "3"}], "]"}]}], ",", " ", 
     RowBox[{
      RowBox[{"h", "[", 
       RowBox[{"3", ",", "3"}], "]"}], " ", "\[Rule]", " ", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"h", "[", 
         RowBox[{"1", ",", "1"}], "]"}]}], " ", "-", " ", 
       RowBox[{"h", "[", 
        RowBox[{"2", ",", "2"}], "]"}]}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.670794053033517*^9, 3.67079410572465*^9}, {
  3.6707942400169373`*^9, 3.6707942423773737`*^9}}],

Cell["\<\
we are left with 5 unknowns and 3 equations from transversality:\
\>", "Text",
 CellChangeTimes->{{3.6707927060433064`*^9, 3.6707927371558123`*^9}, {
   3.670793635356184*^9, 3.670793676383902*^9}, 3.670794550524543*^9, {
   3.670794598268149*^9, 3.670794623844592*^9}, 3.670794668055509*^9}],

Cell[BoxData[
 RowBox[{"constr", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"k1", " ", 
       RowBox[{"h", "[", 
        RowBox[{"1", ",", "1"}], "]"}]}], " ", "+", " ", 
      RowBox[{"k2", " ", 
       RowBox[{"h", "[", 
        RowBox[{"1", ",", "2"}], "]"}]}], " ", "+", " ", 
      RowBox[{"k3", " ", 
       RowBox[{"h", "[", 
        RowBox[{"1", ",", "3"}], "]"}]}]}], " ", "\[Equal]", " ", "0"}], ",", 
    " ", 
    RowBox[{
     RowBox[{
      RowBox[{"k1", " ", 
       RowBox[{"h", "[", 
        RowBox[{"1", ",", "2"}], "]"}]}], " ", "+", " ", 
      RowBox[{"k2", " ", 
       RowBox[{"h", "[", 
        RowBox[{"2", ",", "2"}], "]"}]}], " ", "+", " ", 
      RowBox[{"k3", " ", 
       RowBox[{"h", "[", 
        RowBox[{"2", ",", "3"}], "]"}]}]}], " ", "\[Equal]", " ", "0"}], ",", 
    " ", 
    RowBox[{
     RowBox[{
      RowBox[{"k1", " ", 
       RowBox[{"h", "[", 
        RowBox[{"1", ",", "3"}], "]"}]}], " ", "+", " ", 
      RowBox[{"k2", " ", 
       RowBox[{"h", "[", 
        RowBox[{"2", ",", "3"}], "]"}]}], " ", "-", " ", 
      RowBox[{"k3", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"h", "[", 
          RowBox[{"1", ",", "1"}], "]"}], " ", "+", " ", 
         RowBox[{"h", "[", 
          RowBox[{"2", ",", "2"}], "]"}]}], ")"}]}]}], " ", "\[Equal]", " ", 
     "0"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.670792408334714*^9, 3.6707924939156523`*^9}, {
  3.670793291340014*^9, 3.670793326681386*^9}, {3.670793759882434*^9, 
  3.670793788385972*^9}}],

Cell["\<\
up to a constant factor this is what we want to compute eventually\
\>", "Text",
 CellChangeTimes->{{3.67079467482137*^9, 3.670794682554463*^9}, {
  3.670794723161892*^9, 3.670794748705209*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rhogw", " ", "=", " ", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"h", "[", 
       RowBox[{"i", ",", "j"}], "]"}], " ", 
      RowBox[{"h", "[", 
       RowBox[{"i", ",", "j"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.670794173849175*^9, 3.670794185739087*^9}, {
   3.670794489287777*^9, 3.670794504495721*^9}, 3.670794719895282*^9, {
   3.674334094819949*^9, 3.6743341166033907`*^9}, {3.674335018959599*^9, 
   3.674335023671373*^9}, {3.674335567101562*^9, 3.674335570003235*^9}}],

Cell["\<\
we should end up with only 2 independent hij. however, we can\
\[CloseCurlyQuote]t single out two that work for all k. we have to \
distinguish 3 cases:\
\>", "Text",
 CellChangeTimes->{{3.670794734681385*^9, 3.670794786008341*^9}}],

Cell[CellGroupData[{

Cell["if k3 != 0 (compute: h11, h12)", "Subsection",
 CellChangeTimes->{
  3.670793471514966*^9, {3.670794465013084*^9, 3.670794466643923*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"case1", " ", "=", " ", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{"constr", ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"h", "[", 
         RowBox[{"1", ",", "3"}], "]"}], ",", " ", 
        RowBox[{"h", "[", 
         RowBox[{"2", ",", "2"}], "]"}], ",", " ", 
        RowBox[{"h", "[", 
         RowBox[{"2", ",", "3"}], "]"}]}], "}"}]}], "]"}], " ", "//", " ", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"case1", " ", "/.", " ", "replPrint"}]}], "Input",
 CellChangeTimes->{{3.6707925352858152`*^9, 3.670792543367549*^9}, {
  3.670792581037059*^9, 3.670792630827075*^9}, {3.670792838076281*^9, 
  3.670792839499866*^9}, {3.6707930005286007`*^9, 3.670793008919458*^9}, {
  3.670793794745051*^9, 3.670793801168641*^9}, {3.670793945489717*^9, 
  3.670793991298134*^9}, {3.674337241435789*^9, 3.6743372418752604`*^9}}],

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"Expand", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"rhogw", " ", "/.", " ", "replElim"}], " ", "/.", " ", "case1"}],
     " ", "/.", " ", "replPrint"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.674335266040242*^9, 3.674335454234365*^9}, {
  3.674335584603179*^9, 3.674335588738577*^9}}],

Cell[BoxData["hh"], "Input",
 CellChangeTimes->{{3.674336050146388*^9, 3.67433605281087*^9}, {
  3.674336578595937*^9, 3.6743365796987267`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["if k3 = 0, k2 != 0 (compute: h11, h13)", "Subsection",
 CellChangeTimes->{
  3.6707934777190247`*^9, {3.6707944405979633`*^9, 3.6707944594278603`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"case2", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{"constr", ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"h", "[", 
          RowBox[{"1", ",", "2"}], "]"}], ",", " ", 
         RowBox[{"h", "[", 
          RowBox[{"2", ",", "3"}], "]"}], ",", " ", 
         RowBox[{"h", "[", 
          RowBox[{"2", ",", "2"}], "]"}]}], "}"}]}], "]"}], " ", "/.", " ", 
     RowBox[{"{", 
      RowBox[{"k3", "\[Rule]", " ", "0"}], "}"}]}], "//", " ", "Simplify"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{"case2", " ", "/.", " ", "replPrint"}]}], "Input",
 CellChangeTimes->{{3.67079279328753*^9, 3.67079294864776*^9}, {
  3.670793021217956*^9, 3.67079303930772*^9}, {3.6707938148559847`*^9, 
  3.6707938189921*^9}, {3.6707939733393917`*^9, 3.670793998196437*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"rhogw", " ", "/.", " ", "replElim"}], ")"}], " ", "/.", " ", 
       
       RowBox[{"{", 
        RowBox[{"k3", " ", "\[Rule]", " ", "0"}], "}"}]}], ")"}], " ", "/.", 
     " ", "case2"}], ")"}], " ", "/.", " ", "replPrint"}], " ", "//", " ", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.6707941921523123`*^9, 3.670794209176869*^9}, {
   3.6707942664478397`*^9, 3.670794284423154*^9}, 3.670794515855507*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["if k3 = k2 = 0, k1 != 0 (compute: h22, h23)", "Subsection",
 CellChangeTimes->{
  3.6707934828691998`*^9, {3.670794416312169*^9, 3.670794449284306*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"case3", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{"constr", ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"h", "[", 
          RowBox[{"1", ",", "1"}], "]"}], ",", " ", 
         RowBox[{"h", "[", 
          RowBox[{"1", ",", "2"}], "]"}], ",", " ", 
         RowBox[{"h", "[", 
          RowBox[{"1", ",", "3"}], "]"}]}], "}"}]}], "]"}], "/.", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"k2", "\[Rule]", " ", "0"}], ",", " ", 
       RowBox[{"k3", "\[Rule]", " ", "0"}]}], "}"}]}], "//", " ", 
    "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"case3", " ", "/.", " ", "replPrint"}]}], "Input",
 CellChangeTimes->{{3.670793062720467*^9, 3.670793094097837*^9}, {
  3.670793128700981*^9, 3.6707931688721457`*^9}, {3.670793206791643*^9, 
  3.670793232526965*^9}, {3.670793821896265*^9, 3.670793881267445*^9}, {
  3.670793977763228*^9, 3.670794012234108*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"rhogw", " ", "/.", " ", "replElim"}], ")"}], " ", "/.", " ", 
       
       RowBox[{"{", 
        RowBox[{
         RowBox[{"k2", " ", "\[Rule]", " ", "0"}], ",", " ", 
         RowBox[{"k3", " ", "\[Rule]", " ", "0"}]}], "}"}]}], ")"}], " ", "/.",
      " ", "case3"}], ")"}], " ", "/.", " ", "replPrint"}], " ", "//", " ", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.6707942935764513`*^9, 3.670794300326769*^9}, 
   3.67079452019147*^9, {3.670795057014213*^9, 3.670795057966276*^9}}],

Cell["\<\
hence we have to evolve two additional fields on the whole grid:
field 1: h11 where k3!= 0
\th22 where k2=k3=0, k1!=0
field 2: h12 where k3!=0
\th13 where k3=0, k2!=0
\th23 where k3=k2=0, k1!=0\
\>", "Text",
 CellChangeTimes->{{3.670795015221246*^9, 3.6707951356474323`*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "computing traceless transverse part of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["S", "ij"], TraditionalForm]]]
}], "Section",
 CellChangeTimes->{{3.671822881288925*^9, 3.671822898778462*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"k", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"k1", ",", " ", "k2", ",", " ", "k3"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"S", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"s11", ",", "s12", ",", "s13"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"s12", ",", "s22", ",", "s23"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"s13", ",", "s23", ",", "s33"}], "}"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"P", " ", "=", " ", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"KroneckerDelta", "[", 
      RowBox[{"i", ",", "j"}], "]"}], " ", "-", " ", 
     FractionBox[
      RowBox[{
       RowBox[{"k", "[", 
        RowBox[{"[", "i", "]"}], "]"}], " ", 
       RowBox[{"k", "[", 
        RowBox[{"[", "j", "]"}], "]"}], " "}], 
      RowBox[{"k", ".", "k"}]]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ptest", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"k", ".", "k"}], " ", "-", " ", 
          SuperscriptBox["k1", "2"]}], ",", " ", 
         RowBox[{
          RowBox[{"-", "k1"}], " ", "k2"}], ",", 
         RowBox[{
          RowBox[{"-", "k1"}], " ", "k3"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "k1"}], " ", "k2"}], ",", " ", 
         RowBox[{
          RowBox[{"k", ".", "k"}], " ", "-", " ", 
          SuperscriptBox["k2", "2"]}], ",", " ", 
         RowBox[{
          RowBox[{"-", "k2"}], " ", "k3"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "k1"}], " ", "k3"}], ",", " ", 
         RowBox[{
          RowBox[{"-", "k2"}], " ", "k3"}], ",", " ", 
         RowBox[{
          RowBox[{"k", ".", "k"}], " ", "-", " ", 
          SuperscriptBox["k3", "2"]}]}], "}"}]}], "}"}], " ", "/", " ", 
     RowBox[{"(", 
      RowBox[{"k", ".", "k"}], ")"}]}], " ", "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"P", " ", "-", " ", "Ptest"}], " ", "//", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.671823831507477*^9, 3.67182399810497*^9}, {
  3.6718240408902197`*^9, 3.6718240637676563`*^9}, {3.671824554128632*^9, 
  3.6718245542321577`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"P", ".", "P"}], "  ", "-", "P"}], " ", "//", " ", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.687442202792835*^9, 3.687442238754653*^9}}],

Cell[CellGroupData[{

Cell["direct way", "Subsection",
 CellChangeTimes->{{3.671824112663886*^9, 3.671824116597217*^9}, {
  3.6745941053345947`*^9, 3.674594106187696*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"project", "[", "S_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"P", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "k"}], "]"}], "]"}], " ", 
         RowBox[{"S", "[", 
          RowBox[{"[", 
           RowBox[{"k", ",", "l"}], "]"}], "]"}], " ", 
         RowBox[{"P", "[", 
          RowBox[{"[", 
           RowBox[{"l", ",", "j"}], "]"}], "]"}]}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", "3"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"l", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], " ", "-", " ", 
    RowBox[{
     FractionBox["1", "2"], " ", "P", " ", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"P", "[", 
         RowBox[{"[", 
          RowBox[{"l", ",", "m"}], "]"}], "]"}], " ", 
        RowBox[{"S", "[", 
         RowBox[{"[", 
          RowBox[{"l", ",", "m"}], "]"}], "]"}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"m", ",", "1", ",", "3"}], "}"}]}], "]"}]}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6745941456805067`*^9, 3.6745941736453447`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"STT", " ", "=", " ", 
   RowBox[{
    RowBox[{"project", "[", "S", "]"}], " ", "//", " ", "FullSimplify"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.671823295835565*^9, 3.6718233676956787`*^9}, {
   3.671823407189466*^9, 3.671823464668523*^9}, 3.671823502512073*^9, {
   3.674594180290744*^9, 3.674594183346636*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{"STT", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "i"}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], " ", "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.6874423457982397`*^9, 3.68744236088568*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["indirect, as in code", "Subsection",
 CellChangeTimes->{{3.6718241368959723`*^9, 3.6718241413441353`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"f", " ", "=", " ", 
   RowBox[{"k", " ", "/", " ", 
    RowBox[{"(", 
     RowBox[{"k", ".", "k"}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.671823590582671*^9, 3.6718236296770983`*^9}, {
   3.671823773863676*^9, 3.671823782046659*^9}, {3.671824081159912*^9, 
   3.671824099001189*^9}, 3.6718243331844893`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ks", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"k", "[", 
         RowBox[{"[", "m", "]"}], "]"}], " ", 
        RowBox[{"S", "[", 
         RowBox[{"[", 
          RowBox[{"m", ",", "i"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"m", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.671824144175144*^9, 3.6718241982245817`*^9}, {
  3.671824328946871*^9, 3.671824330746773*^9}, {3.673453689070941*^9, 
  3.673453693806582*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"sp", " ", "=", " ", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"k", "[", 
         RowBox[{"[", "l", "]"}], "]"}], " ", 
        RowBox[{"k", "[", 
         RowBox[{"[", "m", "]"}], "]"}]}], 
       RowBox[{"(", 
        RowBox[{"k", ".", "k"}], ")"}]], " ", 
      RowBox[{"S", "[", 
       RowBox[{"[", 
        RowBox[{"l", ",", "m"}], "]"}], "]"}]}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"l", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6718235453305187`*^9, 3.671823558999914*^9}, {
  3.671823646163354*^9, 3.671823678236216*^9}, {3.671824232211576*^9, 
  3.6718242735862103`*^9}, {3.671824325394163*^9, 3.671824327313487*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"s", " ", "=", " ", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"S", "[", 
      RowBox[{"[", 
       RowBox[{"m", ",", "m"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.671823687384165*^9, 3.6718237037671537`*^9}, {
  3.6718243220813513`*^9, 3.671824323815694*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"s1", " ", "=", " ", 
   RowBox[{
    RowBox[{"sp", " ", "+", " ", "s"}], " ", "//", " ", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s2", " ", "=", " ", 
   RowBox[{
    RowBox[{"sp", " ", "-", " ", "s"}], " ", "//", " ", "Simplify"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.671824309067902*^9, 3.671824357107192*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"S11test", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"S", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "-", " ", 
     RowBox[{"2", " ", 
      RowBox[{"f", "[", 
       RowBox[{"[", "1", "]"}], "]"}], " ", 
      RowBox[{"ks", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], " ", "+", " ", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"[", "1", "]"}], "]"}], " ", 
         RowBox[{"k", "[", 
          RowBox[{"[", "1", "]"}], "]"}], " ", "s1"}], " ", "+", " ", "s2"}], 
       ")"}]}]}], " ", "//", " ", "FullSimplify"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6718237180540953`*^9, 3.671823719069503*^9}, {
  3.67182436115917*^9, 3.671824435743271*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"STTtest", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}], " ", "-", " ", 
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"[", "i", "]"}], "]"}], " ", 
       RowBox[{"ks", "[", 
        RowBox[{"[", "j", "]"}], "]"}]}], " ", "-", " ", 
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"[", "j", "]"}], "]"}], " ", 
       RowBox[{"ks", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], " ", "+", " ", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"f", "[", 
        RowBox[{"[", "i", "]"}], "]"}], " ", 
       RowBox[{"k", "[", 
        RowBox[{"[", "j", "]"}], "]"}], " ", "s1"}], " ", "+", " ", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"i", ",", "j"}], "]"}], " ", "s2"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6718245944214497`*^9, 3.671824670050102*^9}, 
   3.671824731165204*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"STTtest", " ", "-", " ", "STT"}], " ", "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.671824437401516*^9, 3.671824445960413*^9}, {
  3.671824674007757*^9, 3.671824677639748*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["all trace parts vanish", "Subsection",
 CellChangeTimes->{{3.674594234748783*^9, 3.6745942386607847`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"project", "[", 
   RowBox[{"a", " ", 
    RowBox[{"IdentityMatrix", "[", "3", "]"}]}], "]"}], " ", "//", " ", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.674594241985955*^9, 3.674594259245674*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "compute perturbed stress energy for ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Pi]", "ij"], TraditionalForm]]]
}], "Section",
 CellChangeTimes->{{3.673792838091783*^9, 3.673792849716989*^9}}],

Cell[BoxData[
 RowBox[{"Quit", "[", "]"}]], "Input",
 CellChangeTimes->{{3.673794517294957*^9, 3.673794518971879*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"gbdd", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", 
       SuperscriptBox["a", "2"], ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       SuperscriptBox["a", "2"], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", 
       SuperscriptBox["a", "2"]}], "}"}]}], "}"}]}], ";", 
  RowBox[{"gbdd", "//", "MatrixForm"}]}]], "Input",
 CellChangeTimes->{{3.67379285400423*^9, 3.673792892161684*^9}, {
  3.673792922825296*^9, 3.673792951918201*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"gbUU", " ", "=", " ", 
   RowBox[{"Inverse", "[", "gbdd", "]"}]}], ";", " ", 
  RowBox[{"gbUU", " ", "//", " ", "MatrixForm"}]}]], "Input",
 CellChangeTimes->{{3.6737928941515417`*^9, 3.673792954525728*^9}, 
   3.673794532163744*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"gbUd", " ", "=", " ", 
   RowBox[{"gbUU", ".", "gbdd"}]}], ";", " ", 
  RowBox[{"gbUd", " ", "//", "MatrixForm"}]}]], "Input",
 CellChangeTimes->{{3.674584382054792*^9, 3.674584393255691*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"gdd", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "1"}], " ", "-", " ", 
        RowBox[{"2", " ", "\[Psi]"}]}], ",", "0", ",", "0", ",", "0"}], "}"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", 
       RowBox[{
        SuperscriptBox["a", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"1", " ", "-", " ", 
          RowBox[{"2", " ", "\[Psi]"}]}], ")"}]}], ",", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{
        SuperscriptBox["a", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"1", " ", "-", " ", 
          RowBox[{"2", " ", "\[Psi]"}]}], ")"}]}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", 
       RowBox[{
        SuperscriptBox["a", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"1", " ", "-", " ", 
          RowBox[{"2", " ", "\[Psi]"}]}], ")"}]}]}], "}"}]}], "}"}]}], ";", 
  RowBox[{"gdd", "//", "MatrixForm"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"gdd", " ", "=", " ", "gbdd"}], ";"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.673792958051701*^9, 3.673793002925412*^9}, {
  3.6745851366017227`*^9, 3.6745851469370728`*^9}, {3.674594323908196*^9, 
  3.674594328411294*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"gUU", " ", "=", " ", 
   RowBox[{
    RowBox[{"Normal", "@", 
     RowBox[{"Series", "[", 
      RowBox[{
       RowBox[{"Inverse", "[", "gdd", "]"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"\[Psi]", ",", "0", ",", "1"}], "}"}]}], "]"}]}], " ", "//", 
    " ", "Simplify"}]}], ";", " ", 
  RowBox[{"gUU", " ", "//", "MatrixForm"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"gUU", " ", "=", " ", "gbUU"}], ";"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.6737930056993113`*^9, 3.673793040067093*^9}, {
  3.6745851485130873`*^9, 3.674585156152369*^9}, {3.674594330586707*^9, 
  3.6745943337949*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"delgdd", " ", "=", " ", 
   RowBox[{
    RowBox[{"gdd", " ", "-", " ", "gbdd"}], " ", "//", "Simplify"}]}], ";", 
  " ", 
  RowBox[{"delgdd", " ", "//", "MatrixForm"}]}]], "Input",
 CellChangeTimes->{{3.673793054479967*^9, 3.6737930803394537`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"delgUU", " ", "=", " ", 
   RowBox[{
    RowBox[{"-", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"gbUU", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}], " ", 
          RowBox[{"gbUU", "[", 
           RowBox[{"[", 
            RowBox[{"k", ",", "l"}], "]"}], "]"}], " ", 
          RowBox[{"delgdd", "[", 
           RowBox[{"[", 
            RowBox[{"j", ",", "l"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"l", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "4"}], "}"}]}], "]"}]}], "//", 
    "Simplify"}]}], ";", " ", 
  RowBox[{"delgUU", " ", "//", "MatrixForm"}]}]], "Input",
 CellChangeTimes->{{3.673793088371325*^9, 3.673793241302326*^9}, {
  3.673812341842267*^9, 3.6738123432581053`*^9}, {3.6738123823292294`*^9, 
  3.6738123876328497`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "test", "*)"}], 
  RowBox[{
   RowBox[{"delgUU", " ", "-", " ", 
    RowBox[{"(", 
     RowBox[{"gUU", " ", "-", " ", "gbUU"}], ")"}]}], " ", "//", " ", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.674583036079071*^9, 3.674583059213319*^9}}],

Cell[BoxData[{
 RowBox[{"\[Phi]d", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    SubscriptBox["\[Phi]", "0"], ",", 
    SubscriptBox["\[Phi]", "1"], ",", 
    SubscriptBox["\[Phi]", "2"], ",", 
    SubscriptBox["\[Phi]", "3"]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"\[Phi]bd", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    SubscriptBox["\[Phi]b", "0"], ",", "0", ",", "0", ",", "0"}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"\[Phi]U", " ", "=", " ", 
  RowBox[{
   RowBox[{"gUU", ".", "\[Phi]d"}], " ", "//", " ", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"\[Phi]bU", " ", "=", " ", 
  RowBox[{
   RowBox[{"gbUU", ".", "\[Phi]bd"}], " ", "//", " ", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"del\[Phi]d", " ", "=", " ", 
  RowBox[{"\[Phi]d", " ", "-", " ", "\[Phi]bd"}]}], "\[IndentingNewLine]", 
 RowBox[{"del\[Phi]U", " ", "=", " ", 
  RowBox[{"\[Phi]U", " ", "-", " ", "\[Phi]bU"}]}]}], "Input",
 CellChangeTimes->{{3.673793336874899*^9, 3.673793630152731*^9}, {
   3.673897333588921*^9, 3.673897351820386*^9}, 3.6738973888360167`*^9, {
   3.674581235655375*^9, 3.67458123935275*^9}, {3.674583088813929*^9, 
   3.674583096323777*^9}, {3.674583685897769*^9, 3.6745836897847633`*^9}, {
   3.674583965388619*^9, 3.6745839942491283`*^9}}],

Cell[CellGroupData[{

Cell["the full stress energy", "Subsection",
 CellChangeTimes->{{3.6737952925014973`*^9, 3.673795297917304*^9}, {
  3.6745944193446712`*^9, 3.674594423784635*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Tdd", " ", "=", " ", 
   RowBox[{
    RowBox[{"Normal", "@", 
     RowBox[{"Series", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"{", "\[Phi]d", "}"}], "]"}], ".", 
         RowBox[{"{", "\[Phi]d", "}"}]}], " ", "-", " ", 
        RowBox[{"gdd", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            FractionBox["1", "2"], " ", 
            RowBox[{"\[Phi]U", ".", " ", "\[Phi]d"}]}], " ", "+", " ", "V"}], 
          ")"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Psi]", ",", "0", ",", "1"}], "}"}]}], "]"}]}], " ", "//", 
    " ", "Simplify"}]}], ";", " ", 
  RowBox[{"Tdd", " ", "//", "MatrixForm"}]}]], "Input",
 CellChangeTimes->{{3.673794559245278*^9, 3.673794648932283*^9}, {
  3.6737968397053747`*^9, 3.6737968507842093`*^9}, {3.67458135313997*^9, 
  3.6745813600511513`*^9}, {3.6745813961975946`*^9, 3.6745813963000593`*^9}, {
  3.674581780250752*^9, 3.6745817803295393`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TUd", " ", "=", " ", 
   RowBox[{
    RowBox[{"Normal", "@", 
     RowBox[{"Series", "[", 
      RowBox[{
       RowBox[{"gUU", ".", "Tdd"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Psi]", ",", "0", ",", "1"}], "}"}]}], "]"}]}], " ", "//", 
    " ", "Simplify"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6737953272302094`*^9, 3.673795330142243*^9}, {
  3.67458139985141*^9, 3.6745813999869337`*^9}, {3.674581776105666*^9, 
  3.674581776193356*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Tkk", " ", "=", " ", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"TUd", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "i"}], "]"}], "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"i", ",", "2", ",", "4"}], "}"}]}], "]"}], " ", "//", " ", 
    "FullSimplify"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.673795312250869*^9, 3.673795334782124*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "the perturbed stress energy, perturbation from ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["T", "\[Mu]\[Nu]"], "-"}], "<", 
    SubscriptBox["T", "\[Mu]\[Nu]"], ">"}], TraditionalForm]]]
}], "Subsection",
 CellChangeTimes->{{3.6738958229609547`*^9, 3.6738958730964003`*^9}, {
  3.674581174362246*^9, 3.674581180286648*^9}, {3.674594411409441*^9, 
  3.674594416065052*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Tbdd", " ", "=", "  ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{"{", "\[Phi]bd", "}"}], "]"}], ".", 
      RowBox[{"{", "\[Phi]bd", "}"}]}], " ", "-", " ", 
     RowBox[{"gbdd", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"gbUU", ".", "\[Phi]bd"}], ")"}], ".", "\[Phi]bd"}]}], " ",
         "+", " ", "V"}], ")"}]}]}], " ", "//", " ", "Simplify"}]}], ";", " ", 
  RowBox[{"Tbdd", " ", "//", "MatrixForm"}]}]], "Input",
 CellChangeTimes->{{3.6738958809415283`*^9, 3.673895913920813*^9}, {
   3.67389596701513*^9, 3.67389597001507*^9}, {3.673896139274868*^9, 
   3.6738961686174297`*^9}, 3.673896206584147*^9, {3.673897364860648*^9, 
   3.673897398267354*^9}, {3.674579009871077*^9, 3.674579033987351*^9}, {
   3.674579140107149*^9, 3.674579230922861*^9}, 3.67458130726825*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"delTdd", " ", "=", " ", 
   RowBox[{
    RowBox[{"Tdd", " ", "-", " ", "Tbdd"}], " ", "//", " ", 
    "FullSimplify"}]}], ";", " ", 
  RowBox[{"delTdd", " ", "//", "MatrixForm"}]}]], "Input",
 CellChangeTimes->{{3.6738958740525503`*^9, 3.6738958779680862`*^9}, {
  3.673896225230307*^9, 3.6738962350459948`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"delTdd", " ", "/.", " ", 
   RowBox[{"{", 
    RowBox[{"\[Psi]", "\[Rule]", " ", "0"}], "}"}]}], " ", "//", " ", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.674594434346168*^9, 3.674594444705371*^9}}],

Cell[CellGroupData[{

Cell["show that we do not need the extra part", "Subsubsection",
 CellChangeTimes->{{3.674594560904846*^9, 3.6745945675522614`*^9}}],

Cell[BoxData[
 RowBox[{"simplepart", " ", "=", " ", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{"\[Phi]d", "[", 
      RowBox[{"[", 
       RowBox[{"2", ";;", "4"}], "]"}], "]"}], "}"}], "]"}], ".", 
   RowBox[{"{", 
    RowBox[{"\[Phi]d", "[", 
     RowBox[{"[", 
      RowBox[{"2", ";;", "4"}], "]"}], "]"}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.6745945848607197`*^9, 3.674594593617774*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"project", "[", 
    RowBox[{"delTdd", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"2", ";;", "4"}], ",", 
       RowBox[{"2", ";;", "4"}]}], "]"}], "]"}], "]"}], " ", "-", " ", 
   RowBox[{"project", "[", "simplepart", "]"}]}], " ", "//", " ", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.6745944672951202`*^9, 3.674594550636203*^9}, {
  3.674594583252577*^9, 3.674594600809843*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
this would be the extra part that we don\[CloseCurlyQuote]t need because it\
\[CloseCurlyQuote]s a pure trace\
\>", "Subsubsection",
 CellChangeTimes->{{3.674594373036306*^9, 3.67459439866527*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"TbUd", " ", "=", " ", 
   RowBox[{
    RowBox[{"Normal", "@", 
     RowBox[{"Series", "[", 
      RowBox[{
       RowBox[{"gUU", ".", "Tbdd"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Psi]", ",", "0", ",", "1"}], "}"}]}], "]"}]}], " ", "//", 
    "Simplify"}]}], ";", " ", 
  RowBox[{"TbUd", " ", "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TbUd", " ", "=", "  ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{"{", "\[Phi]bU", "}"}], "]"}], ".", 
      RowBox[{"{", "\[Phi]bd", "}"}]}], " ", "-", " ", 
     RowBox[{"gbUd", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"gbUU", ".", "\[Phi]bd"}], ")"}], ".", "\[Phi]bd"}]}], " ",
         "+", " ", "V"}], ")"}]}]}], " ", "//", " ", "Simplify"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.674581679048296*^9, 3.674581711499064*^9}, 
   3.674582047516349*^9, {3.674582647989667*^9, 3.6745826501010103`*^9}, {
   3.674582696238307*^9, 3.674582717750575*^9}, 3.674582759760984*^9, 
   3.674582792031609*^9, 3.6745829227737303`*^9, {3.6745835529847193`*^9, 
   3.6745835634965477`*^9}, {3.674584349865239*^9, 3.674584361409487*^9}, {
   3.67458442002274*^9, 3.674584452078967*^9}}],

Cell[TextData[{
 "watch out! ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    SuperscriptBox["\[Delta]T", "\[Mu]"], "\[Nu]"], TraditionalForm]]],
 " is complicated! (weinberg p. 223 (5.1.28))"
}], "Text",
 CellChangeTimes->{{3.674583442197085*^9, 3.67458348616389*^9}, {
  3.6745840054816103`*^9, 3.6745840061994133`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"delTUd", " ", "=", " ", 
   RowBox[{
    RowBox[{"Normal", "@", 
     RowBox[{"Series", "[", 
      RowBox[{
       RowBox[{"gbUU", ".", 
        RowBox[{"(", 
         RowBox[{"delTdd", " ", "-", " ", 
          RowBox[{"delgdd", ".", "TbUd"}]}], ")"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Psi]", ",", "0", ",", "1"}], "}"}]}], "]"}]}], " ", "//", 
    " ", "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"delTUd", " ", "=", " ", 
   RowBox[{
    RowBox[{"TUd", " ", "-", " ", "TbUd"}], " ", "//", "Simplify"}]}], ";", 
  " ", 
  RowBox[{"delTUd", " ", "//", "MatrixForm"}]}]}], "Input",
 CellChangeTimes->{{3.673896996572784*^9, 3.673897016420619*^9}, 
   3.673897126514202*^9, {3.67389725251021*^9, 3.673897260853804*^9}, {
   3.674581615836371*^9, 3.6745816336597557`*^9}, {3.674582430044661*^9, 
   3.67458246444307*^9}, {3.67458262597398*^9, 3.67458267438805*^9}, {
   3.6745828675309258`*^9, 3.6745828802163897`*^9}, {3.674582929027999*^9, 
   3.674582943283283*^9}, {3.674583489134286*^9, 3.674583528931271*^9}, {
   3.674584460803594*^9, 3.674584465218535*^9}}],

Cell[BoxData[
 RowBox[{"delTkk", " ", "=", " ", 
  RowBox[{
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"delTUd", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "i"}], "]"}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", "2", ",", "4"}], "}"}]}], "]"}], " ", "//", " ", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.67379416177908*^9, 3.673794230076178*^9}, 
   3.67379434149864*^9, {3.673794483264141*^9, 3.673794508036312*^9}, {
   3.6737947592560263`*^9, 3.67379475978365*^9}, {3.673794855140959*^9, 
   3.6737948553806257`*^9}, {3.673794961312037*^9, 3.673794963247634*^9}, {
   3.67379501778337*^9, 3.673795026808243*^9}, 3.674579426092169*^9, {
   3.674581895631254*^9, 3.674581899871231*^9}, {3.6745819880774193`*^9, 
   3.6745819914927473`*^9}}],

Cell[BoxData[
 RowBox[{"part2", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"-", " ", 
     FractionBox[
      SuperscriptBox["a", "2"], "3"]}], "  ", 
    RowBox[{"Normal", "@", 
     RowBox[{"Series", "[", 
      RowBox[{"delTkk", ",", 
       RowBox[{"{", 
        RowBox[{"\[Psi]", ",", "0", ",", "1"}], "}"}]}], "]"}]}], " ", 
    RowBox[{"IdentityMatrix", "[", "4", "]"}]}], " ", "//", " ", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.673794246156869*^9, 3.673794384438599*^9}, 
   3.6737956914837914`*^9, {3.673795736450972*^9, 3.6737957369388742`*^9}, 
   3.673897102167088*^9, {3.674579459172419*^9, 3.674579472243334*^9}, {
   3.674582174439973*^9, 3.6745821846553793`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"res", " ", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"delTdd", " ", "+", " ", "part2"}], ")"}], "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"2", ";;", "4"}], ",", 
       RowBox[{"2", ";;", "4"}]}], "]"}], "]"}], " ", "//", " ", 
    "FullSimplify"}]}], ";", " ", 
  RowBox[{"res", "//", " ", "MatrixForm"}]}]], "Input",
 CellChangeTimes->{{3.673794334980837*^9, 3.673794353473489*^9}, {
  3.673794793804879*^9, 3.673794851812316*^9}, {3.673795114265855*^9, 
  3.673795133152718*^9}, {3.673795222479186*^9, 3.67379524158241*^9}, {
  3.673897060402279*^9, 3.6738970625466633`*^9}, {3.674578980943074*^9, 
  3.674578987150648*^9}, {3.674581930336502*^9, 3.6745819408561993`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"res", " ", "/.", " ", 
    RowBox[{"{", 
     RowBox[{"\[Psi]", " ", "\[Rule]", " ", "0"}], "}"}]}], "//", " ", 
   "FullSimplify"}], " ", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.673795508960752*^9, 3.673795537225665*^9}, {
  3.673795580321636*^9, 3.673795605792858*^9}, {3.673897455610681*^9, 
  3.6738976683863583`*^9}, {3.673897724909194*^9, 3.673897728156105*^9}, {
  3.674578246665913*^9, 3.674578254376109*^9}, {3.6745786614590178`*^9, 
  3.674578663618279*^9}, {3.6745819257368927`*^9, 3.6745819688326597`*^9}, {
  3.674582779000198*^9, 3.6745827808899813`*^9}}]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "with the perturbed stress energy, perturbation from analytic ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["T", "\[Mu]\[Nu]"], TraditionalForm]]]
}], "Subsection",
 CellChangeTimes->{{3.6737953028609667`*^9, 3.6737953062769623`*^9}, {
  3.6738958531608953`*^9, 3.673895863172035*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"delTdd", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{"{", "\[Phi]d", "}"}], "]"}], ".", 
      RowBox[{"{", "del\[Phi]d", "}"}]}], " ", "+", " ", 
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{"{", "del\[Phi]d", "}"}], "]"}], ".", 
      RowBox[{"{", "\[Phi]d", "}"}]}], " ", "-", " ", 
     RowBox[{"delgdd", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"\[Phi]U", ".", "\[Phi]d"}]}], " ", "+", " ", "V"}], ")"}]}],
      " ", "-", " ", 
     RowBox[{"gdd", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"delgUU", ".", "\[Phi]d"}], ")"}], ".", "\[Phi]d"}]}], " ",
         "+", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"gUU", ".", "del\[Phi]d"}], ")"}], ".", "\[Phi]d"}], " ", 
        "+", " ", 
        RowBox[{
         RowBox[{"V", "'"}], " ", "del\[Phi]"}]}], ")"}]}]}], " ", "//", " ", 
    "FullSimplify"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6737935951692533`*^9, 3.673793597185151*^9}, {
   3.673793645045169*^9, 3.6737936811821613`*^9}, {3.673793731550466*^9, 
   3.6737937317087107`*^9}, {3.6737937883734493`*^9, 3.673793980176798*^9}, 
   3.673794159138194*^9, {3.673896007909066*^9, 3.673896011428439*^9}, {
   3.673896050467526*^9, 3.6738960509792767`*^9}, {3.673896099684327*^9, 
   3.673896107716267*^9}, {3.67389722963284*^9, 3.67389723480079*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"delTUd", " ", "=", " ", 
   RowBox[{
    RowBox[{"Normal", "@", 
     RowBox[{"Series", "[", 
      RowBox[{
       RowBox[{"gbUU", ".", 
        RowBox[{"(", 
         RowBox[{"delTdd", " ", "-", " ", 
          RowBox[{"delgdd", ".", "TbUd"}]}], ")"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Psi]", ",", "0", ",", "1"}], "}"}]}], "]"}]}], " ", "//", 
    " ", "Simplify"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.673794976421626*^9, 3.673795010800846*^9}, {
  3.6745822919406967`*^9, 3.674582297572523*^9}, {3.674583710215762*^9, 
  3.67458373097552*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"part1", " ", "=", " ", 
   RowBox[{
    RowBox[{"Normal", "@", 
     RowBox[{"Series", "[", 
      RowBox[{"delTdd", ",", 
       RowBox[{"{", 
        RowBox[{"\[Psi]", ",", "0", ",", "1"}], "}"}]}], "]"}]}], " ", "//", 
    " ", "FullSimplify"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.673793987590053*^9, 3.673794013331957*^9}, {
  3.673794115112061*^9, 3.6737941171509733`*^9}, {3.6737941500533133`*^9, 
  3.673794157132907*^9}, {3.6737947572481213`*^9, 3.67379477740049*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"delTkk", " ", "=", " ", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"delTUd", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "i"}], "]"}], "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"i", ",", "2", ",", "4"}], "}"}]}], "]"}], " ", "//", " ", 
    "FullSimplify"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.67379416177908*^9, 3.673794230076178*^9}, 
   3.67379434149864*^9, {3.673794483264141*^9, 3.673794508036312*^9}, {
   3.6737947592560263`*^9, 3.67379475978365*^9}, {3.673794855140959*^9, 
   3.6737948553806257`*^9}, {3.673794961312037*^9, 3.673794963247634*^9}, {
   3.67379501778337*^9, 3.673795026808243*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"part2", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"-", " ", 
      FractionBox[
       SuperscriptBox["a", "2"], "3"]}], "  ", 
     RowBox[{"Normal", "@", 
      RowBox[{"Series", "[", 
       RowBox[{"delTkk", ",", 
        RowBox[{"{", 
         RowBox[{"\[Psi]", ",", "0", ",", "1"}], "}"}]}], "]"}]}], " ", 
     RowBox[{"IdentityMatrix", "[", "4", "]"}]}], " ", "//", " ", 
    "FullSimplify"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.673794246156869*^9, 3.673794384438599*^9}, 
   3.6737956914837914`*^9, {3.673795736450972*^9, 3.6737957369388742`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"res", " ", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"part1", " ", "+", " ", "part2"}], ")"}], "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"2", ";;", "4"}], ",", 
       RowBox[{"2", ";;", "4"}]}], "]"}], "]"}], " ", "//", " ", 
    "FullSimplify"}]}], ";", " ", 
  RowBox[{"res", " ", "//", " ", "MatrixForm"}]}]], "Input",
 CellChangeTimes->{{3.673794334980837*^9, 3.673794353473489*^9}, {
  3.673794793804879*^9, 3.673794851812316*^9}, {3.673795114265855*^9, 
  3.673795133152718*^9}, {3.673795222479186*^9, 3.67379524158241*^9}, {
  3.674584083916136*^9, 3.674584084867552*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"res", " ", "/.", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["del\[Phi]", "0"], "\[Rule]", " ", 
      SubscriptBox["\[Phi]", "0"]}], ",", 
     RowBox[{
      SubscriptBox["del\[Phi]", "1"], "\[Rule]", " ", 
      SubscriptBox["\[Phi]", "1"]}], ",", 
     RowBox[{
      SubscriptBox["del\[Phi]", "2"], "\[Rule]", " ", 
      SubscriptBox["\[Phi]", "2"]}], ",", 
     RowBox[{
      SubscriptBox["del\[Phi]", "3"], "\[Rule]", " ", 
      SubscriptBox["\[Phi]", "3"]}]}], "}"}]}], " ", "//", " ", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.673795508960752*^9, 3.673795537225665*^9}, {
  3.673795580321636*^9, 3.673795605792858*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["from 0712.2991", "Subsection",
 CellChangeTimes->{3.6738043233703814`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"g07dd", " ", "=", " ", 
    RowBox[{"DiagonalMatrix", "[", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       SuperscriptBox["a", "2"], ",", 
       SuperscriptBox["a", "2"], ",", 
       SuperscriptBox["a", "2"]}], "}"}], "]"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"g07dd", " ", "=", " ", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.673804344646421*^9, 3.673804379629547*^9}, 
   3.6739801297418337`*^9, {3.674578694228944*^9, 3.6745786966355543`*^9}, {
   3.674579533474511*^9, 3.6745795516476603`*^9}, {3.6745798697163982`*^9, 
   3.674579871267758*^9}, {3.674583840024651*^9, 3.6745838431761103`*^9}, {
   3.6745852035223722`*^9, 3.674585211489307*^9}}],

Cell[BoxData[
 RowBox[{"g07UU", " ", "=", " ", 
  RowBox[{"Inverse", "[", "g07dd", "]"}]}]], "Input",
 CellChangeTimes->{{3.673812517033687*^9, 3.67381252387339*^9}}],

Cell[BoxData[
 RowBox[{"\[Phi]07U", " ", "=", " ", 
  RowBox[{
   RowBox[{"g07UU", " ", ".", " ", "\[Phi]d"}], " ", "//", " ", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.673804458004095*^9, 3.6738044779206333`*^9}, {
   3.6738125285375633`*^9, 3.673812530257279*^9}, 3.673812594811657*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"S", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Transpose", "@", 
       RowBox[{"{", 
        RowBox[{"\[Phi]d", "[", 
         RowBox[{"[", 
          RowBox[{"2", ";;", "4"}], "]"}], "]"}], "}"}]}], ".", 
      RowBox[{"{", 
       RowBox[{"\[Phi]d", "[", 
        RowBox[{"[", 
         RowBox[{"2", ";;", "4"}], "]"}], "]"}], "}"}]}], " ", "-", " ", 
     RowBox[{
      FractionBox[
       RowBox[{"1", " "}], "3"], 
      RowBox[{"IdentityMatrix", "[", "3", "]"}], " ", 
      RowBox[{
       RowBox[{"\[Phi]07U", "[", 
        RowBox[{"[", 
         RowBox[{"2", ";;", "4"}], "]"}], "]"}], ".", 
       RowBox[{"\[Phi]d", "[", 
        RowBox[{"[", 
         RowBox[{"2", ";;", "4"}], "]"}], "]"}]}]}]}], " ", "//", " ", 
    "Simplify"}]}], ";", " ", 
  RowBox[{"S", " ", "//", " ", "MatrixForm"}]}]], "Input",
 CellChangeTimes->{{3.673794900170871*^9, 3.6737949402642508`*^9}, 
   3.6737950431379004`*^9, {3.673795145213344*^9, 3.673795204032604*^9}, {
   3.6737952495314913`*^9, 3.6737952531220207`*^9}, {3.6738044833139067`*^9, 
   3.6738044852340508`*^9}, {3.673804689462798*^9, 3.673804692437989*^9}, {
   3.673812573758624*^9, 3.673812575222301*^9}, {3.673812615919908*^9, 
   3.673812617887246*^9}, {3.673812654972999*^9, 3.673812664116213*^9}, {
   3.673812717779345*^9, 3.673812790829685*^9}, {3.673812852291766*^9, 
   3.6738129374831657`*^9}, {3.673896924607202*^9, 3.673896971048696*^9}, {
   3.6739800767261477`*^9, 3.673980077622878*^9}, {3.6745787410135098`*^9, 
   3.674578741933488*^9}, {3.6745788798238707`*^9, 3.674578885095956*^9}, {
   3.674579546265388*^9, 3.674579546712339*^9}, {3.6745798792030153`*^9, 
   3.674579880748212*^9}, {3.674583779821951*^9, 3.674583800448256*^9}, {
   3.674585222482419*^9, 3.674585232767372*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["parametric resonance", "Section",
 CellChangeTimes->{{3.6874421042969646`*^9, 3.687442113808825*^9}}],

Cell[BoxData[
 RowBox[{"ass", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"m", " ", ">", " ", "0"}], ",", " ", 
    RowBox[{
     RowBox[{"a", "[", "t", "]"}], " ", ">", "0"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "'"}], "[", "t", "]"}], " ", ">", "0"}], ",", " ", 
    RowBox[{"phie", " ", ">", "0"}], ",", " ", 
    RowBox[{"ae", " ", ">", " ", "0"}], ",", " ", 
    RowBox[{"t", " ", ">", "0"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.6874238866948843`*^9, 3.687423905565579*^9}, {
  3.687424011571663*^9, 3.687424038523675*^9}, {3.68742443048726*^9, 
  3.6874244323172197`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"phi", "[", "t", "]"}], " ", "=", " ", 
  RowBox[{"phie", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     FractionBox["ae", 
      RowBox[{"a", "[", "t", "]"}]], ")"}], 
    RowBox[{"3", "/", "2"}]], 
   RowBox[{"Sin", "[", 
    RowBox[{"m", " ", "t"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.687422959079772*^9, 3.687423011864917*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dphi", "[", "t", "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{"Series", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"phi", "[", "t", "]"}], ",", "t"}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", "[", "t", "]"}], ",", "0", ",", "1"}], "}"}]}], "]"}], 
   " ", "//", " ", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.6874229992018433`*^9, 3.687423025422387*^9}, {
  3.6874243519415817`*^9, 3.687424359717087*^9}}],

Cell[BoxData[
 RowBox[{"Normal", "@", 
  RowBox[{"Series", "[", 
   RowBox[{
    RowBox[{"dphi", "[", "t", "]"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"a", "[", "t", "]"}], ",", "0", ",", "2"}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.687423174790627*^9, 3.6874232338964853`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"V", "[", 
   RowBox[{"phi", "[", "t", "]"}], "]"}], " ", "=", " ", 
  RowBox[{
   SuperscriptBox["m", "2"], " ", 
   FractionBox[
    SuperscriptBox[
     RowBox[{"phi", "[", "t", "]"}], "2"], "2"]}]}]], "Input",
 CellChangeTimes->{{3.687423312900002*^9, 3.687423333693898*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Vp", "[", 
   RowBox[{"phi", "[", "t", "]"}], "]"}], " ", "=", " ", 
  RowBox[{
   SuperscriptBox["m", "2"], " ", 
   RowBox[{"phi", "[", "t", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.687424380424193*^9, 3.687424390744425*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Hsq", "[", "t", "]"}], " ", "=", " ", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{
       FractionBox["\[Kappa]", "3"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], " ", 
          SuperscriptBox[
           RowBox[{"dphi", "[", "t", "]"}], "2"]}], " ", "+", " ", 
         RowBox[{"V", "[", 
          RowBox[{"phi", "[", "t", "]"}], "]"}]}], ")"}]}], ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"a", "[", "t", "]"}], ",", "0", ",", "1"}], "}"}]}], "]"}], 
    ",", " ", 
    RowBox[{"Assumptions", "\[Rule]", "ass"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.687423145571349*^9, 3.687423159909832*^9}, {
  3.687423277894145*^9, 3.6874233076368933`*^9}, {3.687423368621339*^9, 
  3.687423370686677*^9}, {3.687424399782732*^9, 3.687424418245946*^9}, {
  3.68742447098738*^9, 3.687424488970498*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"H", "[", "t", "]"}], " ", "=", " ", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{"SeriesCoefficient", "[", 
       RowBox[{
        RowBox[{"Hsq", "[", "t", "]"}], ",", " ", 
        RowBox[{"-", "3"}]}], "]"}], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "t", "]"}], 
       RowBox[{"-", "3"}]]}], "]"}], ",", " ", 
    RowBox[{"Assumptions", "\[Rule]", "ass"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.687424839165597*^9, 3.687424884229246*^9}}],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{"pre", "=", " ", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{"dphi", "[", "t", "]"}], 
       RowBox[{"H", "[", "t", "]"}]], " ", 
      SuperscriptBox["m", "2"], 
      RowBox[{"phi", "[", "t", "]"}]}], ",", " ", 
     RowBox[{"Assumptions", "\[Rule]", "ass"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.687423680904636*^9, 3.687423749342581*^9}, {
  3.687423814062821*^9, 3.687423818004919*^9}, {3.687423882807414*^9, 
  3.6874238834301243`*^9}}],

Cell[BoxData[
 RowBox[{"term", " ", "=", " ", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"2", " ", "\[Kappa]", " ", 
     RowBox[{"SeriesCoefficient", "[", 
      RowBox[{"pre", ",", " ", 
       RowBox[{
        RowBox[{"-", "3"}], "/", "2"}]}], "]"}], " ", 
     SuperscriptBox[
      RowBox[{"a", "[", "t", "]"}], 
      RowBox[{
       RowBox[{"-", "3"}], "/", "2"}]]}], ",", " ", 
    RowBox[{"Assumptions", "\[Rule]", "ass"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.687423753949991*^9, 3.687423875830628*^9}, {
  3.6874249135707693`*^9, 3.687424918242189*^9}, {3.687424986304624*^9, 
  3.6874250113022327`*^9}, {3.687425068457508*^9, 3.6874250701930113`*^9}}],

Cell[BoxData[
 RowBox[{"z", " ", "=", " ", 
  RowBox[{
   RowBox[{"m", " ", "t"}], " ", "+", 
   FractionBox["\[Pi]", "4"]}]}]], "Input",
 CellChangeTimes->{{3.687425023996634*^9, 3.687425041217854*^9}}],

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"term", " ", "-", " ", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{"6", " ", "\[Kappa]"}], "]"}], " ", "phie", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["ae", 
        RowBox[{"a", "[", "t", "]"}]], ")"}], 
      RowBox[{"3", "/", "2"}]], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", "z"}], "]"}]}]}], ",", " ", 
   RowBox[{"Assumptions", "\[Rule]", "ass"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6874250131414022`*^9, 3.687425148469545*^9}, {
  3.687425218707068*^9, 3.687425219194994*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["gaussian random fields kernel", "Section",
 CellChangeTimes->{{3.6890919011972103`*^9, 3.689091904514647*^9}}],

Cell[BoxData[
 RowBox[{"m", "=", "1"}]], "Input",
 CellChangeTimes->{{3.6890921168175173`*^9, 3.6890921176032467`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"f", "[", "r_", "]"}], " ", ":=", 
  RowBox[{"NIntegrate", "[", 
   RowBox[{
    RowBox[{
     FractionBox["1", 
      RowBox[{"Sqrt", "[", "\[Pi]", "]"}]], " ", 
     FractionBox[
      SuperscriptBox["k", "2"], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["k", "2"], " ", "+", " ", 
         SuperscriptBox["m", "2"]}], ")"}], 
       FractionBox["1", "4"]]], " ", 
     RowBox[{"Sinc", "[", 
      RowBox[{"k", " ", "r"}], "]"}]}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"k", ",", "0", ",", "Infinity"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.689091906698948*^9, 3.68909197350464*^9}, {
  3.6890920142562923`*^9, 3.6890920779095707`*^9}, {3.6890923784846077`*^9, 
  3.6890923948748417`*^9}}],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"f", "[", "r", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"r", ",", "0", ",", "6"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6890920248905163`*^9, 3.689092025624197*^9}, {
  3.689092060484584*^9, 3.689092094532406*^9}, {3.6890923818681602`*^9, 
  3.689092405018859*^9}, {3.689094735843115*^9, 3.6890947634344053`*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6890920097630997`*^9, 3.689092012032659*^9}}],

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{"Exp", "[", 
      RowBox[{"\[ImaginaryI]", " ", "k", " ", "r", " ", "t"}], "]"}], "  ", 
     ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", 
       RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}], ",", 
   RowBox[{"Assumptions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"k", ">", "0"}], ",", " ", 
      RowBox[{"r", ">", "0"}]}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.689096754334342*^9, 3.6890968087079906`*^9}, {
   3.6890974371679688`*^9, 3.689097457215066*^9}, 3.6890980522138033`*^9, {
   3.689098145505851*^9, 3.6890981457056503`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["perturbed Einstein equations (compact)", "Subchapter",
 CellChangeTimes->{{3.689144860329439*^9, 3.689144878696616*^9}}],

Cell[CellGroupData[{

Cell["initialization", "Section",
 CellChangeTimes->{{3.687010686327883*^9, 3.6870106891016006`*^9}}],

Cell[BoxData[
 RowBox[{"Quit", "[", "]"}]], "Input",
 CellChangeTimes->{{3.687011506673355*^9, 3.68701150768678*^9}}],

Cell[BoxData[
 RowBox[{"<<", "EDCRGTCcode.m"}]], "Input",
 CellChangeTimes->{{3.687009597329968*^9, 3.6870096036236687`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["pretty printing", "Section",
 CellChangeTimes->{{3.687010692469817*^9, 3.6870106944854507`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"expansionOrder", " ", "=", " ", "2"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tolin", "[", "f_", "]"}], " ", ":=", " ", 
   RowBox[{"Simplify", "@", 
    RowBox[{"Normal", "@", 
     RowBox[{"Series", "[", 
      RowBox[{"f", ",", " ", 
       RowBox[{"{", 
        RowBox[{"Psi", ",", "0", ",", "expansionOrder"}], "}"}]}], 
      "]"}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.66162916071454*^9, 3.6616291837383413`*^9}, {
  3.66162936215162*^9, 3.661629364199099*^9}, {3.662851102293614*^9, 
  3.662851114045546*^9}, {3.662851155506918*^9, 3.662851155682184*^9}, {
  3.663090499285575*^9, 3.663090499452745*^9}, {3.6630910911647577`*^9, 
  3.663091091252843*^9}, {3.66309178085858*^9, 3.663091781120894*^9}, {
  3.66309204810703*^9, 3.663092048240993*^9}, {3.663094035124029*^9, 
  3.663094035530568*^9}, {3.663897903918662*^9, 3.66389792976507*^9}, {
  3.663898027744709*^9, 3.6638980278725567`*^9}, {3.66421649557686*^9, 
  3.664216499719297*^9}, {3.687007423852401*^9, 3.687007424652383*^9}, {
  3.687008718750409*^9, 3.687008718941927*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"printrepl", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox["phi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "dphi"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["phi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "xphi"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["phi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "1", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "yphi"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["phi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "zphi"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       SuperscriptBox["phi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"2", ",", "0", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "ddphi"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["phi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "2", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "xxphi"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["phi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "2", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "yyphi"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["phi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "0", ",", "2"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "zzphi"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "[", "t", "]"}], " ", "\[Rule]", " ", "a"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"a", "'"}], "[", "t", "]"}], " ", "\[Rule]", " ", "da"}], ",", 
     
     RowBox[{
      RowBox[{
       RowBox[{"a", "''"}], "[", "t", "]"}], " ", "\[Rule]", " ", "dda"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"V", "[", 
       RowBox[{"phi", "[", 
        RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "]"}], " ", 
      "\[Rule]", " ", "V"}], ",", " ", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"V", "[", 
         RowBox[{"phi", "[", 
          RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "]"}], ",", 
        RowBox[{"phi", "[", 
         RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], "]"}], " ", 
      "\[Rule]", " ", "Vprime"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Psi", "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "Psi"}], ",", " ", 
     RowBox[{
      RowBox[{
       SuperscriptBox["Psi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "dPsi"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["Psi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "xPsi"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["Psi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "1", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "yPsi"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["Psi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "zPsi"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       SuperscriptBox["Psi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"2", ",", "0", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "ddPsi"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["Psi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "2", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "xxPsi"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["Psi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "2", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "yyPsi"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["Psi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "0", ",", "2"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "zzPsi"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       SuperscriptBox["Psi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "1", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "xdPsi"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["Psi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0", ",", "1", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "ydPsi"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["Psi", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0", ",", "0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "\[Rule]", 
      " ", "zdPsi"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.659213914364317*^9, 3.65921392209678*^9}, {
   3.659214396071636*^9, 3.659214400462729*^9}, {3.6592144383026733`*^9, 
   3.659214534062351*^9}, {3.659214571991007*^9, 3.6592146891433773`*^9}, {
   3.659214787192404*^9, 3.65921479109603*^9}, {3.662742990338163*^9, 
   3.662743083577395*^9}, 3.662756343169889*^9, {3.6628290815125513`*^9, 
   3.6628291014635468`*^9}, {3.6628292399271717`*^9, 3.662829244141405*^9}, {
   3.662851658665413*^9, 3.66285168577603*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Psisqrepllist", " ", "=", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Derivative", "@@", "#"}], ")"}], "[", "Psi", "]"}], "[", 
         RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], " ", "&"}], " ", 
       "/@", " ", 
       RowBox[{"Tuples", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], ",", " ", 
         RowBox[{"{", "4", "}"}]}], "]"}]}], ",", "Psi", ",", " ", "dPsi", 
      ",", " ", "xPsi", ",", " ", "yPsi", ",", " ", "zPsi", ",", " ", "lPsi", 
      ",", " ", "gPsi", ",", " ", "ddPsi", ",", " ", "xxPsi", ",", " ", 
      "yyPsi", ",", " ", "zzPsi", ",", " ", "xdPsi", ",", " ", "ydPsi", ",", 
      " ", "zdPsi"}], " ", "}"}], " ", "//", " ", "Flatten"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.687012539981927*^9, 3.687012565839197*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Psisqrepl", " ", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"#", "\[Rule]", " ", "0"}], ")"}], "&"}], "/@", 
    RowBox[{"Times", "@@@", 
     RowBox[{"Tuples", "[", 
      RowBox[{"Psisqrepllist", ",", " ", 
       RowBox[{"{", "2", "}"}]}], "]"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.663093091206379*^9, 3.663093225696507*^9}, {
   3.663093267811098*^9, 3.663093325344105*^9}, {3.663093364695919*^9, 
   3.663093422118293*^9}, {3.663093495623479*^9, 3.663093520561963*^9}, 
   3.663093566528418*^9, {3.664214806435214*^9, 3.6642148088114557`*^9}, {
   3.664214887069092*^9, 3.664214889708708*^9}, {3.66421494164084*^9, 
   3.6642149469110823`*^9}, {3.6870103830886183`*^9, 3.687010406070396*^9}, {
   3.687011965909936*^9, 3.687011982077387*^9}, {3.687012524745158*^9, 
   3.687012574280058*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"oprepl", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"xxphi", " ", "\[Rule]", "  ", 
      RowBox[{"lphi", " ", "-", " ", "yyphi", " ", "-", " ", "zzphi"}]}], ",", 
     RowBox[{"xxPsi", " ", "\[Rule]", "  ", 
      RowBox[{"lPsi", " ", "-", " ", "yyPsi", " ", "-", " ", "zzPsi"}]}], ",",
      " ", 
     RowBox[{
      RowBox[{"xphi", " ", "xPsi"}], " ", "\[Rule]", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "yphi"}], " ", "yPsi"}], "-", 
       RowBox[{"zphi", " ", "zPsi"}], "  ", "+", " ", 
       RowBox[{"gphi", " ", "gPsi"}]}]}], ",", " ", 
     RowBox[{"da", " ", "\[Rule]", " ", 
      RowBox[{"H", " ", "a"}]}], ",", " ", 
     RowBox[{
      SuperscriptBox["xphi", "2"], " ", "\[Rule]", " ", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["yphi", "2"]}], " ", "-", " ", 
       SuperscriptBox["zphi", "2"], " ", "+", " ", 
       SuperscriptBox["gphi", "2"]}]}], ",", " ", 
     RowBox[{
      SuperscriptBox["xPsi", "2"], " ", "\[Rule]", " ", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["yPsi", "2"]}], " ", "-", " ", 
       SuperscriptBox["zPsi", "2"], " ", "+", " ", 
       SuperscriptBox["gPsi", "2"]}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.659214793541716*^9, 3.659214931155787*^9}, {
   3.659215044272204*^9, 3.659215066023184*^9}, {3.659215187363412*^9, 
   3.659215204714739*^9}, {3.6592156626027393`*^9, 3.659215663906513*^9}, {
   3.6592157005773363`*^9, 3.6592157422419577`*^9}, {3.659215957680072*^9, 
   3.6592159577599077`*^9}, {3.6592164270709352`*^9, 
   3.6592164534208717`*^9}, {3.6592881588968487`*^9, 3.659288181195691*^9}, 
   3.659288894571817*^9, {3.660940168303521*^9, 3.660940175150783*^9}, {
   3.6616292678887367`*^9, 3.661629314263686*^9}, 3.662756820532968*^9, {
   3.6628291250594177`*^9, 3.66282913391964*^9}, {3.6628291719415627`*^9, 
   3.66282918294094*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"pretty", "[", "f_", "]"}], " ", ":=", " ", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"Expand", "[", 
       RowBox[{"tolin", "[", 
        RowBox[{"f", " ", "/.", " ", "printrepl"}], "]"}], "]"}], " ", "/.", 
      " ", "Psisqrepl"}], "]"}], " ", "/.", "oprepl"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.687010564838685*^9, 3.687010577765503*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["get background", "Section",
 CellChangeTimes->{{3.687011094870701*^9, 3.687011098038207*^9}}],

Cell[CellGroupData[{

Cell["geometry", "Subsection",
 CellChangeTimes->{{3.687011204802184*^9, 3.687011206697069*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"coords", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.659213500185669*^9, 3.659213510640218*^9}, {
   3.661805265682004*^9, 3.661805267194525*^9}, 3.662757062864636*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"g", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], ",", "0", ",", "0"}], "}"}], ",", 
     
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", 
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"g", " ", "//", " ", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.6592132263670177`*^9, 3.659213327349605*^9}, {
   3.659213515554082*^9, 3.6592135156902237`*^9}, {3.659213549427917*^9, 
   3.659213562219933*^9}, 3.659214205885046*^9, {3.659287997316237*^9, 
   3.659288011285386*^9}, {3.659288783616477*^9, 3.65928879398288*^9}, {
   3.659288859455915*^9, 3.659288860144106*^9}, {3.660939909094689*^9, 
   3.660939913567176*^9}, {3.661189582767799*^9, 3.6611895896059523`*^9}, {
   3.661190896548168*^9, 3.661190912622839*^9}, {3.661808185832955*^9, 
   3.661808202158963*^9}, {3.6629509934671087`*^9, 3.662951017499392*^9}, 
   3.662952230713958*^9, {3.687009665153469*^9, 3.687009681848733*^9}, {
   3.6870111105912*^9, 3.687011124838148*^9}, {3.6870112194652977`*^9, 
   3.687011224255747*^9}, {3.687011399155781*^9, 3.687011401521782*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RGtensors", "[", 
   RowBox[{"g", ",", "coords"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.6592135276621113`*^9, 3.6592135335942593`*^9}, {
   3.662748384872767*^9, 3.662748385312427*^9}, {3.6628402725171432`*^9, 
   3.662840273132886*^9}, {3.662947462915447*^9, 3.662947463321968*^9}, {
   3.662947634896944*^9, 3.66294763561549*^9}, 3.662952234230245*^9, {
   3.6630911496209803`*^9, 3.663091150051323*^9}, {3.663092041667851*^9, 
   3.663092042297411*^9}, {3.664216514240219*^9, 3.664216514686512*^9}, {
   3.6660292422484617`*^9, 3.6660292432389297`*^9}, {3.687009696071208*^9, 
   3.687009696502994*^9}, {3.6870097270895348`*^9, 3.6870097276230917`*^9}, {
   3.687011227304714*^9, 3.68701122735209*^9}, {3.687011404041872*^9, 
   3.687011404201756*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"bgg", " ", "=", " ", "g"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bggUU", " ", "=", " ", "gUU"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6870112433798313`*^9, 3.687011272084388*^9}, {
  3.6870114092578363`*^9, 3.6870114122892723`*^9}}],

Cell[BoxData[
 RowBox[{"bgEUd", " ", "=", " ", "EUd"}]], "Input",
 CellChangeTimes->{{3.6870111420177727`*^9, 3.687011155332119*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"bgEdd", " ", "=", " ", 
   RowBox[{"Lower", "[", 
    RowBox[{"bgEUd", ",", " ", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bgEUU", " ", "=", " ", 
   RowBox[{"Raise", "[", 
    RowBox[{"bgEUd", ",", " ", "2"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6870111603272457`*^9, 3.687011195161912*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["energy momentum tensor", "Subsection",
 CellChangeTimes->{{3.687011277779492*^9, 3.687011280427824*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"phidd", " ", "=", " ", 
   RowBox[{"Outer", "[", 
    RowBox[{"Times", ",", 
     RowBox[{"covD", "[", 
      RowBox[{"phi", "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "]"}], ",", 
     RowBox[{"covD", "[", 
      RowBox[{"phi", "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "]"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.661629699067011*^9, 3.661629707010198*^9}, {
   3.6616298103080263`*^9, 3.661629810723523*^9}, {3.662743172610839*^9, 
   3.662743201569762*^9}, {3.687011301842498*^9, 3.687011314963399*^9}, 
   3.6870113511302967`*^9, 3.6870114273632383`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"bgTdd", " ", "=", 
   RowBox[{"phidd", " ", "-", " ", 
    RowBox[{"bgg", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"Contract", "[", 
         RowBox[{
          RowBox[{"Raise", "[", 
           RowBox[{"phidd", ",", "1"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], " ", "+", " ", 
       RowBox[{"V", "[", 
        RowBox[{"phi", "[", 
         RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "]"}]}], 
      ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bgTUd", " ", "=", " ", 
   RowBox[{"Raise", "[", 
    RowBox[{"bgTdd", ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bgTUU", " ", "=", " ", 
   RowBox[{"Raise", "[", 
    RowBox[{"bgTUd", ",", "2"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQvVfmzG8Gj9eOb+T8GBmBdMeEY+wgWv/uZi4Q3aY/
RxpEe1SvBtOPL4srgehp05OVQfSZ8//UQfTy1okmYPH3j71BNMcdcT8QXfXw
n3sgkO5y4PUA0TN6vl5R8AKa+2TaVRAt0H/vGYiepsv6CkTbLUn5DKJzfneA
6axJ97MVgbSU79YcEO3yOu2lOpAOWPX3DYh2v/HzI4i2OCH+CUQ7OJY99APS
/nvqwLRQava8NiD9I2jqAhAdl/ZxOYi+0/cZTDMlBymeAdJa9a1gukTDzQBE
O633ANN332xpyKp47fhJYz+YztrD1wqiyx4xdYDoy5krJ4JokYzrk0E0AAZw
oi8=
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"bgTdd", " ", "//", "pretty"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.687011432519854*^9, 3.6870114466872272`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["perturbed quantities", "Section",
 CellChangeTimes->{{3.687010701797874*^9, 3.6870107094212837`*^9}, {
  3.687011597354876*^9, 3.687011600202848*^9}}],

Cell[CellGroupData[{

Cell["geometry", "Subsection",
 CellChangeTimes->{{3.687011601874714*^9, 3.6870116032184467`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"coords", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.659213500185669*^9, 3.659213510640218*^9}, {
   3.661805265682004*^9, 3.661805267194525*^9}, 3.662757062864636*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"g", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "1"}], "-", 
        RowBox[{"2", " ", 
         RowBox[{"Psi", "[", 
          RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], ",", "0", 
       ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"a", "[", "t", "]"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{"1", " ", "-", " ", 
          RowBox[{"2", " ", 
           RowBox[{"Psi", "[", 
            RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], ")"}]}], 
       ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"a", "[", "t", "]"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{"1", " ", "-", " ", 
          RowBox[{"2", " ", 
           RowBox[{"Psi", "[", 
            RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], ")"}]}], 
       ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"a", "[", "t", "]"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{"1", " ", "-", " ", 
          RowBox[{"2", " ", 
           RowBox[{"Psi", "[", 
            RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], ")"}]}]}],
       "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"g", " ", "//", " ", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.6592132263670177`*^9, 3.659213327349605*^9}, {
   3.659213515554082*^9, 3.6592135156902237`*^9}, {3.659213549427917*^9, 
   3.659213562219933*^9}, 3.659214205885046*^9, {3.659287997316237*^9, 
   3.659288011285386*^9}, {3.659288783616477*^9, 3.65928879398288*^9}, {
   3.659288859455915*^9, 3.659288860144106*^9}, {3.660939909094689*^9, 
   3.660939913567176*^9}, {3.661189582767799*^9, 3.6611895896059523`*^9}, {
   3.661190896548168*^9, 3.661190912622839*^9}, {3.661808185832955*^9, 
   3.661808202158963*^9}, {3.6629509934671087`*^9, 3.662951017499392*^9}, 
   3.662952230713958*^9, {3.687009665153469*^9, 3.687009681848733*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RGtensors", "[", 
   RowBox[{"g", ",", "coords"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.6592135276621113`*^9, 3.6592135335942593`*^9}, {
   3.662748384872767*^9, 3.662748385312427*^9}, {3.6628402725171432`*^9, 
   3.662840273132886*^9}, {3.662947462915447*^9, 3.662947463321968*^9}, {
   3.662947634896944*^9, 3.66294763561549*^9}, 3.662952234230245*^9, {
   3.6630911496209803`*^9, 3.663091150051323*^9}, {3.663092041667851*^9, 
   3.663092042297411*^9}, {3.664216514240219*^9, 3.664216514686512*^9}, {
   3.6660292422484617`*^9, 3.6660292432389297`*^9}, {3.687009696071208*^9, 
   3.687009696502994*^9}, {3.6870097270895348`*^9, 3.6870097276230917`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Edd", " ", "=", " ", 
   RowBox[{"Lower", "[", 
    RowBox[{"EUd", ",", " ", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EUU", " ", "=", " ", 
   RowBox[{"Raise", "[", 
    RowBox[{"EUd", ",", " ", "2"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.687010720508304*^9, 3.687010785987178*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["energy momentum tensor", "Subsection",
 CellChangeTimes->{{3.687010713557369*^9, 3.6870107174210463`*^9}, {
  3.687011612338369*^9, 3.687011618755805*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Tdd", " ", "=", 
   RowBox[{"phidd", " ", "-", " ", 
    RowBox[{"g", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"Contract", "[", 
         RowBox[{
          RowBox[{"Raise", "[", 
           RowBox[{"phidd", ",", "1"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], " ", "+", " ", 
       RowBox[{"V", "[", 
        RowBox[{"phi", "[", 
         RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "]"}]}], 
      ")"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQA2IQvVfmzG8Gj9eOb+T8GBmBdMeEY+wgWv/uZi4Q3aY/
RxpEe1SvBtOPL4srgehp05OVQfSZ8//UQfTy1okmYPH3j71BNMcdcT8QXfXw
n3sgkO5y4PUA0TN6vl5R8AKa+2TaVRAt0H/vGYiepsv6CkTbLUn5DKJzfneA
6axJ97MVgbSU79YcEO3yOu2lOpAOWPX3DYh2v/HzI4i2OCH+CUQ7OJY99APS
/nvqwLRQava8NiD9I2jqAhAdl/ZxOYi+0/cZTDMlBymeAdJa9a1gukTDzQBE
O633ANN332xpyKp47fhJYz+YztrD1wqiyx4xdYDoy5krJ4JokYzrk0F02+zT
y0H0g/Abq0E0AHzuq5k=
  "]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"TUd", " ", "=", " ", 
   RowBox[{"Raise", "[", 
    RowBox[{"Tdd", ",", " ", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TUU", " ", "=", " ", 
   RowBox[{"Raise", "[", 
    RowBox[{"TUd", ",", " ", "2"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.687010768087019*^9, 3.687010790906949*^9}, {
  3.6870116818088293`*^9, 3.687011687464115*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"TUd", "-", " ", "bgTUd"}], ")"}], " ", "//", " ", "pretty"}], 
  " ", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.6870117353309917`*^9, 3.6870117487874937`*^9}, {
  3.687018695585966*^9, 3.6870186980732927`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["check components", "Section",
 CellChangeTimes->{{3.687010798378495*^9, 3.6870108007462873`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"bgEdd", " ", "//", " ", "pretty"}], " ", "//", " ", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.687011873091123*^9, 3.6870118790776176`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"bgEUd", " ", "//", " ", "pretty"}], " ", "//", " ", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.687014747745741*^9, 3.6870147486577663`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Edd", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "-", " ", 
    RowBox[{"bgEdd", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1"}], "]"}], "]"}]}], " ", "//", "pretty"}], " ", "//",
   " ", "Expand"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Edd", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", "-", " ", 
    RowBox[{"bgEdd", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "2"}], "]"}], "]"}]}], " ", "//", "pretty"}], " ", "//",
   " ", "Expand"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Edd", "[", 
     RowBox[{"[", 
      RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", "-", " ", 
    RowBox[{"bgEdd", "[", 
     RowBox[{"[", 
      RowBox[{"2", ",", "2"}], "]"}], "]"}]}], " ", "//", "pretty"}], " ", "//",
   " ", "Expand"}]}], "Input",
 CellChangeTimes->{{3.687010269328725*^9, 3.687010272159731*^9}, {
  3.687010329073977*^9, 3.687010352573463*^9}, {3.68701042243813*^9, 
  3.687010552574387*^9}, {3.687010591029635*^9, 3.68701062105223*^9}, {
  3.687010855747444*^9, 3.687010873320179*^9}, {3.687011789202702*^9, 
  3.687011789274461*^9}, {3.687011861521967*^9, 3.68701186861017*^9}, {
  3.687012042058289*^9, 3.687012065985566*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"EUd", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "-", " ", 
    RowBox[{"bgEUd", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1"}], "]"}], "]"}]}], " ", "//", "pretty"}], " ", "//",
   " ", "Expand"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"EUd", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", "-", " ", 
    RowBox[{"bgEUd", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "2"}], "]"}], "]"}]}], " ", "//", "pretty"}], " ", "//",
   " ", "Expand"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"EUd", "[", 
     RowBox[{"[", 
      RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", "-", " ", 
    RowBox[{"bgEUd", "[", 
     RowBox[{"[", 
      RowBox[{"2", ",", "2"}], "]"}], "]"}]}], " ", "//", "pretty"}], " ", "//",
   " ", "Expand"}]}], "Input",
 CellChangeTimes->{{3.687010269328725*^9, 3.687010272159731*^9}, {
  3.687010329073977*^9, 3.687010352573463*^9}, {3.68701042243813*^9, 
  3.687010552574387*^9}, {3.687010591029635*^9, 3.68701062105223*^9}, {
  3.687010855747444*^9, 3.687010873320179*^9}, {3.687011789202702*^9, 
  3.687011789274461*^9}, {3.687011861521967*^9, 3.68701186861017*^9}, {
  3.687012042058289*^9, 3.687012065985566*^9}, {3.687014799426311*^9, 
  3.687014809394418*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["einstein equations", "Section",
 CellChangeTimes->{{3.687012146974242*^9, 3.687012152653358*^9}}],

Cell[CellGroupData[{

Cell["background equations", "Subsection",
 CellChangeTimes->{{3.687015040655587*^9, 3.68701504880602*^9}}],

Cell[BoxData[
 RowBox[{"bgeq", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"bgEUd", " ", "-", " ", "bgTUd"}], " ", "//", " ", "pretty"}], 
   " ", "//", " ", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.687015051652546*^9, 3.687015062141728*^9}, {
  3.687015171738461*^9, 3.687015191586905*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"bgeq", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "\[Equal]", " ", "0"}], " ", 
  "//", "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bgeq", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", "\[Equal]", " ", "0"}], " ", 
  "//", "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"bgeq", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "i"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "2", ",", "4"}], "}"}]}], "]"}], " ", "\[Equal]", " ",
    "0"}], " ", "//", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.687015200802479*^9, 3.687015320429583*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Ud components", "Subsection",
 CellChangeTimes->{{3.687012814347246*^9, 3.687012815907164*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"rhs", " ", "=", " ", 
   RowBox[{
    RowBox[{"\[Kappa]", " ", 
     RowBox[{"(", 
      RowBox[{"TUd", "-", " ", "bgTUd"}], ")"}]}], " ", "//", " ", 
    "pretty"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"rhs", " ", "//", " ", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.6870117353309917`*^9, 3.6870117487874937`*^9}, {
  3.687012162951254*^9, 3.687012178412478*^9}, {3.6870126059994507`*^9, 
  3.6870126094774237`*^9}, {3.687012818580949*^9, 3.687012820603216*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"lhs", " ", "=", " ", 
   RowBox[{
    RowBox[{"EUd", " ", "-", " ", "bgEUd"}], " ", "//", " ", "pretty"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"lhs", " ", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.6870121980311747`*^9, 3.6870122113503523`*^9}, {
  3.687012597351059*^9, 3.687012603533352*^9}, {3.687012836137591*^9, 
  3.687012841017528*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"eq", " ", "=", " ", 
   RowBox[{
    RowBox[{"rhs", " ", "-", " ", "lhs"}], " ", "//", "FullSimplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"eq", " ", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.6870126122699223`*^9, 3.687012622820191*^9}, {
  3.687012665621792*^9, 3.687012683331358*^9}, {3.687012911256567*^9, 
  3.6870129183942432`*^9}}],

Cell[CellGroupData[{

Cell["the 00 part", "Subsubsection",
 CellChangeTimes->{{3.6870135029104767`*^9, 3.68701350728655*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"replrho", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Psi", " ", 
      SuperscriptBox["dphi", "2"]}], " ", "\[Rule]", " ", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{"\[Rho]", " ", "-", " ", "b\[Rho]"}], ")"}]}], " ", "+", " ", 
      
      RowBox[{
       FractionBox["Psi", 
        SuperscriptBox["a", "2"]], 
       SuperscriptBox["gphi", "2"]}]}]}], "}"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"Expand", "[", 
     RowBox[{"eq", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], " ", "/.", " ", 
    "replrho"}], "]"}], " ", "\[Equal]", " ", "0"}]], "Input",
 CellChangeTimes->{{3.687012690806589*^9, 3.687012701309119*^9}, {
  3.687012869053376*^9, 3.687012887892695*^9}, {3.6870129266475697`*^9, 
  3.6870130206994953`*^9}, {3.6870131982726707`*^9, 3.687013211280306*^9}, {
  3.687013265726428*^9, 3.687013423542233*^9}, {3.687013546726863*^9, 
  3.6870135473910217`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["the 0i part", "Subsubsection",
 CellChangeTimes->{{3.687013560374572*^9, 3.687013562318583*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"eq", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", "\[Equal]", " ", "0"}], "//",
    "Simplify"}], " ", "//", " ", "Expand"}]], "Input",
 CellChangeTimes->{{3.6870135651601467`*^9, 3.687013565456141*^9}, {
  3.687013933438282*^9, 3.687013942995734*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["the ii part", "Subsubsection",
 CellChangeTimes->{{3.687013566918372*^9, 3.6870135687663527`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"replp", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Psi", " ", 
      SuperscriptBox["dphi", "2"]}], " ", "\[Rule]", " ", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{"p", " ", "-", " ", "bp"}], ")"}]}], " ", "-", " ", 
      RowBox[{
       FractionBox["Psi", 
        RowBox[{"3", " ", 
         SuperscriptBox["a", "2"]}]], 
       SuperscriptBox["gphi", "2"]}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.687014102116179*^9, 3.68701413484377*^9}}],

Cell[BoxData[
 RowBox[{"eq3", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"eq", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "i"}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "2", ",", "4"}], "}"}]}], "]"}], "/", "3"}], " ", "//",
    " ", "pretty"}]}]], "Input",
 CellChangeTimes->{{3.687013574752942*^9, 3.687013613316766*^9}, {
  3.687013656458045*^9, 3.687013656856379*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"Expand", "[", "eq3", "]"}], " ", "/.", " ", "replp"}], "]"}]}], 
  " ", "\[Equal]", " ", "0"}]], "Input",
 CellChangeTimes->{{3.6870136391787863`*^9, 3.6870137016901083`*^9}, {
  3.6870141617333403`*^9, 3.687014200255475*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "different ansatz with complete ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["G", "\[Mu]\[Nu]"], "=", 
    RowBox[{"\[Kappa]", " ", 
     SubscriptBox["T", "\[Mu]\[Nu]"]}]}], TraditionalForm]]]
}], "Section",
 CellChangeTimes->{{3.687020600044765*^9, 3.6870206311945972`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"lhs", " ", "=", " ", 
   RowBox[{"EUd", "  ", "//", "pretty"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rhs", " ", "=", " ", 
   RowBox[{
    RowBox[{"\[Kappa]", " ", "TUd"}], " ", "//", " ", "pretty"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.68702063395364*^9, 3.687020689394883*^9}, {
  3.6870214253512278`*^9, 3.687021427333723*^9}}],

Cell[BoxData[
 RowBox[{"eq", " ", "=", " ", 
  RowBox[{
   RowBox[{"lhs", " ", "-", " ", "rhs"}], " ", "//", " ", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.687020691284402*^9, 3.687020697024892*^9}}],

Cell[CellGroupData[{

Cell["the 00 part", "Subsubsection",
 CellChangeTimes->{{3.6870207052338257`*^9, 3.687020711680291*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{"Expand", "[", 
     RowBox[{"eq", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "]"}], " ", "\[Equal]", 
   " ", "0"}], " ", "//", " ", "Expand"}]], "Input",
 CellChangeTimes->{{3.687020744473743*^9, 3.687020746497072*^9}, {
  3.6870208696450872`*^9, 3.6870208713005457`*^9}, {3.687021215322124*^9, 
  3.6870212203059196`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["the ii part", "Subsubsection",
 CellChangeTimes->{{3.687022260988628*^9, 3.687022273276451*^9}}],

Cell[BoxData[
 RowBox[{"eq3", " ", "=", " ", 
  RowBox[{
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"eq", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "i"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "2", ",", "4"}], "}"}]}], "]"}], " ", "//", " ", 
   "pretty"}]}]], "Input",
 CellChangeTimes->{{3.687013574752942*^9, 3.687013613316766*^9}, {
  3.687013656458045*^9, 3.687013656856379*^9}, {3.687021562817651*^9, 
  3.687021577136935*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{"Expand", "[", "eq3", "]"}], "]"}], "/", "3"}], " ", "\[Equal]", 
   " ", "0"}], " ", "//", " ", "Expand"}]], "Input",
 CellChangeTimes->{{3.6870136391787863`*^9, 3.6870137016901083`*^9}, {
  3.6870141617333403`*^9, 3.687014200255475*^9}, {3.687021580680711*^9, 
  3.687021608712071*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["the 0i part", "Subsubsection",
 CellChangeTimes->{{3.687022276395618*^9, 3.68702227856428*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{"Expand", "[", 
     RowBox[{"eq", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "2"}], "]"}], "]"}], "]"}], "]"}], " ", "\[Equal]", 
   " ", "0"}], " ", "//", " ", "Expand"}]], "Input",
 CellChangeTimes->{{3.687022302834239*^9, 3.687022303026808*^9}}]
}, Open  ]]
}, Open  ]]
}, Closed]]
},
WindowSize->{1150, 1005},
WindowMargins->{{Automatic, 85}, {Automatic, 0}},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
ShowSelection->True,
FrontEndVersion->"10.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (December 10, \
2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 124, 1, 64, "Section"],
Cell[706, 25, 117, 2, 28, "Input"],
Cell[826, 29, 388, 8, 51, "Input"],
Cell[1217, 39, 328, 9, 49, "Input"],
Cell[1548, 50, 427, 10, 48, "Input"],
Cell[1978, 62, 444, 12, 28, "Input"],
Cell[2425, 76, 668, 15, 28, "Input"],
Cell[3096, 93, 795, 21, 28, "Input"],
Cell[3894, 116, 309, 7, 28, "Input"],
Cell[4206, 125, 703, 16, 28, "Input"],
Cell[4912, 143, 645, 15, 28, "Input"],
Cell[5560, 160, 653, 19, 65, "Input"],
Cell[6216, 181, 896, 25, 28, "Input"],
Cell[7115, 208, 519, 15, 65, "Input"],
Cell[7637, 225, 309, 8, 49, "Input"],
Cell[7949, 235, 979, 25, 28, "Input"],
Cell[8931, 262, 372, 8, 28, "Input"],
Cell[9306, 272, 524, 12, 28, "Input"],
Cell[9833, 286, 974, 26, 28, "Input"],
Cell[10810, 314, 336, 8, 28, "Input"],
Cell[11149, 324, 357, 10, 28, "Input"],
Cell[11509, 336, 235, 5, 28, "Input"],
Cell[11747, 343, 1584, 41, 80, "Input"],
Cell[13334, 386, 526, 15, 53, "Input"],
Cell[13863, 403, 516, 16, 49, "Input"],
Cell[14382, 421, 1661, 45, 76, "Input"],
Cell[16046, 468, 1000, 27, 28, "Input"],
Cell[17049, 497, 231, 6, 28, "Input"],
Cell[17283, 505, 129, 2, 28, "Input"],
Cell[17415, 509, 331, 10, 30, "Input"],
Cell[17749, 521, 666, 13, 30, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[18452, 539, 361, 12, 50, "Section"],
Cell[18816, 553, 120, 2, 27, "Input"],
Cell[18939, 557, 1239, 31, 108, "Input"],
Cell[20181, 590, 861, 22, 27, "Input"],
Cell[21045, 614, 1070, 26, 27, "Input"],
Cell[22118, 642, 1604, 33, 53, "Input"],
Cell[23725, 677, 524, 14, 27, "Input"],
Cell[24252, 693, 93, 1, 26, "Text"],
Cell[24348, 696, 392, 10, 27, "Input"],
Cell[24743, 708, 100, 1, 26, "Text"],
Cell[24846, 711, 419, 12, 27, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[25302, 728, 169, 2, 50, "Section"],
Cell[25474, 732, 120, 2, 27, "Input"],
Cell[25597, 736, 206, 5, 33, "Input"],
Cell[25806, 743, 290, 7, 27, "Input"],
Cell[26099, 752, 1117, 22, 64, "Input"],
Cell[27219, 776, 861, 22, 27, "Input"],
Cell[28083, 800, 1070, 26, 27, "Input"],
Cell[29156, 828, 1130, 29, 53, "Input"],
Cell[30289, 859, 524, 14, 27, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[30850, 878, 229, 7, 50, "Section"],
Cell[31082, 887, 4235, 106, 207, "Input"],
Cell[35320, 995, 682, 18, 58, "Input"],
Cell[36005, 1015, 686, 20, 62, "Input"],
Cell[36694, 1037, 596, 17, 63, "Input"],
Cell[37293, 1056, 745, 17, 33, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[38075, 1078, 235, 3, 50, "Section"],
Cell[38313, 1083, 1376, 35, 125, "Text"],
Cell[39692, 1120, 172, 3, 28, "Input"],
Cell[CellGroupData[{
Cell[39889, 1127, 96, 1, 44, "Subsection"],
Cell[39988, 1130, 621, 13, 66, "Input"],
Cell[40612, 1145, 584, 13, 46, "Input"],
Cell[41199, 1160, 467, 11, 28, "Input"],
Cell[41669, 1173, 306, 7, 28, "Input"],
Cell[41978, 1182, 470, 12, 46, "Input"],
Cell[42451, 1196, 348, 8, 46, "Input"],
Cell[42802, 1206, 422, 11, 46, "Input"],
Cell[43227, 1219, 911, 23, 48, "Input"],
Cell[44141, 1244, 322, 6, 28, "Input"],
Cell[44466, 1252, 465, 13, 28, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44968, 1270, 95, 1, 44, "Subsection"],
Cell[45066, 1273, 322, 8, 50, "Input"],
Cell[45391, 1283, 284, 7, 28, "Input"],
Cell[45678, 1292, 111, 3, 28, "Input"],
Cell[45792, 1297, 231, 6, 28, "Input"],
Cell[46026, 1305, 409, 7, 28, "Input"],
Cell[46438, 1314, 179, 5, 28, "Input"],
Cell[46620, 1321, 317, 7, 35, "Input"],
Cell[46940, 1330, 745, 17, 35, "Input"],
Cell[47688, 1349, 94, 1, 28, "Input"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[47831, 1356, 146, 2, 50, "Section"],
Cell[47980, 1360, 500, 14, 49, "Input"],
Cell[48483, 1376, 785, 21, 48, "Input"],
Cell[49271, 1399, 176, 4, 28, "Input"],
Cell[49450, 1405, 2361, 65, 313, "Input"],
Cell[51814, 1472, 94, 1, 28, "Input"],
Cell[51911, 1475, 1201, 34, 53, "Input"],
Cell[CellGroupData[{
Cell[53137, 1513, 111, 1, 44, "Subsection"],
Cell[53251, 1516, 818, 23, 62, "Input"],
Cell[54072, 1541, 772, 23, 62, "Input"],
Cell[54847, 1566, 1811, 44, 97, "Input"],
Cell[56661, 1612, 724, 12, 28, "Input"],
Cell[57388, 1626, 285, 8, 28, "Input"],
Cell[57676, 1636, 981, 26, 80, "Input"],
Cell[58660, 1664, 291, 7, 28, "Input"],
Cell[58954, 1673, 994, 27, 62, "Input"],
Cell[59951, 1702, 191, 2, 29, "Text"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[60191, 1710, 105, 1, 50, "Section"],
Cell[60299, 1713, 120, 2, 27, "Input"],
Cell[60422, 1717, 1868, 55, 105, "Input"],
Cell[62293, 1774, 928, 23, 58, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[63258, 1802, 109, 1, 50, "Section"],
Cell[63370, 1805, 1253, 32, 48, "Input"],
Cell[64626, 1839, 296, 7, 27, "Input"],
Cell[64925, 1848, 354, 9, 27, "Input"],
Cell[65282, 1859, 403, 10, 27, "Input"],
Cell[65688, 1871, 352, 9, 27, "Input"],
Cell[66043, 1882, 455, 12, 27, "Input"],
Cell[66501, 1896, 504, 12, 27, "Input"],
Cell[67008, 1910, 456, 12, 27, "Input"],
Cell[67467, 1924, 681, 19, 27, "Input"],
Cell[68151, 1945, 1349, 39, 33, "Input"],
Cell[69503, 1986, 94, 1, 27, "Input"],
Cell[69600, 1989, 201, 4, 27, "Input"],
Cell[69804, 1995, 973, 26, 27, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[70814, 2026, 114, 1, 50, "Section"],
Cell[70931, 2029, 138, 3, 27, "Input"],
Cell[71072, 2034, 232, 6, 30, "Input"],
Cell[71307, 2042, 713, 17, 33, "Input"],
Cell[72023, 2061, 873, 21, 33, "Input"],
Cell[72899, 2084, 502, 11, 27, "Input"],
Cell[73404, 2097, 324, 8, 27, "Input"],
Cell[73731, 2107, 220, 5, 27, "Input"],
Cell[73954, 2114, 495, 10, 43, "Input"],
Cell[74452, 2126, 263, 7, 33, "Input"],
Cell[74718, 2135, 295, 8, 49, "Input"],
Cell[75016, 2145, 422, 8, 27, "Input"],
Cell[75441, 2155, 587, 15, 33, "Input"],
Cell[76031, 2172, 376, 9, 27, "Input"],
Cell[76410, 2183, 410, 8, 27, "Input"],
Cell[76823, 2193, 488, 12, 27, "Input"],
Cell[77314, 2207, 481, 12, 27, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[77832, 2224, 117, 1, 50, "Section"],
Cell[77952, 2227, 136, 3, 28, "Input"],
Cell[78091, 2232, 512, 16, 28, "Input"],
Cell[78606, 2250, 1143, 35, 28, "Input"],
Cell[79752, 2287, 739, 20, 34, "Input"],
Cell[80494, 2309, 938, 25, 35, "Input"],
Cell[81435, 2336, 339, 9, 28, "Input"],
Cell[CellGroupData[{
Cell[81799, 2349, 127, 1, 44, "Subsection"],
Cell[81929, 2352, 457, 10, 32, "Input"],
Cell[82389, 2364, 405, 9, 28, "Input"],
Cell[82797, 2375, 669, 18, 35, "Input"],
Cell[83469, 2395, 281, 6, 48, "Input"],
Cell[83753, 2403, 320, 9, 28, "Input"],
Cell[84076, 2414, 401, 12, 35, "Input"],
Cell[84480, 2428, 661, 20, 35, "Input"],
Cell[85144, 2450, 807, 23, 35, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[85988, 2478, 219, 4, 44, "Subsection"],
Cell[86210, 2484, 548, 10, 28, "Input"],
Cell[86761, 2496, 481, 10, 28, "Input"],
Cell[87245, 2508, 267, 5, 28, "Input"],
Cell[87515, 2515, 283, 6, 28, "Input"],
Cell[87801, 2523, 670, 14, 50, "Input"],
Cell[88474, 2539, 766, 18, 49, "Input"],
Cell[89243, 2559, 764, 20, 28, "Input"],
Cell[90010, 2581, 168, 3, 28, "Input"],
Cell[90181, 2586, 167, 4, 56, "Input"],
Cell[90351, 2592, 693, 15, 70, "Input"],
Cell[91047, 2609, 570, 14, 35, "Input"],
Cell[91620, 2625, 601, 14, 28, "Input"],
Cell[92224, 2641, 870, 23, 27, "Input"],
Cell[93097, 2666, 256, 5, 27, "Input"],
Cell[93356, 2673, 383, 9, 27, "Input"],
Cell[93742, 2684, 347, 10, 27, "Input"],
Cell[94092, 2696, 355, 9, 27, "Input"],
Cell[94450, 2707, 309, 7, 27, "Input"],
Cell[94762, 2716, 251, 5, 27, "Input"],
Cell[95016, 2723, 1049, 27, 58, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[96102, 2755, 168, 2, 34, "Subsection"],
Cell[96273, 2759, 642, 17, 46, "Input"],
Cell[96918, 2778, 501, 11, 27, "Input"],
Cell[97422, 2791, 844, 22, 43, "Input"],
Cell[98269, 2815, 256, 5, 27, "Input"],
Cell[98528, 2822, 1144, 30, 43, "Input"],
Cell[99675, 2854, 387, 10, 27, "Input"],
Cell[100065, 2866, 589, 16, 27, "Input"],
Cell[100657, 2884, 2784, 72, 100, "Input"],
Cell[103444, 2958, 455, 9, 43, "Input"],
Cell[103902, 2969, 620, 14, 43, "Input"],
Cell[104525, 2985, 338, 8, 43, "Input"],
Cell[104866, 2995, 153, 3, 27, "Input"],
Cell[105022, 3000, 281, 7, 27, "Input"],
Cell[105306, 3009, 440, 9, 27, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[105783, 3023, 164, 2, 34, "Subsection"],
Cell[105950, 3027, 594, 16, 46, "Input"],
Cell[106547, 3045, 444, 10, 27, "Input"],
Cell[106994, 3057, 857, 24, 33, "Input"],
Cell[107854, 3083, 844, 22, 43, "Input"],
Cell[108701, 3107, 224, 4, 27, "Input"],
Cell[108928, 3113, 768, 21, 33, "Input"],
Cell[109699, 3136, 2048, 54, 64, "Input"],
Cell[111750, 3192, 353, 7, 43, "Input"],
Cell[112106, 3201, 620, 14, 46, "Input"],
Cell[112729, 3217, 338, 8, 46, "Input"],
Cell[113070, 3227, 249, 5, 28, "Input"],
Cell[113322, 3234, 153, 3, 28, "Input"],
Cell[113478, 3239, 351, 8, 28, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[113866, 3252, 134, 1, 44, "Subsection"],
Cell[114003, 3255, 728, 14, 32, "Input"],
Cell[114734, 3271, 442, 13, 28, "Input"],
Cell[115179, 3286, 916, 28, 28, "Input"],
Cell[116098, 3316, 680, 18, 34, "Input"],
Cell[116781, 3336, 938, 25, 56, "Input"],
Cell[117722, 3363, 576, 14, 50, "Input"],
Cell[118301, 3379, 489, 10, 28, "Input"],
Cell[118793, 3391, 287, 4, 28, "Input"],
Cell[119083, 3397, 305, 5, 28, "Input"],
Cell[119391, 3404, 670, 14, 50, "Input"],
Cell[120064, 3420, 812, 18, 49, "Input"],
Cell[120879, 3440, 683, 18, 28, "Input"],
Cell[121565, 3460, 168, 3, 28, "Input"],
Cell[121736, 3465, 167, 4, 56, "Input"],
Cell[121906, 3471, 741, 16, 70, "Input"],
Cell[122650, 3489, 238, 3, 28, "Input"],
Cell[122891, 3494, 601, 14, 28, "Input"],
Cell[123495, 3510, 870, 23, 28, "Input"],
Cell[124368, 3535, 256, 5, 28, "Input"],
Cell[124627, 3542, 383, 9, 28, "Input"],
Cell[125013, 3553, 347, 10, 28, "Input"],
Cell[125363, 3565, 355, 9, 28, "Input"],
Cell[125721, 3576, 309, 7, 28, "Input"],
Cell[126033, 3585, 251, 5, 28, "Input"],
Cell[126287, 3592, 1049, 27, 63, "Input"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[127385, 3625, 134, 1, 50, "Section"],
Cell[CellGroupData[{
Cell[127544, 3630, 154, 2, 44, "Subsection"],
Cell[127701, 3634, 156, 3, 28, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[127894, 3642, 136, 1, 44, "Subsection"],
Cell[128033, 3645, 318, 9, 28, "Input"],
Cell[128354, 3656, 3165, 94, 95, "Input"],
Cell[131522, 3752, 1128, 23, 35, "Input"],
Cell[132653, 3777, 248, 6, 49, "Input"],
Cell[132904, 3785, 246, 5, 28, "Input"],
Cell[133153, 3792, 1274, 28, 53, "Input"],
Cell[134430, 3822, 160, 3, 28, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[134627, 3830, 201, 3, 44, "Subsection"],
Cell[134831, 3835, 957, 19, 46, "Input"],
Cell[135791, 3856, 447, 12, 28, "Input"],
Cell[136241, 3870, 722, 18, 46, "Input"],
Cell[136966, 3890, 695, 14, 28, "Input"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[137710, 3910, 180, 2, 50, "Section"],
Cell[137893, 3914, 138, 3, 28, "Input"],
Cell[CellGroupData[{
Cell[138056, 3921, 158, 2, 44, "Subsection"],
Cell[138217, 3925, 128, 2, 28, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[138382, 3932, 171, 2, 44, "Subsection"],
Cell[138556, 3936, 201, 4, 27, "Input"],
Cell[138760, 3942, 683, 19, 33, "Input"],
Cell[139446, 3963, 159, 3, 27, "Input"],
Cell[139608, 3968, 253, 5, 27, "Input"],
Cell[139864, 3975, 482, 12, 29, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[140383, 3992, 133, 1, 36, "Subsection"],
Cell[140519, 3995, 636, 16, 43, "Input"],
Cell[141158, 4013, 470, 12, 27, "Input"],
Cell[141631, 4027, 799, 14, 27, "Input"],
Cell[142433, 4043, 3349, 78, 199, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[145819, 4126, 121, 1, 36, "Subsection"],
Cell[145943, 4129, 7899, 229, 138, "Input"],
Cell[153845, 4360, 3906, 90, 183, "Input"],
Cell[157754, 4452, 1916, 42, 53, "Input"],
Cell[159673, 4496, 2209, 67, 33, "Input"],
Cell[161885, 4565, 3309, 77, 87, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[165231, 4647, 287, 8, 37, "Subsection"],
Cell[165521, 4657, 325, 4, 26, "Text"],
Cell[165849, 4663, 469, 10, 27, "Input"],
Cell[166321, 4675, 263, 6, 27, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[166621, 4686, 143, 1, 36, "Subsection"],
Cell[166767, 4689, 295, 8, 47, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[167099, 4702, 137, 1, 36, "Subsection"],
Cell[167239, 4705, 289, 6, 27, "Input"],
Cell[167531, 4713, 2039, 53, 49, "Input"],
Cell[169573, 4768, 163, 3, 26, "Text"],
Cell[169739, 4773, 577, 13, 27, "Input"],
Cell[170319, 4788, 354, 6, 27, "Input"],
Cell[170676, 4796, 265, 7, 27, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[170978, 4808, 209, 3, 36, "Subsection"],
Cell[171190, 4813, 1146, 22, 43, "Input"],
Cell[172339, 4837, 188, 4, 26, "Text"],
Cell[172530, 4843, 550, 11, 27, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[173117, 4859, 311, 4, 36, "Subsection"],
Cell[173431, 4865, 1452, 37, 64, "Input"],
Cell[174886, 4904, 97, 1, 26, "Text"],
Cell[174986, 4907, 604, 13, 27, "Input"],
Cell[175593, 4922, 437, 9, 27, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[176067, 4936, 352, 6, 36, "Subsection"],
Cell[176422, 4944, 869, 18, 43, "Input"],
Cell[177294, 4964, 269, 7, 27, "Input"],
Cell[177566, 4973, 1091, 20, 27, "Input"],
Cell[178660, 4995, 651, 15, 27, "Input"],
Cell[179314, 5012, 557, 12, 27, "Input"],
Cell[179874, 5026, 136, 2, 27, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[180047, 5033, 173, 2, 36, "Subsection"],
Cell[180223, 5037, 237, 5, 27, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[180497, 5047, 213, 3, 36, "Subsection"],
Cell[180713, 5052, 307, 10, 29, "Text"],
Cell[181023, 5064, 554, 14, 27, "Input"],
Cell[181580, 5080, 610, 16, 27, "Input"],
Cell[182193, 5098, 1291, 28, 46, "Input"],
Cell[183487, 5128, 96, 1, 26, "Text"],
Cell[183586, 5131, 803, 23, 46, "Input"],
Cell[184392, 5156, 499, 11, 43, "Input"],
Cell[184894, 5169, 559, 14, 27, "Input"],
Cell[185456, 5185, 670, 19, 43, "Input"],
Cell[186129, 5206, 90, 1, 26, "Text"],
Cell[186222, 5209, 889, 26, 83, "Input"],
Cell[187114, 5237, 886, 26, 43, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[188037, 5268, 104, 1, 36, "Subsection"],
Cell[188144, 5271, 252, 7, 27, "Input"],
Cell[CellGroupData[{
Cell[188421, 5282, 105, 1, 24, "Subsubsection"],
Cell[188529, 5285, 656, 16, 43, "Input"],
Cell[189188, 5303, 685, 15, 43, "Input"],
Cell[189876, 5320, 441, 12, 43, "Input"],
Cell[190320, 5334, 87, 1, 26, "Text"],
Cell[190410, 5337, 535, 15, 27, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[190982, 5357, 107, 1, 24, "Subsubsection"],
Cell[191092, 5360, 423, 11, 43, "Input"],
Cell[191518, 5373, 355, 10, 43, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[191910, 5388, 103, 1, 24, "Subsubsection"],
Cell[192016, 5391, 421, 11, 43, "Input"],
Cell[192440, 5404, 204, 4, 26, "Text"],
Cell[192647, 5410, 306, 5, 43, "Input"],
Cell[192956, 5417, 254, 6, 27, "Input"],
Cell[193213, 5425, 465, 12, 64, "Input"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[193727, 5443, 262, 3, 36, "Subsection"],
Cell[193992, 5448, 660, 13, 27, "Input"],
Cell[194655, 5463, 266, 8, 47, "Input"],
Cell[CellGroupData[{
Cell[194946, 5475, 105, 1, 24, "Subsubsection"],
Cell[195054, 5478, 1850, 46, 43, "Input"],
Cell[196907, 5526, 1864, 50, 58, "Input"],
Cell[198774, 5578, 89, 1, 26, "Text"],
Cell[198866, 5581, 1562, 47, 58, "Input"],
Cell[200431, 5630, 87, 1, 26, "Text"],
Cell[200521, 5633, 1504, 45, 58, "Input"],
Cell[202028, 5680, 88, 1, 26, "Text"],
Cell[202119, 5683, 1433, 44, 58, "Input"],
Cell[203555, 5729, 1256, 36, 70, "Input"],
Cell[204814, 5767, 131, 2, 27, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[204982, 5774, 104, 1, 24, "Subsubsection"],
Cell[205089, 5777, 216, 6, 27, "Input"],
Cell[205308, 5785, 283, 8, 27, "Input"],
Cell[205594, 5795, 514, 12, 27, "Input"],
Cell[206111, 5809, 89, 1, 26, "Text"],
Cell[206203, 5812, 742, 19, 43, "Input"],
Cell[206948, 5833, 90, 1, 26, "Text"],
Cell[207041, 5836, 727, 20, 43, "Input"],
Cell[207771, 5858, 1228, 33, 43, "Input"],
Cell[209002, 5893, 969, 27, 43, "Input"],
Cell[209974, 5922, 737, 17, 43, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[210748, 5944, 103, 1, 24, "Subsubsection"],
Cell[210854, 5947, 762, 19, 27, "Input"],
Cell[211619, 5968, 87, 1, 26, "Text"],
Cell[211709, 5971, 702, 21, 43, "Input"],
Cell[212414, 5994, 748, 21, 43, "Input"],
Cell[213165, 6017, 246, 5, 27, "Input"],
Cell[213414, 6024, 89, 1, 26, "Text"],
Cell[213506, 6027, 795, 23, 43, "Input"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[214350, 6056, 157, 3, 36, "Subsection"],
Cell[214510, 6061, 1007, 29, 72, "Input"],
Cell[215520, 6092, 439, 13, 27, "Input"],
Cell[215962, 6107, 482, 14, 27, "Input"],
Cell[216447, 6123, 965, 19, 43, "Input"],
Cell[217415, 6144, 382, 11, 27, "Input"],
Cell[217800, 6157, 490, 13, 43, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[218327, 6175, 162, 2, 36, "Subsection"],
Cell[218492, 6179, 415, 11, 27, "Input"],
Cell[218910, 6192, 287, 7, 27, "Input"],
Cell[219200, 6201, 125, 2, 27, "Input"],
Cell[219328, 6205, 263, 7, 27, "Input"],
Cell[219594, 6214, 263, 7, 27, "Input"],
Cell[219860, 6223, 91, 1, 26, "Text"],
Cell[219954, 6226, 569, 17, 30, "Input"],
Cell[220526, 6245, 180, 4, 27, "Input"],
Cell[220709, 6251, 3292, 95, 131, "Input"],
Cell[224004, 6348, 5079, 152, 151, "Input"],
Cell[229086, 6502, 4890, 149, 151, "Input"],
Cell[233979, 6653, 4839, 148, 151, "Input"],
Cell[238821, 6803, 317, 7, 43, "Input"],
Cell[239141, 6812, 544, 14, 27, "Input"],
Cell[239688, 6828, 940, 26, 43, "Input"],
Cell[240631, 6856, 89, 1, 26, "Text"],
Cell[240723, 6859, 427, 12, 27, "Input"],
Cell[241153, 6873, 1023, 26, 64, "Input"],
Cell[242179, 6901, 87, 1, 26, "Text"],
Cell[242269, 6904, 891, 24, 64, "Input"],
Cell[243163, 6930, 364, 9, 47, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[243564, 6944, 124, 1, 36, "Subsection"],
Cell[243691, 6947, 1308, 39, 58, "Input"],
Cell[245002, 6988, 88, 1, 26, "Text"],
Cell[245093, 6991, 1334, 41, 58, "Input"],
Cell[246430, 7034, 89, 1, 26, "Text"],
Cell[246522, 7037, 1342, 41, 58, "Input"],
Cell[247867, 7080, 126, 1, 26, "Text"],
Cell[247996, 7083, 1596, 42, 58, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[249629, 7130, 249, 5, 36, "Subsection"],
Cell[249881, 7137, 358, 9, 30, "Input"],
Cell[250242, 7148, 474, 9, 27, "Input"],
Cell[250719, 7159, 874, 20, 43, "Input"],
Cell[251596, 7181, 1388, 34, 43, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[253021, 7220, 218, 4, 36, "Subsection"],
Cell[253242, 7226, 443, 11, 33, "Input"],
Cell[253688, 7239, 644, 16, 27, "Input"],
Cell[254335, 7257, 1041, 29, 43, "Input"],
Cell[255379, 7288, 402, 10, 27, "Input"],
Cell[255784, 7300, 405, 10, 27, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[256226, 7315, 243, 3, 36, "Subsection"],
Cell[256472, 7320, 1847, 53, 81, "Input"],
Cell[258322, 7375, 218, 5, 27, "Input"],
Cell[258543, 7382, 285, 7, 30, "Input"],
Cell[258831, 7391, 915, 22, 33, "Input"],
Cell[259749, 7415, 302, 8, 27, "Input"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[260100, 7429, 136, 1, 50, "Section"],
Cell[260239, 7432, 120, 2, 28, "Input"],
Cell[CellGroupData[{
Cell[260384, 7438, 158, 2, 44, "Subsection"],
Cell[260545, 7442, 128, 2, 28, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[260710, 7449, 133, 1, 44, "Subsection"],
Cell[260846, 7452, 2103, 49, 97, "Input"],
Cell[262952, 7503, 470, 12, 28, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[263459, 7520, 121, 1, 44, "Subsection"],
Cell[263583, 7523, 7899, 229, 187, "Input"],
Cell[271485, 7754, 3906, 90, 195, "Input"],
Cell[275394, 7846, 1916, 42, 57, "Input"],
Cell[277313, 7890, 2209, 67, 35, "Input"],
Cell[279525, 7959, 3309, 77, 111, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[282871, 8041, 143, 1, 44, "Subsection"],
Cell[283017, 8044, 295, 8, 49, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[283349, 8057, 137, 1, 44, "Subsection"],
Cell[283489, 8060, 289, 6, 28, "Input"],
Cell[283781, 8068, 3584, 94, 97, "Input"],
Cell[287368, 8164, 163, 3, 29, "Text"],
Cell[287534, 8169, 1846, 44, 63, "Input"],
Cell[289383, 8215, 354, 6, 28, "Input"],
Cell[289740, 8223, 266, 6, 28, "Input"],
Cell[290009, 8231, 265, 7, 28, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[290311, 8243, 213, 3, 44, "Subsection"],
Cell[290527, 8248, 307, 10, 32, "Text"],
Cell[290837, 8260, 554, 14, 28, "Input"],
Cell[291394, 8276, 610, 16, 28, "Input"],
Cell[292007, 8294, 1291, 28, 48, "Input"],
Cell[293301, 8324, 96, 1, 29, "Text"],
Cell[293400, 8327, 803, 23, 48, "Input"],
Cell[294206, 8352, 499, 11, 46, "Input"],
Cell[294708, 8365, 559, 14, 28, "Input"],
Cell[295270, 8381, 670, 19, 46, "Input"],
Cell[295943, 8402, 90, 1, 29, "Text"],
Cell[296036, 8405, 889, 26, 88, "Input"],
Cell[296928, 8433, 886, 26, 46, "Input"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[297863, 8465, 112, 1, 50, "Section"],
Cell[297978, 8468, 445, 13, 53, "Input"],
Cell[298426, 8483, 733, 21, 49, "Input"],
Cell[299162, 8506, 433, 12, 59, "Input"],
Cell[299598, 8520, 710, 21, 35, "Input"],
Cell[300311, 8543, 1142, 30, 35, "Input"],
Cell[301456, 8575, 1514, 43, 106, "Input"],
Cell[302973, 8620, 455, 13, 59, "Input"],
Cell[303431, 8635, 1509, 42, 56, "Input"],
Cell[304943, 8679, 505, 14, 59, "Input"],
Cell[305451, 8695, 1493, 44, 53, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[306981, 8744, 115, 1, 50, "Section"],
Cell[307099, 8747, 295, 9, 28, "Input"],
Cell[307397, 8758, 1087, 30, 46, "Input"],
Cell[308487, 8790, 1034, 27, 46, "Input"],
Cell[309524, 8819, 77, 1, 28, "Input"],
Cell[309604, 8822, 99, 1, 29, "Text"],
Cell[309706, 8825, 4724, 120, 216, "Input"],
Cell[314433, 8947, 96, 1, 29, "Text"],
Cell[314532, 8950, 5102, 130, 250, "Input"],
Cell[319637, 9082, 280, 6, 28, "Input"],
Cell[319920, 9090, 2976, 83, 131, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[322933, 9178, 204, 6, 55, "Section"],
Cell[323140, 9186, 138, 3, 27, "Input"],
Cell[323281, 9191, 96, 1, 26, "Text"],
Cell[323380, 9194, 571, 16, 33, "Input"],
Cell[323954, 9212, 332, 6, 47, "Input"],
Cell[324289, 9220, 274, 7, 33, "Input"],
Cell[324566, 9229, 773, 18, 33, "Input"],
Cell[325342, 9249, 107, 1, 26, "Text"],
Cell[325452, 9252, 371, 11, 33, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[325860, 9268, 288, 11, 55, "Section"],
Cell[326151, 9281, 94, 1, 28, "Input"],
Cell[326248, 9284, 118, 2, 28, "Input"],
Cell[326369, 9288, 160, 3, 29, "Text"],
Cell[326532, 9293, 962, 24, 28, "Input"],
Cell[327497, 9319, 221, 4, 29, "Text"],
Cell[327721, 9325, 178, 4, 29, "Text"],
Cell[327902, 9331, 1060, 30, 28, "Input"],
Cell[328965, 9363, 302, 5, 29, "Text"],
Cell[329270, 9370, 1554, 46, 46, "Input"],
Cell[330827, 9418, 204, 4, 29, "Text"],
Cell[331034, 9424, 705, 17, 28, "Input"],
Cell[331742, 9443, 242, 5, 29, "Text"],
Cell[CellGroupData[{
Cell[332009, 9452, 143, 2, 44, "Subsection"],
Cell[332155, 9456, 904, 20, 46, "Input"],
Cell[333062, 9478, 349, 8, 28, "Input"],
Cell[333414, 9488, 144, 2, 28, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[333595, 9495, 157, 2, 44, "Subsection"],
Cell[333755, 9499, 853, 21, 46, "Input"],
Cell[334611, 9522, 553, 15, 28, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[335201, 9542, 158, 2, 44, "Subsection"],
Cell[335362, 9546, 975, 24, 46, "Input"],
Cell[336340, 9572, 632, 17, 28, "Input"],
Cell[336975, 9591, 285, 8, 119, "Text"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[337309, 9605, 213, 6, 55, "Section"],
Cell[337525, 9613, 2469, 74, 123, "Input"],
Cell[339997, 9689, 189, 5, 28, "Input"],
Cell[CellGroupData[{
Cell[340211, 9698, 149, 2, 44, "Subsection"],
Cell[340363, 9702, 1460, 43, 66, "Input"],
Cell[341826, 9747, 354, 8, 28, "Input"],
Cell[342183, 9757, 332, 10, 28, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[342552, 9772, 112, 1, 44, "Subsection"],
Cell[342667, 9775, 354, 8, 28, "Input"],
Cell[343024, 9785, 679, 19, 28, "Input"],
Cell[343706, 9806, 842, 23, 51, "Input"],
Cell[344551, 9831, 401, 11, 28, "Input"],
Cell[344955, 9844, 387, 11, 46, "Input"],
Cell[345345, 9857, 840, 24, 48, "Input"],
Cell[346188, 9883, 1197, 34, 48, "Input"],
Cell[347388, 9919, 225, 5, 28, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[347650, 9929, 112, 1, 44, "Subsection"],
Cell[347765, 9932, 237, 6, 28, "Input"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[348051, 9944, 214, 6, 55, "Section"],
Cell[348268, 9952, 118, 2, 28, "Input"],
Cell[348389, 9956, 711, 19, 35, "Input"],
Cell[349103, 9977, 268, 6, 28, "Input"],
Cell[349374, 9985, 227, 5, 28, "Input"],
Cell[349604, 9992, 1377, 40, 53, "Input"],
Cell[350984, 10034, 679, 18, 46, "Input"],
Cell[351666, 10054, 283, 7, 28, "Input"],
Cell[351952, 10063, 1148, 31, 46, "Input"],
Cell[353103, 10096, 288, 8, 28, "Input"],
Cell[353394, 10106, 1276, 29, 115, "Input"],
Cell[CellGroupData[{
Cell[354695, 10139, 163, 2, 44, "Subsection"],
Cell[354861, 10143, 1020, 26, 46, "Input"],
Cell[355884, 10171, 490, 13, 27, "Input"],
Cell[356377, 10186, 415, 12, 27, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[356829, 10203, 418, 11, 37, "Subsection"],
Cell[357250, 10216, 971, 23, 46, "Input"],
Cell[358224, 10241, 347, 8, 27, "Input"],
Cell[358574, 10251, 242, 6, 27, "Input"],
Cell[CellGroupData[{
Cell[358841, 10261, 132, 1, 24, "Subsubsection"],
Cell[358976, 10264, 428, 12, 27, "Input"],
Cell[359407, 10278, 449, 12, 27, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[359893, 10295, 207, 4, 24, "Subsubsection"],
Cell[360103, 10301, 1356, 35, 62, "Input"],
Cell[361462, 10338, 323, 9, 26, "Text"],
Cell[361788, 10349, 1138, 26, 43, "Input"],
Cell[362929, 10377, 788, 17, 27, "Input"],
Cell[363720, 10396, 703, 17, 50, "Input"],
Cell[364426, 10415, 745, 17, 27, "Input"],
Cell[365174, 10434, 630, 12, 27, "Input"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[365853, 10452, 301, 7, 37, "Subsection"],
Cell[366157, 10461, 1586, 41, 46, "Input"],
Cell[367746, 10504, 603, 16, 27, "Input"],
Cell[368352, 10522, 517, 12, 27, "Input"],
Cell[368872, 10536, 689, 16, 27, "Input"],
Cell[369564, 10554, 609, 16, 50, "Input"],
Cell[370176, 10572, 650, 16, 27, "Input"],
Cell[370829, 10590, 700, 19, 27, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[371566, 10614, 80, 1, 34, "Subsection"],
Cell[371649, 10617, 832, 19, 49, "Input"],
Cell[372484, 10638, 166, 3, 27, "Input"],
Cell[372653, 10643, 298, 6, 27, "Input"],
Cell[372954, 10651, 1820, 40, 47, "Input"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[374823, 10697, 107, 1, 50, "Section"],
Cell[374933, 10700, 618, 15, 28, "Input"],
Cell[375554, 10717, 374, 11, 50, "Input"],
Cell[375931, 10730, 507, 14, 28, "Input"],
Cell[376441, 10746, 314, 9, 28, "Input"],
Cell[376758, 10757, 313, 9, 50, "Input"],
Cell[377074, 10768, 264, 7, 32, "Input"],
Cell[377341, 10777, 957, 25, 49, "Input"],
Cell[378301, 10804, 544, 15, 35, "Input"],
Cell[378848, 10821, 541, 14, 51, "Input"],
Cell[379392, 10837, 679, 16, 35, "Input"],
Cell[380074, 10855, 203, 5, 45, "Input"],
Cell[380280, 10862, 603, 16, 50, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[380920, 10883, 116, 1, 50, "Section"],
Cell[381039, 10886, 119, 2, 28, "Input"],
Cell[381161, 10890, 783, 22, 65, "Input"],
Cell[381947, 10914, 384, 8, 28, "Input"],
Cell[382334, 10924, 94, 1, 28, "Input"],
Cell[382431, 10927, 686, 18, 28, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[383154, 10950, 126, 1, 46, "Subchapter"],
Cell[CellGroupData[{
Cell[383305, 10955, 101, 1, 64, "Section"],
Cell[383409, 10958, 117, 2, 28, "Input"],
Cell[383529, 10962, 125, 2, 28, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[383691, 10969, 102, 1, 64, "Section"],
Cell[383796, 10972, 1117, 23, 46, "Input"],
Cell[384916, 10997, 7899, 229, 187, "Input"],
Cell[392818, 11228, 957, 24, 46, "Input"],
Cell[393778, 11254, 863, 18, 28, "Input"],
Cell[394644, 11274, 1916, 42, 57, "Input"],
Cell[396563, 11318, 441, 11, 28, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[397041, 11334, 99, 1, 64, "Section"],
Cell[CellGroupData[{
Cell[397165, 11339, 96, 1, 44, "Subsection"],
Cell[397264, 11342, 289, 6, 28, "Input"],
Cell[397556, 11350, 1532, 33, 53, "Input"],
Cell[399091, 11385, 799, 13, 28, "Input"],
Cell[399893, 11400, 286, 6, 46, "Input"],
Cell[400182, 11408, 133, 2, 28, "Input"],
Cell[400318, 11412, 367, 9, 46, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[400722, 11426, 110, 1, 44, "Subsection"],
Cell[400835, 11429, 654, 15, 28, "Input"],
Cell[401492, 11446, 1294, 35, 85, "Input"],
Cell[402789, 11483, 165, 3, 28, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[403003, 11492, 156, 2, 64, "Section"],
Cell[CellGroupData[{
Cell[403184, 11498, 98, 1, 44, "Subsection"],
Cell[403285, 11501, 289, 6, 28, "Input"],
Cell[403577, 11509, 2220, 55, 75, "Input"],
Cell[405800, 11566, 700, 11, 28, "Input"],
Cell[406503, 11579, 357, 9, 46, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[406897, 11593, 161, 2, 44, "Subsection"],
Cell[407061, 11597, 1016, 27, 48, "Input"],
Cell[408080, 11626, 408, 10, 46, "Input"],
Cell[408491, 11638, 287, 7, 28, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[408827, 11651, 103, 1, 64, "Section"],
Cell[408933, 11654, 183, 4, 28, "Input"],
Cell[409119, 11660, 183, 4, 28, "Input"],
Cell[409305, 11666, 1328, 36, 63, "Input"],
Cell[410636, 11704, 1377, 37, 63, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[412050, 11746, 103, 1, 64, "Section"],
Cell[CellGroupData[{
Cell[412178, 11751, 107, 1, 44, "Subsection"],
Cell[412288, 11754, 305, 7, 28, "Input"],
Cell[412596, 11763, 760, 23, 63, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[413393, 11791, 101, 1, 44, "Subsection"],
Cell[413497, 11794, 512, 11, 46, "Input"],
Cell[414012, 11807, 400, 9, 46, "Input"],
Cell[414415, 11818, 397, 9, 46, "Input"],
Cell[CellGroupData[{
Cell[414837, 11831, 103, 1, 35, "Subsubsection"],
Cell[414943, 11834, 462, 15, 50, "Input"],
Cell[415408, 11851, 585, 13, 28, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[416030, 11869, 102, 1, 35, "Subsubsection"],
Cell[416135, 11872, 342, 9, 28, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[416514, 11886, 104, 1, 35, "Subsubsection"],
Cell[416621, 11889, 528, 16, 50, "Input"],
Cell[417152, 11907, 456, 13, 28, "Input"],
Cell[417611, 11922, 322, 8, 28, "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[417994, 11937, 306, 9, 68, "Section"],
Cell[418303, 11948, 392, 10, 46, "Input"],
Cell[418698, 11960, 209, 5, 28, "Input"],
Cell[CellGroupData[{
Cell[418932, 11969, 104, 1, 35, "Subsubsection"],
Cell[419039, 11972, 437, 11, 28, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[419513, 11988, 102, 1, 35, "Subsubsection"],
Cell[419618, 11991, 474, 13, 28, "Input"],
Cell[420095, 12006, 378, 9, 28, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[420510, 12020, 101, 1, 35, "Subsubsection"],
Cell[420614, 12023, 333, 9, 28, "Input"]
}, Open  ]]
}, Open  ]]
}, Closed]]
}
]
*)

(* End of internal cache information *)
